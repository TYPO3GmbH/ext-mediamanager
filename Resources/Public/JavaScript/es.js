!function(){const e={NODE_ENV:"production"};try{if(process)return process.env=Object.assign({},process.env),void Object.assign(process.env,e)}catch(e){}globalThis.process={env:e}}();var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function __extends(e,t){function r(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function __decorate(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function __values(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}const isCEPolyfill="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,removeNodes=(e,t,r=null)=>{for(;t!==r;){const r=t.nextSibling;e.removeChild(t),t=r}},marker=`{{lit-${String(Math.random()).slice(2)}}}`,nodeMarker=`\x3c!--${marker}--\x3e`,markerRegex=new RegExp(`${marker}|${nodeMarker}`),boundAttributeSuffix="$lit$";class Template{constructor(e,t){this.parts=[],this.element=t;const r=[],o=[],n=document.createTreeWalker(t.content,133,null,!1);let i=0,a=-1,s=0;const{strings:l,values:{length:c}}=e;for(;s<c;){const e=n.nextNode();if(null!==e){if(a++,1===e.nodeType){if(e.hasAttributes()){const t=e.attributes,{length:r}=t;let o=0;for(let e=0;e<r;e++)endsWith(t[e].name,boundAttributeSuffix)&&o++;for(;o-- >0;){const t=l[s],r=lastAttributeNameRegex.exec(t)[2],o=r.toLowerCase()+boundAttributeSuffix,n=e.getAttribute(o);e.removeAttribute(o);const i=n.split(markerRegex);this.parts.push({type:"attribute",index:a,name:r,strings:i}),s+=i.length-1}}"TEMPLATE"===e.tagName&&(o.push(e),n.currentNode=e.content)}else if(3===e.nodeType){const t=e.data;if(t.indexOf(marker)>=0){const o=e.parentNode,n=t.split(markerRegex),i=n.length-1;for(let t=0;t<i;t++){let r,i=n[t];if(""===i)r=createMarker();else{const e=lastAttributeNameRegex.exec(i);null!==e&&endsWith(e[2],boundAttributeSuffix)&&(i=i.slice(0,e.index)+e[1]+e[2].slice(0,-boundAttributeSuffix.length)+e[3]),r=document.createTextNode(i)}o.insertBefore(r,e),this.parts.push({type:"node",index:++a})}""===n[i]?(o.insertBefore(createMarker(),e),r.push(e)):e.data=n[i],s+=i}}else if(8===e.nodeType)if(e.data===marker){const t=e.parentNode;null!==e.previousSibling&&a!==i||(a++,t.insertBefore(createMarker(),e)),i=a,this.parts.push({type:"node",index:a}),null===e.nextSibling?e.data="":(r.push(e),a--),s++}else{let t=-1;for(;-1!==(t=e.data.indexOf(marker,t+1));)this.parts.push({type:"node",index:-1}),s++}}else n.currentNode=o.pop()}for(const e of r)e.parentNode.removeChild(e)}}const endsWith=(e,t)=>{const r=e.length-t.length;return r>=0&&e.slice(r)===t},isTemplatePartActive=e=>-1!==e.index,createMarker=()=>document.createComment(""),lastAttributeNameRegex=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/,walkerNodeFilter=133;function removeNodesFromTemplate(e,t){const{element:{content:r},parts:o}=e,n=document.createTreeWalker(r,walkerNodeFilter,null,!1);let i=nextActiveIndexInTemplateParts(o),a=o[i],s=-1,l=0;const c=[];let d=null;for(;n.nextNode();){s++;const e=n.currentNode;for(e.previousSibling===d&&(d=null),t.has(e)&&(c.push(e),null===d&&(d=e)),null!==d&&l++;void 0!==a&&a.index===s;)a.index=null!==d?-1:a.index-l,i=nextActiveIndexInTemplateParts(o,i),a=o[i]}c.forEach((e=>e.parentNode.removeChild(e)))}const countNodes=e=>{let t=11===e.nodeType?0:1;const r=document.createTreeWalker(e,walkerNodeFilter,null,!1);for(;r.nextNode();)t++;return t},nextActiveIndexInTemplateParts=(e,t=-1)=>{for(let r=t+1;r<e.length;r++){const t=e[r];if(isTemplatePartActive(t))return r}return-1};function insertNodeIntoTemplate(e,t,r=null){const{element:{content:o},parts:n}=e;if(null==r)return void o.appendChild(t);const i=document.createTreeWalker(o,walkerNodeFilter,null,!1);let a=nextActiveIndexInTemplateParts(n),s=0,l=-1;for(;i.nextNode();){l++;for(i.currentNode===r&&(s=countNodes(t),r.parentNode.insertBefore(t,r));-1!==a&&n[a].index===l;){if(s>0){for(;-1!==a;)n[a].index+=s,a=nextActiveIndexInTemplateParts(n,a);return}a=nextActiveIndexInTemplateParts(n,a)}}}const directives=new WeakMap,directive=e=>(...t)=>{const r=e(...t);return directives.set(r,!0),r},isDirective=e=>"function"==typeof e&&directives.has(e),noChange={},nothing={};class TemplateInstance{constructor(e,t,r){this.__parts=[],this.template=e,this.processor=t,this.options=r}update(e){let t=0;for(const r of this.__parts)void 0!==r&&r.setValue(e[t]),t++;for(const e of this.__parts)void 0!==e&&e.commit()}_clone(){const e=isCEPolyfill?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],r=this.template.parts,o=document.createTreeWalker(e,133,null,!1);let n,i=0,a=0,s=o.nextNode();for(;i<r.length;)if(n=r[i],isTemplatePartActive(n)){for(;a<n.index;)a++,"TEMPLATE"===s.nodeName&&(t.push(s),o.currentNode=s.content),null===(s=o.nextNode())&&(o.currentNode=t.pop(),s=o.nextNode());if("node"===n.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(s.previousSibling),this.__parts.push(e)}else this.__parts.push(...this.processor.handleAttributeExpressions(s,n.name,n.strings,this.options));i++}else this.__parts.push(void 0),i++;return isCEPolyfill&&(document.adoptNode(e),customElements.upgrade(e)),e}}const policy=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:e=>e}),commentMarker=` ${marker} `;class TemplateResult{constructor(e,t,r,o){this.strings=e,this.values=t,this.type=r,this.processor=o}getHTML(){const e=this.strings.length-1;let t="",r=!1;for(let o=0;o<e;o++){const e=this.strings[o],n=e.lastIndexOf("\x3c!--");r=(n>-1||r)&&-1===e.indexOf("--\x3e",n+1);const i=lastAttributeNameRegex.exec(e);t+=null===i?e+(r?commentMarker:nodeMarker):e.substr(0,i.index)+i[1]+i[2]+boundAttributeSuffix+i[3]+marker}return t+=this.strings[e],t}getTemplateElement(){const e=document.createElement("template");let t=this.getHTML();return void 0!==policy&&(t=policy.createHTML(t)),e.innerHTML=t,e}}const isPrimitive=e=>null===e||!("object"==typeof e||"function"==typeof e),isIterable=e=>Array.isArray(e)||!(!e||!e[Symbol.iterator]);class AttributeCommitter{constructor(e,t,r){this.dirty=!0,this.element=e,this.name=t,this.strings=r,this.parts=[];for(let e=0;e<r.length-1;e++)this.parts[e]=this._createPart()}_createPart(){return new AttributePart(this)}_getValue(){const e=this.strings,t=e.length-1,r=this.parts;if(1===t&&""===e[0]&&""===e[1]){const e=r[0].value;if("symbol"==typeof e)return String(e);if("string"==typeof e||!isIterable(e))return e}let o="";for(let n=0;n<t;n++){o+=e[n];const t=r[n];if(void 0!==t){const e=t.value;if(isPrimitive(e)||!isIterable(e))o+="string"==typeof e?e:String(e);else for(const t of e)o+="string"==typeof t?t:String(t)}}return o+=e[t],o}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class AttributePart{constructor(e){this.value=void 0,this.committer=e}setValue(e){e===noChange||isPrimitive(e)&&e===this.value||(this.value=e,isDirective(e)||(this.committer.dirty=!0))}commit(){for(;isDirective(this.value);){const e=this.value;this.value=noChange,e(this)}this.value!==noChange&&this.committer.commit()}}class NodePart{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(createMarker()),this.endNode=e.appendChild(createMarker())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=createMarker()),e.__insert(this.endNode=createMarker())}insertAfterPart(e){e.__insert(this.startNode=createMarker()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){if(null===this.startNode.parentNode)return;for(;isDirective(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=noChange,e(this)}const e=this.__pendingValue;e!==noChange&&(isPrimitive(e)?e!==this.value&&this.__commitText(e):e instanceof TemplateResult?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):isIterable(e)?this.__commitIterable(e):e===nothing?(this.value=nothing,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const t=this.startNode.nextSibling,r="string"==typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=r:this.__commitNode(document.createTextNode(r)),this.value=e}__commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof TemplateInstance&&this.value.template===t)this.value.update(e.values);else{const r=new TemplateInstance(t,e.processor,this.options),o=r._clone();r.update(e.values),this.__commitNode(o),this.value=r}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let r,o=0;for(const n of e)r=t[o],void 0===r&&(r=new NodePart(this.options),t.push(r),0===o?r.appendIntoPart(this):r.insertAfterPart(t[o-1])),r.setValue(n),r.commit(),o++;o<t.length&&(t.length=o,this.clear(r&&r.endNode))}clear(e=this.startNode){removeNodes(this.startNode.parentNode,e.nextSibling,this.endNode)}}class BooleanAttributePart{constructor(e,t,r){if(this.value=void 0,this.__pendingValue=void 0,2!==r.length||""!==r[0]||""!==r[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=r}setValue(e){this.__pendingValue=e}commit(){for(;isDirective(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=noChange,e(this)}if(this.__pendingValue===noChange)return;const e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=noChange}}class PropertyCommitter extends AttributeCommitter{constructor(e,t,r){super(e,t,r),this.single=2===r.length&&""===r[0]&&""===r[1]}_createPart(){return new PropertyPart(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class PropertyPart extends AttributePart{}let eventOptionsSupported=!1;(()=>{try{const e={get capture(){return eventOptionsSupported=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}})();class EventPart{constructor(e,t,r){this.value=void 0,this.__pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=r,this.__boundHandleEvent=e=>this.handleEvent(e)}setValue(e){this.__pendingValue=e}commit(){for(;isDirective(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=noChange,e(this)}if(this.__pendingValue===noChange)return;const e=this.__pendingValue,t=this.value,r=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),o=null!=e&&(null==t||r);r&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),o&&(this.__options=getOptions(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=noChange}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}const getOptions=e=>e&&(eventOptionsSupported?{capture:e.capture,passive:e.passive,once:e.once}:e.capture);function templateFactory(e){let t=templateCaches.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},templateCaches.set(e.type,t));let r=t.stringsArray.get(e.strings);if(void 0!==r)return r;const o=e.strings.join(marker);return r=t.keyString.get(o),void 0===r&&(r=new Template(e,e.getTemplateElement()),t.keyString.set(o,r)),t.stringsArray.set(e.strings,r),r}const templateCaches=new Map,parts=new WeakMap,render=(e,t,r)=>{let o=parts.get(t);void 0===o&&(removeNodes(t,t.firstChild),parts.set(t,o=new NodePart(Object.assign({templateFactory:templateFactory},r))),o.appendInto(t)),o.setValue(e),o.commit()};class DefaultTemplateProcessor{handleAttributeExpressions(e,t,r,o){const n=t[0];if("."===n){return new PropertyCommitter(e,t.slice(1),r).parts}if("@"===n)return[new EventPart(e,t.slice(1),o.eventContext)];if("?"===n)return[new BooleanAttributePart(e,t.slice(1),r)];return new AttributeCommitter(e,t,r).parts}handleTextExpression(e){return new NodePart(e)}}const defaultTemplateProcessor=new DefaultTemplateProcessor;"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.3.0");const html=(e,...t)=>new TemplateResult(e,t,"html",defaultTemplateProcessor),getTemplateCacheKey=(e,t)=>`${e}--${t}`;let compatibleShadyCSSVersion=!0;void 0===window.ShadyCSS?compatibleShadyCSSVersion=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),compatibleShadyCSSVersion=!1);const shadyTemplateFactory=e=>t=>{const r=getTemplateCacheKey(t.type,e);let o=templateCaches.get(r);void 0===o&&(o={stringsArray:new WeakMap,keyString:new Map},templateCaches.set(r,o));let n=o.stringsArray.get(t.strings);if(void 0!==n)return n;const i=t.strings.join(marker);if(n=o.keyString.get(i),void 0===n){const r=t.getTemplateElement();compatibleShadyCSSVersion&&window.ShadyCSS.prepareTemplateDom(r,e),n=new Template(t,r),o.keyString.set(i,n)}return o.stringsArray.set(t.strings,n),n},TEMPLATE_TYPES=["html","svg"],removeStylesFromLitTemplates=e=>{TEMPLATE_TYPES.forEach((t=>{const r=templateCaches.get(getTemplateCacheKey(t,e));void 0!==r&&r.keyString.forEach((e=>{const{element:{content:t}}=e,r=new Set;Array.from(t.querySelectorAll("style")).forEach((e=>{r.add(e)})),removeNodesFromTemplate(e,r)}))}))},shadyRenderSet=new Set,prepareTemplateStyles=(e,t,r)=>{shadyRenderSet.add(e);const o=r?r.element:document.createElement("template"),n=t.querySelectorAll("style"),{length:i}=n;if(0===i)return void window.ShadyCSS.prepareTemplateStyles(o,e);const a=document.createElement("style");for(let e=0;e<i;e++){const t=n[e];t.parentNode.removeChild(t),a.textContent+=t.textContent}removeStylesFromLitTemplates(e);const s=o.content;r?insertNodeIntoTemplate(r,a,s.firstChild):s.insertBefore(a,s.firstChild),window.ShadyCSS.prepareTemplateStyles(o,e);const l=s.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==l)t.insertBefore(l.cloneNode(!0),t.firstChild);else if(r){s.insertBefore(a,s.firstChild);const e=new Set;e.add(a),removeNodesFromTemplate(r,e)}},render$1=(e,t,r)=>{if(!r||"object"!=typeof r||!r.scopeName)throw new Error("The `scopeName` option is required.");const o=r.scopeName,n=parts.has(t),i=compatibleShadyCSSVersion&&11===t.nodeType&&!!t.host,a=i&&!shadyRenderSet.has(o),s=a?document.createDocumentFragment():t;if(render(e,s,Object.assign({templateFactory:shadyTemplateFactory(o)},r)),a){const e=parts.get(s);parts.delete(s);const r=e.value instanceof TemplateInstance?e.value.template:void 0;prepareTemplateStyles(o,s,r),removeNodes(t,t.firstChild),t.appendChild(s),parts.set(t,e)}!n&&i&&window.ShadyCSS.styleElement(t.host)};var _a;window.JSCompiler_renameProperty=(e,t)=>e;const defaultConverter={toAttribute(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},notEqual=(e,t)=>t!==e&&(t==t||e==e),defaultPropertyDeclaration={attribute:!0,type:String,converter:defaultConverter,reflect:!1,hasChanged:notEqual},STATE_HAS_UPDATED=1,STATE_UPDATE_REQUESTED=4,STATE_IS_REFLECTING_TO_ATTRIBUTE=8,STATE_IS_REFLECTING_TO_PROPERTY=16,finalized="finalized";class UpdatingElement extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach(((t,r)=>{const o=this._attributeNameForProperty(r,t);void 0!==o&&(this._attributeToPropertyMap.set(o,r),e.push(o))})),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;void 0!==e&&e.forEach(((e,t)=>this._classProperties.set(t,e)))}}static createProperty(e,t=defaultPropertyDeclaration){if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const r="symbol"==typeof e?Symbol():"__"+e,o=this.getPropertyDescriptor(e,r,t);void 0!==o&&Object.defineProperty(this.prototype,e,o)}static getPropertyDescriptor(e,t,r){return{get(){return this[t]},set(o){const n=this[e];this[t]=o,this.requestUpdateInternal(e,n,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this._classProperties&&this._classProperties.get(e)||defaultPropertyDeclaration}static finalize(){const e=Object.getPrototypeOf(this);if(e.hasOwnProperty(finalized)||e.finalize(),this[finalized]=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]];for(const r of t)this.createProperty(r,e[r])}}static _attributeNameForProperty(e,t){const r=t.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t,r=notEqual){return r(e,t)}static _propertyValueFromAttribute(e,t){const r=t.type,o=t.converter||defaultConverter,n="function"==typeof o?o:o.fromAttribute;return n?n(e,r):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const r=t.type,o=t.converter;return(o&&o.toAttribute||defaultConverter.toAttribute)(e,r)}initialize(){this._updateState=0,this._updatePromise=new Promise((e=>this._enableUpdatingResolver=e)),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach(((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}}))}_applyInstanceProperties(){this._instanceProperties.forEach(((e,t)=>this[t]=e)),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,t,r){t!==r&&this._attributeToProperty(e,r)}_propertyToAttribute(e,t,r=defaultPropertyDeclaration){const o=this.constructor,n=o._attributeNameForProperty(e,r);if(void 0!==n){const e=o._propertyValueToAttribute(t,r);if(void 0===e)return;this._updateState=this._updateState|STATE_IS_REFLECTING_TO_ATTRIBUTE,null==e?this.removeAttribute(n):this.setAttribute(n,e),this._updateState=this._updateState&~STATE_IS_REFLECTING_TO_ATTRIBUTE}}_attributeToProperty(e,t){if(this._updateState&STATE_IS_REFLECTING_TO_ATTRIBUTE)return;const r=this.constructor,o=r._attributeToPropertyMap.get(e);if(void 0!==o){const e=r.getPropertyOptions(o);this._updateState=this._updateState|STATE_IS_REFLECTING_TO_PROPERTY,this[o]=r._propertyValueFromAttribute(t,e),this._updateState=this._updateState&~STATE_IS_REFLECTING_TO_PROPERTY}}requestUpdateInternal(e,t,r){let o=!0;if(void 0!==e){const n=this.constructor;r=r||n.getPropertyOptions(e),n._valueHasChanged(this[e],t,r.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==r.reflect||this._updateState&STATE_IS_REFLECTING_TO_PROPERTY||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,r))):o=!1}!this._hasRequestedUpdate&&o&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(e,t){return this.requestUpdateInternal(e,t),this.updateComplete}async _enqueueUpdate(){this._updateState=this._updateState|STATE_UPDATE_REQUESTED;try{await this._updatePromise}catch(e){}const e=this.performUpdate();return null!=e&&await e,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return this._updateState&STATE_UPDATE_REQUESTED}get hasUpdated(){return this._updateState&STATE_HAS_UPDATED}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{e=this.shouldUpdate(t),e?this.update(t):this._markUpdated()}catch(t){throw e=!1,this._markUpdated(),t}e&&(this._updateState&STATE_HAS_UPDATED||(this._updateState=this._updateState|STATE_HAS_UPDATED,this.firstUpdated(t)),this.updated(t))}_markUpdated(){this._changedProperties=new Map,this._updateState=this._updateState&~STATE_UPDATE_REQUESTED}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach(((e,t)=>this._propertyToAttribute(t,this[t],e))),this._reflectingProperties=void 0),this._markUpdated()}updated(e){}firstUpdated(e){}}_a=finalized,UpdatingElement[_a]=!0;const legacyCustomElement=(e,t)=>(window.customElements.define(e,t),t),standardCustomElement=(e,t)=>{const{kind:r,elements:o}=t;return{kind:r,elements:o,finisher(t){window.customElements.define(e,t)}}},customElement=e=>t=>"function"==typeof t?legacyCustomElement(e,t):standardCustomElement(e,t),standardProperty=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?Object.assign(Object.assign({},t),{finisher(r){r.createProperty(t.key,e)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(r){r.createProperty(t.key,e)}},legacyProperty=(e,t,r)=>{t.constructor.createProperty(r,e)};function property(e){return(t,r)=>void 0!==r?legacyProperty(e,t,r):standardProperty(e,t)}function internalProperty(e){return property({attribute:!1,hasChanged:null==e?void 0:e.hasChanged})}function query(e,t){return(r,o)=>{const n={get(){return this.renderRoot.querySelector(e)},enumerable:!0,configurable:!0};if(t){const t="symbol"==typeof o?Symbol():"__"+o;n.get=function(){return void 0===this[t]&&(this[t]=this.renderRoot.querySelector(e)),this[t]}}return void 0!==o?legacyQuery(n,r,o):standardQuery(n,r)}}function queryAsync(e){return(t,r)=>{const o={async get(){return await this.updateComplete,this.renderRoot.querySelector(e)},enumerable:!0,configurable:!0};return void 0!==r?legacyQuery(o,t,r):standardQuery(o,t)}}function queryAll(e){return(t,r)=>{const o={get(){return this.renderRoot.querySelectorAll(e)},enumerable:!0,configurable:!0};return void 0!==r?legacyQuery(o,t,r):standardQuery(o,t)}}const legacyQuery=(e,t,r)=>{Object.defineProperty(t,r,e)},standardQuery=(e,t)=>({kind:"method",placement:"prototype",key:t.key,descriptor:e}),ElementProto=Element.prototype,legacyMatches=ElementProto.msMatchesSelector||ElementProto.webkitMatchesSelector;function queryAssignedNodes(e="",t=!1,r=""){return(o,n)=>{const i={get(){const o="slot"+(e?`[name=${e}]`:":not([name])"),n=this.renderRoot.querySelector(o);let i=n&&n.assignedNodes({flatten:t});return i&&r&&(i=i.filter((e=>e.nodeType===Node.ELEMENT_NODE&&e.matches?e.matches(r):legacyMatches.call(e,r)))),i},enumerable:!0,configurable:!0};return void 0!==n?legacyQuery(i,o,n):standardQuery(i,o)}}const supportsAdoptingStyleSheets=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,constructionToken=Symbol();class CSSResult{constructor(e,t){if(t!==constructionToken)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&(supportsAdoptingStyleSheets?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const unsafeCSS=e=>new CSSResult(String(e),constructionToken),textFromCSSResult=e=>{if(e instanceof CSSResult)return e.cssText;if("number"==typeof e)return e;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${e}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)},css=(e,...t)=>{const r=t.reduce(((t,r,o)=>t+textFromCSSResult(r)+e[o+1]),e[0]);return new CSSResult(r,constructionToken)};(window.litElementVersions||(window.litElementVersions=[])).push("2.4.0");const renderNotImplemented={};class LitElement extends UpdatingElement{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const e=this.getStyles();if(Array.isArray(e)){const t=(e,r)=>e.reduceRight(((e,r)=>Array.isArray(r)?t(r,e):(e.add(r),e)),r),r=t(e,new Set),o=[];r.forEach((e=>o.unshift(e))),this._styles=o}else this._styles=void 0===e?[]:[e];this._styles=this._styles.map((e=>{if(e instanceof CSSStyleSheet&&!supportsAdoptingStyleSheets){const t=Array.prototype.slice.call(e.cssRules).reduce(((e,t)=>e+t.cssText),"");return unsafeCSS(t)}return e}))}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?supportsAdoptingStyleSheets?this.renderRoot.adoptedStyleSheets=e.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map((e=>e.cssText)),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(e){const t=this.render();super.update(e),t!==renderNotImplemented&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach((e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)})))}render(){return renderNotImplemented}}LitElement.finalized=!0,LitElement.render=render$1;var css_248z=css`:host{display:block}#alert{display:flex;padding:var(--typo3-alert-padding-y,.75rem) var(--typo3-alert-padding-y,1rem);margin-bottom:var(--typo3-alert-margin-bottom,1rem);border:var(--typo3-global-alert-border-width) solid transparent;border-radius:var(--typo3-global-alert-border-radius);align-items:center}#message{flex:1}#btn-close{font-size:var(--typo3-alert-close-btn-font-size,var(--typo3-global-close-btn-font-size));font-weight:var(--typo3-alert-close-btn-font-weight,var(--typo3-global-close-btn-font-weight));line-height:var(--typo3-alert-close-btn-line-height,var(--typo3-global-close-btn-line-height));opacity:var(--typo3-alert-close-btn-color,.5);text-shadow:0 1px 0 #fff;background-color:transparent;border:none;cursor:pointer;outline:none;color:inherit}#btn-close:hover{text-decoration:none;opacity:var(--typo3-alert-close-btn-color-hover,.75)}:host([color=primary]) #alert{color:var(--typo3-alert-primary-color,var(--typo3-global-badge-primary-color));background-color:var(--typo3-alert-primary-background-color,var(--typo3-global-badge-primary-bg));border-color:var(--typo3-global-brand-primary-border-color,var(--typo3-global-brand-primary-border-color))}:host([color=success]) #alert{color:var(--typo3-alert-success-color,var(--typo3-global-alert-success-color));background-color:var(--typo3-alert-success-background-color,var(--typo3-global-alert-success-bg));border-color:var(--typo3-alert-success-border-color,var(--typo3-global-alert-success-border))}:host([color=info]) #alert{color:var(--typo3-alert-info-color,var(--typo3-global-alert-info-color));background-color:var(--typo3-alert-info-background-color,var(--typo3-global-alert-info-bg));border-color:var(--typo3-alert-info-border-color,var(--typo3-global-alert-info-border))}:host([color=warning]) #alert{color:var(--typo3-alert-warning-color,var(--typo3-global-alert-warning-color));background-color:var(--typo3-alert-warning-background-color,var(--typo3-global-alert-warning-bg));border-color:var(--typo3-alert-warning-border-color,var(--typo3-global-alert-warning-border))}:host([color=danger]) #alert{color:var(--typo3-alert-danger-color,var(--typo3-global-alert-danger-color));background-color:var(--typo3-alert-danger-background-color,var(--typo3-global-alert-danger-bg));border-color:var(--typo3-alert-danger-border-color,var(--typo3-global-alert-danger-border))}slot{display:flex;vertical-align:center;align-items:center}`,css_248z$1=css`:host{--typo3-global-font-family-base:Verdana,Arial,Helvetica,sans-serif;--typo3-global-font-size-default:0.75rem;--typo3-global-font-weight-medium:700;--typo3-global-gray-base:#000;--typo3-global-gray-darker:#222;--typo3-global-gray-dark:#333;--typo3-global-gray:#555;--typo3-global-gray-light:#777;--typo3-global-gray-lighter:#eee;--typo3-global-brand-primary:#0078e6;--typo3-global-brand-primary-text-color:#fff;--typo3-global-brand-primary-hover:#005db3;--typo3-global-brand-primary-border-color:#006bcc;--typo3-global-brand-primary-border-color-active:#004b8f;--typo3-global-brand-primary-border-color-hover:#004b8f;--typo3-global-brand-secondary:#6c757d;--typo3-global-brand-secondary-text-color:#fff;--typo3-global-brand-secondary-hover:#545b62;--typo3-global-brand-secondary-border-color:var(--typo3-global-brand-secondary);--typo3-global-brand-secondary-border-color-active:#50565c;--typo3-global-brand-secondary-border-color-hover:#50565c;--typo3-global-brand-warning:#e8a33d;--typo3-global-brand-warning-text-color:#fff;--typo3-global-brand-warning-hover:#d88b1a;--typo3-global-brand-warning-border-color:#e59826;--typo3-global-brand-warning-border-color-active:#b87716;--typo3-global-brand-warning-border-color-hover:#b87716;--typo3-global-brand-success:#79a548;--typo3-global-brand-success-text-color:#fff;--typo3-global-brand-success-hover:#5f8139;--typo3-global-brand-success-border-color-hover:#4d682d;--typo3-global-brand-success-border-color-active:#8bb759;--typo3-global-brand-success-border-color:#6c9340;--typo3-global-brand-danger:#c83c3c;--typo3-global-brand-danger-text-color:#fff;--typo3-global-brand-danger-hover:#a32e2e;--typo3-global-brand-danger-border-color:#b73434;--typo3-global-brand-danger-border-color-active:#872626;--typo3-global-brand-danger-border-color-hover:#872626;--typo3-global-brand-info:#6daae0;--typo3-global-brand-info-text-color:#fff;--typo3-global-brand-info-hover:#4391d7;--typo3-global-brand-info-border-color:#589edc;--typo3-global-brand-info-border-color-active:#2b80cc;--typo3-global-brand-info-border-color-hover:#2b80cc;--typo3-global-brand-default-text-color:var(--typo3-global-gray-dark);--typo3-global-brand-default:var(--typo3-global-gray-lighter);--typo3-global-brand-default-hover:#d4d4d4;--typo3-global-brand-default-border-color:#bbb;--typo3-global-brand-default-border-color-hover:#9c9c9c;--typo3-global-brand-default-border-color-active:#9c9c9c;--typo3-global-default-border-radius:0.125rem;--typo3-global-default-border-width:0.0625rem;--typo3-global-animation-duration:0.5s;--typo3-global-default-gap:0.25rem;--typo3-global-btn-border-radius:var(--typo3-global-default-border-color-radius);--typo3-global-btn-font-size:var(--typo3-global-font-size-default);--typo3-global-btn-line-height:1.4;--typo3-global-btn-padding:0.375rem;--typo3-global-btn-border-width:var(--typo3-global-default-border-width);--typo3-global-btn-icon-size:1rem;--typo3-global-btn-disabled-opacity:0.65;--typo3-global-close-btn-font-size:1.3125rem;--typo3-global-close-btn-font-weight:var(--typo3-global-font-weight-medium);--typo3-global-close-btn-line-height:0.75;--typo3-global-close-btn-color:#000;--typo3-global-close-btn-opacity:0.5;--typo3-global-badge-padding:0.25em 0.4em;--typo3-global-badge-font-weight:500;--typo3-global-badge-border-radius:50%;--typo3-global-badge-size:1.375rem;--typo3-global-badge-font-size:var(--typo3-global-font-size-default);--typo3-global-badge-default-color:var(--typo3-global-brand-default-text-color);--typo3-global-badge-default-bg:var(--typo3-global-brand-default);--typo3-global-badge-primary-color:var(--typo3-global-brand-primary-text-color);--typo3-global-badge-primary-bg:var(--typo3-global-brand-primary);--typo3-global-badge-success-color:var(--typo3-global-brand-success-text-color);--typo3-global-badge-success-bg:var(--typo3-global-brand-success);--typo3-global-badge-info-color:var(--typo3-global-brand-info-text-color);--typo3-global-badge-info-bg:var(--typo3-global-brand-info);--typo3-global-badge-warning-color:var(--typo3-global-brand-warning-text-color);--typo3-global-badge-warning-bg:var(--typo3-global-brand-warning);--typo3-global-badge-danger-color:var(--typo3-global-brand-danger-text-color);--typo3-global-badge-danger-bg:var(--typo3-global-brand-danger);--typo3-global-splitpane-splitter-color:var(--typo3-global-gray-lighter);--typo3-global-splitpane-splitter-color-hover:#969696;--typo3-global-splitpane-handle-width:0.125rem;--typo3-global-splitpane-handle-height:1.5rem;--typo3-global-tooltip-font-size:var(--typo3-global-font-size-default);--typo3-global-tooltip-line-height:1;--typo3-global-tooltip-bg:var(--typo3-global-gray-dark);--typo3-global-tooltip-color:#fff;--typo3-global-tooltip-padding:0.5rem;--typo3-global-tooltip-border-radius:var(--typo3-global-default-border-radius);--typo3-global-tooltip-max-width:15rem;--typo3-global-tooltip-transition:opacity var(--typo3-global-animation-duration) ease-in-out;--typo3-global-alert-border-radius:var(--typo3-global-default-border-radius);--typo3-global-alert-border-width:var(--typo3-global-default-border-width);--typo3-global-alert-success-color:#3c763d;--typo3-global-alert-success-bg:#dff0d8;--typo3-global-alert-success-border:transparent;--typo3-global-alert-info-color:#31708f;--typo3-global-alert-info-bg:#d9edf7;--typo3-global-alert-info-border:transparent;--typo3-global-alert-warning-color:#8a6d3b;--typo3-global-alert-warning-bg:#fcf8e3;--typo3-global-alert-warning-border:transparent;--typo3-global-alert-danger-color:#a94442;--typo3-global-alert-danger-bg:#f2dede;--typo3-global-alert-danger-border:transparent;--typo3-global-modal-bg:#fff;--typo3-global-modal-font-size:var(--typo3-global-font-size-default);--typo3-global-modal-padding:.625rem 1rem;--typo3-global-modal-border-color:rgba(0,0,0,0.2);--typo3-global-modal-border-width:var(--typo3-global-default-border-width);--typo3-global-modal-border-radius:var(--typo3-global-default-border-radius);--typo3-global-modal-close-btn-font-size:0.625rem;--typo3-global-modal-close-btn-line-height:1.2rem;--typo3-global-modal-close-btn-color:#000;--typo3-global-modal-close-btn-opacity:0.5;--typo3-global-list-item-icon-size:var(--typo3-global-btn-icon-size);--typo3-global-list-item-padding-x:1rem;--typo3-global-list-item-padding-y:0.25rem;--typo3-global-list-item-icon-gap:var(--typo3-global-default-gap);--typo3-global-list-item-color:rgba(0,0,0,0.87);--typo3-global-list-item-bg-hover:#f8f9fa;--typo3-global-list-item-color-hover:#16181b;--typo3-global-datagrid-border-color:var(--typo3-global-gray-lighter);--typo3-global-datagrid-cell-color:var(--typo3-global-gray-dark);--typo3-global-datagrid-order-arrow-color:var(--typo3-global-gray);--typo3-global-datagrid-font:12px Verdana;--typo3-global-datagrid-cell-height:30;--typo3-global-datagrid-cell-border-width:1;--typo3-global-breadcrumb-item-color:var(--typo3-global-brand-secondary);--typo3-global-breadcrumb-item-color-active:rgba(0,0,0,0.87);font-family:var(--typo3-theme--typo3-global-font-family,var(--typo3-global-font-family-base));font-size:var(--typo3-global-font-size-default)}`;let Typo3Alert=class extends LitElement{constructor(){super(...arguments),this.color="default",this.dismissible=!1,this.isHidden=!1}render(){return html`${this.isHidden?"":html`<div id="alert"><div id="message"><slot></slot></div>${this.dismissible?html`<button id="btn-close" @click="${this.close}">Ã—</button>`:""}</div>`}`}close(){this.dismissible&&(this.isHidden=!0,this.dispatchEvent(new CustomEvent("typo3-alert-close")))}};Typo3Alert.styles=[css_248z$1,css_248z],__decorate([property({type:String,reflect:!0})],Typo3Alert.prototype,"color",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3Alert.prototype,"dismissible",void 0),__decorate([internalProperty()],Typo3Alert.prototype,"isHidden",void 0),Typo3Alert=__decorate([customElement("typo3-alert")],Typo3Alert);var css_248z$2=css`:host{padding:var(--typo3-global-badge-padding);font-weight:var(--typo3-badge-font-weight,var(--typo3-global-badge-font-weight));vertical-align:baseline;text-align:center;display:inline-flex;justify-content:center;border-radius:var(--typo3-global-badge-border-radius);overflow:hidden;white-space:nowrap;text-overflow:ellipsis;pointer-events:none;min-width:var(--typo3-badge-size,var(--typo3-global-badge-size));height:var(--typo3-badge-size,var(--typo3-global-badge-size));line-height:var(--typo3-badge-size,var(--typo3-global-badge-size));font-size:var(--typo3-badge-font-size,var(--typo3-global-badge-font-size));color:var(--typo3-badge-text-color,var(--typo3-global-badge-default-color));background-color:var(--typo3-badge-background-color,var(--typo3-global-badge-default-bg))}:host([color=default]){color:var(--typo3-badge-default-color,var(--typo3-global-badge-default-color));background-color:var(--typo3-badge-default-background-color,var(--typo3-global-badge-default-bg))}:host([color=primary]){color:var(--typo3-badge-primary-color,var(--typo3-global-badge-primary-color));background-color:var(--typo3-badge-primary-background-color,var(--typo3-global-badge-primary-bg))}:host([color=success]){color:var(--typo3-badge-success-color,var(--typo3-global-badge-success-color));background-color:var(--typo3-badge-success-background-color,var(--typo3-global-badge-success-bg))}:host([color=info]){color:var(--typo3-badge-info-color,var(--typo3-global-badge-info-color));background-color:var(--typo3-badge-info-background-color,var(--typo3-global-badge-info-bg))}:host([color=warning]){color:var(--typo3-badge-warning-color,var(--typo3-global-badge-warning-color));background-color:var(--typo3-badge-warning-background-color,var(--typo3-global-badge-warning-bg))}:host([color=danger]){color:var(--typo3-badge-danger-color,var(--typo3-global-badge-danger-color));background-color:var(--typo3-badge-danger-background-color,var(--typo3-global-badge-danger-bg))}:host([size=small]){padding:var(--typo3-badge-padding-small,.0625rem);min-width:var(--typo3-badge-size-small,1rem);height:var(--typo3-badge-size-small,1rem);line-height:var(--typo3-badge-size-small,1rem);font-size:var(--typo3-badge-font-size-small,.5rem)}::slotted(svg){fill:currentColor;margin:auto;width:var(--typo3-badge-size,var(--typo3-global-badge-size));height:var(--typo3-badge-size,var(--typo3-global-badge-size))}:host([size=small]) ::slotted(svg){width:var(--typo3-badge-size-small,1rem);height:var(--typo3-badge-size-small,1rem)}`;let Typo3Badge=class extends LitElement{constructor(){super(...arguments),this.color="default",this.size="medium"}render(){return html`<slot></slot>`}};Typo3Badge.styles=[css_248z$1,css_248z$2],__decorate([property({type:String,reflect:!0})],Typo3Badge.prototype,"color",void 0),__decorate([property({type:String,reflect:!0})],Typo3Badge.prototype,"size",void 0),Typo3Badge=__decorate([customElement("typo3-badge")],Typo3Badge);var css_248z$3=css`.breadcrumb{display:flex;flex-wrap:nowrap;white-space:nowrap}::slotted(:not(:last-child)):after{display:inline-block;padding-right:var(--typo3-breadcrumb-separator-gap,var(--typo3-global-default-gap));padding-left:var(--typo3-breadcrumb-separator-gap,var(--typo3-global-default-gap));color:var(--typo3-breadcrumb-item-color,var(--typo3-global-breadcrumb-item-color));content:var(--typo3-breadcrumb-separator-content,"/")}`;let Typo3Breadcrumb=class extends LitElement{constructor(){super(...arguments),this.handleResize=()=>{this.resizeAction&&window.clearTimeout(this.resizeAction),this.resizeAction=window.setTimeout(this.stripBreadcrumbs,100)},this.stripBreadcrumbs=()=>{const e=this.getBoundingClientRect().width;this.items.forEach((e=>e.shortened=!1));let t=this.items.map((e=>e.originalWidth)).reduce(((e,t)=>e+t),0);const r=this.items.slice(1,-1);for(;t>e&&r.length>0;){const e=r.shift();t-=e.originalWidth-35,e.shortened=!0}}}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.handleResize),this.handleResize(),this.resizeObserver=new ResizeObserver(this.handleResize),this.resizeObserver.observe(this)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("resize",this.handleResize),this.resizeObserver.disconnect()}render(){return html`<div class="breadcrumb"><slot name="item"></slot></div>`}};Typo3Breadcrumb.styles=[css_248z$1,css_248z$3],__decorate([queryAssignedNodes("item",!1,"typo3-breadcrumb-item")],Typo3Breadcrumb.prototype,"items",void 0),Typo3Breadcrumb=__decorate([customElement("typo3-breadcrumb")],Typo3Breadcrumb);var css_248z$4=css`.breadcrumb-item{text-decoration:none;color:var(--typo3-breadcrumb-item-color,var(--typo3-global-breadcrumb-item-color));white-space:nowrap}:host([active]) .breadcrumb-item,a.breadcrumb-item:hover{color:var(--typo3-breadcrumb-item-color-active,var(--typo3-global-breadcrumb-item-color-active))}`;let Typo3BreadcrumbItem=class extends LitElement{constructor(){super(...arguments),this.active=!1,this.title="",this.link=null,this.shortened=!1,this.originalWidth=0}firstUpdated(){this.originalWidth=this.getBoundingClientRect().width}render(){const e=this.shortened?"...":this.title;return null===this.link?html`<span class="breadcrumb-item">${e}</span>`:html`<a class="breadcrumb-item" href="${this.link}" title="${this.title}">${e}</a>`}};Typo3BreadcrumbItem.styles=[css_248z$1,css_248z$4],__decorate([property({type:Boolean,reflect:!0})],Typo3BreadcrumbItem.prototype,"active",void 0),__decorate([property({type:String,reflect:!0})],Typo3BreadcrumbItem.prototype,"title",void 0),__decorate([property({type:String,reflect:!0})],Typo3BreadcrumbItem.prototype,"link",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3BreadcrumbItem.prototype,"shortened",void 0),Typo3BreadcrumbItem=__decorate([customElement("typo3-breadcrumb-item")],Typo3BreadcrumbItem);var css_248z$5=css`:host{display:inline-flex;flex-direction:row;vertical-align:top}.button #label{white-space:nowrap}.button #label+::slotted([slot=icon]),.button slot[name=icon]+#label{margin-left:var(--typo3-btn-text-icon-gap,var(--typo3-global-default-gap))}.button{display:flex;flex:1 1 auto;cursor:pointer;padding:var(--typo3-btn-padding,var(--typo3-global-btn-padding));outline:none;justify-content:center;align-items:center;border:var(--typo3-btn-border-width,var(--typo3-global-btn-border-width)) solid transparent;font-size:var(--typo3-btn-font-size,var(--typo3-global-btn-font-size));line-height:var(--typo3-btn-line-height,var(--typo3-global-btn-line-height));border-radius:var(--typo3-btn-border-radius,var(--typo3-global-btn-border-radius))}:host([color=default]) .button{color:var(--typo3-btn-default-color,var(--typo3-global-brand-default-text-color));background-color:var(--typo3-btn-default-background-color,var(--typo3-global-brand-default));border-color:var(--typo3-btn-default-border-color,var(--typo3-global-brand-default-border-color))}:host([color=default]) .button:focus{color:var(--typo3-btn-default-color-focus,var(--typo3-global-brand-default-text-color));background-color:var(--typo3-btn-default-background-color-focus,var(--typo3-global-brand-default-hover));border-color:var(--typo3-btn-default-border-color-focus,var(--typo3-global-brand-default-border-color-active))}:host([color=default]) .button:hover{color:var(--typo3-btn-default-color-hover,var(--typo3-global-brand-default-text-color));background-color:var(--typo3-btn-default-background-color-hover,var(--typo3-global-brand-default-hover));border-color:var(--typo3-btn-default-border-color-hover,var(--typo3-global-brand-default-border-color-hover))}:host([color=default]) .button:active,:host([color=default][active]) .button{color:var(--typo3-btn-default-color-active,var(--typo3-global-brand-default-text-color));background-color:var(--typo3-btn-default-background-color-active,var(--typo3-global-brand-default-hover));border-color:var(--typo3-btn-default-border-color-active,var(--typo3-global-brand-default-hover))}:host([color=default][disabled]) .button:focus,:host([color=default][disabled]) .button:hover{color:var(--typo3-btn-default-color,var(--typo3-global-brand-default-text-color));background-color:var(--typo3-btn-default-background-color,var(--typo3-global-brand-default))}:host([color=primary]) .button{color:var(--typo3-btn-primary-color,var(--typo3-global-brand-primary-text-color));background-color:var(--typo3-btn-primary-background-color,var(--typo3-global-brand-primary));border-color:var(--typo3-btn-primary-border-color,var(--typo3-global-brand-primary-border-color))}:host([color=primary]) .button:focus{color:var(--typo3-btn-primary-color-focus,var(--typo3-global-brand-primary-text-color));background-color:var(--typo3-btn-primary-background-color-focus,var(--typo3-global-brand-primary-hover));border-color:var(--typo3-btn-primary-border-color-focus,var(--typo3-global-brand-primary-border-color-active))}:host([color=primary]) .button:hover{color:var(--typo3-btn-primary-color-hover,var(--typo3-global-brand-primary-text-color));background-color:var(--typo3-btn-primary-background-color-hover,var(--typo3-global-brand-primary-hover));border-color:var(--typo3-btn-primary-border-color-hover,var(--typo3-global-brand-primary-border-color-hover))}:host([color=primary]) .button:active,:host([color=primary][active]) .button{color:var(--typo3-btn-primary-color-active,var(--typo3-global-brand-primary-text-color));background-color:var(--typo3-btn-primary-background-color-active,var(--typo3-global-brand-primary-hover));border-color:var(--typo3-btn-primary-border-color-active,var(--typo3-global-brand-primary-hover))}:host([color=primary][disabled]) .button:focus,:host([color=primary][disabled]) .button:hover{color:var(--typo3-btn-primary-color,var(--typo3-global-brand-primary-text-color));background-color:var(--typo3-btn-primary-background-color,var(--typo3-global-brand-primary))}:host([color=secondary]) .button{color:var(--typo3-btn-secondary-color,var(--typo3-global-brand-secondary-text-color));background-color:var(--typo3-btn-secondary-background-color,var(--typo3-global-brand-secondary));border-color:var(--typo3-btn-secondary-border-color,var(--typo3-global-brand-secondary-border-color))}:host([color=secondary]) .button:focus{color:var(--typo3-btn-secondary-color-focus,var(--typo3-global-brand-secondary-text-color));background-color:var(--typo3-btn-secondary-background-color-focus,var(--typo3-global-brand-secondary-hover));border-color:var(--typo3-btn-secondary-border-color-focus,var(--typo3-global-brand-secondary-border-color-active))}:host([color=secondary]) .button:hover{color:var(--typo3-btn-secondary-color-hover,var(--typo3-global-brand-secondary-text-color));background-color:var(--typo3-btn-secondary-background-color-hover,var(--typo3-global-brand-secondary-hover));border-color:var(--typo3-btn-secondary-border-color-hover,var(--typo3-global-brand-secondary-border-color-hover))}:host([color=secondary]) .button:active,:host([color=secondary][active]) .button{color:var(--typo3-btn-secondary-color-active,var(--typo3-global-brand-secondary-text-color));background-color:var(--typo3-btn-secondary-background-color-active,var(--typo3-global-brand-secondary-hover));border-color:var(--typo3-btn-secondary-border-color-active,var(--typo3-global-brand-secondary-hover))}:host([color=secondary][disabled]) .button:focus,:host([color=secondary][disabled]) .button:hover{color:var(--typo3-btn-secondary-color,var(--typo3-global-brand-secondary-text-color));background-color:var(--typo3-btn-secondary-background-color,var(--typo3-global-brand-secondary))}:host([color=success]) .button{color:var(--typo3-btn-success-color,var(--typo3-global-brand-success-text-color));background-color:var(--typo3-btn-success-background-color,var(--typo3-global-brand-success));border-color:var(--typo3-btn-success-border-color,var(--typo3-global-brand-success-border-color))}:host([color=success]) .button:focus{color:var(--typo3-btn-success-color-focus,var(--typo3-global-brand-success-text-color));background-color:var(--typo3-btn-success-background-color-focus,var(--typo3-global-brand-success-hover));border-color:var(--typo3-btn-success-border-color-focus,var(--typo3-global-brand-success-border-color-active))}:host([color=success]) .button:hover{color:var(--typo3-btn-success-color-hover,var(--typo3-global-brand-success-text-color));background-color:var(--typo3-btn-success-background-color-hover,var(--typo3-global-brand-success-hover));border-color:var(--typo3-btn-success-border-color-hover,var(--typo3-global-brand-success-border-color-hover))}:host([color=success]) .button:active,:host([color=success][active]) .button{color:var(--typo3-btn-success-color-active,var(--typo3-global-brand-success-text-color));background-color:var(--typo3-btn-success-background-color-active,var(--typo3-global-brand-success-hover));border-color:var(--typo3-btn-success-border-color-active,var(--typo3-global-brand-success-hover))}:host([color=success][disabled]) .button:focus,:host([color=success][disabled]) .button:hover{color:var(--typo3-btn-success-color,var(--typo3-global-brand-success-text-color));background-color:var(--typo3-btn-success-background-color,var(--typo3-global-brand-success))}:host([color=info]) .button{color:var(--typo3-btn-info-color,var(--typo3-global-brand-info-text-color));background-color:var(--typo3-btn-info-background-color,var(--typo3-global-brand-info));border-color:var(--typo3-btn-info-border-color,var(--typo3-global-brand-info-border-color))}:host([color=info]) .button:focus{color:var(--typo3-btn-info-color-focus,var(--typo3-global-brand-info-text-color));background-color:var(--typo3-btn-info-background-color-focus,var(--typo3-global-brand-info-hover));border-color:var(--typo3-btn-info-border-color-focus,var(--typo3-global-brand-info-border-color-active))}:host([color=info]) .button:hover{color:var(--typo3-btn-info-color-hover,var(--typo3-global-brand-info-text-color));background-color:var(--typo3-btn-info-background-color-hover,var(--typo3-global-brand-info-hover));border-color:var(--typo3-btn-info-border-color-hover,var(--typo3-global-brand-info-border-color-hover))}:host([color=info]) .button:active,:host([color=info][active]) .button{color:var(--typo3-btn-info-color-active,var(--typo3-global-brand-info-text-color));background-color:var(--typo3-btn-info-background-color-active,var(--typo3-global-brand-info-hover));border-color:var(--typo3-btn-info-border-color-active,var(--typo3-global-brand-info-hover))}:host([color=info][disabled]) .button:focus,:host([color=info][disabled]) .button:hover{color:var(--typo3-btn-info-color,var(--typo3-global-brand-info-text-color));background-color:var(--typo3-btn-info-background-color,var(--typo3-global-brand-info))}:host([color=warning]) .button{color:var(--typo3-btn-warning-color,var(--typo3-global-brand-warning-text-color));background-color:var(--typo3-btn-warning-background-color,var(--typo3-global-brand-warning));border-color:var(--typo3-btn-warning-border-color,var(--typo3-global-brand-warning-border-color))}:host([color=warning]) .button:focus{color:var(--typo3-btn-warning-color-focus,var(--typo3-global-brand-warning-text-color));background-color:var(--typo3-btn-warning-background-color-focus,var(--typo3-global-brand-warning-hover));border-color:var(--typo3-btn-warning-border-color-focus,var(--typo3-global-brand-warning-border-color-active))}:host([color=warning]) .button:hover{color:var(--typo3-btn-warning-color-hover,var(--typo3-global-brand-warning-text-color));background-color:var(--typo3-btn-warning-background-color-hover,var(--typo3-global-brand-warning-hover));border-color:var(--typo3-btn-warning-border-color-hover,var(--typo3-global-brand-warning-border-color-hover))}:host([color=warning]) .button:active,:host([color=warning][active]) .button{color:var(--typo3-btn-warning-color-active,var(--typo3-global-brand-warning-text-color));background-color:var(--typo3-btn-warning-background-color-active,var(--typo3-global-brand-warning-hover));border-color:var(--typo3-btn-warning-border-color-active,var(--typo3-global-brand-warning-hover))}:host([color=warning][disabled]) .button:focus,:host([color=warning][disabled]) .button:hover{color:var(--typo3-btn-warning-color,var(--typo3-global-brand-warning-text-color));background-color:var(--typo3-btn-warning-background-color,var(--typo3-global-brand-warning))}:host([color=danger]) .button{color:var(--typo3-btn-danger-color,var(--typo3-global-brand-danger-text-color));background-color:var(--typo3-btn-danger-background-color,var(--typo3-global-brand-danger));border-color:var(--typo3-btn-danger-border-color,var(--typo3-global-brand-danger-border-color))}:host([color=danger]) .button:focus{color:var(--typo3-btn-danger-color-focus,var(--typo3-global-brand-danger-text-color));background-color:var(--typo3-btn-danger-background-color-focus,var(--typo3-global-brand-danger-hover));border-color:var(--typo3-btn-danger-border-color-focus,var(--typo3-global-brand-danger-border-color-active))}:host([color=danger]) .button:hover{color:var(--typo3-btn-danger-color-hover,var(--typo3-global-brand-danger-text-color));background-color:var(--typo3-btn-danger-background-color-hover,var(--typo3-global-brand-danger-hover));border-color:var(--typo3-btn-danger-border-color-hover,var(--typo3-global-brand-danger-border-color-hover))}:host([color=danger]) .button:active,:host([color=danger][active]) .button{color:var(--typo3-btn-danger-color-active,var(--typo3-global-brand-danger-text-color));background-color:var(--typo3-btn-danger-background-color-active,var(--typo3-global-brand-danger-hover));border-color:var(--typo3-btn-danger-border-color-active,var(--typo3-global-brand-danger-hover))}:host([color=danger][disabled]) .button:focus,:host([color=danger][disabled]) .button:hover{color:var(--typo3-btn-danger-color,var(--typo3-global-brand-danger-text-color));background-color:var(--typo3-btn-danger-background-color,var(--typo3-global-brand-danger))}:host([disabled]) .button{cursor:not-allowed;opacity:var(--typo3-global-btn-disabled-opacity)}slot[name=icon]::slotted(*){fill:currentColor;width:var(--typo3-btn-icon-size,var(--typo3-global-btn-icon-size));height:var(--typo3-btn-icon-size,var(--typo3-global-btn-icon-size))}:host([only-icon]) #button{border-color:transparent;background:none}`;class Typo3BaseButton extends LitElement{constructor(){super(...arguments),this.disabled=!1,this.active=!1,this.label="",this.iconRight=!1,this.onlyicon=!1,this.color="default"}connectedCallback(){super.connectedCallback(),this.shadowRoot.addEventListener("click",(e=>{this.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),!0)}render(){return html`<button id="button" class="button" .disabled="${this.disabled}" aria-label="${this.label}">${this.buttonContent}</button>`}focus(e){this.buttonElement.focus(e)}get buttonContent(){const e=html`<slot name="icon"></slot>`,t=html`<div id="label"><slot></slot></div>`,r=[];return this.hasText&&r.push(t),this.hasIcon&&(this.iconRight?r.push(e):r.unshift(e)),r}get hasText(){return!!this.textContent&&""!==this.textContent.trim()}get hasIcon(){return!!this.querySelector('[slot="icon"]')}}__decorate([property({type:Boolean,reflect:!0})],Typo3BaseButton.prototype,"disabled",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3BaseButton.prototype,"active",void 0),__decorate([property({type:String})],Typo3BaseButton.prototype,"label",void 0),__decorate([property({type:Boolean,reflect:!0,attribute:"icon-right"})],Typo3BaseButton.prototype,"iconRight",void 0),__decorate([property({type:Boolean,reflect:!0,attribute:"only-icon"})],Typo3BaseButton.prototype,"onlyicon",void 0),__decorate([property({type:String,reflect:!0})],Typo3BaseButton.prototype,"color",void 0),__decorate([query("button")],Typo3BaseButton.prototype,"buttonElement",void 0);let Typo3Button=class extends Typo3BaseButton{};Typo3Button.styles=[css_248z$1,css_248z$5],Typo3Button=__decorate([customElement("typo3-button")],Typo3Button);var css_248z$6=css`.button>:last-child:after{display:inline-block;width:0;height:0;margin-left:.255em;vertical-align:.255em;content:"";border-top:.3em solid;border-right:.3em solid transparent;border-bottom:0;border-left:.3em solid transparent}`;let Typo3DropdownButton=class extends Typo3BaseButton{constructor(){super(),this.color="secondary"}};Typo3DropdownButton.styles=[css_248z$1,css_248z$5,css_248z$6],Typo3DropdownButton=__decorate([customElement("typo3-dropdown-button")],Typo3DropdownButton);var css_248z$7=css`div.button{pointer-events:none}:host,:host typo3-button{--typo3-btn-border-radius:none;--typo3-btn-icon-size:0.75rem}`;let Typo3SelectionButton=class extends LitElement{constructor(){super(...arguments),this.count=0,this.suffix="Selected",this.color="primary"}render(){return 0===this.count?html``:html`<div class="button">${this.count} ${this.suffix}</div><typo3-button color="${this.color}" icon-right @click="${this.clearSelection}"><svg slot="icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"/></svg></typo3-button>`}clearSelection(){this.count=0,this.dispatchEvent(new CustomEvent("typo3-selection-clear"))}};Typo3SelectionButton.styles=[css_248z$1,css_248z$5,css_248z$7],__decorate([property({type:Number,reflect:!0})],Typo3SelectionButton.prototype,"count",void 0),__decorate([property({type:String,reflect:!0})],Typo3SelectionButton.prototype,"suffix",void 0),__decorate([property({type:String,reflect:!0})],Typo3SelectionButton.prototype,"color",void 0),__decorate([query("typo3-button")],Typo3SelectionButton.prototype,"button",void 0),Typo3SelectionButton=__decorate([customElement("typo3-selection-button")],Typo3SelectionButton);var css_248z$8=css`:host{border:var(--typo3-card-border-size,.125rem) solid var(--typo3-card-border-color,#eaeaea);border-radius:var(--typo3-card-border-radius,.25rem);background-color:var(--typo3-card-background-color,#fff);width:100%;height:var(--typo3-card-height,13.0625rem);display:flex;position:relative;flex-direction:column;text-decoration:none;overflow:hidden;box-sizing:border-box}:host([selected]){outline:.125rem auto -webkit-focus-ring-color}:host(:focus),:host(:hover){border-color:var(--typo3-card-border-color-hover,var(--typo3-global-brand-info))}.body{padding:var(--typo3-card-body-padding-top,1.25rem) var(--typo3-card-body-padding-right,1.875rem) var(--typo3-card-body-padding-bottom,1.25rem) var(--typo3-card-body-padding-left,1.875rem);text-align:center}.title{font-size:var(--typo3-card-title-text-size,.875rem);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:var(--typo3-card-title-text-color,#505050)}[contenteditable=true]:focus{overflow:visible!important;white-space:pre-wrap!important}.subtitle{font-size:var(--typo3-card-subtitle-text-size,.625rem);color:var(--typo3-card-subtitle-color,#6e6e6e)}.image{padding-top:1.25rem;box-sizing:border-box;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;flex:1}.image ::slotted([slot=image]){pointer-events:none}:host([variant=file]) .image ::slotted([slot=image]){height:70%}:host([variant=folder]) .image ::slotted([slot=image]){pointer-events:none}:host slot[name=badge]{position:absolute;display:inline-block;margin-left:.625rem;font-size:.625rem;right:calc(50% - 4rem);top:calc(100% - 1.5rem)}:host([variant=preview]) .image{padding-top:0;height:12.875rem}:host([variant=preview]) .image ::slotted([slot=image]){width:100%;height:100%;object-fit:cover}:host([variant=preview]) .body{position:absolute;bottom:0;width:100%;padding-left:.5rem;padding-right:.5rem;text-align:left;z-index:1;background:linear-gradient(180deg,transparent,rgba(0,0,0,.8));box-sizing:border-box}:host([variant=preview]) .subtitle,:host([variant=preview]) .title{color:#fff;text-shadow:0 0 .1875em #000}.checkbox-button{position:absolute;top:.5rem;right:.5rem;width:1.5rem;height:1.5rem;background:none;border:none;color:inherit;padding:0;margin:0;user-select:none;cursor:pointer;background-color:#fff;border-radius:50%;outline:none}.checkbox-button .icon-actions-checkbox{height:100%;width:100%;line-height:1rem;position:relative;display:inline-block;overflow:hidden;vertical-align:-22%;color:var(--typo3-global-gray-light)}:host([selected]) .checkbox-button .icon-actions-checkbox{color:var(--typo3-global-brand-primary)}slot[name=checkbox]::slotted(svg){display:block;height:100%;width:100%;transform:translateZ(0);fill:currentcolor;pointer-events:none}`;let Typo3Card=class extends LitElement{constructor(){super(...arguments),this.title="",this.subtitle="",this.variant="file",this.selected=!1,this.titleEditable=!1,this.disabled=!1,this.notSelectable=!1,this.tabindex=-1,this.inEditMode=!1}connectedCallback(){super.connectedCallback()}render(){return html`<div class="image"><slot name="image"></slot><slot name="badge"></slot></div><div class="body"><div class="title" ?contentEditable="${this.titleEditable}" @click="${this._onClick}" @dblclick="${this._onDblclick}" @blur="${()=>this._onBlur()}" @keydown="${this._onKeyDown}">${this.title}</div><div class="subtitle">${this.subtitle}</div></div>${this.renderCheckbox}`}get renderCheckbox(){return!1===this.hasCheckboxSlot||!0===this.notSelectable?html``:html`<button aria-label="Select" class="checkbox-button" tabindex="-1"><span class="icon-actions-checkbox" aria-hidden="true"><slot name="checkbox"></slot></span></button>`}get hasCheckboxSlot(){return!!this.querySelector('[slot="checkbox"]')}_onClick(e){this.titleEditable&&(this.inEditMode=!0,e.stopImmediatePropagation())}_onDblclick(e){this.inEditMode&&e.stopImmediatePropagation()}_onBlur(e=!1){if(this.inEditMode){this.inEditMode=!1;const t=this.titleElement.innerText.trim();if(this.titleElement.innerHTML=this.title,e||t===this.title)return void this.titleElement.blur();this.dispatchEvent(new CustomEvent("typo3-card-title-rename",{detail:t}))}}_onKeyDown(e){-1!==["Enter","Tab","Escape"].indexOf(e.key)&&this._onBlur("Escape"===e.key),this.inEditMode&&e.stopPropagation()}};function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _newArrowCheck(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],o=!0,n=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){n=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(n)throw i}}return r}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _createForOfIteratorHelper(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function defaults(e){e.defaults={attributes:[["allowColumnReordering",!0],["allowColumnResize",!0],["allowColumnResizeFromCell",!1],["allowFreezingRows",!1],["allowFreezingColumns",!1],["allowMovingSelection",!0],["allowRowHeaderResize",!0],["allowRowReordering",!1],["allowRowResize",!0],["allowRowResizeFromCell",!1],["allowSorting",!0],["autoGenerateSchema",!1],["autoResizeColumns",!1],["autoResizeRows",!1],["blanksText","(Blanks)"],["borderDragBehavior","none"],["borderResizeZone",10],["clearSettingsOptionText","Clear saved settings"],["columnHeaderClickBehavior","sort"],["columnSelectorHiddenText","&nbsp;&nbsp;&nbsp;"],["columnSelectorText","Add/Remove columns"],["columnSelectorVisibleText","âœ“"],["contextHoverScrollAmount",2],["contextHoverScrollRateMs",5],["copyHeadersOnSelectAll",!0],["copyText","Copy"],["debug",!1],["editable",!0],["ellipsisText","..."],["filterOptionText","Filter %s"],["filterTextPrefix","(filtered) "],["globalRowResize",!1],["hideColumnText","Hide %s"],["hoverMode","cell"],["maxAutoCompleteItems",200],["multiLine",!1],["name",""],["pageUpDownOverlap",1],["pasteText","Paste"],["persistantSelectionMode",!1],["removeFilterOptionText","Remove filter on %s"],["reorderDeadZone",3],["resizeScrollZone",20],["rowGrabZoneSize",5],["saveAppearance",!0],["scrollAnimationPPSThreshold",.75],["scrollPointerLock",!1],["scrollRepeatRate",75],["selectionFollowsActiveCell",!1],["selectionHandleBehavior","none"],["selectionMode","cell"],["selectionScrollIncrement",20],["selectionScrollZone",20],["showClearSettingsOption",!0],["showColumnHeaders",!0],["showColumnSelector",!0],["showCopy",!1],["showFilter",!0],["showNewRow",!1],["showOrderByOption",!0],["showOrderByOptionTextAsc","Order by %s ascending"],["showOrderByOptionTextDesc","Order by %s descending"],["showPaste",!1],["showPerformance",!1],["showRowHeaders",!0],["showRowNumbers",!0],["showRowNumberGaps",!0],["singleSelectionMode",!1],["snapToRow",!1],["touchContextMenuTimeMs",800],["touchDeadZone",3],["touchEasingMethod","easeOutQuad"],["touchReleaseAcceleration",1e3],["touchReleaseAnimationDurationMs",2e3],["touchScrollZone",20],["touchSelectHandleZone",20],["touchZoomSensitivity",.005],["touchZoomMin",.5],["touchZoomMax",1.75],["maxPixelRatio",2],["tree",!1],["treeHorizontalScroll",!1]],styles:[["activeCellBackgroundColor","rgba(255, 255, 255, 1)"],["activeCellBorderColor","rgba(110, 168, 255, 1)"],["activeCellBorderWidth",1],["activeCellColor","rgba(0, 0, 0, 1)"],["activeCellFont","16px sans-serif"],["activeCellHoverBackgroundColor","rgba(255, 255, 255, 1)"],["activeCellHorizontalAlignment","left"],["activeCellHoverColor","rgba(0, 0, 0, 1)"],["activeCellOverlayBorderColor","rgba(66, 133, 244, 1)"],["activeCellOverlayBorderWidth",1],["activeCellPaddingBottom",5],["activeCellPaddingLeft",5],["activeCellPaddingRight",5],["activeCellPaddingTop",5],["activeCellSelectedBackgroundColor","rgba(236, 243, 255, 1)"],["activeCellSelectedColor","rgba(0, 0, 0, 1)"],["activeCellVerticalAlignment","center"],["activeColumnHeaderCellBackgroundColor","rgba(225, 225, 225, 1)"],["activeColumnHeaderCellColor","rgba(0, 0, 0, 1)"],["activeRowHeaderCellBackgroundColor","rgba(225, 225, 225, 1)"],["activeRowHeaderCellColor","rgba(0, 0, 0, 1)"],["autocompleteBottomMargin",60],["autosizeHeaderCellPadding",8],["autosizePadding",5],["cellAutoResizePadding",13],["cellBackgroundColor","rgba(255, 255, 255, 1)"],["cellBorderColor","rgba(195, 199, 202, 1)"],["cellBorderWidth",1],["cellColor","rgba(0, 0, 0, 1)"],["cellFont","16px sans-serif"],["cellGridHeight",250],["cellHeight",24],["cellHeightWithChildGrid",150],["cellHorizontalAlignment","left"],["cellHoverBackgroundColor","rgba(255, 255, 255, 1)"],["cellHoverColor","rgba(0, 0, 0, 1)"],["cellPaddingBottom",5],["cellPaddingLeft",5],["cellPaddingRight",5],["cellPaddingTop",5],["cellSelectedBackgroundColor","rgba(236, 243, 255, 1)"],["cellSelectedColor","rgba(0, 0, 0, 1)"],["cellVerticalAlignment","center"],["cellWidth",250],["cellWidthWithChildGrid",250],["cellWhiteSpace","nowrap"],["cellLineHeight",1],["cellLineSpacing",3],["childContextMenuArrowColor","rgba(43, 48, 43, 1)"],["childContextMenuArrowHTML","&#x25BA;"],["childContextMenuMarginLeft",-11],["childContextMenuMarginTop",-6],["columnHeaderCellBackgroundColor","rgba(240, 240, 240, 1)"],["columnHeaderCellBorderColor","rgba(172, 172, 172, 1)"],["columnHeaderCellBorderWidth",1],["columnHeaderCellCapBackgroundColor","rgba(240, 240, 240, 1)"],["columnHeaderCellCapBorderColor","rgba(172, 172, 172, 1)"],["columnHeaderCellCapBorderWidth",1],["columnHeaderCellColor","rgba(50, 50, 50, 1)"],["columnHeaderCellFont","16px sans-serif"],["columnHeaderCellHeight",25],["columnHeaderCellHorizontalAlignment","left"],["columnHeaderCellHoverBackgroundColor","rgba(235, 235, 235, 1)"],["columnHeaderCellHoverColor","rgba(0, 0, 0, 1)"],["columnHeaderCellPaddingBottom",5],["columnHeaderCellPaddingLeft",5],["columnHeaderCellPaddingRight",5],["columnHeaderCellPaddingTop",5],["columnHeaderCellVerticalAlignment","center"],["columnHeaderOrderByArrowBorderColor","rgba(195, 199, 202, 1)"],["columnHeaderOrderByArrowBorderWidth",1],["columnHeaderOrderByArrowColor","rgba(155, 155, 155, 1)"],["columnHeaderOrderByArrowHeight",8],["columnHeaderOrderByArrowMarginLeft",0],["columnHeaderOrderByArrowMarginRight",5],["columnHeaderOrderByArrowMarginTop",6],["columnHeaderOrderByArrowWidth",13],["contextFilterButtonBorder","solid 1px rgba(158, 163, 169, 1)"],["contextFilterButtonBorderRadius","3px"],["contextFilterButtonHTML","&#x25BC;"],["contextFilterInputBackground","rgba(255,255,255,1)"],["contextFilterInputBorder","solid 1px rgba(158, 163, 169, 1)"],["contextFilterInputBorderRadius","0"],["contextFilterInputColor","rgba(0,0,0,1)"],["contextFilterInputFontFamily","sans-serif"],["contextFilterInputFontSize","14px"],["contextFilterInvalidRegExpBackground","rgba(180, 6, 1, 1)"],["contextFilterInvalidRegExpColor","rgba(255, 255, 255, 1)"],["contextMenuArrowColor","rgba(43, 48, 43, 1)"],["contextMenuArrowDownHTML","&#x25BC;"],["contextMenuArrowUpHTML","&#x25B2;"],["contextMenuBackground","rgba(240, 240, 240, 1)"],["contextMenuBorder","solid 1px rgba(158, 163, 169, 1)"],["contextMenuBorderRadius","3px"],["contextMenuChildArrowFontSize","12px"],["contextMenuColor","rgba(43, 48, 43, 1)"],["contextMenuCursor","default"],["contextMenuFilterButtonFontFamily","sans-serif"],["contextMenuFilterButtonFontSize","10px"],["contextMenuFilterInvalidExpresion","rgba(237, 155, 156, 1)"],["contextMenuFontFamily","sans-serif"],["contextMenuFontSize","16px"],["contextMenuHoverBackground","rgba(182, 205, 250, 1)"],["contextMenuHoverColor","rgba(43, 48, 153, 1)"],["contextMenuItemBorderRadius","3px"],["contextMenuItemMargin","2px"],["contextMenuLabelDisplay","inline-block"],["contextMenuLabelMargin","0 3px 0 0"],["contextMenuLabelMaxWidth","700px"],["contextMenuLabelMinWidth","75px"],["contextMenuMarginLeft",3],["contextMenuMarginTop",-3],["contextMenuOpacity","0.98"],["contextMenuPadding","2px"],["contextMenuWindowMargin",30],["contextMenuZIndex",1e4],["cornerCellBackgroundColor","rgba(240, 240, 240, 1)"],["cornerCellBorderColor","rgba(202, 202, 202, 1)"],["debugBackgroundColor","rgba(0, 0, 0, .0)"],["debugColor","rgba(255, 15, 24, 1)"],["debugEntitiesColor","rgba(76, 231, 239, 1.00)"],["debugFont","11px sans-serif"],["debugPerfChartBackground","rgba(29, 25, 26, 1.00)"],["debugPerfChartTextColor","rgba(255, 255, 255, 0.8)"],["debugPerformanceColor","rgba(252, 255, 37, 1.00)"],["debugScrollHeightColor","rgba(248, 33, 103, 1.00)"],["debugScrollWidthColor","rgba(66, 255, 27, 1.00)"],["debugTouchPPSXColor","rgba(246, 102, 24, 1.00)"],["debugTouchPPSYColor","rgba(186, 0, 255, 1.00)"],["display","inline-block"],["editCellBackgroundColor","white"],["editCellBorder","solid 1px rgba(110, 168, 255, 1)"],["editCellBoxShadow","0 2px 5px rgba(0,0,0,0.4)"],["editCellColor","black"],["editCellFontFamily","sans-serif"],["editCellFontSize","16px"],["editCellPaddingLeft",4],["editCellZIndex",1e4],["frozenMarkerHoverColor","rgba(236, 243, 255, 1)"],["frozenMarkerHoverBorderColor","rgba(110, 168, 255, 1)"],["frozenMarkerActiveColor","rgba(236, 243, 255, 1)"],["frozenMarkerActiveBorderColor","rgba(110, 168, 255, 1)"],["frozenMarkerColor","rgba(222, 222, 222, 1)"],["frozenMarkerBorderColor","rgba(168, 168, 168, 1)"],["frozenMarkerBorderWidth",1],["frozenMarkerWidth",2],["gridBackgroundColor","rgba(240, 240, 240, 1)"],["gridBorderCollapse","collapse"],["gridBorderColor","rgba(202, 202, 202, 1)"],["gridBorderWidth",1],["height","auto"],["maxHeight","inherit"],["maxWidth","inherit"],["minColumnWidth",45],["minHeight","inherit"],["minRowHeight",24],["minWidth","inherit"],["mobileContextMenuMargin",10],["mobileEditInputHeight",30],["mobileEditFontFamily","sans-serif"],["mobileEditFontSize","16px"],["moveOverlayBorderWidth",1],["moveOverlayBorderColor","rgba(66, 133, 244, 1)"],["moveOverlayBorderSegments","12, 7"],["name","default"],["overflowY","auto"],["overflowX","auto"],["reorderMarkerBackgroundColor","rgba(0, 0, 0, 0.1)"],["reorderMarkerBorderColor","rgba(0, 0, 0, 0.2)"],["reorderMarkerBorderWidth",1.25],["reorderMarkerIndexBorderColor","rgba(66, 133, 244, 1)"],["reorderMarkerIndexBorderWidth",2.75],["rowHeaderCellBackgroundColor","rgba(240, 240, 240, 1)"],["rowHeaderCellBorderColor","rgba(200, 200, 200, 1)"],["rowHeaderCellBorderWidth",1],["rowHeaderCellColor","rgba(50, 50, 50, 1)"],["rowHeaderCellFont","16px sans-serif"],["rowHeaderCellHeight",25],["rowHeaderCellHorizontalAlignment","left"],["rowHeaderCellHoverBackgroundColor","rgba(235, 235, 235, 1)"],["rowHeaderCellHoverColor","rgba(0, 0, 0, 1)"],["rowHeaderCellPaddingBottom",5],["rowHeaderCellPaddingLeft",5],["rowHeaderCellPaddingRight",5],["rowHeaderCellPaddingTop",5],["rowHeaderCellRowNumberGapHeight",5],["rowHeaderCellRowNumberGapColor","rgba(50, 50, 50, 1)"],["rowHeaderCellSelectedBackgroundColor","rgba(217, 217, 217, 1)"],["rowHeaderCellSelectedColor","rgba(50, 50, 50, 1)"],["rowHeaderCellVerticalAlignment","center"],["rowHeaderCellWidth",57],["scrollBarActiveColor","rgba(125, 125, 125, 1)"],["scrollBarBackgroundColor","rgba(240, 240, 240, 1)"],["scrollBarBorderColor","rgba(202, 202, 202, 1)"],["scrollBarBorderWidth",.5],["scrollBarBoxBorderRadius",4.125],["scrollBarBoxColor","rgba(192, 192, 192, 1)"],["scrollBarBoxMargin",2],["scrollBarBoxMinSize",15],["scrollBarBoxWidth",8],["scrollBarCornerBackgroundColor","rgba(240, 240, 240, 1)"],["scrollBarCornerBorderColor","rgba(202, 202, 202, 1)"],["scrollBarWidth",11],["selectionHandleBorderColor","rgba(255, 255, 255, 1)"],["selectionHandleBorderWidth",1.5],["selectionHandleColor","rgba(66, 133, 244, 1)"],["selectionHandleSize",8],["selectionHandleType","square"],["selectionOverlayBorderColor","rgba(66, 133, 244, 1)"],["selectionOverlayBorderWidth",1],["treeArrowBorderColor","rgba(195, 199, 202, 1)"],["treeArrowBorderWidth",1],["treeArrowClickRadius",5],["treeArrowColor","rgba(155, 155, 155, 1)"],["treeArrowHeight",8],["treeArrowMarginLeft",0],["treeArrowMarginRight",5],["treeArrowMarginTop",6],["treeArrowWidth",13],["treeGridHeight",250],["width","auto"]]}}function component(){var e,t={dehyphenateProperty:function(e){e=e.replace("--cdg-","");var t,r="";return Array.prototype.forEach.call(e,(function(e){if(t)return t=!1,void(r+=e.toUpperCase());"-"!==e?r+=e:t=!0})),r},hyphenateProperty:function(e,t){var r="";return Array.prototype.forEach.call(e,(function(e){e!==e.toUpperCase()?r+=e:r+="-"+e.toLowerCase()})),(t?"--cdg-":"")+r},applyComponentStyle:function(r,o){if(o.isComponent){var n=window.getComputedStyle("CANVAS-DATAGRID"===o.tagName?o:o.canvas,null),i={};o.computedStyle=n,defaults(i),(i=i.defaults.styles).forEach((function(r){var i;""===(i=n.getPropertyValue(t.hyphenateProperty(r[0],!0)))&&(i=n.getPropertyValue(t.hyphenateProperty(r[0],!1))),""!==i&&"string"==typeof i&&o.setStyleProperty(r[0],e[_typeof(r[1])](i.replace(/^\s+/,"").replace(/\s+$/,""),r[1]),!0)})),!r&&o.dispatchEvent&&(requestAnimationFrame((function(){o.resize(!0)})),o.dispatchEvent("stylechanged",o.style))}}};return e={data:function(e){try{return JSON.parse(e)}catch(e){throw new Error("Cannot read JSON data in canvas-datagrid data.")}},schema:function(e){try{return JSON.parse(e)}catch(e){throw new Error("Cannot read JSON data in canvas-datagrid schema attribute.")}},number:function(e,t){var r=parseInt(e,10);return isNaN(r)?t:r},boolean:function(e){return/true/i.test(e)},string:function(e){return e}},t.getObservableAttributes=function(){var e={},t=["data","schema","style","className","name"];return defaults(e),e.defaults.attributes.forEach((function(e){t.push(e[0].toLowerCase())})),t},t.disconnectedCallback=function(){this.connected=!1},t.connectedCallback=function(){var e=this;e.parentDOMNode.innerHTML="",e.parentDOMNode.appendChild(e.canvas),e.connected=!0,t.observe(e),t.applyComponentStyle(!0,e),e.resize(!0)},t.adoptedCallback=function(){this.resize()},t.attributeChangedCallback=function(r,o,n){var i,a,s=this;if("style"!==r){if("data"===r)return"application/x-canvas-datagrid"===s.dataType&&(s.dataType="application/json+x-canvas-datagrid"),void(s.data=n);if("schema"!==r)if("name"!==r){if("class"!==r&&"className"!==r){var l,c;if("attributes",l=r,defaults(c={}),a=c.defaults.attributes.filter((function(e){return e[0].toLowerCase()===l.toLowerCase()||t.hyphenateProperty(e[0])===l.toLowerCase()||t.hyphenateProperty(e[0],!0)===l.toLowerCase()}))[0])return i=e[_typeof(a[1])],void(s.attributes[a[0]]=i(n));/^on/.test(r)&&s.addEventListener("on"+r,Function("e",n))}}else s.name=n;else s.schema=e.schema(n)}else t.applyComponentStyle(!1,s)},t.observe=function(e){var r;window.MutationObserver&&(e.applyComponentStyle=function(){t.applyComponentStyle(!1,e),e.resize()},(r=new window.MutationObserver((function(t){var r,o;Array.prototype.forEach.call(t,(function(t){"class"!==t.attributeName&&"style"!==t.attributeName&&"STYLE"!==t.target.nodeName?t.target.parentNode&&"STYLE"===t.target.parentNode.nodeName?o=!0:t.target===e&&(t.addedNodes.length>0||"characterData"===t.type)&&(r=!0):o=!0})),o&&e.applyComponentStyle(!1,e),r&&("application/x-canvas-datagrid"===e.dataType&&(e.dataType="application/json+x-canvas-datagrid"),e.data=e.innerHTML)}))).observe(e,{characterData:!0,childList:!0,attributes:!0,subtree:!0}),Array.prototype.forEach.call(document.querySelectorAll("style"),(function(e){r.observe(e,{characterData:!0,childList:!0,attributes:!0,subtree:!0})})))},t}function draw(e){var t=[],r=!1,o=0,n=300,i=[],a=[],s=[];function l(e,t,r,o){r=r||1;var n,i=[];for(n=e;n<=t;n+=r)i[n]=void 0===o?n:"function"==typeof o?o(n):o;return i}function c(t){var o,n=t.innerHTML||t.formattedValue,i=n.toString()+t.rowIndex.toString()+t.columnIndex.toString(),a=Math.round(t.x+e.canvasOffsetLeft),s=Math.round(t.y+e.canvasOffsetTop);if(e.htmlImageCache[i]){if(o=e.htmlImageCache[i].img,e.htmlImageCache[i].height===t.height&&e.htmlImageCache[i].width===t.width){if(!o.complete)return;return e.ctx.drawImage(o,a,s)}e.htmlImageCache[i]=void 0}else r=!1;o=new Image(t.width,t.height),e.htmlImageCache[i]={img:o,width:t.width,height:t.height},o.onload=function(){var t;e.ctx.drawImage(o,a,s),t=!0,Object.keys(e.htmlImageCache).forEach((function(r){e.htmlImageCache[r].img.complete||(t=!1)})),t&&!r&&(r=!0,e.draw())},o.src="data:image/svg+xml;base64,"+btoa('<svg xmlns="http://www.w3.org/2000/svg" width="'+t.width+'" height="'+t.height+'">\n<foreignObject class="node" x="0" y="0" width="100%" height="100%">\n<body xmlns="http://www.w3.org/1999/xhtml" style="margin:0;padding:0;">\n'+n+"\n</body></foreignObject>\n</svg>\n")}function d(t,r,o,n,i){var a=(t+=e.canvasOffsetLeft)+o,s=(r+=e.canvasOffsetTop)+n;e.ctx.beginPath(),e.ctx.moveTo(t+i,r),e.ctx.lineTo(a-i,r),e.ctx.quadraticCurveTo(a,r,a,r+i),e.ctx.lineTo(a,r+n-i),e.ctx.quadraticCurveTo(a,s,a-i,s),e.ctx.lineTo(t+i,s),e.ctx.quadraticCurveTo(t,s,t,s-i),e.ctx.lineTo(t,r+i),e.ctx.quadraticCurveTo(t,r,t+i,r)}function u(t,r,o,n){t+=e.canvasOffsetLeft,r+=e.canvasOffsetTop,e.ctx.fillRect(t,r,o,n)}function p(t,r,o,n){t+=e.canvasOffsetLeft,r+=e.canvasOffsetTop,e.ctx.strokeRect(t,r,o,n)}function h(t,r,o){r+=e.canvasOffsetLeft,o+=e.canvasOffsetTop,e.ctx.fillText(t,r,o)}function f(t){e.ctx.beginPath(),0===t&&(e.ctx.moveTo(e.lastFrozenColumnPixel,e.lastFrozenRowPixel),e.ctx.lineTo(e.lastFrozenColumnPixel,e.height),e.ctx.lineTo(e.width,e.height),e.ctx.lineTo(e.width,e.lastFrozenRowPixel)),1===t&&(e.ctx.moveTo(0,e.lastFrozenRowPixel),e.ctx.lineTo(0,e.height),e.ctx.lineTo(e.width,e.height),e.ctx.lineTo(e.width,e.lastFrozenRowPixel)),2===t&&(e.ctx.moveTo(e.lastFrozenColumnPixel,0),e.ctx.lineTo(e.width,0),e.ctx.lineTo(e.width,e.height),e.ctx.lineTo(e.lastFrozenColumnPixel,e.height)),e.ctx.clip()}function g(t,r,o){if("circle"===e.style.selectionHandleType)return function(t,r,o){t+=e.canvasOffsetLeft,r+=e.canvasOffsetTop,e.ctx.beginPath(),e.ctx.arc(t,r,o,0,2*Math.PI),e.ctx.fill()}(t,r,.5*o);u(t-.5*o,r-.5*o,o,o)}function m(t,r,o){if("circle"===e.style.selectionHandleType)return function(t,r,o){t+=e.canvasOffsetLeft,r+=e.canvasOffsetTop,e.ctx.beginPath(),e.ctx.arc(t,r,o,0,2*Math.PI),e.ctx.stroke()}(t,r,.5*o);p(t-.5*o,r-.5*o,o,o)}function y(t,r){e.ctx.beginPath(),{t:function(){e.ctx.moveTo(t.x+e.canvasOffsetLeft,t.y+e.canvasOffsetTop),e.ctx.lineTo(t.x+e.canvasOffsetLeft+t.width,t.y+e.canvasOffsetTop)},r:function(){e.ctx.moveTo(t.x+e.canvasOffsetLeft+t.width,t.y+e.canvasOffsetTop),e.ctx.lineTo(t.x+e.canvasOffsetLeft+t.width,t.y+e.canvasOffsetTop+t.height)},b:function(){e.ctx.moveTo(t.x+e.canvasOffsetLeft,t.y+e.canvasOffsetTop+t.height),e.ctx.lineTo(t.x+e.canvasOffsetLeft+t.width,t.y+e.canvasOffsetTop+t.height)},l:function(){e.ctx.moveTo(t.x+e.canvasOffsetLeft,t.y+e.canvasOffsetTop),e.ctx.lineTo(t.x+e.canvasOffsetLeft,t.y+e.canvasOffsetTop+t.height)}}[r](),e.ctx.stroke()}e.htmlImageCache={},e.draw=function(r){if(!e.dispatchEvent("beforedraw",{})&&(e.isChildGrid||e.height&&e.width))if(e.isChildGrid&&r)requestAnimationFrame(e.parentGrid.draw);else if(!1!==e.intf.visible){var b,v,_,w,x,S,E,C,T,I,A,O,F,L,D,M,R,k,P,B,N,$,z,H,j,U=e.viewData||[],V="collapse"===e.style.gridBorderCollapse,G=[],W=[],K=[],q=[],Y=U.length,X=e.currentCell||{},Z=e.getColumnHeaderCellHeight(),J=e.getRowHeaderCellWidth(),Q=e.style.cellHeight;o+=1,v=performance.now(),e.visibleRowHeights=[],U.length>e.orders.rows.length&&e.createRowOrders(),e.ctx.save(),e.visibleRows=[],L=e.getSchema(),e.visibleCells=[],e.canvasOffsetTop=e.isChildGrid?e.parentNode.offsetTop:.5,e.canvasOffsetLeft=e.isChildGrid?e.parentNode.offsetLeft:-.5,O=e.height,d(0,0,F=e.width,O,0),e.ctx.clip(),e.ctx.fillStyle=e.style.gridBackgroundColor,u(0,0,F,O),function(){var t=Math.min(U.length,e.frozenRow);for(I=-e.scrollBox.scrollLeft+e.scrollPixelLeft+e.style.cellBorderWidth,T=Z,D=0;D<t&&re(e.orders.rows[D],D);D+=1);e.attributes.allowFreezingRows&&(T+=e.style.frozenMarkerBorderWidth+e.style.frozenMarkerWidth-.4999999999),e.lastFrozenRowPixel=T}(),function(){e.ctx.save(),e.frozenRow>0&&(d(0,e.lastFrozenRowPixel,e.width,e.height-e.lastFrozenRowPixel,0),e.ctx.clip());var t,r,o,n=L.length;for(I=-e.scrollBox.scrollLeft+e.scrollPixelLeft+e.style.cellBorderWidth,e.attributes.snapToRow||(T+=-e.scrollBox.scrollTop+e.scrollPixelTop+e.style.cellBorderWidth),D=e.frozenRow+e.scrollIndexTop;D<Y&&(r=e.orders.rows[D],e.scrollIndexBottom=D,e.scrollPixelBottom=T,re(r,D));D+=1);if(e.attributes.showNewRow){for(e.attributes.showRowHeaders&&(I+=J),E=Q=e.style.cellHeight,S=!1,t=e.scrollIndexLeft;t<n&&(o=e.orders.columns[t],!((I+=te(e.newRow,U.length,U.length)(L[o],o,t))>e.width+e.scrollBox.scrollLeft));t+=1);q.push([e.newRow,U.length,U.length,T,E])}e.ctx.restore()}(),function(){if(R){e.ctx.save();var t=e.activeCell.columnIndex+1>e.frozenColumn||e.activeCell.rowIndex+1>e.frozenRow;d(t?e.lastFrozenColumnPixel:0,t?e.lastFrozenRowPixel:0,t?e.width-e.lastFrozenColumnPixel:e.width,t?e.height-e.lastFrozenRowPixel:e.height,0),e.ctx.clip(),"row"===e.attributes.selectionMode?e.activeCell&&e.activeCell.rowIndex===R.rowIndex&&(e.ctx.lineWidth=e.style.activeCellOverlayBorderWidth,e.ctx.strokeStyle=e.style.activeCellOverlayBorderColor,p(1,R.y,e.getHeaderWidth()+J,e.visibleRowHeights[R.rowIndex])):(e.ctx.lineWidth=e.style.activeCellOverlayBorderWidth,e.ctx.strokeStyle=e.style.activeCellOverlayBorderColor,p(R.x,R.y,R.width,R.height)),e.ctx.restore()}}(),function(){var t,r,o,n,i,a,s=L.length;function l(a,l){for(l=Math.min(l,s),o=a;o<l&&(r=e.orders.columns[o],(i=L[r]).hidden||(t={title:i.title,name:i.name,width:i.width||e.style.cellWidth,style:"columnHeaderCell",type:"string",index:o,order:r},n={columnHeaderCell:i.title||i.name},!((I+=te(n,-1,-1)(t,r,o))>e.width+e.scrollBox.scrollLeft)));o+=1);}q.forEach((function(t,r){T=t[3],Q=t[4],r===e.frozenRow&&(e.ctx.save(),d(0,e.lastFrozenRowPixel,e.width,e.height-e.lastFrozenRowPixel,0),e.ctx.clip()),function(t,r,o){if(e.attributes.showRowHeaders){I=0;var n=e.viewData&&r<e.viewData.length?e.getBoundRowIndexFromViewRowIndex(r)+1:e.originalData?e.originalData.length+1:o+1,i=e.hasActiveFilters()?n:r+1,a={rowHeaderCell:i},s={name:"rowHeaderCell",width:e.sizes.columns[-1]||e.style.rowHeaderCellWidth,style:"rowHeaderCell",type:"string",data:i,index:-1};S=e.openChildren[r],te(a,o,r)(s,-1,-1)}}(t[0],t[1],t[2])})),e.ctx.restore(),e.attributes.showColumnHeaders&&(I=-e.scrollBox.scrollLeft+e.scrollPixelLeft+e.style.columnHeaderCellBorderWidth,e.attributes.showRowHeaders&&(I+=J),T=0,Q=e.getColumnHeaderCellHeight(),l(e.scrollIndexLeft,s),a=I,I=e.style.columnHeaderCellBorderWidth,e.attributes.showRowHeaders&&(I+=J),l(0,e.frozenColumn),(I=a)<F&&(A={name:"",width:e.style.scrollBarWidth,style:"columnHeaderCellCap",isColumnHeaderCell:!0,isColumnHeaderCellCap:!0,type:"string",index:L.length},te({endCap:""},-1,-1)(A,-1,-1)),e.attributes.showRowHeaders&&(C={cornerCell:""},I=0,A={name:"cornerCell",width:e.style.rowHeaderCellWidth,style:"cornerCell",type:"string",index:-1},te(C,-1,-1)(A,-1,-1)))}(),k=e.lastFrozenRowPixel-e.style.frozenMarkerWidth,P=e.lastFrozenColumnPixel-e.style.frozenMarkerBorderWidth,B=e.currentCell&&"frozen-row-marker"===e.currentCell.style,N=e.currentCell&&"frozen-column-marker"===e.currentCell.style,e.ctx.lineWidth=e.style.frozenMarkerBorderWidth,e.attributes.allowFreezingColumns&&(e.ctx.fillStyle=N?e.style.frozenMarkerHoverColor:e.style.frozenMarkerColor,e.ctx.strokeStyle=N?e.style.frozenMarkerHoverBorderColor:e.style.frozenMarkerBorderColor,u(P,0,e.style.frozenMarkerWidth,e.height),p(P,0,e.style.frozenMarkerWidth,e.height),e.visibleCells.unshift({x:P,y:0,height:e.height,width:e.style.frozenMarkerWidth+e.style.frozenMarkerBorderWidth,style:"frozen-column-marker"})),e.attributes.allowFreezingRows&&(e.ctx.fillStyle=B?e.style.frozenMarkerHoverColor:e.style.frozenMarkerColor,e.ctx.strokeStyle=B?e.style.frozenMarkerHoverBorderColor:e.style.frozenMarkerBorderColor,u(0,k,e.width,e.style.frozenMarkerWidth),p(0,k,e.width,e.style.frozenMarkerWidth),e.visibleCells.unshift({x:0,y:k,height:e.style.frozenMarkerWidth+e.style.frozenMarkerBorderWidth,width:e.width,style:"frozen-row-marker"})),e.freezeMarkerPosition&&(e.ctx.fillStyle=e.style.frozenMarkerActiveColor,e.ctx.strokeStyle=e.style.frozenMarkerActiveBorderColor,"frozen-column-marker"===e.dragMode?(u(e.freezeMarkerPosition.x,0,e.style.frozenMarkerWidth,e.height),p(e.freezeMarkerPosition.x,0,e.style.frozenMarkerWidth,e.height)):(u(0,e.freezeMarkerPosition.y,e.width,e.style.frozenMarkerWidth),p(0,e.freezeMarkerPosition.y,e.width,e.style.frozenMarkerWidth))),(e.mobile||e.attributes.allowMovingSelection)&&(e.ctx.lineWidth=e.style.selectionHandleBorderWidth,e.ctx.strokeStyle=e.style.selectionHandleBorderColor,e.ctx.fillStyle=e.style.selectionHandleColor,K.forEach((function(t){!function(t,r){var o=e.style.selectionHandleSize;({tr:function(){g(t.x+t.width,t.y,o),m(t.x+t.width,t.y,o)},br:function(){g(t.x+t.width,t.y+t.height,o),m(t.x+t.width,t.y+t.height,o)},tl:function(){g(t.x,t.y,o),m(t.x,t.y,o)},bl:function(){g(t.x,t.y+t.height,o),m(t.x,t.y+t.height,o)}})[r]()}(t[0],t[1]);var r=e.attributes.touchSelectHandleZone/2,o=t[0].x+("tl"===t[1]||"bl"===t[1]?0:t[0].width)-r,n=t[0].y+("bl"===t[1]||"br"===t[1]?t[0].height:0)-r;e.visibleCells.unshift({x:o,y:n,height:e.style.selectionHandleSize+r,width:e.style.selectionHandleSize+r,style:"selection-handle-"+t[1]})}))),function(){if(e.reorderObject){var t={height:e.reorderObject.height,width:e.reorderObject.width,x:e.reorderObject.x+e.reorderObject.dragOffset.x,y:e.reorderObject.y+e.reorderObject.dragOffset.y},r={width:F,height:O,x:0,y:0};e.ctx.fillStyle=e.style.reorderMarkerBackgroundColor,e.ctx.lineWidth=e.style.reorderMarkerBorderWidth,e.ctx.strokeStyle=e.style.reorderMarkerBorderColor,"row-reorder"===e.dragMode?(t.width=F,t.x=0,r.width=F,r.height=e.currentCell.height,r.y=e.currentCell.y,u(t.x,t.y,t.width,t.height),p(t.x,t.y,t.width,t.height),e.ctx.lineWidth=e.style.reorderMarkerIndexBorderWidth,e.ctx.strokeStyle=e.style.reorderMarkerIndexBorderColor,e.currentCell.rowIndex!==e.reorderObject.rowIndex&&e.currentCell.rowIndex>-1&&e.currentCell.rowIndex<Y&&y(r,e.reorderTarget.sortRowIndex>e.reorderObject.sortRowIndex?"b":"t")):"column-reorder"===e.dragMode&&e.reorderObject&&(t.height=O,t.y=0,r.height=O,r.width=e.currentCell.width,r.y=0,r.x=e.currentCell.x,u(t.x,t.y,t.width,t.height),p(t.x,t.y,t.width,t.height),e.ctx.lineWidth=e.style.reorderMarkerIndexBorderWidth,e.ctx.strokeStyle=e.style.reorderMarkerIndexBorderColor,e.currentCell.sortColumnIndex!==e.reorderObject.sortColumnIndex&&e.currentCell.sortColumnIndex>-1&&e.currentCell.sortColumnIndex<L.length&&y(r,e.reorderTarget.columnIndex>e.reorderObject.columnIndex?"r":"l"))}}(),e.movingSelection&&(e.ctx.lineWidth=e.style.moveOverlayBorderWidth,e.ctx.strokeStyle=e.style.moveOverlayBorderColor,e.ctx.setLineDash(e.style.moveOverlayBorderSegments),W.forEach((function(e){y(e[0],e[1])})),e.ctx.setLineDash([])),e.ctx.lineWidth=e.style.gridBorderWidth,e.ctx.strokeStyle=e.style.gridBorderColor,p(0,0,e.width,e.height),function(){function t(e){y(e[0],e[1])}e.ctx.lineWidth=e.style.selectionOverlayBorderWidth,e.ctx.strokeStyle=e.style.selectionOverlayBorderColor,G.filter((function(t){return t[0].rowIndex<e.frozenRow&&t[0].columnIndex<e.frozenColumn})).forEach(t),e.ctx.save(),f(0),G.filter((function(t){return t[0].rowIndex>=e.frozenRow&&t[0].columnIndex>=e.frozenColumn})).forEach(t),e.ctx.restore(),e.ctx.save(),f(1),G.filter((function(t){return t[0].rowIndex>=e.frozenRow&&t[0].columnIndex<e.frozenColumn})).forEach(t),e.ctx.restore(),e.ctx.save(),f(2),G.filter((function(t){return t[0].rowIndex<e.frozenRow&&t[0].columnIndex>=e.frozenColumn})).forEach(t),e.ctx.restore()}(),z=e.scrollBox.entities,H=2*e.style.scrollBarBoxMargin,e.ctx.strokeStyle=e.style.scrollBarBorderColor,e.ctx.lineWidth=e.style.scrollBarBorderWidth,z.horizontalBox.x=J+e.style.scrollBarBoxMargin+(z.horizontalBar.width-e.scrollBox.scrollBoxWidth)*(e.scrollBox.scrollLeft/e.scrollBox.scrollWidth),z.verticalBox.y=Z+e.style.scrollBarBoxMargin+(z.verticalBar.height-e.scrollBox.scrollBoxHeight)*(e.scrollBox.scrollTop/e.scrollBox.scrollHeight),e.scrollBox.horizontalBarVisible&&(e.ctx.fillStyle=e.style.scrollBarBackgroundColor,u(z.horizontalBar.x,z.horizontalBar.y,z.horizontalBar.width+H,z.horizontalBar.height),p(z.horizontalBar.x,z.horizontalBar.y,z.horizontalBar.width+H,z.horizontalBar.height),e.ctx.fillStyle=e.style.scrollBarBoxColor,e.scrollBox.horizontalBoxVisible&&(/horizontal/.test(X.context)&&(e.ctx.fillStyle=e.style.scrollBarActiveColor),d(z.horizontalBox.x,z.horizontalBox.y,z.horizontalBox.width,z.horizontalBox.height,e.style.scrollBarBoxBorderRadius),e.ctx.stroke(),e.ctx.fill()),$=!0,e.visibleCells.unshift(z.horizontalBar),e.visibleCells.unshift(z.horizontalBox)),e.scrollBox.verticalBarVisible&&(e.ctx.fillStyle=e.style.scrollBarBackgroundColor,u(z.verticalBar.x,z.verticalBar.y,z.verticalBar.width,z.verticalBar.height+H),p(z.verticalBar.x,z.verticalBar.y,z.verticalBar.width,z.verticalBar.height+H),e.scrollBox.verticalBoxVisible&&(e.ctx.fillStyle=e.style.scrollBarBoxColor,/vertical/.test(X.context)&&(e.ctx.fillStyle=e.style.scrollBarActiveColor),d(z.verticalBox.x,z.verticalBox.y,z.verticalBox.width,z.verticalBox.height,e.style.scrollBarBoxBorderRadius),e.ctx.stroke(),e.ctx.fill()),$=!0,e.visibleCells.unshift(z.verticalBar),e.visibleCells.unshift(z.verticalBox)),$&&(e.ctx.strokeStyle=e.style.scrollBarCornerBorderColor,e.ctx.fillStyle=e.style.scrollBarCornerBackgroundColor,d(z.corner.x,z.corner.y,z.corner.width,z.corner.height,0),e.ctx.stroke(),e.ctx.fill(),e.visibleCells.unshift(z.corner)),b&&e.resize(!0),e.ctx.save(),(e.attributes.showPerformance||e.attributes.debug)&&(0===t.length&&(t=l(0,n,1,0)),t.pop(),t.unshift(performance.now()-v)),e.attributes.debug?(e.ctx.font=e.style.debugFont,(j={}).perf=(t.reduce((function(e,t){return e+t}),0)/Math.min(o,t.length)).toFixed(1),j.perfDelta=t[0].toFixed(1),j.frozenColumnsWidth=function(){for(var t=0,r=e.getSchema(),o=0,n=Math.min(e.frozenColumn,r.length);o<n;)r[o].hidden||(t+=e.getColumnWidth(o)),o+=1;return t}(),j.htmlImages=Object.keys(e.htmlImageCache).length,j.reorderObject="x: "+(e.reorderObject||{columnIndex:0}).columnIndex+", y: "+(e.reorderObject||{rowIndex:0}).rowIndex,j.reorderTarget="x: "+(e.reorderTarget||{columnIndex:0}).columnIndex+", y: "+(e.reorderTarget||{rowIndex:0}).rowIndex,j.scale=e.scale,j.startScale=e.startScale,j.scaleDelta=e.scaleDelta,j.zoomDeltaStart=e.zoomDeltaStart,j.touchLength=e.touchLength,j.touches="y0: "+(e.touchPosition||{y:0}).y+" y1: "+(e.touchPosition1||{y:0}).y,j.scrollBox=e.scrollBox.toString(),j.scrollIndex="x: "+e.scrollIndexLeft+", y: "+e.scrollIndexTop,j.scrollPixel="x: "+e.scrollPixelLeft+", y: "+e.scrollPixelTop,j.canvasOffset="x: "+e.canvasOffsetLeft+", y: "+e.canvasOffsetTop,j.touchDelta="x: "+e.touchDelta.x+", y: "+e.touchDelta.y,j.touchAnimateTo="x: "+e.touchAnimateTo.x+", y: "+e.touchAnimateTo.y,j.scrollAnimation="x: "+e.scrollAnimation.x+", y: "+e.scrollAnimation.y,j.touchPPS="x: "+e.xPPS+", y: "+e.yPPS,j.touchPPST="x: "+e.xPPST+", y: "+e.yPPST,j.touchDuration=e.touchDuration,j.pointerLockPosition=e.pointerLockPosition?e.pointerLockPosition.x+", "+e.pointerLockPosition.y:"",j.size="w: "+e.width+", h: "+e.height,j.mouse="x: "+e.mouse.x+", y: "+e.mouse.y,j.touch=e.touchStart?"x: "+e.touchStart.x+", y: "+e.touchStart.y:"",j.entities=e.visibleCells.length,j.hasFocus=e.hasFocus,j.dragMode=e.dragMode,e.currentCell&&(j.columnIndex=e.currentCell.columnIndex,j.rowIndex=e.currentCell.rowIndex,j.sortColumnIndex=e.currentCell.sortColumnIndex,j.sortRowIndex=e.currentCell.sortRowIndex,j.context=e.currentCell.context,j.dragContext=e.currentCell.dragContext,j.style=e.currentCell.style,j.type=e.currentCell.type),e.ctx.textAlign="right",e.ctx.fillStyle=e.style.debugBackgroundColor,u(0,0,e.width,e.height),Object.keys(j).forEach((function(t,r){var o=t+": "+j[t];e.ctx.fillStyle=e.style.debugColor,h(o,F-20,(e.attributes.showPerformance?140:24)+14*r)})),e.ctx.restore()):e.ctx.restore(),function(){if(e.attributes.showPerformance){var r=e.width-250-e.style.scrollBarWidth-2*e.style.scrollBarBorderWidth,o=Z;0===a.length&&(a=l(0,n,1,(function(){return[0,0]}))),0===s.length&&(s=l(0,n,1,(function(){return[0,0]}))),0===i.length&&(i=l(0,n,1,0)),e.ctx.lineWidth=.5,e.ctx.textAlign="left",e.ctx.font=e.style.debugFont,e.ctx.fillStyle=e.style.debugPerfChartBackground,u(r,o,250,100),[["Scroll Height",a,0,e.scrollBox.scrollHeight,e.style.debugScrollHeightColor,!1],["Scroll Width",a,1,e.scrollBox.scrollWidth,e.style.debugScrollWidthColor,!1],["Performance",t,void 0,200,e.style.debugPerformanceColor,!1],["Entities",i,void 0,1500,e.style.debugEntitiesColor,!1],["TouchPPSX",s,0,1e3,e.style.debugTouchPPSXColor,!0],["TouchPPSY",s,1,1e3,e.style.debugTouchPPSYColor,!0]].forEach((function(e,t){e.push(t),c.apply(null,e)})),e.ctx.fillStyle=e.style.debugPerfChartBackground,i.pop(),i.unshift(e.visibleCells.length),a.pop(),a.unshift([e.scrollBox.scrollTop,e.scrollBox.scrollLeft]),s.pop(),s.unshift([e.yPPS,e.xPPS])}function c(t,n,i,a,s,l,c){var d;!function(t,r,o,n,i,a,s,l,c){var d=250/i.length,u=r/s;o+=e.canvasOffsetLeft,n+=e.canvasOffsetTop,e.ctx.beginPath(),e.ctx.moveTo(o,n+r),i.forEach((function(t){var i,s,l=void 0===a?t:t[a];c&&(l=Math.abs(l)),i=o+d,s=n+r-l*u,e.ctx.lineTo(i,s),o+=d})),e.ctx.moveTo(o+250,n+r),e.ctx.strokeStyle=l,e.ctx.stroke()}(0,100,r,o,n,i,a,s,l),e.ctx.fillStyle=s,u(3+r,o+9+11*c,8,8),e.ctx.fillStyle=e.style.debugPerfChartTextColor,d=void 0!==i?n[0][i]:n[0],h(t+" "+(isNaN(d)?0:d).toFixed(3),14+r,o+16+11*c)}}(),e.dispatchEvent("afterdraw",{})||e.ctx.restore()}function ee(t,r,o,n){n=n||{x:0,y:0},t.selectionBorder="",!t.isRowHeader&&e.selections[t.rowIndex+-n.y]&&-1!==e.selections[t.rowIndex+-n.y].indexOf(t.columnIndex+-n.x)&&(e.selections[t.rowIndex-1-n.y]&&-1!==e.selections[t.rowIndex-1-n.y].indexOf(t.columnIndex+-n.x)&&0!==t.rowIndex||t.isHeader||(r.push([t,"t"]),t[o+"BorderTop"]=!0,t[o+"Border"]+="t"),e.selections[t.rowIndex+1+-n.y]&&-1!==e.selections[t.rowIndex+1+-n.y].indexOf(t.columnIndex+-n.x)||(r.push([t,"b"]),t[o+"BorderBottom"]=!0,t[o+"Border"]+="b"),e.selections[t.rowIndex+-n.y]&&0!==t.columnIndex&&-1!==e.selections[t.rowIndex+-n.y].indexOf(t.columnIndex-1-n.x)||(r.push([t,"l"]),t[o+"BorderLeft"]=!0,t[o+"Border"]+="l"),e.selections[t.rowIndex+-n.y]&&t.columnIndex!==L.length&&-1!==e.selections[t.rowIndex+-n.y].indexOf(t.columnIndex+1+-n.x)||(r.push([t,"r"]),t[o+"BorderRight"]=!0,t[o+"Border"]+="r"))}function te(t,r,o){return function(n,i,a){if(n.hidden)return 0;var s,l,f,g=n.style||"cell",m=/HeaderCell/.test(g),y=/cornerCell/.test(g),v="rowHeaderCell"===g,x="columnHeaderCell"===g,C="nowrap"!==e.style.cellWhiteSpace,A=e.selections[r]&&-1!==e.selections[r].indexOf(a),O=e.hovers.rowIndex===r&&("row"===e.attributes.hoverMode||e.hovers.columnIndex===a),L=e.activeCell.rowIndex===r&&e.activeCell.columnIndex===a,D="columnHeaderCellCap"===g,M=t?t[n.name]:void 0,k="canvas-datagrid"===n.type,P=!(e.orders.rows[e.activeCell.rowIndex]!==r&&e.orders.columns[e.activeCell.columnIndex]!==i||-1!==a&&-1!==r)&&(v?"activeRowHeaderCell":"activeColumnHeaderCell"),B=e.formatters[n.type||"string"],N=0,$=0,z=e.sizes.columns[i]||n.width,H={value:M,row:t,header:n};if(D&&(z=F-I),void 0===z&&(z=e.style.cellWidth),z*=e.scale,I+z+e.style.cellBorderWidth<0&&(I+=z+e.style.cellBorderWidth),L&&"cornerCell"!==g&&(g="activeCell"),-1!==e.visibleRows.indexOf(o)||m||e.visibleRows.push(o),f=e.dispatchEvent("formatcellvalue",H),_=I,w=T,"cornerCell"===g?(_=0,w=0):v?_=0:m&&(w=0),(l={type:k?"canvas-datagrid-cell":n.type,style:g,nodeType:"canvas-datagrid-cell",x:_,y:w,fontHeight:(e.style[g+"FontHeight"]||0)*e.scale,horizontalAlignment:e.style[g+"HorizontalAlignment"],verticalAlignment:e.style[g+"VerticalAlignment"],paddingLeft:(e.style[g+"PaddingLeft"]||0)*e.scale,paddingTop:(e.style[g+"PaddingTop"]||0)*e.scale,paddingRight:(e.style[g+"PaddingRight"]||0)*e.scale,paddingBottom:(e.style[g+"PaddingBottom"]||0)*e.scale,whiteSpace:e.style.cellWhiteSpace,lineHeight:e.style.cellLineHeight,lineSpacing:e.style.cellLineSpacing,offsetTop:e.canvasOffsetTop+w,offsetLeft:e.canvasOffsetLeft+_,scrollTop:e.scrollBox.scrollTop,scrollLeft:e.scrollBox.scrollLeft,active:L||P,hovered:O,selected:A,width:z,height:Q,offsetWidth:z,offsetHeight:Q,parentNode:e.intf.parentNode,offsetParent:e.intf.parentNode,data:t,isCorner:y,isHeader:m,isColumnHeader:x,isColumnHeaderCellCap:D,isRowHeader:v,rowOpen:S,header:n,columnIndex:a,rowIndex:r,viewRowIndex:r,viewColumnIndex:a,boundRowIndex:e.getBoundRowIndexFromViewRowIndex(r),boundColumnIndex:a,sortColumnIndex:i,sortRowIndex:o,isGrid:k,isNormal:!k&&!y&&!m,gridId:(e.attributes.name||"")+o+":"+i,parentGrid:e.intf,innerHTML:"",activeHeader:P,value:m&&!v?n.title||n.name:M}).calculatedLineHeight=l.fontHeight*l.lineHeight+l.lineSpacing,l.paddedWidth=l.width-l.paddingRight-l.paddingLeft,l.paddedHeight=l.height-l.paddingTop-l.paddingBottom,H.cell=l,l.userHeight=l.isHeader?e.sizes.rows[-1]:E,l.userWidth=l.isHeader?e.sizes.columns.cornerCell:e.sizes.columns[i],e.visibleCells.unshift(l),!e.dispatchEvent("beforerendercell",H)){if(e.ctx.fillStyle=e.style[g+"BackgroundColor"],e.ctx.strokeStyle=e.style[g+"BorderColor"],e.ctx.lineWidth=e.style[g+"BorderWidth"],O&&(e.ctx.fillStyle=e.style[g+"HoverBackgroundColor"],e.ctx.strokeStyle=e.style[g+"HoverBorderColor"]),A&&(e.ctx.fillStyle=e.style[g+"SelectedBackgroundColor"],e.ctx.strokeStyle=e.style[g+"SelectedBorderColor"]),P&&(e.ctx.fillStyle=e.style[P+"BackgroundColor"]),e.dispatchEvent("rendercell",H),l.isGrid&&(l.height!==E&&(l.height=E||e.style.cellHeightWithChildGrid,b=!0),l.width=e.sizes.columns[i]||e.style.cellWidthWithChildGrid),S&&!l.isRowHeader&&(l.height=e.sizes.rows[o]||e.style.cellHeight),l.isGrid||(u(_,w,l.width,l.height),p(_,w,l.width,l.height)),e.ctx.save(),d(l.x,l.y,l.width,l.height,0),e.ctx.clip(),e.dispatchEvent("afterrendercell",H),l.height===Q||S&&!l.isRowHeader||(e.sizes.rows[m?-1:o]=l.height,b=!0),l.width!==z&&(e.sizes.columns[i]=l.width,b=!0),v&&e.attributes.tree&&(e.dispatchEvent("rendertreearrow",H)||($=function(t,r,o){var n=e.style.treeArrowMarginTop*e.scale,i=e.style.treeArrowMarginRight*e.scale,a=e.style.treeArrowMarginLeft*e.scale,s=e.style.treeArrowWidth*e.scale,l=e.style.treeArrowHeight*e.scale;return r+=e.canvasOffsetLeft,o+=e.canvasOffsetTop,e.ctx.fillStyle=e.style.treeArrowColor,e.ctx.strokeStyle=e.style.treeArrowBorderColor,e.ctx.beginPath(),r+=a,o+=n,e.openChildren[t.rowIndex]?(e.ctx.moveTo(r,o),e.ctx.lineTo(r+s,o),e.ctx.lineTo(r+.5*s,o+l),e.ctx.moveTo(r,o)):(e.ctx.lineTo(r,o),e.ctx.lineTo(r+l,o+.5*s),e.ctx.lineTo(r,o+s),e.ctx.lineTo(r,o)),e.ctx.stroke(),e.ctx.fill(),a+s+i}(l,e.style[g+"PaddingLeft"],w))),e.attributes.showRowNumbers&&v||!v)if(l.isGrid&&!e.dispatchEvent("beforerendercellgrid",H)){if(!e.childGrids[l.gridId]){if((s=e.cellGridAttributes).name=e.attributes.saveAppearance?l.gridId:void 0,s.component=!1,s.parentNode=l,s.data=M,H.cellGridAttributes=s,e.dispatchEvent("beforecreatecellgrid",H))return;e.childGrids[l.gridId]=e.createGrid(s),e.sizes.rows[o]=e.sizes.rows[o]||e.style.cellGridHeight,b=!0}l.grid=e.childGrids[l.gridId],l.grid.parentNode=l,l.grid.visible=!0,l.grid.draw(),e.dispatchEvent("rendercellgrid",H)}else l.isGrid||(e.childGrids[l.gridId]&&(e.childGrids[l.gridId].parentNode.offsetHeight=0),m&&e.orderBy===n.name&&(e.dispatchEvent("renderorderbyarrow",H)||(N=function(t,r){var o=e.style.columnHeaderOrderByArrowMarginTop*e.scale,n=e.style.columnHeaderOrderByArrowMarginLeft*e.scale,i=e.style.columnHeaderOrderByArrowMarginRight*e.scale,a=e.style.columnHeaderOrderByArrowWidth*e.scale,s=e.style.columnHeaderOrderByArrowHeight*e.scale;return t+=e.canvasOffsetLeft,r+=e.canvasOffsetTop,e.ctx.fillStyle=e.style.columnHeaderOrderByArrowColor,e.ctx.strokeStyle=e.style.columnHeaderOrderByArrowBorderColor,e.ctx.beginPath(),t+=n,r+=o,"asc"===e.orderDirection?(e.ctx.moveTo(t,r),e.ctx.lineTo(t+a,r),e.ctx.lineTo(t+.5*a,r+s),e.ctx.moveTo(t,r)):(e.ctx.lineTo(t,r+s),e.ctx.lineTo(t+a,r+s),e.ctx.lineTo(t+.5*a,r),e.ctx.lineTo(t,r+s)),e.ctx.stroke(),e.ctx.fill(),n+a+i}(_+e.style[g+"PaddingLeft"],0))),e.ctx.fillStyle=e.style[g+"Color"],O&&(e.ctx.fillStyle=e.style[g+"HoverColor"]),A&&(e.ctx.fillStyle=e.style[g+"SelectedColor"]),P&&(e.ctx.fillStyle=e.style[P+"Color"]),l.treeArrowWidth=$,l.orderByArrowWidth=N,void 0!==(f=void 0!==f?f:B?B(H):"")||B||(f="",console.warn("canvas-datagrid: Unknown format "+n.type+" add a cellFormater")),l.formattedValue=(null!=f?f:"").toString(),e.columnFilters&&void 0!==e.columnFilters[f]&&m&&(l.formattedValue=e.attributes.filterTextPrefix+f),e.ctx.font=e.style[g+"FontHeight"]*e.scale+"px "+e.style[g+"FontName"],e.dispatchEvent("formattext",H)||(l.text=function(t,r){if(!t.formattedValue)return{lines:[{width:0,value:""}],width:0,height:t.calculatedLineHeight};var o,n,i,a,s,l,c=t.formattedValue.split(r),d=t.calculatedLineHeight,u=[],p="nowrap"!==e.style.cellWhiteSpace,h=e.attributes.autoResizeRows&&p,f=e.attributes.ellipsisText,g={width:0,value:""},m=p?t.paddedHeight:t.calculatedLineHeight;for(u.push(g),i=e.ctx.measureText(" "+f).width,o=0;o<c.length;o+=1){n=c[o];var y=e.ctx.measureText(n+r);if(g.width+y.width+i<t.paddedWidth)g.value+=n+r,g.width+=y.width;else if(/\w-\w/.test(n)&&t.paddedWidth<y.width)c.splice(o,1,n.split("-")[0]+"-",n.split("-")[1]),o-=1;else{if(g={width:y.width,value:n+r},0===o&&(u=[]).push(g),(d+=t.calculatedLineHeight)>m&&!h){if(0===u.length)break;if((l=u[u.length-1]).width<t.paddedWidth&&1===c.length)break;var b=s=l.value+n;if((a=e.ctx.measureText(s+f).width)>t.paddedWidth)for(var v=parseInt(s.length/2),_=-1;v>0;)s=b.substr(0,v*_+s.length),_=(a=e.ctx.measureText(s+f).width)>t.paddedWidth?-1:1,v=parseInt(v/2);s+=b.length!=s.length?f:"",l.value=s,l.width=a;break}o>0&&u.push(g)}}return{lines:u,width:0,height:t.calculatedLineHeight*u.length}}(l," ")),e.dispatchEvent("rendertext",H)||(l.innerHTML||"html"===n.type?c(l):function(t){t.text.lines.length;var r,o,n=t.fontHeight*t.lineHeight,i="nowrap"!==e.style.cellWhiteSpace,a=0;for(r=0;r<t.text.lines.length;r+=1){o=t.text.lines[r];var s=Math.max(.5*(t.height-(i?t.text.height:t.calculatedLineHeight)),0)+n,l=t.paddingLeft+t.treeArrowWidth+t.orderByArrowWidth;"right"===t.horizontalAlignment?l=t.paddingLeft+t.paddedWidth-o.width:"center"===t.horizontalAlignment&&(l=t.paddingLeft+(t.paddedWidth+t.paddingRight)/2-o.width/2),"top"===t.verticalAlignment?s=t.calculatedLineHeight:"bottom"===t.verticalAlignment&&(s=t.height-t.paddingBottom-t.text.height),o.height=n+t.lineSpacing,o.offsetLeft=l,o.offsetTop=s,o.x=t.x+l,o.y=t.y+a+s,a+=o.height,h(o.value,o.x,o.y)}e.attributes.debug&&t.active&&requestAnimationFrame((function(){e.ctx.font=e.style.debugFont,e.ctx.fillStyle=e.style.debugColor,h(JSON.stringify({x:t.x,y:t.y,h:t.height,w:t.width,pw:t.paddedWidth,idx:t.columnIndex,idx_ord:t.sortColumnIndex},null,"\t"),t.x+14,t.y+14),h(JSON.stringify(t.text.lines.map((function(e){return{w:e.width,v:e.value.length}})),null,"\t"),t.x+14,t.y+30)}))}(l),C&&l.text&&l.text.height>E&&(e.sizes.rows[m?-1:o]=l.text.height,b=!0)));if(L&&(R=l),ee(l,G,"selection"),function(t){(e.attributes.allowMovingSelection||e.mobile)&&(t.selectionBorderTop&&t.selectionBorderRight&&e.mobile&&(K.push([t,"tr"]),t.selectionHandle="tr"),t.selectionBorderTop&&t.selectionBorderLeft&&e.mobile&&(K.push([t,"tl"]),t.selectionHandle="tl"),t.selectionBorderBottom&&t.selectionBorderLeft&&e.mobile&&(K.push([t,"bl"]),t.selectionHandle="bl"),t.selectionBorderBottom&&t.selectionBorderRight&&("none"!==e.attributes.selectionHandleBehavior||e.mobile)&&(K.push([t,"br"]),t.selectionHandle="br"))}(l),e.movingSelection&&ee(l,W,"move",e.moveOffset),e.ctx.restore(),v&&e.attributes.showRowNumbers&&e.attributes.showRowNumberGaps){var j=e.getBoundRowIndexFromViewRowIndex(r-1);if(void 0!==j&&l.boundRowIndex>0&&l.boundRowIndex-j>1){var U=e.style.rowHeaderCellRowNumberGapHeight,q=e.style.rowHeaderCellRowNumberGapColor;e.ctx.save(),e.ctx.fillStyle=q,u(l.x,l.y-U/2,l.width,U),e.ctx.restore()}}return I+=l.width+(V?0:e.style.cellBorderWidth),l.width}}}function re(t,r){var o,n,i,a,s=L.length;if(T-2*Q>O)return!1;if(M=U[t],S=e.openChildren[t],i=(e.sizes.rows[t]||e.style.cellHeight)*e.scale,n=(S?e.sizes.trees[t]:0)*e.scale,T<-(E=i+n))return!1;for(e.attributes.showRowHeaders&&(I+=J),Q=E,a=e.scrollIndexLeft;a<s;a+=1)if(o=e.orders.columns[a],(I+=te(M,t,r)(L[o],o,a))>e.width){e.scrollIndexRight=a,e.scrollPixelRight=I;break}for(I=0,e.attributes.showRowHeaders&&(I+=J),a=0;a<e.frozenColumn&&(o=e.orders.columns[a],!((I+=te(M,t,r)(L[o],o,a))>e.width));a+=1);return e.lastFrozenColumnPixel=I,Q=E,I=-e.scrollBox.scrollLeft+e.scrollPixelLeft+e.style.cellBorderWidth,x=e.childGrids[t],t!==U.length&&S?(x.visible=!0,x.parentNode={offsetTop:T+i+e.canvasOffsetTop,offsetLeft:J-1+e.canvasOffsetLeft,offsetHeight:n,offsetWidth:e.width-J-e.style.scrollBarWidth-1,offsetParent:e.intf.parentNode,parentNode:e.intf.parentNode,style:e.style,nodeType:"canvas-datagrid-tree",scrollTop:e.scrollBox.scrollTop,scrollLeft:e.scrollBox.scrollLeft,rowIndex:t},e.visibleCells.unshift({rowIndex:t,columnIndex:0,y:x.parentNode.offsetTop,x:x.parentNode.offsetLeft,height:x.height,width:x.width,style:"tree-grid",type:x.parentNode.nodeType}),x.draw()):x&&(x.parentNode.offsetHeight=0,delete e.sizes.trees[t]),q.push([M,t,r,T,E]),e.visibleRowHeights[t]=E,T+=Q+(V?0:e.style.cellBorderWidth),!0}}}function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return commonjsRequire(e,null==t?r.path:t)}},r.exports),r.exports}function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}Typo3Card.styles=[css_248z$1,css_248z$8],__decorate([property({type:String})],Typo3Card.prototype,"title",void 0),__decorate([property({type:String})],Typo3Card.prototype,"subtitle",void 0),__decorate([property({type:String,reflect:!0})],Typo3Card.prototype,"variant",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3Card.prototype,"selected",void 0),__decorate([property({type:String,reflect:!0})],Typo3Card.prototype,"value",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3Card.prototype,"titleEditable",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3Card.prototype,"disabled",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3Card.prototype,"notSelectable",void 0),__decorate([property({type:Number,reflect:!0})],Typo3Card.prototype,"tabindex",void 0),__decorate([internalProperty()],Typo3Card.prototype,"inEditMode",void 0),__decorate([query(".title")],Typo3Card.prototype,"titleElement",void 0),Typo3Card=__decorate([customElement("typo3-card")],Typo3Card);var dist=createCommonjsModule((function(e){e.exports=function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==_typeof(e)&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),n=Object.keys(o.default).reduce((function(e,t){return e.concat(o.default[t])}),[]);t.default=function(e){return-1===n.indexOf(e.key)}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default={modifier:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock"],legacyModifier:["Hyper","Super"],whiteSpace:["Enter","Tab"],navigation:["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp"],editing:["Backspace","Clear","Copy","CrSel","Cut","Delete","EraseEof","ExSel","Insert","Paste","Redo","Undo"],ui:["Accept","Again","Attn","Cancel","ContextMenu","Escape","Execute","Find","Help","Pause","Play","Props","Select","ZoomIn","ZoomOut"],device:["BrightnessDown","BrightnessUp","Eject","LogOff","Power","PowerOff","PrintScreen","Hibernate","Standby","WakeUp"],imeCompositionKeys:["AllCandidates","Alphanumeric","CodeInput","Compose","Convert","Dead","FinalMode","GroupFirst","GroupLast","GroupNext","GroupPrevious","ModeChange","NextCandidate","NonConvert","PreviousCandidate","Process","SingleCandidate"],koreanSpecific:["HangulMode","HanjaMode","JunjaMode"],japaneseSpecific:["Eisu","Hankaku","Hiragana","HiraganaKatakana","KanaMode","KanjiMode","Katakana","Romaji","Zenkaku","ZenkakuHankaku"],commonFunction:["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Soft1","Soft2","Soft3","Soft4"],multimedia:["ChannelDown","ChannelUp","Close","MailForward","MailReply","MailSend","MediaClose","MediaFastForward","MediaPause","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaTrackNext","MediaTrackPrevious","New","Open","Print","Save","SpellCheck"],multimediaNumpad:["Key11","Key12"],audio:["AudioBalanceLeft","AudioBalanceRight","AudioBassBoostDown","AudioBassBoostToggle","AudioBassBoostUp","AudioFaderFront","AudioFaderRear","AudioSurroundModeNext","AudioTrebleDown","AudioTrebleUp","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","MicrophoneToggle","MicrophoneVolumeDown","MicrophoneVolumeUp","MicrophoneVolumeMute"],speech:["SpeechCorrectionList","SpeechInputToggle"],application:["LaunchApplication1","LaunchApplication2","LaunchCalendar","LaunchContacts","LaunchMail","LaunchMediaPlayer","LaunchMusicPlayer","LaunchPhone","LaunchScreenSaver","LaunchSpreadsheet","LaunchWebBrowser","LaunchWebCam","LaunchWordProcessor"],browser:["BrowserBack","BrowserFavorites","BrowserForward","BrowserHome","BrowserRefresh","BrowserSearch","BrowserStop"],mobilePhone:["AppSwitch","Call","Camera","CameraFocus","EndCall","GoBack","GoHome","HeadsetHook","LastNumberRedial","Notification","MannerMode","VoiceDial"],tv:["TV","TV3DMode","TVAntennaCable","TVAudioDescription","TVAudioDescriptionMixDown","TVAudioDescriptionMixUp","TVContentsMenu","TVDataService","TVInput","TVInputComponent1","TVInputComponent2","TVInputComposite1","TVInputComposite2","TVInputHDMI1","TVInputHDMI2","TVInputHDMI3","TVInputHDMI4","TVInputVGA1","TVMediaContext","TVNetwork","TVNumberEntry","TVPower","TVRadioService","TVSatellite","TVSatelliteBS","TVSatelliteCS","TVSatelliteToggle","TVTerrestrialAnalog","TVTerrestrialDigital","TVTimer"],mediaControls:["AVRInput","AVRPower","ColorF0Red","ColorF1Green","ColorF2Yellow","ColorF3Blue","ColorF4Grey","ColorF5Brown","ClosedCaptionToggle","Dimmer","DisplaySwap","DVR","Exit","FavoriteClear0","FavoriteClear1","FavoriteClear2","FavoriteClear3","FavoriteRecall0","FavoriteRecall1","FavoriteRecall2","FavoriteRecall3","FavoriteStore0","FavoriteStore1","FavoriteStore2","FavoriteStore3","Guide","GuideNextDay","GuidePreviousDay","Info","InstantReplay","Link","ListProgram","LiveContent","Lock","MediaApps","MediaAudioTrack","MediaLast","MediaSkipBackward","MediaSkipForward","MediaStepBackward","MediaStepForward","MediaTopMenu","NavigateIn","NavigateNext","NavigateOut","NavigatePrevious","NextFavoriteChannel","NextUserProfile","OnDemand","Pairing","PinPDown","PinPMove","PinPToggle","PinPUp","PlaySpeedDown","PlaySpeedReset","PlaySpeedUp","RandomToggle","RcLowBattery","RecordSpeedNext","RfBypass","ScanChannelsToggle","ScreenModeNext","Settings","SplitScreenToggle","STBInput","STBPower","Subtitle","Teletext","VideoModeNext","Wink","ZoomToggle"]}}]).default})),isPrintableKeyEvent=getDefaultExportFromCjs(dist);function events(e){var t;e.stopPropagation=function(e){e.stopPropagation()},e.addEventListener=function(t,r){e.events[t]=e.events[t]||[],e.events[t].unshift(r)},e.removeEventListener=function(t,r){(e.events[t]||[]).forEach((function(o,n){r===o&&e.events[t].splice(n,1)}))},e.dispatchEvent=function(t,r){var o;function n(){o=!0}if(r=t.type?t:r||{},t=t.type||t,e.events[t])return e.events[t].forEach((function(t){r.ctx=e.ctx,r.preventDefault=n,t.apply(e.intf,[r])})),o},e.getRatio=function(){return Math.min(e.attributes.maxPixelRatio,(window.devicePixelRatio||1)/(e.ctx.webkitBackingStorePixelRatio||e.ctx.mozBackingStorePixelRatio||e.ctx.msBackingStorePixelRatio||e.ctx.oBackingStorePixelRatio||e.ctx.backingStorePixelRatio||1))},e.resize=function(t){if(e.canvas){var r,o,n={x:0,y:0,height:0,width:0,style:"vertical-scroll-bar"},i={x:0,y:0,height:0,width:0,style:"horizontal-scroll-bar"},a={x:0,y:0,height:0,width:0,style:"vertical-scroll-box"},s={x:0,y:0,height:0,width:0,style:"horizontal-scroll-box"},l={x:0,y:0,height:0,width:0,isCorner:!0,isScrollBoxCorner:!0,style:"scroll-box-corner"},c=2*e.style.scrollBarBoxMargin,d=2*e.style.scrollBarBorderWidth,u=.5*e.style.scrollBarBoxMargin,p=e.style.scrollBarWidth+2*e.style.scrollBarBorderWidth,h=e.getRatio(),f="collapse"===e.style.gridBorderCollapse?1:2,g=e.style.cellBorderWidth*f,m=e.style.columnHeaderCellBorderWidth*f,y=0,b=0,v=(e.viewData||[]).length,_=e.getColumnHeaderCellHeight(),w=e.getRowHeaderCellWidth(),x=e.style.cellHeight,S=e.getSchema();for(e.scrollCache.x=[],e.scrollCache.y=[],r=0;r<v;r+=1)e.scrollCache.y[r]=y,y+=((e.sizes.rows[r]||x)+(e.sizes.trees[r]||0))*e.scale+(e.frozenRow>r&&e.sizes.trees[r]||0);return v>1&&(e.scrollCache.y[r]=y),b=S.reduce((function(t,r,o){if(S[e.orders.columns[o]].hidden)return e.scrollCache.x[o]=t,t;var n=t+e.getColumnWidth(e.orders.columns[o]);return e.scrollCache.x[o]=n,n}),0)||0,e.attributes.showNewRow&&(y+=x),e.attributes.snapToRow&&(y+=e.style.cellHeight),T(),e.isChildGrid?(e.width=e.parentNode.offsetWidth,e.height=e.parentNode.offsetHeight):e.height===e.canvas.offsetHeight&&e.width===e.canvas.offsetWidth||(e.height=e.canvas.offsetHeight,e.width=e.canvas.offsetWidth,e.canvasOffsetLeft=e.args.canvasOffsetLeft||0,e.canvasOffsetTop=e.args.canvasOffsetTop||0),e.scrollBox.top=_+m,e.scrollBox.left=w,C(),E(),e.scrollBox.horizontalBarVisible&&("auto"!==e.style.height||e.isChildGrid||(e.height+=p),y+=p,T(),C(),E()),e.scrollBox.verticalBarVisible&&("auto"!==e.style.width||e.isChildGrid||(e.width+=p),b+=p,T(),C(),E()),C(),e.scrollBox.scrollWidth=b-e.scrollBox.width,e.scrollBox.scrollHeight=y-e.scrollBox.height,e.scrollBox.widthBoxRatio=e.scrollBox.width/b,e.scrollBox.scrollBoxWidth=e.scrollBox.width*e.scrollBox.widthBoxRatio-e.style.scrollBarWidth-d-u,e.scrollBox.heightBoxRatio=(e.scrollBox.height-_)/y,e.scrollBox.scrollBoxHeight=e.scrollBox.height*e.scrollBox.heightBoxRatio-e.style.scrollBarWidth-d-u,e.scrollBox.scrollBoxWidth=Math.max(e.scrollBox.scrollBoxWidth,e.style.scrollBarBoxMinSize),e.scrollBox.scrollBoxHeight=Math.max(e.scrollBox.scrollBoxHeight,e.style.scrollBarBoxMinSize),i.x+=w,i.y+=e.height-e.style.scrollBarWidth-u,i.width=e.width-e.style.scrollBarWidth-w-u-c,i.height=e.style.scrollBarWidth+e.style.scrollBarBorderWidth+u,s.y=i.y+e.style.scrollBarBoxMargin,s.width=e.scrollBox.scrollBoxWidth,s.height=e.style.scrollBarBoxWidth,n.x+=e.width-e.style.scrollBarWidth-e.style.scrollBarBorderWidth-u,n.y+=_,n.width=e.style.scrollBarWidth+e.style.scrollBarBorderWidth+u,n.height=e.height-_-e.style.scrollBarWidth-u-c,a.x=n.x+e.style.scrollBarBoxMargin,a.width=e.style.scrollBarBoxWidth,a.height=e.scrollBox.scrollBoxHeight,l.x=i.x+i.width+c,l.y=n.y+n.height+c,l.width=e.style.scrollBarWidth+e.style.scrollBarBorderWidth,l.height=e.style.scrollBarWidth+e.style.scrollBarBorderWidth,e.scrollBox.entities={horizontalBar:i,horizontalBox:s,verticalBar:n,verticalBox:a,corner:l},e.scrollBox.bar={v:n,h:i},e.scrollBox.box={v:a,h:s},e.page=Math.max(1,e.visibleRows.length-3-e.attributes.pageUpDownOverlap),e.isChildGrid||(e.canvas.width=e.width*h,e.canvas.height=e.height*h,e.ctx.scale(h,h)),e.resizeEditInput(),e.scroll(!0),t&&e.draw(!0),e.dispatchEvent("resize",{}),!0}function E(){e.scrollBox.horizontalBarVisible="auto"!==e.style.width&&b>e.scrollBox.width&&"hidden"!==e.style.overflowX||"scroll"===e.style.overflowX,e.scrollBox.horizontalBoxVisible=b>e.scrollBox.width,e.scrollBox.verticalBarVisible="auto"!==e.style.height&&y>e.scrollBox.height&&"hidden"!==e.style.overflowY||"scroll"===e.style.overflowY,e.scrollBox.verticalBoxVisible=y>e.scrollBox.height}function C(){e.scrollBox.width=e.width-w,e.scrollBox.height=e.height-_}function T(){e.isChildGrid||(o={height:_+y+g+1,width:b+w+g},["width","height"].forEach((function(t){-1!==["auto",void 0].indexOf(e.style[t])&&-1!==["auto",void 0].indexOf(e.appliedInlineStyles[t])?e.parentNodeStyle[t]=o[t]+"px":-1==["auto",void 0].indexOf(e.style[t])&&-1==["auto",void 0].indexOf(e.appliedInlineStyles[t])&&(e.parentNodeStyle[t]=e.style[t],e.isComponent&&(e.canvas.style[t]=e.style[t]))})))}},e.scroll=function(t){var r=e.getSchema(),o=(e.viewData||[]).length,n=e.style.cellHeight;for(e.scrollIndexTop=Math.floor(o*(e.scrollBox.scrollTop/e.scrollBox.scrollHeight)-100),e.scrollIndexTop=Math.max(e.scrollIndexTop,0),e.scrollPixelTop=e.scrollCache.y[e.scrollIndexTop],0===e.scrollBox.scrollHeight&&(e.scrollIndexTop=0),e.scrollPixelTop=0,e.scrollIndexLeft=e.frozenColumn,e.scrollPixelLeft=0;e.scrollPixelTop<e.scrollBox.scrollTop&&e.scrollIndexTop<e.viewData.length;)e.scrollIndexTop+=1,e.scrollPixelTop=e.scrollCache.y[e.scrollIndexTop];for(;e.scrollPixelLeft<e.scrollBox.scrollLeft+1&&e.scrollIndexLeft<r.length;)e.scrollPixelLeft=e.scrollCache.x[e.scrollIndexLeft],e.scrollIndexLeft+=1;r.length>0&&(e.scrollIndexLeft=Math.max(e.scrollIndexLeft-1,0),e.scrollPixelLeft-=e.getColumnWidth(e.orders.columns[e.scrollIndexLeft])),(e.viewData||[]).length>0&&(e.scrollIndexTop=Math.max(e.scrollIndexTop-1,0),e.scrollPixelTop=Math.max(e.scrollPixelTop-(e.viewData[e.scrollIndexTop]?(e.sizes.rows[e.scrollIndexTop]||n)+(e.sizes.trees[e.scrollIndexTop]||0):n)*e.scale,0)),e.ellipsisCache={},t||e.draw(!0),requestAnimationFrame(e.resizeEditInput),e.dispatchEvent("scroll",{top:e.scrollBox.scrollTop,left:e.scrollBox.scrollLeft})},e.mousemove=function(t,r){if(!e.contextMenu&&!e.input){e.mouse=r||e.getLayerPos(t);var o,n,i,a,s=(t.ctrlKey||t.metaKey||e.attributes.persistantSelectionMode)&&!e.attributes.singleSelectionMode,l=e.getSchema(),c=e.mouse.x,d=e.mouse.y,u=e.getCellAt(c,d),p={NativeEvent:t,cell:u,x:c,y:d},h=e.currentCell;if(clearTimeout(e.scrollTimer),e.isInGrid({x:c,y:d})||(e.hasFocus=!1),!e.dispatchEvent("mousemove",p)&&(u&&e.currentCell&&(e.rowBoundaryCrossed=e.currentCell.rowIndex!==u.rowIndex,e.columnBoundaryCrossed=e.currentCell.columnIndex!==u.columnIndex,e.cellBoundaryCrossed=e.rowBoundaryCrossed||e.columnBoundaryCrossed,["row","column","cell"].forEach((function(t){e[t+"BoundaryCrossed"]&&(p.cell=h,e.dispatchEvent(t+"mouseout",p),p.cell=u,e.dispatchEvent(t+"mouseover",p))}))),e.currentCell=u,e.hasFocus)){if(e.hovers={},!e.draggingItem&&u&&-1===e.scrollModes.indexOf(u.context)&&(e.dragItem=u,e.dragMode=u.dragContext,e.cursor=u.context,"cell"===u.context&&(e.cursor="default",e.hovers={rowIndex:u.rowIndex,columnIndex:u.columnIndex}),(e.selecting||e.reorderObject)&&"cell"===u.context)){if(a={x:Math.abs(e.dragStart.x-c),y:Math.abs(e.dragStart.y-d)},-1!==e.dragStartObject.columnIndex&&t.shiftKey&&(e.dragStartObject={rowIndex:e.activeCell.rowIndex,columnIndex:e.activeCell.columnIndex}),n={top:Math.min(e.dragStartObject.rowIndex,u.rowIndex),left:Math.min(e.dragStartObject.columnIndex,u.columnIndex),bottom:Math.max(e.dragStartObject.rowIndex,u.rowIndex),right:Math.max(e.dragStartObject.columnIndex,u.columnIndex)},-1===e.dragStartObject.columnIndex&&(i=e.getSelectionBounds(),n.left=-1,n.right=l.length-1,n.top=Math.min(i.top,u.rowIndex),n.bottom=Math.max(i.bottom,u.rowIndex)),e.dragStartObject.rowIndex===u.rowIndex&&e.dragStartObject.columnIndex===u.columnIndex||(e.ignoreNextClick=!0),e.cellBoundaryCrossed||0===a.x&&0===a.y||"row"===e.attributes.selectionMode)if("row"!==e.attributes.selectionMode&&-1!==e.dragStartObject.columnIndex||!e.rowBoundaryCrossed){if("row"!==e.attributes.selectionMode)if(e.dragAddToSelection||void 0===u.rowIndex){if(e.selections[u.rowIndex]=e.selections[u.rowIndex]||[],-1===e.selections[u.rowIndex].indexOf(u.columnIndex)){e.selections[u.rowIndex].push(u.columnIndex);var f={selections:e.selections,selectedData:e.getSelectedData(),selectionBounds:e.getSelectionBounds()};e.dispatchEvent("selectionchanged",f)}}else e.selections[u.rowIndex]&&-1!==e.selections[u.rowIndex].indexOf(u.columnIndex)&&e.selections[u.rowIndex].splice(e.selections[u.rowIndex].indexOf(u.columnIndex),1)}else e.selectRow(u.rowIndex,s,null,!0);if(!(e.selectionBounds&&n.top===e.selectionBounds.top&&n.left===e.selectionBounds.left&&n.bottom===e.selectionBounds.bottom&&n.right===e.selectionBounds.right||s))if(e.selections=[],i=n,"row"===e.attributes.selectionMode)for(o=i.top;o<=i.bottom;o+=1)e.selectRow(o,!0,null,!0);else-1!==n.top&&e.selectArea(i,!0);e.autoScrollZone(t,c,d,s)}e.cellBoundaryCrossed=!1,e.rowBoundaryCrossed=!1,e.columnBoundaryCrossed=!1,e.draw(!0)}}},e.click=function(t,r){var o,n=JSON.stringify(e.getSelectionBounds()),i=(t.ctrlKey||t.metaKey||e.attributes.persistantSelectionMode)&&!e.attributes.singleSelectionMode,a=r||e.getLayerPos(t);if(e.currentCell=e.getCellAt(a.x,a.y),void 0===e.currentCell.grid)if(e.input&&e.endEdit(),e.ignoreNextClick)e.ignoreNextClick=!1;else if(o=e.currentCell,!e.dispatchEvent("click",{NativeEvent:t,cell:e.currentCell})&&e.hasFocus){if(-1!==["rowHeaderCell","columnHeaderCell"].indexOf(e.currentCell.style)||i||e.setActiveCell(o.columnIndex,o.rowIndex),"cell"===e.currentCell.context){if("cornerCell"===e.currentCell.style)return e.selectAll(),e.draw(),void s();if("columnHeaderCell"===e.currentCell.style){if("sort"===e.attributes.columnHeaderClickBehavior)return e.orderBy===o.header.name?e.orderDirection="asc"===e.orderDirection?"desc":"asc":e.orderDirection="asc",e.order(o.header.name,e.orderDirection),void s();if("select"===e.attributes.columnHeaderClickBehavior)return e.selectColumn(o.header.index,i,t.shiftKey),void e.draw()}if(e.selections[o.rowIndex]=e.selections[o.rowIndex]||[],("row"===e.attributes.selectionMode||"rowHeaderCell"===e.currentCell.style)&&"rowHeaderCell"===e.currentCell.style&&e.attributes.tree&&a.x>0&&a.x-e.currentCell.x<e.style.treeArrowWidth+e.style.treeArrowMarginLeft+e.style.treeArrowMarginRight+e.style.treeArrowClickRadius&&a.y-e.currentCell.y<e.style.treeArrowHeight+e.style.treeArrowMarginTop+e.style.treeArrowClickRadius&&a.y>0)return void e.toggleTree(o.rowIndex);t.shiftKey&&!i&&(e.selectionBounds=e.getSelectionBounds(),e.selectArea(void 0,!1))}s(),e.draw(!0)}function s(){var t,r=e.getSelectionBounds();n!==JSON.stringify(r)&&(t={selections:e.selections,selectionBounds:e.getSelectionBounds()},Object.defineProperty(t,"selectedData",{get:function(){return e.getSelectedData()}}),e.dispatchEvent("selectionchanged",t))}},e.dragResizeColumn=function(t){var r,o,n;return r=e.getLayerPos(t),o=e.resizingStartingWidth+r.x-e.dragStart.x,n=e.resizingStartingHeight+r.y-e.dragStart.y,o<e.style.minColumnWidth&&(o=e.style.minColumnWidth),n<e.style.minRowHeight&&(n=e.style.minRowHeight),!e.dispatchEvent("resizecolumn",{x:o,y:n,draggingItem:e.draggingItem})&&(e.scrollBox.scrollLeft>e.scrollBox.scrollWidth-e.attributes.resizeScrollZone&&"ew-resize"===e.dragMode&&(e.resize(!0),e.scrollBox.scrollLeft+=o),"ew-resize"===e.dragMode?(e.sizes.columns["rowHeaderCell"===e.draggingItem.header.style?"cornerCell":e.draggingItem.sortColumnIndex]=o,-1!==["rowHeaderCell","cornerCell"].indexOf(e.draggingItem.header.style)&&e.resize(!0),void e.resizeChildGrids()):"ns-resize"===e.dragMode?(e.draggingItem.rowOpen?e.sizes.trees[e.draggingItem.rowIndex]=n:e.attributes.globalRowResize?e.style.cellHeight=n:e.sizes.rows[e.draggingItem.rowIndex]=n,e.dispatchEvent("resizerow",{row:n}),void e.resizeChildGrids()):void(e.ellipsisCache={}))},e.stopDragResize=function(){e.resize(),document.body.removeEventListener("mousemove",e.dragResizeColumn,!1),document.body.removeEventListener("mouseup",e.stopDragResize,!1),e.setStorageData(),e.draw(!0),e.ignoreNextClick=!0},e.scrollGrid=function(t){var r=e.getLayerPos(t);return e.attributes.scrollPointerLock&&e.pointerLockPosition&&-1!==["horizontal-scroll-box","vertical-scroll-box"].indexOf(e.scrollStartMode)&&(e.pointerLockPosition.x+=t.movementX,e.pointerLockPosition.y+=t.movementY,e.pointerLockPosition.x=Math.min(e.width-e.style.scrollBarWidth,Math.max(0,e.pointerLockPosition.x)),e.pointerLockPosition.y=Math.min(e.height-e.style.scrollBarWidth,Math.max(0,e.pointerLockPosition.y)),r=e.pointerLockPosition),e.scrollMode=e.getCellAt(r.x,r.y).context,"horizontal-scroll-box"===e.scrollMode&&"horizontal-scroll-box"!==e.scrollStartMode?(e.scrollStartMode="horizontal-scroll-box",e.dragStart=r,e.scrollStart.left=e.scrollBox.scrollLeft,void clearTimeout(e.scrollTimer)):"vertical-scroll-box"===e.scrollMode&&"vertical-scroll-box"!==e.scrollStartMode?(e.scrollStartMode="vertical-scroll-box",e.dragStart=r,e.scrollStart.top=e.scrollBox.scrollTop,void clearTimeout(e.scrollTimer)):("vertical-scroll-box"===e.scrollStartMode&&"vertical-scroll-box"!==e.scrollMode&&(e.scrollMode="vertical-scroll-box"),"horizontal-scroll-box"===e.scrollStartMode&&"horizontal-scroll-box"!==e.scrollMode&&(e.scrollMode="horizontal-scroll-box"),clearTimeout(e.scrollTimer),void(-1!==e.scrollModes.indexOf(e.scrollMode)&&("vertical-scroll-box"===e.scrollMode?e.scrollBox.scrollTop=e.scrollStart.top+(r.y-e.dragStart.y)/e.scrollBox.heightBoxRatio:"vertical-scroll-top"===e.scrollMode?(e.scrollBox.scrollTop-=e.page*e.style.cellHeight,e.scrollTimer=setTimeout(e.scrollGrid,e.attributes.scrollRepeatRate,t)):"vertical-scroll-bottom"===e.scrollMode&&(e.scrollBox.scrollTop+=e.page*e.style.cellHeight,e.scrollTimer=setTimeout(e.scrollGrid,e.attributes.scrollRepeatRate,t)),"horizontal-scroll-box"===e.scrollMode?e.scrollBox.scrollLeft=e.scrollStart.left+(r.x-e.dragStart.x)/e.scrollBox.widthBoxRatio:"horizontal-scroll-right"===e.scrollMode?(e.scrollBox.scrollLeft+=e.attributes.selectionScrollIncrement,e.scrollTimer=setTimeout(e.scrollGrid,e.attributes.scrollRepeatRate,t)):"horizontal-scroll-left"===e.scrollMode&&(e.scrollBox.scrollLeft-=e.attributes.selectionScrollIncrement,e.scrollTimer=setTimeout(e.scrollGrid,e.attributes.scrollRepeatRate,t)))))},e.stopScrollGrid=function(){clearTimeout(e.scrollTimer),document.exitPointerLock&&document.exitPointerLock(),document.removeEventListener("mousemove",e.scrollGrid,!1)},e.dragReorder=function(t){var r,o,n,i="column-reorder"===e.dragMode,a="row-reorder"===e.dragMode;o=(r=e.getLayerPos(t)).x-e.dragStart.x,n=r.y-e.dragStart.y,!e.attributes.allowColumnReordering&&i||!e.attributes.allowRowReordering&&a||e.dispatchEvent("reordering",{NativeEvent:t,source:e.dragStartObject,target:e.currentCell,dragMode:e.dragMode})||(Math.abs(o)>e.attributes.reorderDeadZone||Math.abs(n)>e.attributes.reorderDeadZone)&&(e.reorderObject=e.draggingItem,e.reorderTarget=e.currentCell,e.reorderObject.dragOffset={x:o,y:n},e.autoScrollZone(t,i?r.x:-1,a?r.y:-1,!1))},e.stopDragReorder=function(t){var r,o,n={"row-reorder":e.orders.rows,"column-reorder":e.orders.columns},i={"row-reorder":"rowIndex","column-reorder":"sortColumnIndex"}[e.dragMode];document.body.removeEventListener("mousemove",e.dragReorder,!1),document.body.removeEventListener("mouseup",e.stopDragReorder,!1),e.reorderObject&&e.reorderTarget&&("column-reorder"===e.dragMode&&e.reorderTarget.sortColumnIndex>-1&&e.reorderTarget.sortColumnIndex<e.getSchema().length||"row-reorder"===e.dragMode&&e.reorderTarget.rowIndex>-1&&e.reorderTarget.rowIndex<e.viewData.length)&&e.reorderObject[i]!==e.reorderTarget[i]&&!e.dispatchEvent("reorder",{NativeEvent:t,source:e.reorderObject,target:e.reorderTarget,dragMode:e.dragMode})&&(e.ignoreNextClick=!0,r=n[e.dragMode].indexOf(e.reorderObject[i]),o=n[e.dragMode].indexOf(e.reorderTarget[i]),n[e.dragMode].splice(r,1),n[e.dragMode].splice(o,0,e.reorderObject[i]),"column-reorder"===e.dragMode?e.orders.columns=n[e.dragMode]:e.orders.rows=n[e.dragMode],e.resize(),e.setStorageData()),e.reorderObject=void 0,e.reorderTarget=void 0,e.draw(!0)},e.dragMove=function(t){if(!e.dispatchEvent("moving",{NativeEvent:t,cell:e.currentCell})){var r=e.getLayerPos(t);e.moveOffset={x:e.currentCell.columnIndex-e.dragStartObject.columnIndex,y:e.currentCell.rowIndex-e.dragStartObject.rowIndex},(Math.abs(r.x)>e.attributes.reorderDeadZone||Math.abs(r.y)>e.attributes.reorderDeadZone)&&setTimeout((function(){e.autoScrollZone(t,r.x,r.y,!1)}),1)}},e.stopDragMove=function(t){document.body.removeEventListener("mousemove",e.dragMove,!1),document.body.removeEventListener("mouseup",e.stopDragMove,!1);var r=e.getSelectionBounds();if(e.dispatchEvent("endmove",{NativeEvent:t,cell:e.currentCell}))return e.movingSelection=void 0,e.moveOffset=void 0,void e.draw(!0);e.moveOffset&&(e.moveTo(e.movingSelection,r.left+e.moveOffset.x,r.top+e.moveOffset.y),e.moveSelection(e.moveOffset.x,e.moveOffset.y)),e.movingSelection=void 0,e.moveOffset=void 0,e.draw(!0)},e.freezeMove=function(t){if(!e.dispatchEvent("freezemoving",{NativeEvent:t,cell:e.currentCell})){var r=e.getLayerPos(t);e.ignoreNextClick=!0,e.freezeMarkerPosition=r,e.currentCell&&void 0!==e.currentCell.rowIndex&&"frozen-row-marker"===e.dragMode&&(e.scrollBox.scrollTop=0,e.frozenRow=e.currentCell.rowIndex+1),e.currentCell&&void 0!==e.currentCell.columnIndex&&"frozen-column-marker"===e.dragMode&&(e.scrollBox.scrollLeft=0,e.frozenColumn=e.currentCell.columnIndex+1),(Math.abs(r.x)>e.attributes.reorderDeadZone||Math.abs(r.y)>e.attributes.reorderDeadZone)&&setTimeout((function(){e.autoScrollZone(t,r.x,r.y,!1)}),1)}},e.stopFreezeMove=function(t){if(document.body.removeEventListener("mousemove",e.freezeMove,!1),document.body.removeEventListener("mouseup",e.stopFreezeMove,!1),e.freezeMarkerPosition=void 0,e.dispatchEvent("endfreezemove",{NativeEvent:t,cell:e.currentCell}))return e.frozenRow=e.startFreezeMove.x,e.frozenColumn=e.startFreezeMove.y,void e.draw(!0);e.draw(!0)},e.mousedown=function(t,r){if(e.lastMouseDownTarget=t.target,!e.dispatchEvent("mousedown",{NativeEvent:t,cell:e.currentCell})&&e.hasFocus&&2!==t.button&&!e.input){var o=t.ctrlKey||t.metaKey,n=/-move/.test(e.dragMode),i=/frozen-row-marker|frozen-column-marker/.test(e.dragMode),a=/-resize/.test(e.dragMode);if(e.dragStart=r||e.getLayerPos(t),e.scrollStart={left:e.scrollBox.scrollLeft,top:e.scrollBox.scrollTop},e.dragStartObject=e.getCellAt(e.dragStart.x,e.dragStart.y),e.dragAddToSelection=!e.dragStartObject.selected,o||t.shiftKey||/(vertical|horizontal)-scroll-(bar|box)/.test(e.dragStartObject.context)||!e.currentCell||e.currentCell.isColumnHeader||n||i||a||(e.selections=[]),!e.dragStartObject.isGrid){if(-1!==e.scrollModes.indexOf(e.dragStartObject.context))return e.scrollMode=e.dragStartObject.context,e.scrollStartMode=e.dragStartObject.context,e.scrollGrid(t),e.attributes.scrollPointerLock&&-1!==["horizontal-scroll-box","vertical-scroll-box"].indexOf(e.scrollStartMode)&&(e.pointerLockPosition={x:e.dragStart.x,y:e.dragStart.y},e.canvas.requestPointerLock()),document.addEventListener("mousemove",e.scrollGrid,!1),document.addEventListener("mouseup",e.stopScrollGrid,!1),void(e.ignoreNextClick=!0);if("cell"===e.dragMode)return e.selecting=!0,void(("row"===e.attributes.selectionMode||-1===e.dragStartObject.columnIndex)&&e.dragStartObject.rowIndex>-1?e.selectRow(e.dragStartObject.rowIndex,o,null):"row"!==e.attributes.selectionMode&&e.mousemove(t));if(n){if(e.draggingItem=e.dragItem,e.movingSelection=e.selections.concat([]),e.dragging=e.dragStartObject,e.dispatchEvent("beginmove",{NativeEvent:t,cell:e.currentCell}))return;return document.body.addEventListener("mousemove",e.dragMove,!1),document.body.addEventListener("mouseup",e.stopDragMove,!1),e.mousemove(t)}if(i){if(e.draggingItem=e.dragItem,e.startFreezeMove={x:e.frozenRow,y:e.frozenColumn},e.dispatchEvent("beginfreezemove",{NativeEvent:t}))return;return document.body.addEventListener("mousemove",e.freezeMove,!1),document.body.addEventListener("mouseup",e.stopFreezeMove,!1),e.mousemove(t)}return a?(e.draggingItem=e.dragItem,e.draggingItem.rowOpen?e.resizingStartingHeight=e.sizes.trees[e.draggingItem.rowIndex]:e.resizingStartingHeight=e.sizes.rows[e.draggingItem.rowIndex]||e.style.cellHeight,e.resizingStartingWidth=e.sizes.columns["rowHeaderCell"===e.draggingItem.header.style?"cornerCell":e.draggingItem.sortColumnIndex]||e.draggingItem.width,document.body.addEventListener("mousemove",e.dragResizeColumn,!1),void document.body.addEventListener("mouseup",e.stopDragResize,!1)):-1!==["row-reorder","column-reorder"].indexOf(e.dragMode)?(e.draggingItem=e.dragStartObject,document.body.addEventListener("mousemove",e.dragReorder,!1),void document.body.addEventListener("mouseup",e.stopDragReorder,!1)):void 0}}},e.mouseup=function(t){clearTimeout(e.scrollTimer),e.cellBoundaryCrossed=!0,e.rowBoundaryCrossed=!0,e.columnBoundaryCrossed=!0,e.selecting=void 0,e.draggingItem=void 0,e.dragStartObject=void 0,e.dispatchEvent("mouseup",{NativeEvent:t,cell:e.currentCell})||(e.hasFocus||t.target===e.canvas)&&(e.currentCell&&void 0!==e.currentCell.grid||e.contextMenu||e.input||(e.dragStart&&e.isInGrid(e.dragStart)&&e.controlInput.focus(),t.preventDefault()))},e.getAdjacentCells=function(){var t,r=e.getSchema(),o={};for(t=0;t<r.length;t+=1)r[e.orders.columns[t]].hidden||(void 0===o.first&&(o.first=t,o.left=t),o.last=t,t>e.activeCell.columnIndex&&void 0===o.right&&(o.right=t),t<e.activeCell.columnIndex&&(o.left=t));return void 0===o.right&&(o.right=o.last),o},e.keydown=function(t){var r,o=e.getAdjacentCells(),n=e.activeCell.columnIndex,i=e.activeCell.rowIndex,a=t.ctrlKey||t.metaKey,s=e.viewData.length-1,l=e.getSchema().length-1;if(!e.dispatchEvent("keydown",{NativeEvent:t,cell:e.currentCell})&&e.hasFocus){if(isPrintableKeyEvent(t)&&!a)return e.beginEditAt(n,i,t,!0);if(e.attributes.showNewRow&&(s+=1),"Tab"===t.key&&t.preventDefault(),"Escape"===t.key?e.selectNone():a&&"a"===t.key?e.selectAll():"ArrowDown"===t.key?i+=1:"ArrowUp"===t.key?i-=1:"ArrowLeft"===t.key&&!a||t.shiftKey&&"Tab"===t.key?n=o.left:"ArrowRight"===t.key&&!a||!t.shiftKey&&"Tab"===t.key?n=o.right:"PageUp"===t.key?(i-=e.page,t.preventDefault()):"PageDown"===t.key?(i+=e.page,t.preventDefault()):"Home"===t.key||a&&"ArrowUp"===t.key?i=0:"End"===t.key||a&&"ArrowDown"===t.key?i=e.viewData.length-1:a&&"ArrowRight"===t.key?n=o.last:a&&"ArrowLeft"===t.key&&(n=o.first),"Enter"===t.key)return t.preventDefault(),e.beginEditAt(n,i,t);(n<0||Number.isNaN(n))&&(n=o.first),i>s&&(i=s),(i<0||Number.isNaN(i))&&(i=0),n>l&&(n=o.last);var c=["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(t.key);t.shiftKey&&c&&(e.selections[Math.max(i,0)]=e.selections[Math.max(i,0)]||[],e.selections[Math.max(i,0)].push(n),e.selectionBounds=e.getSelectionBounds(),e.selectArea(void 0,a),e.draw(!0)),n===e.activeCell.columnIndex&&i===e.activeCell.rowIndex||(e.scrollIntoView(n!==e.activeCell.columnIndex?n:void 0,i===e.activeCell.rowIndex||Number.isNaN(i)?void 0:i),e.setActiveCell(n,i),!t.shiftKey&&e.attributes.selectionFollowsActiveCell&&(a||(e.selections=[]),e.selections[i]=e.selections[i]||[],e.selections[i].push(n),r={selectedData:e.getSelectedData(),selections:e.selections,selectionBounds:e.getSelectionBounds()},Object.defineProperty(r,"selectedData",{get:function(){return e.getSelectedData()}}),e.dispatchEvent("selectionchanged",r)),e.draw(!0))}},e.keyup=function(t){e.dispatchEvent("keyup",{NativeEvent:t,cell:e.currentCell})||e.hasFocus},e.keypress=function(t){e.hasFocus&&e.dispatchEvent("keypress",{NativeEvent:t,cell:e.currentCell})},e.dblclick=function(t){e.dispatchEvent("dblclick",{NativeEvent:t,cell:e.currentCell})||e.hasFocus&&("ew-resize"===e.currentCell.context&&"columnHeaderCell"===e.currentCell.style?e.fitColumnToValues(e.currentCell.header.name):"ew-resize"===e.currentCell.context&&"cornerCell"===e.currentCell.style?e.autosize():-1!==["cell","activeCell"].indexOf(e.currentCell.style)&&e.beginEditAt(e.currentCell.columnIndex,e.currentCell.rowIndex))},e.scrollWheel=function(r){var o,n,i=r,a=void 0===r.deltaX?r.NativeEvent.deltaX:r.deltaX,s=void 0===r.deltaY?r.NativeEvent.deltaY:r.deltaY,l=void 0===r.deltaMode?r.NativeEvent.deltaMode:r.deltaMode;r=r.NativeEvent||r,t?i.preventDefault(r):e.dispatchEvent("wheel",{NativeEvent:r})||(e.touchHaltAnimation=!0,o=e.scrollBox.scrollLeft,n=e.scrollBox.scrollTop,e.hasFocus&&(1===l&&(s*=17),(e.scrollBox.scrollTop<e.scrollBox.scrollHeight&&s>0||e.scrollBox.scrollLeft<e.scrollBox.scrollWidth&&a>0||e.scrollBox.scrollTop>0&&s<0||e.scrollBox.scrollLeft>0&&a<0)&&i.preventDefault(r),t=setTimeout((function(){t=void 0,e.scrollBox.scrollTo(a+o,s+n)}),1)))},e.pasteData=function(t,r,o,n){var i=this,a=e.getVisibleSchema(),s=function(e){return _newArrowCheck(this,i),/(?:^(<meta[^>]+>)?<table>)|(?:<!--StartFragment-->\s*<table>)/.test(e)}.bind(this);if("text/html"===r&&!1===s(t))return console.warn("Unrecognized HTML format. HTML must be a simple table, e.g.: <table><tr><td>data</td></tr></table>."),void console.warn("Data with the mime type text/html not in this format will not be imported as row data.");var l=function(e,t){var r=this;return"text/html"===t?e.substring(e.indexOf("<table><tr>")+11,e.indexOf("</tr></table>")).split("</tr><tr>").filter(function(e){return _newArrowCheck(this,r),!/^<th>|^<thead>/.test(e)}.bind(this)).map(function(e){var t=this;return _newArrowCheck(this,r),e.match(/<td>[^<]+/g).map(function(e){return _newArrowCheck(this,t),e.replace(/^<td>/,"")}.bind(this))}.bind(this)):e.split("\n").map(function(e){return _newArrowCheck(this,r),[e]}.bind(this))}(t,r);if(1===l.length){var c=l[0][0];e.forEachSelectedCell((function(e,t,r){e[t][r]=c}))}else{for(var d=[],u=0;u<l.length;u++){var p=e.orders.rows[o+u],h=l[u],f=e.viewData[p],g=Object.assign({},f);d[p]=[];for(var m=0;m<h.length;m++){var y=a[n+m];if(y){var b=y.name;null!=(c=h[m])?(d[p].push(n+m),g[b]=c):g[b]=f[b]}else console.warn("Paste data exceeded grid bounds. Skipping.")}e.originalData[p]=g}e.selections=d}var v=[];return e.selections.forEach((function(e,t){void 0!==t&&e.forEach((function(e){v.push([t,e])}))})),e.dispatchEvent("afterpaste",{cells:v}),e.refresh(),l.length},e.getNextVisibleColumnIndex=function(t){var r,o=e.getVisibleSchema();for(r=0;r<o.length;r+=1)if(o[r].columnIndex===t)return o[r+1].columnIndex;return-1},e.getVisibleColumnIndexOf=function(t){var r,o=e.getVisibleSchema();for(r=0;r<o.length;r+=1)if(o[r].columnIndex===t)return r;return-1},e.paste=function(t){var r=this;if(e.attributes.editable&&!e.dispatchEvent("beforepaste",{NativeEvent:t})){var o=new Map(Array.from(t.clipboardData.items).map(function(e){return _newArrowCheck(this,r),[e.type,e]}.bind(this))),n=["text/html","text/csv","text/plain"],i=n.map(function(e){return _newArrowCheck(this,r),o.get(e)}.bind(this)).filter(function(e){return _newArrowCheck(this,r),!!e}.bind(this));if(0!==i.length){var a=i[0],s=a.type;a.getAsString((function(t){e.pasteData(t,s,e.activeCell.rowIndex,e.getVisibleColumnIndexOf(e.activeCell.columnIndex)),e.draw()}))}else console.warn("Cannot find supported clipboard data type. Supported types are:",n.join(", "))}},e.cut=function(t){e.copy(t),e.forEachSelectedCell((function(e,t,r){e[t][r]=""}))},e.copy=function(t){if(!e.dispatchEvent("copy",{NativeEvent:t})&&e.hasFocus&&t.clipboardData){var r,o,n,i=[],a=[],s={},l=e.getSelectedData(),c=e.getSchema();l.length>0&&(l.forEach((function(t){var r=Object.keys(t);if(t){var o=[],n=[],l=[];c.forEach((function(t,r){l.push(c[e.orders.columns[r]])})),l.forEach((function(e,i){-1!==r.indexOf(e.name)&&(s[e.name]=!0,function(e,t,r,o){null!==e&&!1!==e&&void 0!==e&&e.replace?(t.push(u(e)),r.push('"'+e.replace(/"/g,'""')+'"')):void 0!==e?(r.push(e),t.push(u(e))):(r.push(""),t.push("<td>&nbsp;</td>"))}(t[e.name],o,n))})),i.push(o.join("")),a.push(n.join(","))}})),r=p(n=Object.keys(s))+a.join("\n"),o="<table>"+p(n,!0)+"<tr>"+i.join("</tr><tr>")+"</tr></table>",1===n.length&&(r=r.substring(1,r.length-1)),t.clipboardData.setData("text/html",o),t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/csv",r),t.clipboardData.setData("application/json",JSON.stringify(l)),t.preventDefault())}function d(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}function u(e){return"<td>"+("string"==typeof(e=null==e?"":e)?d(e):e)+"</td>"}function p(r,o){if(!c.length||r.length<2)return"";var n=[];return o&&n.push("<tr>"),c.forEach((function(i,a){if(!(i=c[e.orders.columns[a]]).hidden&&-1!==r.indexOf(i.name)){var s={NativeEvent:t,column:i};e.dispatchEvent("copyonschema",s)&&(i=s.column);var l=i.name||i.title||"";o?n.push("<th>"+d(l)+"</th>"):n.push('"'+l.replace(/"/g,'""')+'"')}})),n.push(o?"</tr>":"\n"),n.join(o?"":",")}}}function touch(e){var t,r;e.scrollAnimation={},e.touchDelta={},e.touchAnimateTo={},e.animationFrames=0,e.getTouchPos=function(t,r){var o,n=r?t.touches[r]:t.touches[0],i=e.canvas.getBoundingClientRect();if(n)return o={x:n.clientX-i.left,y:n.clientY-i.top},e.isChildGrid&&(o.x-=e.canvasOffsetLeft,o.y-=e.canvasOffsetTop),{x:o.x,y:o.y,rect:i}},e.easingFunctions={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e}},e.easing=function(t,r,o,n){return o*e.easingFunctions[e.attributes.touchEasingMethod](t/n)+r},e.calculatePPSTimed=function(){e.xPPST=-(e.touchDelta.x-e.touchSigmaTimed.x)/(e.touchDelta.t-e.touchSigmaTimed.t),e.yPPST=-(e.touchDelta.y-e.touchSigmaTimed.y)/(e.touchDelta.t-e.touchSigmaTimed.t),e.touchSigmaTimed={x:e.touchDelta.x,y:e.touchDelta.y,t:performance.now()}},e.calculatePPS=function(){e.xPPS=-(e.touchDelta.x-e.touchSigma.x)/(e.touchDelta.t-e.touchSigma.t),e.yPPS=-(e.touchDelta.y-e.touchSigma.y)/(e.touchDelta.t-e.touchSigma.t),e.touchSigma={x:e.touchDelta.x,y:e.touchDelta.y,t:performance.now()}},e.touchEndAnimation=function(){if(!e.canvas||!e.scrollBox.scrollTo)return requestAnimationFrame(e.touchEndAnimation);var t,r=performance.now(),o=e.attributes.touchReleaseAnimationDurationMs;t=r-e.touchDelta.t,e.animationFrames+=1,e.scrollAnimation.x=e.easing(t,e.touchDelta.scrollLeft,e.touchAnimateTo.x,o),e.scrollAnimation.y=e.easing(t,e.touchDelta.scrollTop,e.touchAnimateTo.y,o),t>o||e.scrollAnimation.y===e.scrollBox.scrollTop&&e.scrollAnimation.x===e.scrollBox.scrollLeft||e.stopAnimation||(e.scrollBox.scrollTo(e.scrollAnimation.x,e.scrollAnimation.y),requestAnimationFrame(e.touchEndAnimation))},e.touchEditCell=function(t){e.beginEditAt(t.columnIndex,t.rowIndex)},e.touchCell=function(t){return function(){clearInterval(e.calculatePPSTimer);var r,o=e.getTouchPos(t);if(Math.abs(e.touchDelta.x)+Math.abs(e.touchDelta.y)<e.attributes.touchDeadZone){if(!(r=e.getCellAt(o.x,o.y)))return;if(e.touchingCell&&e.touchingCell.rowIndex===r.rowIndex&&e.touchingCell.columnIndex===r.columnIndex)return void e.touchEditCell(r);e.input&&e.input.editCell&&e.endEdit(),e.touchingCell=r,e.selectArea({top:r.rowIndex,bottom:r.rowIndex,left:r.columnIndex,right:r.columnIndex}),e.draw(!0)}}},e.touchstart=function(t){if(t.changedTouches[0]&&(e.touchStart=e.getTouchPos(t),e.startingCell=e.getCellAt(e.touchStart.x,e.touchStart.y,!0)),!e.dispatchEvent("touchstart",{NativeEvent:t,cell:e.startingCell})){if(e.disposeContextMenu(),clearInterval(e.calculatePPSTimer),clearTimeout(e.touchContextTimeout),e.touchStartEvent=t,e.stopAnimation=!0,e.animationFrames=0,e.stopPropagation(t),t.preventDefault(),1===t.touches.length&&t.changedTouches[0]&&!e.zoomAltered){if(e.touchLength=1,e.touchStart=e.touchStart||e.touchStart1,e.touchScrollStart={x:e.scrollBox.scrollLeft,y:e.scrollBox.scrollTop,t:performance.now()},e.touchDelta={x:0,y:0,scrollLeft:e.scrollBox.scrollLeft,scrollTop:e.scrollBox.scrollTop,t:e.touchScrollStart.t},e.touchSigma={x:e.touchDelta.x,y:e.touchDelta.y,t:e.touchDelta.t},e.touchSigmaTimed={x:e.touchDelta.x,y:e.touchDelta.y,t:e.touchDelta.t},e.touchContextTimeout=setTimeout((function(){e.contextmenuEvent(t,e.touchStart)}),e.attributes.touchContextMenuTimeMs),e.calculatePPSTimer=setInterval(e.calculatePPSTimed,50),e.startingCell&&(e.startingCell.isGrid||-1!==["tree","inherit"].indexOf(e.startingCell.context)))return void(e.hasFocus=!1);if(e.hasFocus=!0,e.startingCell.isHeader)return e.startingCell.isRowHeader?(e.selectArea({top:e.startingCell.rowIndex,bottom:e.startingCell.rowIndex,left:0,right:e.getVisibleSchema().length-1}),e.draw(!0)):e.startingCell.isColumnHeader&&("sort"===e.attributes.columnHeaderClickBehavior&&(e.orderBy===e.startingCell.header.name?e.orderDirection="asc"===e.orderDirection?"desc":"asc":e.orderDirection="asc",e.order(e.startingCell.header.name,e.orderDirection)),"select"===e.attributes.columnHeaderClickBehavior&&(e.selectArea({top:0,bottom:e.viewData.length-1,left:e.startingCell.columnIndex,right:e.startingCell.columnIndex}),e.draw(!0))),void e.touchEndEvents(t)}e.zoomAltered||(document.body.addEventListener("touchmove",e.touchmove,{passive:!1}),document.body.addEventListener("touchend",e.touchend,!1),document.body.addEventListener("touchcancel",e.touchcancel,!1),e.draw(!0))}},e.touchSelect=function(t,r){if(void 0!==t.rowIndex&&void 0!==t.columnIndex){e.touchSelecting=!0;var o=e.getSelectionBounds();"selection-handle-bl"===r&&t.rowIndex>=o.top&&t.columnIndex<=o.right?(o.bottom=t.rowIndex,o.left=t.columnIndex):"selection-handle-tl"===r&&t.rowIndex<=o.bottom&&t.columnIndex<=o.right?(o.top=t.rowIndex,o.left=t.columnIndex):"selection-handle-tr"===r&&t.rowIndex<=o.bottom&&t.columnIndex>=o.left?(o.top=t.rowIndex,o.right=t.columnIndex):"selection-handle-br"===r&&t.rowIndex>=o.top&&t.columnIndex>=o.left&&(o.bottom=t.rowIndex,o.right=t.columnIndex),"row"===e.attributes.selectionMode||-1===t.rowIndex?(o.left=0,o.right=e.getSchema().length-1):o.left=Math.max(0,o.left),e.selectArea(o),e.draw(!0)}},e.touchmove=function(o){t||requestAnimationFrame((function(){t=!0,function(t){var o,n,i,a,s,l,c,d,u;if(!e.dispatchEvent("beforetouchmove",{NativeEvent:t})){if(clearTimeout(r),t.changedTouches[0]&&(e.touchPosition=e.getTouchPos(t)),t.changedTouches[1]&&(e.touchPosition1=e.getTouchPos(t,1)),Math.abs(e.touchDelta.x)+Math.abs(e.touchDelta.y)>e.attributes.touchDeadZone&&clearTimeout(e.touchContextTimeout),2===t.touches.length&&e.touchPosition&&e.touchPosition1)return d=e.touchPosition.y,u=e.touchPosition1.y,e.zoomDeltaStart||(e.zoomDeltaStart=Math.abs(d-u),e.startScale=e.scale),e.touchLength=2,e.scaleDelta=e.zoomDeltaStart-Math.abs(d-u),e.scale=e.startScale-e.scaleDelta*e.attributes.touchZoomSensitivity,e.scale=Math.min(Math.max(e.scale,e.attributes.touchZoomMin),e.attributes.touchZoomMax),e.zoomAltered=!0,e.resize(!0),void e.resizeChildGrids();e.zoomAltered||(e.touchLength=1,e.touchPosition=e.touchPosition||e.touchPosition1,o=e.getColumnHeaderCellHeight(),n=e.getRowHeaderCellWidth(),i=e.width-e.style.scrollBarWidth-e.touchPosition.x<e.attributes.selectionScrollZone,a=e.touchPosition.x-n<e.attributes.selectionScrollZone,s=e.height-e.style.scrollBarWidth-e.touchPosition.y<e.attributes.selectionScrollZone,l=e.touchPosition.y-o<e.attributes.selectionScrollZone,c=e.style.scrollBarWidth,t.stopPropagation(),e.touchDelta={x:e.touchPosition.x-e.touchStart.x,y:e.touchPosition.y-e.touchStart.y,scrollLeft:e.scrollBox.scrollLeft,scrollTop:e.scrollBox.scrollTop,t:performance.now()},e.currentCell=e.getCellAt(e.touchPosition.x,e.touchPosition.y),e.dispatchEvent("touchmove",{NativeEvent:t,cell:e.currentCell}),e.calculatePPS(),e.touchDuration=performance.now()-e.touchScrollStart.t,e.stopAnimation=!0,e.animationFrames=0,e.touchSelecting&&(i||a||l||s)&&function t(){var o=e.scrollBox.scrollLeft,n=e.scrollBox.scrollTop;o+=i?e.attributes.selectionScrollIncrement:0,n+=s?e.attributes.selectionScrollIncrement:0,n-=l?e.attributes.selectionScrollIncrement:0,o-=a?e.attributes.selectionScrollIncrement:0,e.scrollBox.scrollTo(o,n),r=setTimeout(t,e.attributes.scrollRepeatRate)}(),/vertical-scroll-/.test(e.startingCell.style)?e.scrollBox.scrollTop=e.scrollBox.scrollHeight*((e.touchPosition.y-o-c)/(e.scrollBox.height-c-o)):/horizontal-scroll-/.test(e.startingCell.style)?e.scrollBox.scrollLeft=e.scrollBox.scrollWidth*((e.touchPosition.x-n-c)/(e.scrollBox.width-c-n)):/selection-handle-/.test(e.startingCell.style)?e.touchSelect(e.currentCell,e.startingCell.style):e.scrollBox.scrollTo(e.touchScrollStart.x-e.touchDelta.x,e.touchScrollStart.y-e.touchDelta.y))}}(o),t=!1}))},e.touchEndEvents=function(t){e.zoomDeltaStart=void 0,e.touchSelecting=!1,clearInterval(e.touchScrollTimeout),clearInterval(e.touchContextTimeout),clearInterval(e.calculatePPSTimer),t.stopPropagation(),document.body.removeEventListener("touchmove",e.touchmove,{passive:!1}),document.body.removeEventListener("touchend",e.touchend,!1),document.body.removeEventListener("touchcancel",e.touchcancel,!1)},e.touchend=function(t){if(!e.dispatchEvent("touchend",{NativeEvent:t,cell:e.currentCell}))if(e.zoomDeltaStart=void 0,t.changedTouches[0]&&(e.touchPosition=void 0),t.changedTouches[1]&&(e.touchPosition1=void 0),e.zoomAltered)0===t.touches.length&&(e.zoomAltered=!1);else{var r=Math.abs(e.touchDelta.x)+Math.abs(e.touchDelta.y)<e.attributes.touchDeadZone;isNaN(e.xPPS)&&(e.xPPS=0),isNaN(e.yPPS)&&(e.yPPS=0),isNaN(e.xPPST)&&(e.xPPST=0),isNaN(e.yPPST)&&(e.yPPST=0),e.touchAnimateTo.x=e.xPPS*e.attributes.touchReleaseAcceleration,e.touchAnimateTo.y=e.yPPS*e.attributes.touchReleaseAcceleration,e.calculatePPSTimed(),r&&!e.contextMenu?e.touchCell(e.touchStartEvent)():0!==e.animationFrames||!(Math.abs(e.xPPST)>e.attributes.scrollAnimationPPSThreshold||Math.abs(e.yPPST)>e.attributes.scrollAnimationPPSThreshold)||/-scroll-/.test(e.startingCell.style)||r||(e.stopAnimation=!1,e.touchEndAnimation()),e.touchEndEvents(t)}},e.touchcancel=function(t){e.dispatchEvent("touchcancel",{NativeEvent:t,cell:e.currentCell})||e.touchEndEvents(t)}}function intf(e,t){function r(e,t){var r,o=[];for(r=e;r<=t;r+=1)o[r]=r;return o}e.scale=1,e.orders={rows:[],columns:[]},e.appliedInlineStyles={},e.cellGridAttributes={},e.treeGridAttributes={},e.visibleRowHeights=[],e.hasFocus=!1,e.activeCell={columnIndex:0,rowIndex:0},e.innerHTML="",e.storageName="canvasDataGrid",e.invalidSearchExpClass="canvas-datagrid-invalid-search-regExp",e.localStyleLibraryStorageKey="canvas-datagrid-user-style-library",e.dataType="application/x-canvas-datagrid",e.orderBy=null,e.orderDirection="asc",e.orderings={columns:[],add:function(t,r,o){e.orderings.columns=e.orderings.columns.filter((function(e){return e.orderBy!==t})),e.orderings.columns.push({orderBy:t,orderDirection:r,sortFunction:o})},sort:function(){console.warn("grid.orderings.sort has been deprecated. Please use grid.refresh()."),e.orderings.columns.forEach((function(t){e.viewData.sort(t.sortFunction(t.orderBy,t.orderDirection))}))}},e.columnFilters={},e.filters={},e.frozenRow=0,e.frozenColumn=0,e.ellipsisCache={},e.scrollCache={x:[],y:[]},e.scrollBox={},e.visibleRows=[],e.visibleCells=[],e.sizes={rows:{},columns:{},trees:{}},e.selections=[],e.hovers={},e.attributes={},e.style={},e.formatters={},e.sorters={},e.parsers={},e.schemaHashes={},e.events={},e.changes=[],e.scrollIndexTop=0,e.scrollPixelTop=0,e.scrollIndexLeft=0,e.scrollPixelLeft=0,e.childGrids={},e.openChildren={},e.scrollModes=["vertical-scroll-box","vertical-scroll-top","vertical-scroll-bottom","horizontal-scroll-box","horizontal-scroll-right","horizontal-scroll-left"],e.componentL1Events={},e.eventNames=["afterdraw","afterrendercell","attributechanged","beforebeginedit","beforecreatecellgrid","beforedraw","beforeendedit","beforerendercell","beforerendercellgrid","beginedit","cellmouseout","cellmouseover","click","collapsetree","contextmenu","copy","datachanged","dblclick","endedit","expandtree","formatcellvalue","keydown","keypress","keyup","mousedown","mousemove","mouseup","newrow","ordercolumn","rendercell","rendercellgrid","renderorderbyarrow","rendertext","rendertreearrow","reorder","reordering","resize","resizecolumn","resizerow","schemachanged","scroll","selectionchanged","stylechanged","touchcancel","touchend","touchmove","touchstart","wheel"],e.mouse={x:0,y:0},e.getSelectedData=function(t){var r=[],o=e.getSchema(),n=e.viewData.length;return 0===n?[]:(e.selections.forEach((function(i,a){i&&a!==n&&(0!==i.length?(r[a]={},i.forEach((function(n){if(-1!==n&&o[n]){var i=e.orders.columns[n];!t&&o[i].hidden||e.viewData[a]&&(r[a][o[i].name]=e.viewData[a][o[i].name])}}))):r[a]=null)})),r)},e.getBoundRowIndexFromViewRowIndex=function(t){if(e.boundRowIndexMap&&e.boundRowIndexMap.has(t))return e.boundRowIndexMap.get(t)},e.getColumnHeaderCellHeight=function(){return e.attributes.showColumnHeaders?(e.sizes.rows[-1]||e.style.columnHeaderCellHeight)*e.scale:0},e.getRowHeaderCellWidth=function(){return e.attributes.showRowHeaders?(e.sizes.columns[-1]||e.style.rowHeaderCellWidth)*e.scale:0},e.setStorageData=function(){if(e.attributes.saveAppearance&&e.attributes.name){var t={};e.getSchema().forEach((function(e){t[e.name]=!e.hidden})),localStorage.setItem(e.storageName+"-"+e.attributes.name,JSON.stringify({sizes:{rows:e.sizes.rows,columns:e.sizes.columns},orders:{rows:e.orders.rows,columns:e.orders.columns},orderBy:e.orderBy,orderDirection:e.orderDirection,visibility:t}))}},e.getSchema=function(){return e.schema||e.tempSchema||[]},e.createColumnOrders=function(){var t=e.getSchema();e.orders.columns=r(0,t.length-1)},e.createRowOrders=function(){e.orders.rows=r(0,e.originalData.length-1)},e.getVisibleSchema=function(){return e.getSchema().filter((function(e){return!e.hidden}))},e.applyDefaultValue=function(t,r,o){var n=r.defaultValue||"";"function"==typeof n&&(n=n.apply(e.intf,[r,o])),t[r.name]=n},e.createNewRowData=function(){e.newRow={},e.getSchema().forEach((function(t){e.applyDefaultValue(e.newRow,t,void 0)}))},e.getSchemaNameHash=function(t){for(var r=0;e.schemaHashes[t];)t+=r+=1;return t},e.filter=function(t){var r=e.filters[t];return r||void 0===t||(console.warn("Cannot find filter for type %s, falling back to substring match.",t),r=e.filters.string),r},e.hasActiveFilters=function(){return e.columnFilters&&Object.keys(e.columnFilters).length>0},e.getFilteredAndSortedViewData=function(t){for(var r=this,o=t.map(function(e,t){return _newArrowCheck(this,r),[e,t]}.bind(this)),n=function(){var t=_slicedToArray(a[i],2),r=t[0],n=t[1],s=e.getHeaderByName(r);if(!s)return"continue";var l=s.filter||e.filter(s.type||"string");o=o.filter((function(e){var t=_slicedToArray(e,1)[0][r];return l(t,n)}))},i=0,a=Object.entries(e.columnFilters);i<a.length;i++)n();var s,l=_createForOfIteratorHelper(e.orderings.columns);try{var c=function(){var e=this,t=s.value,r=t.sortFunction(t.orderBy,t.orderDirection);o.sort(function(t,o){_newArrowCheck(this,e);var n=_slicedToArray(t,1)[0],i=_slicedToArray(o,1)[0];return r(n,i)}.bind(this))};for(l.s();!(s=l.n()).done;)c()}catch(e){l.e(e)}finally{l.f()}return{viewData:o.map(function(e){return _newArrowCheck(this,r),_slicedToArray(e,1)[0]}.bind(this)),boundRowIndexMap:new Map(o.map(function(e,t){_newArrowCheck(this,r);var o=_slicedToArray(e,2);return o[0],[t,o[1]]}.bind(this)))}},e.refresh=function(){var t=e.getFilteredAndSortedViewData(e.originalData),r=t.viewData,o=t.boundRowIndexMap;e.viewData=r,e.boundRowIndexMap=o,e.resize(),e.draw(!0)},e.getBestGuessDataType=function(e,t){var r,o,n=t.length;for(o=0;o<n;o+=1)if(void 0!==t[o]&&null!==t[o]&&-1!==[null,void 0].indexOf(t[o][e]))return"object"===(r=_typeof(t[o]))?"string":r;return"string"},e.drawChildGrids=function(){Object.keys(e.childGrids).forEach((function(t){e.childGrids[t].draw()}))},e.resizeChildGrids=function(){Object.keys(e.childGrids).forEach((function(t){e.childGrids[t].resize()}))},e.autoScrollZone=function(t,r,o,n){var i,a=e.getRowHeaderCellWidth(),s=e.getColumnHeaderCellHeight();-1!==o&&(r>e.width-e.attributes.selectionScrollZone&&r<e.width&&(e.scrollBox.scrollLeft+=e.attributes.selectionScrollIncrement,i=!0),r-e.attributes.selectionScrollZone-a<0&&(e.scrollBox.scrollLeft-=e.attributes.selectionScrollIncrement,i=!0)),-1!==o&&(o>e.height-e.attributes.selectionScrollZone&&o<e.height&&(e.scrollBox.scrollTop+=e.attributes.selectionScrollIncrement,i=!0),o-e.attributes.selectionScrollZone-s<0&&(e.scrollBox.scrollTop-=e.attributes.selectionScrollIncrement,i=!0)),i&&!n&&e.currentCell&&-1!==e.currentCell.columnIndex&&(e.scrollTimer=setTimeout(e.mousemove,e.attributes.scrollRepeatRate,t))},e.validateColumn=function(e,t){if(!e.name)throw new Error("A column must contain at least a name.");if(t.filter((function(t){return t.name===e.name})).length>0)throw new Error("A column with the name "+e.name+" already exists and cannot be added again.");return!0},e.setDefaults=function(e,t,r,o){e[r]=void 0===t[r]?o:t[r]},e.setAttributes=function(){e.defaults.attributes.forEach((function(t){e.setDefaults(e.attributes,e.args,t[0],t[1])}))},e.setStyle=function(){e.defaults.styles.forEach((function(t){e.setDefaults(e.style,e.args.style||{},t[0],t[1])}))},e.autosize=function(t){e.getVisibleSchema().forEach((function(r,o){r.name!==t&&void 0!==t||(e.sizes.columns[o]=Math.max(e.findColumnMaxTextLength(r.name),e.style.minColumnWidth))})),e.sizes.columns[-1]=e.findColumnMaxTextLength("cornerCell")},e.dispose=function(){!e.isChildGrid&&e.canvas&&e.canvas.parentNode&&e.canvas.parentNode.removeChild(e.canvas),e.isChildGrid||document.body.removeChild(e.controlInput),e.eventParent.removeEventListener("mouseup",e.mouseup,!1),e.eventParent.removeEventListener("mousedown",e.mousedown,!1),e.eventParent.removeEventListener("dblclick",e.dblclick,!1),e.eventParent.removeEventListener("click",e.click,!1),e.eventParent.removeEventListener("mousemove",e.mousemove),e.eventParent.removeEventListener("wheel",e.scrollWheel,!1),e.canvas.removeEventListener("contextmenu",e.contextmenu,!1),e.canvas.removeEventListener("copy",e.copy),e.controlInput.removeEventListener("copy",e.copy),e.controlInput.removeEventListener("cut",e.cut),e.controlInput.removeEventListener("paste",e.paste),e.controlInput.removeEventListener("keypress",e.keypress,!1),e.controlInput.removeEventListener("keyup",e.keyup,!1),e.controlInput.removeEventListener("keydown",e.keydown,!1),window.removeEventListener("resize",e.resize),e.observer&&e.observer.disconnect&&e.observer.disconnect()},e.tryLoadStoredSettings=function(){var t;e.reloadStoredValues(),e.storedSettings&&"object"===_typeof(e.storedSettings.orders)&&null!==e.storedSettings.orders&&(e.storedSettings.orders.rows.length>=(e.viewData||[]).length&&(e.orders.rows=e.storedSettings.orders.rows),t=e.getSchema(),e.storedSettings.orders.columns.length===t.length&&(e.orders.columns=e.storedSettings.orders.columns),e.orderBy=void 0===e.storedSettings.orderBy?t[0].name:e.storedSettings.orderBy,e.orderDirection=void 0===e.storedSettings.orderDirection?"asc":e.storedSettings.orderDirection,void 0!==e.storedSettings.orderBy&&e.getHeaderByName(e.orderBy)&&e.orderDirection&&e.order(e.orderBy,e.orderDirection))},e.getDomRoot=function(){return e.shadowRoot?e.shadowRoot.host:e.parentNode},e.getFontName=function(e){return e.replace(/\d+\.?\d*px/,"")},e.getFontHeight=function(e){return parseFloat(e,10)},e.parseStyleValue=function(t){if(/Font/.test(t))return e.style[t+"Height"]=e.getFontHeight(e.style[t]),void(e.style[t+"Name"]=e.getFontName(e.style[t]));"moveOverlayBorderSegments"===t&&"string"==typeof e.style[t]&&(e.style[t]=e.style[t].split(",").map((function(e){return parseInt(e,10)})))},e.initProp=function(t){e.args[t]&&Object.keys(e.args[t]).forEach((function(r){e[t][r]=e.args[t][r]}))},e.getStyleProperty=function(t){return-1===e.styleKeys.indexOf(t)?e.parentNodeStyle[t]:e.style[t]},e.setStyleProperty=function(t,r,o){var n=-1!==["height","width","minHeight","minWidth","maxHeight","maxWidth"].indexOf(t);-1===e.styleKeys.indexOf(t)?e.parentNodeStyle[t]=r:(/-/.test(t)&&(t=e.dehyphenateProperty(t)),e.style[t]=r,e.parseStyleValue(t)),n&&e.resize(),o||(e.draw(!0),e.dispatchEvent("stylechanged",{name:"style",value:r}))},e.reloadStoredValues=function(){if(e.attributes.name&&e.attributes.saveAppearance){try{e.storedSettings=localStorage.getItem(e.storageName+"-"+e.attributes.name)}catch(t){console.warn("Error loading stored values. "+t.message),e.storedSettings=void 0}if(e.storedSettings)try{e.storedSettings=JSON.parse(e.storedSettings)}catch(t){console.warn("could not read settings from localStore",t),e.storedSettings=void 0}e.storedSettings&&("object"===_typeof(e.storedSettings.sizes)&&null!==e.storedSettings.sizes&&(e.sizes.rows=e.storedSettings.sizes.rows,e.sizes.columns=e.storedSettings.sizes.columns,["trees","columns","rows"].forEach((function(t){e.sizes[t]||(e.sizes[t]={})}))),"object"===_typeof(e.storedSettings.visibility)&&e.getSchema().forEach((function(t){e.storedSettings.visibility&&void 0!==e.storedSettings.visibility[t.name]&&(t.hidden=!e.storedSettings.visibility[t.name])})))}},e.init=function(){if(!e.initialized){var t={};return e.setAttributes(),e.setStyle(),e.initScrollBox(),e.setDom(),e.nodeType="canvas-datagrid",e.ie=/Trident/.test(window.navigator.userAgent),e.edge=/Edge/.test(window.navigator.userAgent),e.webKit=/WebKit/.test(window.navigator.userAgent),e.moz=/Gecko/.test(window.navigator.userAgent),e.mobile=/Mobile/i.test(window.navigator.userAgent),e.blankValues=[void 0,null,""],e.cursorGrab="grab",e.cursorGrabing="grabbing",e.cursorGrab=e.webKit?"-webkit-grab":e.cursorGrab,e.cursorGrabing=e.moz?"-webkit-grabbing":e.cursorGrabbing,e.pointerLockPosition={x:0,y:0},Object.keys(e.style).forEach(e.parseStyleValue),e.intf.moveSelection=e.moveSelection,e.intf.moveTo=e.moveTo,e.intf.addEventListener=e.addEventListener,e.intf.removeEventListener=e.removeEventListener,e.intf.dispatchEvent=e.dispatchEvent,e.intf.dispose=e.dispose,e.intf.appendTo=e.appendTo,e.intf.getVisibleCellByIndex=e.getVisibleCellByIndex,e.intf.filters=e.filters,e.intf.sorters=e.sorters,e.intf.autosize=e.autosize,e.intf.beginEditAt=e.beginEditAt,e.intf.endEdit=e.endEdit,e.intf.setActiveCell=e.setActiveCell,e.intf.forEachSelectedCell=e.forEachSelectedCell,e.intf.scrollIntoView=e.scrollIntoView,e.intf.clearChangeLog=e.clearChangeLog,e.intf.gotoCell=e.gotoCell,e.intf.gotoRow=e.gotoRow,e.intf.getHeaderByName=e.getHeaderByName,e.intf.findColumnScrollLeft=e.findColumnScrollLeft,e.intf.findRowScrollTop=e.findRowScrollTop,e.intf.fitColumnToValues=e.fitColumnToValues,e.intf.findColumnMaxTextLength=e.findColumnMaxTextLength,e.intf.disposeContextMenu=e.disposeContextMenu,e.intf.getCellAt=e.getCellAt,e.intf.isCellVisible=e.isCellVisible,e.intf.isRowVisible=e.isRowVisible,e.intf.isColumnVisible=e.isColumnVisible,e.intf.order=e.order,e.intf.draw=e.draw,e.intf.refresh=e.refresh,e.intf.isComponent=e.isComponent,e.intf.selectArea=e.selectArea,e.intf.clipElement=e.clipElement,e.intf.getSchemaFromData=e.getSchemaFromData,e.intf.setFilter=e.setFilter,e.intf.selectRow=e.selectRow,e.intf.parentGrid=e.parentGrid,e.intf.toggleTree=e.toggleTree,e.intf.expandTree=e.expandTree,e.intf.collapseTree=e.collapseTree,e.intf.canvas=e.canvas,e.intf.context=e.ctx,e.intf.insertRow=e.insertRow,e.intf.deleteRow=e.deleteRow,e.intf.addRow=e.addRow,e.intf.insertColumn=e.insertColumn,e.intf.deleteColumn=e.deleteColumn,e.intf.addColumn=e.addColumn,e.intf.getClippingRect=e.getClippingRect,e.intf.setRowHeight=e.setRowHeight,e.intf.setColumnWidth=e.setColumnWidth,e.intf.resetColumnWidths=e.resetColumnWidths,e.intf.resetRowHeights=e.resetRowHeights,e.intf.resize=e.resize,e.intf.selectColumn=e.selectColumn,e.intf.selectRow=e.selectRow,e.intf.selectAll=e.selectAll,e.intf.selectNone=e.selectNone,e.intf.drawChildGrids=e.drawChildGrids,e.intf.assertPxColor=e.assertPxColor,e.intf.clearPxColorAssertions=e.clearPxColorAssertions,e.intf.integerToAlpha=e.integerToAlpha,e.intf.copy=e.copy,e.intf.paste=e.paste,e.intf.setStyleProperty=e.setStyleProperty,Object.defineProperty(e.intf,"defaults",{get:function(){return{styles:e.defaults.styles.reduce((function(e,t){return e[t[0]]=t[1],e}),{}),attributes:e.defaults.attributes.reduce((function(e,t){return e[t[0]]=t[1],e}),{})}}}),e.styleKeys=Object.keys(e.intf.defaults.styles),e.styleKeys.map((function(t){return e.hyphenateProperty(t,!1)})).forEach(r),e.styleKeys.map((function(t){return e.hyphenateProperty(t,!0)})).forEach(r),e.DOMStyles=window.getComputedStyle(document.body,null),e.styleKeys.concat(Object.keys(e.DOMStyles)).forEach((function(r){t[r]=void 0,Object.defineProperty(t,r,{get:function(){return e.getStyleProperty(r)},set:function(t){e.initialized&&(e.appliedInlineStyles[r]=t),e.setStyleProperty(r,t)}})})),Object.defineProperty(e.intf,"shadowRoot",{get:function(){return e.shadowRoot}}),Object.defineProperty(e.intf,"activeCell",{get:function(){return e.activeCell}}),Object.defineProperty(e.intf,"hasFocus",{get:function(){return e.hasFocus}}),Object.defineProperty(e.intf,"hasActiveFilters",{get:function(){return e.hasActiveFilters()}}),Object.defineProperty(e.intf,"style",{get:function(){return t},set:function(t){Object.keys(t).forEach((function(r){e.setStyleProperty(r,t[r],!0)})),e.draw(!0),e.dispatchEvent("stylechanged",{name:"style",value:t})}}),Object.defineProperty(e.intf,"attributes",{value:{}}),Object.keys(e.attributes).forEach((function(t){Object.defineProperty(e.intf.attributes,t,{get:function(){return e.attributes[t]},set:function(r){e.attributes[t]=r,"name"===t&&e.tryLoadStoredSettings(),e.draw(!0),e.dispatchEvent("attributechanged",{name:t,value:r[t]})}})})),e.filters.string=function(t,r){if(r===e.attributes.blanksText)return e.blankValues.includes(null==t?t:String(t).trim());t=String(t);var o,n=/\/(i|g|m)*$/.exec(r),i=n?n[0].substring(1):"",a=i.length;if(e.invalidFilterRegEx=void 0,"/"===r.substring(0,1)&&n){try{o=new RegExp(r.substring(1,r.length-(a+1)),i)}catch(t){return void(e.invalidFilterRegEx=t)}return o.test(t)}return!!t.toString&&-1!==t.toString().toLocaleUpperCase().indexOf(r.toLocaleUpperCase())},e.filters.number=function(t,r){return r===e.attributes.blanksText?e.blankValues.includes(null==t?t:String(t).trim()):!r||t===r},["formatters","filters","sorters"].forEach(e.initProp),e.applyComponentStyle(!1,e.intf),e.reloadStoredValues(),e.args.data&&(e.intf.data=e.args.data),(e.intf.innerText||e.intf.textContent)&&("application/x-canvas-datagrid"===e.intf.dataType&&(e.intf.dataType="application/json+x-canvas-datagrid"),e.intf.data=e.intf.innerText||e.intf.textContent),e.args.schema&&(e.intf.schema=e.args.schema),e.isChildGrid||!e.isComponent?requestAnimationFrame((function(){e.resize(!0)})):e.resize(!0),e.initialized=!0,e}function r(t){-1===e.styleKeys.indexOf(t)&&e.styleKeys.push(t)}},e.intf.blur=function(t){e.hasFocus=!1},e.intf.focus=function(){e.hasFocus=!0,e.controlInput.focus()},(e.shadowRoot||e.isChildGrid)&&(Object.defineProperty(e.intf,"height",{get:function(){return e.shadowRoot?e.shadowRoot.height:e.parentNode.height},set:function(t){e.shadowRoot?e.shadowRoot.height=t:e.parentNode.height=t,e.resize(!0)}}),Object.defineProperty(e.intf,"width",{get:function(){return e.shadowRoot?e.shadowRoot.width:e.parentNode.width},set:function(t){e.shadowRoot?e.shadowRoot.width=t:e.parentNode.width=t,e.resize(!0)}}),Object.defineProperty(e.intf,"parentNode",{get:function(){return e.parentNode},set:function(t){if(!e.isChildGrid)throw new TypeError("Cannot set property parentNode which has only a getter");e.parentNode=t}})),Object.defineProperty(e.intf,"visibleRowHeights",{get:function(){return e.visibleRowHeights}}),Object.defineProperty(e.intf,"openChildren",{get:function(){return e.openChildren}}),Object.defineProperty(e.intf,"childGrids",{get:function(){return Object.keys(e.childGrids).map((function(t){return e.childGrids[t]}))}}),Object.defineProperty(e.intf,"isChildGrid",{get:function(){return e.isChildGrid}}),Object.defineProperty(e,"cursor",{get:function(){return e.parentNodeStyle.cursor},set:function(t){"cell"===t&&(t="default"),e.currentCursor!==t&&(e.parentNodeStyle.cursor=t,e.currentCursor=t)}}),Object.defineProperty(e.intf,"orderDirection",{get:function(){return e.orderDirection},set:function(t){"desc"!==t&&(t="asc"),e.orderDirection=t,e.order(e.orderBy,e.orderDirection)}}),Object.defineProperty(e.intf,"orderBy",{get:function(){return e.orderBy},set:function(t){if(void 0===e.getSchema().find((function(e){return e.name===t})))throw new Error("Cannot sort by unknown column name.");e.orderBy=t,e.order(e.orderBy,e.orderDirection)}}),e.isComponent&&(Object.defineProperty(e.intf,"offsetHeight",{get:function(){return e.canvas.offsetHeight}}),Object.defineProperty(e.intf,"offsetWidth",{get:function(){return e.canvas.offsetWidth}})),Object.defineProperty(e.intf,"scrollHeight",{get:function(){return e.scrollBox.scrollHeight}}),Object.defineProperty(e.intf,"scrollWidth",{get:function(){return e.scrollBox.scrollWidth}}),Object.defineProperty(e.intf,"scrollTop",{get:function(){return e.scrollBox.scrollTop},set:function(t){e.scrollBox.scrollTop=t}}),Object.defineProperty(e.intf,"scrollLeft",{get:function(){return e.scrollBox.scrollLeft},set:function(t){e.scrollBox.scrollLeft=t}}),Object.defineProperty(e.intf,"sizes",{get:function(){return e.sizes}}),Object.defineProperty(e.intf,"parentDOMNode",{get:function(){return e.parentDOMNode}}),Object.defineProperty(e.intf,"input",{get:function(){return e.input}}),Object.defineProperty(e.intf,"controlInput",{get:function(){return e.controlInput}}),Object.defineProperty(e.intf,"currentCell",{get:function(){return e.currentCell}}),Object.defineProperty(e.intf,"visibleCells",{get:function(){return e.visibleCells}}),Object.defineProperty(e.intf,"visibleRows",{get:function(){return e.visibleRows}}),Object.defineProperty(e.intf,"selections",{get:function(){return e.selections}}),Object.defineProperty(e.intf,"dragMode",{get:function(){return e.dragMode}}),Object.defineProperty(e.intf,"changes",{get:function(){return e.changes}}),e.intf.formatters=e.formatters,Object.defineProperty(e.intf,"dataType",{get:function(){return e.dataType},set:function(t){if(!e.parsers[t])throw new Error("No parser for MIME type "+t);e.dataType=t}}),e.eventNames.forEach((function(t){Object.defineProperty(e.intf,"on"+t,{get:function(){return e.componentL1Events[t]},set:function(r){e.events[t]=[],e.componentL1Events[t]=r,r&&e.addEventListener(t,r)}})})),Object.defineProperty(e.intf,"frozenRow",{get:function(){return e.frozenRow},set:function(t){if(isNaN(t))throw new TypeError("Expected value for frozenRow to be a number.");if(e.visibleRows.length<t)throw new RangeError("Cannot set a value larger than the number of visible rows.");e.frozenRow=t}}),Object.defineProperty(e.intf,"frozenColumn",{get:function(){return e.frozenColumn},set:function(t){if(isNaN(t))throw new TypeError("Expected value for frozenRow to be a number.");if(e.getVisibleSchema().length<t)throw new RangeError("Cannot set a value larger than the number of visible columns.");e.frozenColumn=t}}),Object.defineProperty(e.intf,"scrollIndexRect",{get:function(){return{top:e.scrollIndexTop,right:e.scrollIndexRight,bottom:e.scrollIndexBottom,left:e.scrollIndexLeft}}}),Object.defineProperty(e.intf,"scrollPixelRect",{get:function(){return{top:e.scrollPixelTop,right:e.scrollPixelRight,bottom:e.scrollPixelBottom,left:e.scrollPixelLeft}}}),Object.defineProperty(e.intf,"rowOrder",{get:function(){return e.orders.rows},set:function(t){if(!Array.isArray(t))throw new TypeError("Value must be an array.");if(!e.originalData||t.length<e.originalData.length)throw new RangeError("Array length must be equal to or greater than number of rows.");e.orders.rows=t}}),Object.defineProperty(e.intf,"columnOrder",{get:function(){return e.orders.columns},set:function(t){if(!Array.isArray(t))throw new TypeError("Value must be an array.");if(t.length<e.getSchema().length)throw new RangeError("Array length must be equal to or greater than number of columns.");e.orders.columns=t}}),Object.defineProperty(e.intf,"selectionBounds",{get:function(){return e.getSelectionBounds()}}),Object.defineProperty(e.intf,"selectedRows",{get:function(){return e.getSelectedData(!0)}}),Object.defineProperty(e.intf,"selectedCells",{get:function(){return e.getSelectedData()}}),Object.defineProperty(e.intf,"visibleSchema",{get:function(){return e.getVisibleSchema().map((function(e){return e}))}}),Object.defineProperty(e.intf,"treeGridAttributes",{get:function(){return e.treeGridAttributes},set:function(t){e.treeGridAttributes=t}}),Object.defineProperty(e.intf,"cellGridAttributes",{get:function(){return e.cellGridAttributes},set:function(t){e.cellGridAttributes=t}}),Object.defineProperty(e.intf,"ctx",{get:function(){return e.ctx}}),Object.defineProperty(e.intf,"schema",{get:function(){return e.getSchema()},set:function(t){if(void 0===t)return e.schema=void 0,e.tempSchema=void 0,void e.dispatchEvent("schemachanged",{schema:void 0});if(!Array.isArray(t)||"object"!==_typeof(t[0]))throw new Error("Schema must be an array of objects.");if(void 0===t[0].name)throw new Error("Expected schema to contain an object with at least a name property.");e.schema=t.map((function(t,r){return t.width=t.width||e.style.cellWidth,t.filter=t.filter||e.filter(t.type),t.type=t.type||"string",t.index=r,t.columnIndex=r,t.rowIndex=-1,t})),e.tempSchema=void 0,e.createNewRowData(),e.createColumnOrders(),e.tryLoadStoredSettings(),e.storedSettings&&"object"===_typeof(e.storedSettings.visibility)&&e.schema.forEach((function(t,r){e.storedSettings&&void 0!==e.storedSettings.visibility[t.name]&&(t.hidden=!e.storedSettings.visibility[t.name])})),e.resize(!0),e.dispatchEvent("schemachanged",{schema:e.schema})}}),e.intf.getTypes=function(){return Object.keys(e.parsers)},e.parseInnerHtml=function(e){if(!e||/^ +$/.test(e))return[];try{e=JSON.parse(e)}catch(e){console.warn(Error("Cannot parse application/json+x-canvas-datagrid formated data. "+e.message+"  \nNote: canvas-datagrid.innerHTML is for string data only.  Use the canvas-datagrid.data property to set object data."))}return e},e.parsers["application/json+x-canvas-datagrid"]=function(t,r){e.parsers["application/x-canvas-datagrid"](e.parseInnerHtml(t),(function(e,t){return r(e,t)}))},e.parsers["application/x-canvas-datagrid"]=function(e,t){return t(e)},e.intf.parsers=e.parsers,e.etl=function(t,r){if(!e.intf.parsers[e.dataType])throw new Error("Unsupported data type.");e.intf.parsers[e.dataType](t,(function(t,o){e.originalData=t,e.viewData=Array.from(e.originalData),Array.isArray(o)&&(e.schema=o),e.attributes.autoGenerateSchema&&(e.schema=e.getSchemaFromData(t)),e.schema||(e.tempSchema=e.getSchemaFromData(t)),e.getSchema()&&e.createColumnOrders(),e.refresh(),e.schema||0!==(e.originalData||[]).length||(e.tempSchema=[{name:""}]),e.fitColumnToValues("cornerCell",!0),(e.tempSchema&&!e.schema||e.attributes.autoGenerateSchema)&&(e.createColumnOrders(),e.dispatchEvent("schemachanged",{schema:e.tempSchema})),r()}))},Object.defineProperty(e.intf,"viewData",{get:function(){return e.viewData}}),Object.defineProperty(e.intf,"boundData",{get:function(){return e.originalData}}),Object.defineProperty(e.intf,"data",{get:function(){return e.originalData},set:function(t){e.etl(t,(function(){e.changes=[],e.createNewRowData(),e.attributes.autoResizeColumns&&e.originalData.length>0&&void 0===e.storedSettings&&e.autosize(),e.fitColumnToValues("cornerCell",!0),e.createRowOrders(),e.tryLoadStoredSettings(),e.dispatchEvent("datachanged",{data:e.originalData}),e.resize(!0)}))}}),e.initScrollBox=function(){var t=0,r=0,o=0,n=0,i=0,a=0,s=20,l=20;function c(t,r){if(isNaN(t))throw new Error("ScrollTop value must be a number");t<0&&(t=0),t>i&&(t=i),i<0&&(t=0),o=t,r||e.scroll()}function d(t,r){if(isNaN(t))throw new Error("ScrollLeft value must be a number");t<0&&(t=0),t>a&&(t=a),a<0&&(t=0),n=t,r||e.scroll()}e.scrollBox.toString=function(){return'{"width": '+a.toFixed(2)+', "height": '+i.toFixed(2)+', "left": '+n.toFixed(2)+', "top": '+o.toFixed(2)+', "widthRatio": '+e.scrollBox.widthBoxRatio.toFixed(5)+', "heightRatio": '+e.scrollBox.heightBoxRatio.toFixed(5)+"}"},e.scrollBox.scrollTo=function(e,t,r){d(e,!0),c(t,r)},Object.defineProperty(e.scrollBox,"scrollBoxHeight",{get:function(){return s},set:function(e){s=e}}),Object.defineProperty(e.scrollBox,"scrollBoxWidth",{get:function(){return l},set:function(e){l=e}}),Object.defineProperty(e.scrollBox,"height",{get:function(){return t},set:function(e){t=e}}),Object.defineProperty(e.scrollBox,"width",{get:function(){return r},set:function(e){r=e}}),Object.defineProperty(e.scrollBox,"scrollTop",{get:function(){return o},set:c}),Object.defineProperty(e.scrollBox,"scrollLeft",{get:function(){return n},set:d}),Object.defineProperty(e.scrollBox,"scrollHeight",{get:function(){return i},set:function(e){o>e&&(o=Math.max(e,0)),i=e}}),Object.defineProperty(e.scrollBox,"scrollWidth",{get:function(){return a},set:function(e){n>e&&(n=Math.max(e,0)),a=e}})}}function contextMenu(e){var t,r,o;function n(t){e.createInlineStyle(t,"canvas-datagrid-context-menu-item"+(e.mobile?"-mobile":"")),t.addEventListener("mouseover",(function(){e.createInlineStyle(t,"canvas-datagrid-context-menu-item:hover")})),t.addEventListener("mouseout",(function(){e.createInlineStyle(t,"canvas-datagrid-context-menu-item")}))}function i(o,a,s,l){var c,d,u,p=document.createElement("div"),h=document.createElement("div"),f=document.createElement("div"),g=[],m=-1,y={};if(!Array.isArray(s))throw new Error("createContextMenu expects an array.");function b(){p.scrollTop>0?e.parentDOMNode.appendChild(h):h.parentNode&&h.parentNode.removeChild(h),p.scrollTop>=p.scrollHeight-p.offsetHeight&&f.parentNode?f.parentNode.removeChild(f):p.scrollHeight-p.offsetHeight>0&&!(p.scrollTop>=p.scrollHeight-p.offsetHeight)&&e.parentDOMNode.appendChild(f)}function v(t){return function o(){var n=e.attributes.contextHoverScrollAmount;"up"===t&&0===p.scrollTop||"down"===t&&p.scrollTop===p.scrollHeight||(p.scrollTop+="up"===t?-n:n,r=setTimeout(o,e.attributes.contextHoverScrollRateMs,t))}}function _(e){return function(){clearTimeout(r)}}return y.parentGrid=e.intf,y.parentContextMenu=l,y.container=p,d={},u=e.scrollOffset(e.canvas),void 0===t&&(t=e.style.contextMenuZIndex),s.forEach((function(t){var r,a=document.createElement("div");function s(e){e.relatedTarget===p||t.contextMenu.container===e.relatedTarget||r===e.relatedTarget||a===e.relatedTarget||t.contextMenu.container.contains(e.relatedTarget)||(t.contextMenu.dispose(),g.splice(g.indexOf(t.contextMenu),1),t.contextMenu=void 0,a.removeEventListener("mouseout",s),p.removeEventListener("mouseout",s),a.setAttribute("contextOpen","0"),a.setAttribute("opening","0"))}function l(r){if("1"===a.getAttribute("opening")&&"1"!==a.getAttribute("contextOpen")){var n=a.getBoundingClientRect();n={left:n.left+e.style.childContextMenuMarginLeft+p.offsetWidth,top:n.top+e.style.childContextMenuMarginTop,bottom:n.bottom,right:n.right},t.contextMenu=i(o,n,r,y),a.setAttribute("contextOpen","1"),a.addEventListener("mouseout",s),p.addEventListener("mouseout",s),g.push(t.contextMenu)}}function c(){var e;"1"!==a.getAttribute("contextOpen")&&(a.setAttribute("opening","1"),"function"!=typeof t.items?l(t.items):void 0!==(e=t.items.apply(y,[function(e){l(e)}]))&&Array.isArray(e)&&l(e))}!function(t){!function e(t){if(null!==t)return"function"==typeof t?e(t(o)):void("object"!==_typeof(t)?(n(a),a.innerHTML=t):a.appendChild(t))}(t.title),t.contextItemContainer=a,(t.items&&t.items.length>0||"function"==typeof t.items)&&(r=document.createElement("div"),e.createInlineStyle(r,"canvas-datagrid-context-child-arrow"),r.innerHTML=e.style.childContextMenuArrowHTML,a.appendChild(r),a.addEventListener("mouseover",c),a.addEventListener("mouseout",(function(){a.setAttribute("opening","0")}))),t.click&&a.addEventListener("click",(function(r){t.click.apply(e,[r])}))}(t),p.appendChild(a)})),e.createInlineStyle(p,"canvas-datagrid-context-menu"+(e.mobile?"-mobile":"")),d.x=a.left-u.left,d.y=a.top-u.top,d.height=0,t+=1,p.style.position="absolute",h.style.color=e.style.contextMenuArrowColor,f.style.color=e.style.contextMenuArrowColor,[h,f].forEach((function(e){e.style.textAlign="center",e.style.position="absolute",e.style.zIndex=t+1})),p.style.zIndex=t,l&&l.inputDropdown&&(p.style.maxHeight=window.innerHeight-d.y-e.style.autocompleteBottomMargin+"px",p.style.minWidth=a.width+"px",d.y+=a.height),e.mobile&&(p.style.width=a.width+"px"),p.style.left=d.x+"px",p.style.top=d.y+"px",p.addEventListener("scroll",b),p.addEventListener("wheel",(function(t){e.hasFocus&&(p.scrollTop+=t.deltaY,p.scrollLeft+=t.deltaX),b()})),h.innerHTML=e.style.contextMenuArrowUpHTML,f.innerHTML=e.style.contextMenuArrowDownHTML,p.appendChild(h),document.body.appendChild(f),document.body.appendChild(p),(c=p.getBoundingClientRect()).bottom>window.innerHeight&&(l&&l.inputDropdown||(d.y-=c.bottom+e.style.contextMenuWindowMargin-window.innerHeight),d.y<0&&(d.y=e.style.contextMenuWindowMargin),p.offsetHeight>window.innerHeight-e.style.contextMenuWindowMargin&&(p.style.height=window.innerHeight-2*e.style.contextMenuWindowMargin+"px")),c.right>window.innerWidth&&(d.x-=c.right-window.innerWidth+e.style.contextMenuWindowMargin),d.x<0&&(d.x=e.style.contextMenuWindowMargin),d.y<0&&(d.y=e.style.contextMenuWindowMargin),p.style.left=d.x+"px",p.style.top=d.y+"px",c=p.getBoundingClientRect(),h.style.top=c.top+"px",f.style.top=c.top+c.height-f.offsetHeight+"px",h.style.left=c.left+"px",f.style.left=c.left+"px",f.style.width=p.offsetWidth+"px",h.style.width=p.offsetWidth+"px",f.addEventListener("mouseover",v("down")),f.addEventListener("mouseout",_()),h.addEventListener("mouseover",v("up")),h.addEventListener("mouseout",_()),b(),y.clickIndex=function(e){s[e].contextItemContainer.dispatchEvent(new Event("click"))},y.rect=c,y.items=s,y.upArrow=h,y.downArrow=f,y.dispose=function(){clearTimeout(r),g.forEach((function(e){e.dispose()})),[f,h,p].forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))},Object.defineProperty(y,"selectedIndex",{get:function(){return m},set:function(t){if("number"!=typeof t||isNaN(t||!isFinite(t)))throw new Error("Context menu selected index must be a sane number.");(m=t)>s.length-1&&(m=s.length-1),m<0&&(m=0),s.forEach((function(t,r){if(r===m)return e.createInlineStyle(t.contextItemContainer,"canvas-datagrid-context-menu-item:hover");e.createInlineStyle(t.contextItemContainer,"canvas-datagrid-context-menu-item")}))}}),y}function a(t){var r,n=document.createElement("div"),a=document.createElement("div"),s=document.createElement("button"),l=document.createElement("input"),c=t.cell&&t.cell.header?t.cell.header.title||t.cell.header.name:"";function d(){l.style.background=e.style.contextFilterInputBackground,l.style.color=e.style.contextFilterInputColor,e.invalidFilterRegEx&&(l.style.background=e.style.contextFilterInvalidRegExpBackground,l.style.color=e.style.contextFilterInvalidRegExpColor)}function u(n){if(!n||!["ArrowDown","ArrowUp","Enter","Tab"].includes(n.key)){var a,s,c,d=(a=0,s={},c=[],e.viewData.forEach((function(r){var o=null==r[t.cell.header.name]?r[t.cell.header.name]:String(r[t.cell.header.name]).trim(),n=e.blankValues.includes(o)?e.attributes.blanksText:o;s[n]||a>e.attributes.maxAutoCompleteItems||(a+=1,s[n]={title:e.formatters[t.cell.header.type||"string"]({cell:{value:n}}),click:function(t){l.value=n,t.stopPropagation(),l.dispatchEvent(new Event("keyup")),e.disposeAutocomplete()}})})),-1!==Object.keys(s).indexOf(e.attributes.blanksText)&&(c.push(s[e.attributes.blanksText]),delete s[e.attributes.blanksText]),c.concat(Object.keys(s).map((function(e){return s[e]}))));r=l.getBoundingClientRect(),o&&(o.dispose(),o=void 0),(o=i(t,{left:r.left,top:r.top,right:r.right,bottom:r.bottom,height:r.height,width:r.width},d,{inputDropdown:!0})).selectedIndex=0}}e.createInlineStyle(a,"canvas-datagrid-context-menu-label"),e.createInlineStyle(s,"canvas-datagrid-context-menu-filter-button"),e.createInlineStyle(l,"canvas-datagrid-context-menu-filter-input"),d(),l.onclick=e.disposeAutocomplete,l.addEventListener("keydown",(function(t){"ArrowDown"===t.key&&(o.selectedIndex+=1),"ArrowUp"===t.key&&(o.selectedIndex-=1),"Enter"===t.key&&(o.clickIndex(o.selectedIndex),e.disposeContextMenu()),"Tab"===t.key&&(o.clickIndex(o.selectedIndex),t.preventDefault()),"Escape"===t.key&&e.disposeContextMenu()})),l.addEventListener("keyup",(function(){e.setFilter(t.cell.header.name,l.value)})),l.addEventListener("keyup",u),["focus","blur","keydown","keyup","change"].forEach((function(e){l.addEventListener(e,d)})),l.value=t.cell.header&&e.columnFilters[t.cell.header.name]||"",a.innerHTML=e.attributes.filterOptionText.replace(/%s/g,c),s.onclick=function(){if(o)return e.disposeAutocomplete();u()},s.innerHTML=e.style.contextFilterButtonHTML,n.addEventListener("click",(function(e){return e.stopPropagation()})),n.appendChild(a),n.appendChild(l),n.appendChild(s),t.items.push({title:n}),Object.keys(e.columnFilters).length&&Object.keys(e.columnFilters).forEach((function(r){var o=e.getHeaderByName(r);t.items.push({title:e.attributes.removeFilterOptionText.replace(/%s/g,o.title||o.name),click:function(t){t.preventDefault(),e.setFilter(r,""),e.controlInput.focus()}})}))}e.disposeAutocomplete=function(){o&&(o.dispose(),o=void 0)},e.disposeContextMenu=function(){document.removeEventListener("click",e.disposeContextMenu),t=e.style.contextMenuZIndex,e.disposeAutocomplete(),e.contextMenu&&e.contextMenu.dispose(),e.contextMenu=void 0},e.contextmenuEvent=function(t,r){if(e.hasFocus||t.target===e.canvas){var o,s=[],l=r||e.getLayerPos(t),c={NativeEvent:t,cell:e.getCellAt(l.x,l.y),items:s};c.cell.isGrid||function(t){var r=!(t.cell.isBackground||t.cell.isColumnHeaderCellCap||t.cell.isScrollBar||t.cell.isCorner||t.cell.isRowHeader)&&t.cell.header;e.attributes.showFilter&&r&&a(t),e.attributes.showCopy&&e.selections.reduce((function(e,t){return e+t.length}),0)>0&&t.items.push({title:e.attributes.copyText,click:function(){document.execCommand("copy"),e.disposeContextMenu(),e.controlInput.focus()}}),e.attributes.showPaste&&e.clipBoardData&&t.items.push({title:e.attributes.pasteText,click:function(){e.paste(e.clipBoardData,t.cell.columnIndex,t.cell.rowIndex),e.draw()}}),e.attributes.showColumnSelector&&(t.items.push({title:e.attributes.columnSelectorText,items:function(){var t=[];return e.getSchema().forEach((function(r){function o(t){r.hidden=!r.hidden,e.dispatchEvent("togglecolumn",{column:r,hidden:r.hidden}),t.preventDefault(),e.stopPropagation(t),e.disposeContextMenu(),e.resize(!0),e.setStorageData()}var i=document.createElement("div");n(i),i.addEventListener("touchstart",o),i.addEventListener("click",o),i.innerHTML=(r.hidden?e.attributes.columnSelectorHiddenText:e.attributes.columnSelectorVisibleText)+(r.title||r.name),t.push({title:i})})),t}}),t.cell&&t.cell.header&&t.cell.columnIndex>-1&&t.items.push({title:e.attributes.hideColumnText.replace(/%s/gi,t.cell.header.title||t.cell.header.name),click:function(r){e.getSchema()[t.cell.columnIndex].hidden=!0,r.preventDefault(),e.stopPropagation(r),e.disposeContextMenu(),e.setStorageData(),setTimeout((function(){e.resize(!0)}),10)}})),e.attributes.saveAppearance&&e.attributes.showClearSettingsOption&&(Object.keys(e.sizes.rows).length>0||Object.keys(e.sizes.columns).length>0)&&t.items.push({title:e.attributes.clearSettingsOptionText,click:function(t){t.preventDefault(),e.sizes.rows={},e.sizes.columns={},e.createRowOrders(),e.createColumnOrders(),e.storedSettings=void 0,e.dispatchEvent("resizecolumn",{columnWidth:e.style.cellWidth}),e.dispatchEvent("resizerow",{cellHeight:e.style.cellHeight}),e.setStorageData(),e.resize(!0),e.disposeContextMenu(),e.controlInput.focus()}}),e.attributes.allowSorting&&e.attributes.showOrderByOption&&r&&(t.items.push({title:e.attributes.showOrderByOptionTextAsc.replace("%s",t.cell.header.title||t.cell.header.name),click:function(r){r.preventDefault(),e.order(t.cell.header.name,"asc"),e.controlInput.focus()}}),t.items.push({title:e.attributes.showOrderByOptionTextDesc.replace("%s",t.cell.header.title||t.cell.header.name),click:function(r){r.preventDefault(),e.order(t.cell.header.name,"desc"),e.disposeContextMenu(),e.controlInput.focus()}}))}(c),e.dispatchEvent("contextmenu",c)||c.cell.isGrid||(e.contextMenu&&e.disposeContextMenu(),o={left:l.x+l.rect.left+e.style.contextMenuMarginLeft+e.canvasOffsetLeft,top:l.y+l.rect.top+e.style.contextMenuMarginTop+e.canvasOffsetTop,right:c.cell.width+c.cell.x+l.rect.left,bottom:c.cell.height+c.cell.y+l.rect.top,height:c.cell.height,width:c.cell.width},e.mobile&&(o.left=e.style.mobileContextMenuMargin+"px",o.width=e.width-2*e.style.mobileContextMenuMargin+"px"),e.contextMenu=i(c,o,s),document.addEventListener("mouseup",(function t(){requestAnimationFrame((function(){document.addEventListener("click",e.disposeContextMenu),document.removeEventListener("mouseup",t)}))})),t.preventDefault())}}}function dom(e){e.getClippingRect=function(t){var r=e.position(e.parentNode),o=e.position(t),n=e.scrollOffset(e.canvas),i={x:0,y:0,h:0,w:0},a={x:-1/0,y:-1/0,h:1/0,w:1/0},s=e.getColumnHeaderCellHeight(),l=e.getRowHeaderCellWidth();return r.top-=n.top,r.left-=n.left,o.top-=n.top,o.left-=n.left,i.h=r.top+r.height-t.offsetTop-e.style.scrollBarWidth,i.w=r.left+r.width-t.offsetLeft-e.style.scrollBarWidth,i.x=r.left+-1*o.left+l,i.y=r.top+-1*o.top+s,{x:i.x>a.x?i.x:a.x,y:i.y>a.y?i.y:a.y,h:i.h<a.h?i.h:a.h,w:i.w<a.w?i.w:a.w}},e.clipElement=function(t){var r=e.getClippingRect(t);r.w<0&&(r.w=0),r.h<0&&(r.h=0),t.style.clip="rect("+r.y+"px,"+r.w+"px,"+r.h+"px,"+r.x+"px)"},e.scrollOffset=function(t){for(var r=0,o=0,n=document.scrollingElement||{scrollLeft:0,scrollTop:0};t.parentNode&&"CANVAS-DATAGRID"!==t.nodeName&&t!==e.intf;)"canvas-datagrid-tree"!==t.nodeType&&"canvas-datagrid-cell"!==t.nodeType&&(r-=t.scrollLeft,o-=t.scrollTop),t=t.parentNode;return{left:r-n.scrollLeft,top:o-n.scrollTop}},e.resizeEditInput=function(){if(e.input&&e.input.editCell){var t=e.canvas.getBoundingClientRect(),r=e.scrollOffset(e.intf),o="collapse"===e.style.gridBorderCollapse?1:2,n=e.style.cellBorderWidth*o,i=e.getVisibleCellByIndex(e.input.editCell.columnIndex,e.input.editCell.rowIndex)||{x:-100,y:-100,height:0,width:0};if(e.mobile)return e.input.style.left="0",e.input.style.top=e.height-e.style.mobileEditInputHeight-n-1+"px",e.input.style.height=e.style.mobileEditInputHeight+"px",void(e.input.style.width=e.width-n-1+"px");e.input.style.left=t.left+i.x+e.canvasOffsetLeft-r.left+"px",e.input.style.top=t.top+i.y-e.style.cellBorderWidth+e.canvasOffsetTop-r.top+"px",e.input.style.height=i.height-n+"px",e.input.style.width=i.width-e.style.cellPaddingLeft+"px",e.clipElement(e.input)}},e.position=function(t,r){for(var o,n,i=0,a=0,s=t;t.offsetParent&&"CANVAS-DATAGRID"!==t.nodeName;)i+=t.offsetLeft,a+=t.offsetTop,o=t.offsetHeight,n=t.offsetWidth,t=t.offsetParent;return r?{left:i,top:a,height:o,width:n}:(t=s,{left:i+(s=e.scrollOffset(t)).left,top:a+s.top,height:o,width:n})},e.getLayerPos=function(t){var r=e.canvas.getBoundingClientRect(),o={x:t.clientX-r.left,y:t.clientY-r.top};return e.isChildGrid&&(o.x-=e.canvasOffsetLeft,o.y-=e.canvasOffsetTop),{x:o.x,y:o.y,rect:r}},e.endEdit=function(t){var r=e.input.editCell,o=r.rowIndex;if(e.dispatchEvent("beforeendedit",{cell:r,newValue:e.input.value,oldValue:r.value,abort:function(){t=!0},input:e.input}))return!1;if(e.input.value!==r.value&&!t){if(e.changes[o]=e.changes[o]||{},e.changes[o][r.header.name]=e.input.value,r.data||(e.originalData[r.boundRowIndex]={},r.data=e.originalData[r.boundRowIndex]),r.data[r.header.name]=e.input.value,o===e.viewData.length){if(e.dispatchEvent("newrow",{value:e.input.value,defaultValue:r.value,aborted:t,cell:r,input:e.input}))return!1;e.addRow(r.data),e.createNewRowData()}e.draw(!0)}return e.input.parentNode&&e.input.parentNode.removeChild(e.input),e.intf.focus(),e.dispatchEvent("endedit",{cell:r,value:e.input.value,aborted:t,input:e.input}),e.input=void 0,!0},e.beginEditAt=function(t,r,o){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e.attributes.editable){e.input&&e.endEdit();var i,a,s,l,c,d=e.getVisibleCellByIndex(t,r);if(e.getSchema(),d&&d.header){if(s=d.header.enum,e.dispatchEvent("beforebeginedit",{cell:d,NativeEvent:o}))return!1;if(e.scrollIntoView(t,r),e.setActiveCell(t,r),i=e.getAdjacentCells(),e.input=s?document.createElement("select"):document.createElement(e.attributes.multiLine?"textarea":"input"),d=e.getVisibleCellByIndex(t,r)){s&&("function"==typeof s?a=s.apply(e.intf,[{cell:d}]):Array.isArray(s)&&(a=s),a.forEach((function(t){var r,o,n=document.createElement("option");Array.isArray(t)?(r=t[0],o=t[1]):(r=t,o=t),r===d.value&&(c=!0),n.value=r,n.innerHTML=o,e.input.appendChild(n)})),c||((l=document.createElement("option")).value=d.value,l.innerHTML=d.value,e.input.appendChild(l)),e.input.addEventListener("change",(function(){e.endEdit(),e.draw(!0)}))),e.dispatchEvent("appendeditinput",{cell:d,input:e.input})||document.body.appendChild(e.input),e.createInlineStyle(e.input,e.mobile?"canvas-datagrid-edit-mobile-input":"canvas-datagrid-edit-input"),e.input.style.position="absolute",e.input.editCell=d,e.resizeEditInput(),e.input.style.zIndex=e.style.editCellZIndex,e.input.style.fontSize=parseInt(e.style.editCellFontSize,10)*e.scale+"px";var u=-1!==[null,void 0].indexOf(d.value),p=u||n;e.input.value=p?"":d.value,e.input.focus(),e.input.addEventListener("click",e.stopPropagation),e.input.addEventListener("dblclick",e.stopPropagation),e.input.addEventListener("mouseup",e.stopPropagation),e.input.addEventListener("mousedown",e.stopPropagation),e.input.addEventListener("keydown",(function(r){var o=d.columnIndex,a=d.rowIndex;if("Escape"===r.key)e.endEdit(!0),e.draw(!0);else if("Enter"===r.key&&e.attributes.multiLine&&r.altKey)e.input.value=e.input.value+"\n",e.input.scrollTop=e.input.scrollHeight;else if("Enter"===r.key){e.endEdit();var s=r.shiftKey?Math.max(0,a-1):Math.min(a+1,e.viewData.length-1);s!==a&&(e.scrollIntoView(o,s),e.setActiveCell(o,s)),e.draw(!0)}else if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(r.key)&&n){switch(r.key){case"ArrowUp":a=Math.max(0,a-1);break;case"ArrowDown":a=Math.min(a+1,e.viewData.length-1);break;case"ArrowLeft":o=Math.max(o-1,0);break;case"ArrowRight":o=i.right}e.endEdit(),e.scrollIntoView(o,a),e.setActiveCell(o,a),e.draw(!0)}else if("Tab"===r.key){if(r.preventDefault(),!e.endEdit())return;o=r.shiftKey?i.left:i.right,i.left===t&&r.shiftKey&&(o=i.last,a-=1),i.right!==t||r.shiftKey||(o=i.first,a+=1),a<0&&(a=e.viewData.length-1),a>e.viewData.length-1&&(a=0),e.scrollIntoView(o,a),e.beginEditAt(o,a,r)}})),e.dispatchEvent("beginedit",{cell:d,input:e.input})}}}},e.createInlineStyle=function(t,r){var o={"canvas-datagrid-context-menu-filter-input":{height:"19px",verticalAlign:"bottom",marginLeft:"2px",padding:"0",background:e.style.contextFilterInputBackground,color:e.style.contextFilterInputColor,border:e.style.contextFilterInputBorder,borderRadius:e.style.contextFilterInputBorderRadius,lineHeight:"normal",fontWeight:"normal",fontFamily:e.style.contextFilterInputFontFamily,fontSize:e.style.contextFilterInputFontSize},"canvas-datagrid-context-menu-filter-button":{height:"19px",verticalAlign:"bottom",marginLeft:"2px",padding:"0",background:e.style.contextMenuBackground,color:e.style.contextMenuColor,border:e.style.contextFilterButtonBorder,borderRadius:e.style.contextFilterButtonBorderRadius,lineHeight:"normal",fontWeight:"normal",fontFamily:e.style.contextMenuFilterButtonFontFamily,fontSize:e.style.contextMenuFilterButtonFontSize},"canvas-datagrid-context-child-arrow":{cssFloat:"right",color:e.style.childContextMenuArrowColor,fontSize:e.style.contextMenuChildArrowFontSize,fontFamily:e.style.contextMenuFontFamily,verticalAlign:"middle"},"canvas-datagrid-autocomplete":{fontFamily:e.style.contextMenuFontFamily,fontSize:e.style.contextMenuFontSize,background:e.style.contextMenuBackground,color:e.style.contextMenuColor,border:e.style.contextMenuBorder,padding:e.style.contextMenuPadding,borderRadius:e.style.contextMenuBorderRadius,opacity:e.style.contextMenuOpacity,position:"absolute",zIndex:9999,overflow:"hidden"},"canvas-datagrid-autocomplete-item":{background:e.style.contextMenuBackground,color:e.style.contextMenuColor},"canvas-datagrid-autocomplete-item:hover":{background:e.style.contextMenuHoverBackground,color:e.style.contextMenuHoverColor},"canvas-datagrid-canvas":{position:"absolute",zIndex:"-1"},"canvas-datagrid":{display:"block"},"canvas-datagrid-control-input":{position:"fixed",top:"-5px",left:"-5px",border:"none",opacity:"0",cursor:"pointer",width:"1px",height:"1px",lineHeight:"normal",fontWeight:"normal",fontFamily:e.style.contextMenuFontFamily,fontSize:e.style.contextMenuFontSize},"canvas-datagrid-edit-mobile-input":{boxSizing:"content-box",outline:"none",margin:"0",padding:"0 0 0 0",lineHeight:"normal",fontWeight:"normal",fontFamily:e.style.mobileEditFontFamily,fontSize:e.style.mobileEditFontSize,border:e.style.editCellBorder,color:e.style.editCellColor,background:e.style.editCellBackgroundColor,appearance:"none",webkitAppearance:"none",mozAppearance:"none",borderRadius:"0"},"canvas-datagrid-edit-input":{boxSizing:"content-box",outline:"none",margin:"0",padding:"0 0 0 "+e.style.editCellPaddingLeft+"px",lineHeight:"normal",fontWeight:"normal",fontFamily:e.style.editCellFontFamily,fontSize:e.style.editCellFontSize,boxShadow:e.style.editCellBoxShadow,border:e.style.editCellBorder,color:e.style.editCellColor,background:e.style.editCellBackgroundColor,appearance:"none",webkitAppearance:"none",mozAppearance:"none",borderRadius:"0"},"canvas-datagrid-context-menu-item-mobile":{lineHeight:"normal",fontWeight:"normal",fontFamily:e.style.contextMenuFontFamily,fontSize:e.style.contextMenuFontSize,color:"inherit",background:"inherit",margin:e.style.contextMenuItemMargin,borderRadius:e.style.contextMenuItemBorderRadius,verticalAlign:"middle"},"canvas-datagrid-context-menu-item":{lineHeight:"normal",fontWeight:"normal",fontFamily:e.style.contextMenuFontFamily,fontSize:e.style.contextMenuFontSize,color:"inherit",background:"inherit",margin:e.style.contextMenuItemMargin,borderRadius:e.style.contextMenuItemBorderRadius,verticalAlign:"middle"},"canvas-datagrid-context-menu-item:hover":{background:e.style.contextMenuHoverBackground,color:e.style.contextMenuHoverColor},"canvas-datagrid-context-menu-label":{margin:e.style.contextMenuLabelMargin,display:e.style.contextMenuLabelDisplay,minWidth:e.style.contextMenuLabelMinWidth,maxWidth:e.style.contextMenuLabelMaxWidth},"canvas-datagrid-context-menu-mobile":{lineHeight:"normal",fontWeight:"normal",fontFamily:e.style.contextMenuFontFamily,fontSize:e.style.contextMenuFontSize,background:e.style.contextMenuBackground,color:e.style.contextMenuColor,border:e.style.contextMenuBorder,padding:e.style.contextMenuPadding,borderRadius:e.style.contextMenuBorderRadius,opacity:e.style.contextMenuOpacity,overflow:"hidden",whiteSpace:"nowrap"},"canvas-datagrid-context-menu":{lineHeight:"normal",fontWeight:"normal",fontFamily:e.style.contextMenuFontFamily,fontSize:e.style.contextMenuFontSize,background:e.style.contextMenuBackground,color:e.style.contextMenuColor,border:e.style.contextMenuBorder,padding:e.style.contextMenuPadding,borderRadius:e.style.contextMenuBorderRadius,opacity:e.style.contextMenuOpacity,overflow:"hidden",whiteSpace:"nowrap",cursor:e.style.contextMenuCursor},"canvas-datagrid-invalid-search-regExp":{background:e.style.contextMenuFilterInvalidExpresion}};o[r]&&Object.keys(o[r]).map((function(e){t.style[e]=o[r][e]}))},e.appendTo=function(t){e.parentNode=t,e.setDom()},e.setDom=function(){e.isChildGrid?(e.parentGrid=e.parentNode.parentGrid,e.ctx=e.parentGrid.context,e.canvas=e.parentGrid.canvas,e.controlInput=e.parentGrid.controlInput,e.eventParent=e.canvas):(e.controlInput=e.controlInput||document.createElement("input"),e.controlInput.onblur=e.intf.blur,e.createInlineStyle(e.controlInput,"canvas-datagrid-control-input"),e.isChildGrid=!1,e.parentDOMNode=e.parentNode,e.parentIsCanvas=/^canvas$/i.test(e.parentDOMNode.tagName),e.parentIsCanvas?e.canvas=e.parentDOMNode:(e.canvas=document.createElement("canvas"),e.parentDOMNode.appendChild(e.canvas)),document.body.appendChild(e.controlInput),e.createInlineStyle(e.canvas,"canvas-datagrid"),e.ctx=e.canvas.getContext("2d"),e.ctx.textBaseline="alphabetic",e.eventParent=e.canvas),e.parentNodeStyle=e.canvas.style,e.controlInput.setAttribute("readonly",!0),e.controlInput.addEventListener("blur",(function(t){t.target!==e.canvas&&(e.hasFocus=!1)})),e.eventParent.addEventListener("scroll",e.resize,!1),e.eventParent.addEventListener("touchstart",e.touchstart,!1),e.eventParent.addEventListener("mouseup",e.mouseup,!1),e.eventParent.addEventListener("mousedown",e.mousedown,!1),e.eventParent.addEventListener("dblclick",e.dblclick,!1),e.eventParent.addEventListener("click",e.click,!1),e.eventParent.addEventListener("mousemove",e.mousemove),e[e.isChildGrid?"parentGrid":"eventParent"].addEventListener("wheel",e.scrollWheel,!1),e.canvas.addEventListener("contextmenu",e.contextmenuEvent,!1),e.controlInput.addEventListener("copy",e.copy),e.controlInput.addEventListener("cut",e.cut),e.controlInput.addEventListener("paste",e.paste),e.controlInput.addEventListener("keypress",e.keypress,!1),e.controlInput.addEventListener("keyup",e.keyup,!1),e.controlInput.addEventListener("keydown",e.keydown,!1),window.addEventListener("resize",e.resize)}}function publicMethods(e){e.integerToAlpha=function(e){for(var t="a".charCodeAt(0),r="z".charCodeAt(0)-t+1,o="";e>=0;)o=String.fromCharCode(e%r+t)+o,e=Math.floor(e/r)-1;return o},e.insertColumn=function(t,r){var o=e.getSchema();if(o.length<r)throw new Error("Index is beyond the length of the schema.");e.validateColumn(t,o),o.splice(r,0,t),e.originalData.forEach((function(r,o){e.applyDefaultValue(r,t,o)})),e.intf.schema=o,e.refresh()},e.deleteColumn=function(t){var r=e.getSchema();e.originalData.forEach((function(e){delete e[r[t].name]})),r.splice(t,1),e.intf.schema=r,e.refresh()},e.addColumn=function(t){var r=e.getSchema();e.validateColumn(t,r),r.push(t),e.originalData.forEach((function(r,o){e.applyDefaultValue(r,t,o)})),e.intf.schema=r,e.refresh()},e.deleteRow=function(t){e.originalData.splice(t,1),e.setFilter(),e.resize(!0)},e.insertRow=function(t,r){if(e.originalData.length<r)throw new Error("Index is beyond the length of the dataset.");e.originalData.splice(r,0,t),e.getSchema().forEach((function(o){void 0===t[o.name]&&e.applyDefaultValue(e.originalData[r],o,r)})),e.setFilter(),e.resize(!0)},e.addRow=function(t){e.originalData.push(t),e.getSchema().forEach((function(r){void 0===t[r.name]&&e.applyDefaultValue(e.originalData[e.originalData.length-1],r,e.originalData.length-1)})),e.setFilter(),e.resize(!0)},e.setRowHeight=function(t,r){e.sizes.rows[t]=r,e.draw(!0)},e.setColumnWidth=function(t,r){e.sizes.columns[t]=r,e.draw(!0)},e.resetColumnWidths=function(){e.sizes.columns={},e.draw(!0)},e.resetRowHeights=function(){e.sizes.rows={},e.draw(!0)},e.setFilter=function(t,r){void 0===t&&void 0===r?e.columnFilters={}:!t||""!==r&&void 0!==r?e.columnFilters[t]=r:delete e.columnFilters[t],e.refresh()},e.findRowScrollTop=function(t){if(void 0===e.scrollCache.y[t])throw new RangeError("Row index ".concat(t," out of range: ").concat(e.scrollCache.y.length,"."));return e.scrollCache.y[t]},e.findColumnScrollLeft=function(t){var r=Math.max(t-1,0);if(void 0===e.scrollCache.x[r])throw new Error("Column index out of range.");return e.scrollCache.x[r]-e.getColumnWidth(e.orders.columns[t])},e.gotoCell=function(t,r,o,n){var i,a=void 0===t?void 0:e.findColumnScrollLeft(t),s=void 0===r?void 0:e.findRowScrollTop(r),l=e.scrollBox.width-(e.scrollBox.verticalBarVisible?e.style.scrollBarWidth:0),c=e.scrollBox.height-(e.scrollBox.horizontalBarVisible?e.style.scrollBarWidth:0);a-=l*(o=void 0===o?0:o),s-=c*(n=void 0===n?0:n),void 0!==t&&void 0!==r?(e.scrollBox.scrollTo(a,s),requestAnimationFrame((function(){(i=e.getVisibleCellByIndex(t,r))&&(a+=i.width*o,s+=i.height*n,e.scrollBox.scrollTo(a,s))}))):void 0!==t?e.scrollBox.scrollLeft=a:void 0!==r&&(e.scrollBox.scrollTop=s)},e.gotoRow=function(t){e.gotoCell(0,t)},e.scrollIntoView=function(t,r,o,n){0===e.visibleCells.filter((function(o){return(o.rowIndex===r||void 0===r)&&(o.columnIndex===t||void 0===t)&&o.x>0&&o.y>0&&o.x+o.width<e.width&&o.y+o.height<e.height})).length&&e.gotoCell(t,r,o,n)},e.setActiveCell=function(t,r){t<0&&(t=0),r<0&&(r=0),e.activeCell={rowIndex:r,columnIndex:t}},e.selectNone=function(t){e.selections=[],e.dispatchEvent("selectionchanged",{selectedData:e.getSelectedData(),selections:e.selections,selectionBounds:e.selectionBounds}),t||e.draw()},e.selectAll=function(t){e.selectArea({top:0,left:-1,right:e.getSchema().length-1,bottom:e.viewData.length-1}),t||e.draw()},e.isColumnSelected=function(t){var r=!0;return e.viewData.forEach((function(o,n){e.selections[n]&&-1!==e.selections[n].indexOf(e.orders.columns[t])||(r=!1)})),r},e.forEachSelectedCell=function(t,r){var o=[],n=r?e.getSchema():e.getVisibleSchema(),i=e.viewData.length;e.selections.forEach((function(r,a){a!==i&&(0!==r.length?(o[a]={},r.forEach((function(r){-1!==r&&n[r]&&t(e.viewData,a,n[r].name)}))):o[a]=null)}))},e.selectColumn=function(t,r,o,n){var i,a,s,l;function c(t){e.viewData.forEach((function(r,o){e.selections[o]=e.selections[o]||[],-1===e.selections[o].indexOf(t)&&e.selections[o].push(t)}))}if(o){if(!e.activeCell)return;for(i=Math.min(e.activeCell.columnIndex,t),a=Math.max(e.activeCell.columnIndex,t),s=i;a>s;s+=1)c(s)}r||o||(e.selections=[],e.activeCell.columnIndex=t,e.activeCell.rowIndex=e.scrollIndexTop),r&&e.isColumnSelected(t)?(l=t,e.viewData.forEach((function(t,r){e.selections[r]=e.selections[r]||[],-1!==e.selections[r].indexOf(l)&&e.selections[r].splice(e.selections[r].indexOf(l),1)}))):c(t),n||e.dispatchEvent("selectionchanged",{selectedData:e.getSelectedData(),selections:e.selections,selectionBounds:e.getSelectionBounds()})},e.selectRow=function(t,r,o,n){var i,a,s,l=e.getVisibleSchema();function c(){n||e.dispatchEvent("selectionchanged",{selectedData:e.getSelectedData(),selections:e.selections,selectionBounds:e.selectionBounds})}function d(t){e.selections[t]=[],e.selections[t].push(-1),l.forEach((function(r,o){e.selections[t].push(e.orders.columns.indexOf(r.index))}))}if((!1===e.dragAddToSelection||void 0===e.dragObject)&&e.selections[t]&&e.selections[t].length-1===l.length&&r)return e.selections[t]=[],void c();if(!0===e.dragAddToSelection||void 0===e.dragObject)if(o&&void 0===e.dragObject){if(!e.activeCell)return;for(a=Math.min(e.activeCell.rowIndex,t),s=Math.max(e.activeCell.rowIndex,t),i=a;s>=i;i+=1)d(i)}else d(t);c()},e.collapseTree=function(t){e.dispatchEvent("collapsetree",{childGrid:e.childGrids[t],data:e.viewData[t],rowIndex:t}),e.openChildren[t].blur(),e.openChildren[t].dispose(),delete e.openChildren[t],delete e.sizes.trees[t],delete e.childGrids[t],e.dispatchEvent("resizerow",{cellHeight:e.style.cellHeight}),e.resize(!0),e.draw(!0)},e.expandTree=function(t){var r,o=e.args.treeGridAttributes||{},n=e.getColumnHeaderCellHeight(),i=e.sizes.columns.cornerCell||e.style.rowHeaderCellWidth,a=e.sizes.trees[t]||e.style.treeGridHeight;e.childGrids[t]||(o.debug=e.attributes.debug,o.name=e.attributes.saveAppearance?e.attributes.name+"tree"+t:void 0,o.style=o.style||e.style,o.parentNode={parentGrid:e.intf,nodeType:"canvas-datagrid-tree",offsetHeight:a,offsetWidth:e.width-i,header:{width:e.width-i},offsetLeft:i,offsetTop:n,offsetParent:e.intf.parentNode,parentNode:e.intf.parentNode,style:"tree",data:e.viewData[t]},r=e.createGrid(o),e.childGrids[t]=r),(r=e.childGrids[t]).visible=!0,e.dispatchEvent("expandtree",{treeGrid:r,data:e.viewData[t],rowIndex:t}),e.openChildren[t]=r,e.sizes.trees[t]=a,e.dispatchEvent("resizerow",{height:e.style.cellHeight}),e.resize(!0)},e.toggleTree=function(t){if(e.openChildren[t])return e.collapseTree(t);e.expandTree(t)},e.getHeaderByName=function(t){var r,o=e.getSchema();for(r=0;r<o.length;r+=1)if(o[r].name===t)return o[r]},e.fitColumnToValues=function(t,r){e.canvas&&(e.sizes.columns["cornerCell"===t?-1:e.getHeaderByName(t).index]=Math.max(e.findColumnMaxTextLength(t),e.style.minColumnWidth),r||(e.resize(),e.draw(!0)))},e.isCellVisible=function(t,r){if(void 0!==r)return e.visibleCells.filter((function(e){return e.columnIndex===t&&e.rowIndex===r})).length>0;var o,n=e.visibleCells.length;for(o=0;o<n;o+=1)if(t.x===e.visibleCells[o].x&&t.y===e.visibleCells[o].y)return!0;return!1},e.order=function(t,r,o,n){var i,a=e.getSchema().filter((function(e){return e.name===t}));if(!e.dispatchEvent("beforesortcolumn",{name:t,direction:r})&&(e.orderBy=t,e.orderDirection=r,e.viewData&&0!==e.viewData.length)){if(0===a.length)throw new Error("Cannot sort.  No such column name");(i=o||a[0].sorter||e.sorters[a[0].type])||void 0===a[0].type||console.warn('Cannot sort type "%s" falling back to string sort.',a[0].type),e.orderings.add(t,r,"function"==typeof i?i:e.sorters.string),e.refresh(),e.dispatchEvent("sortcolumn",{name:t,direction:r}),n||e.setStorageData()}},e.isInGrid=function(t){return!(t.x<0||t.x>e.width||t.y<0||t.y>e.height)},e.moveSelection=function(t,r){var o=[];e.selections.forEach((function(e,n){o[n+r]=[],e.forEach((function(e){o[n+r].push(e+t)}))})),e.selections=o},e.moveTo=function(t,r,o){var n,i=e.getSelectedData(),a=e.getVisibleSchema(),s=t.length,l=-1/0,c=1/0,d=o-1;t.forEach((function(t,o){o!==s&&0!==t.length&&(c=Math.min(e.getVisibleColumnIndexOf(r),c),l=Math.max(l,t.length),t.forEach((function(t){t=e.getVisibleColumnIndexOf(t),a[t]&&(e.data[o]||(e.data[o]={}),e.data[o][a[t].name]=null)})))})),t.forEach((function(t,o){var s;d+=1,n=e.getVisibleColumnIndexOf(r),t.forEach((function(t,r){t=e.getVisibleColumnIndexOf(t),r>0&&(n+=t-s),s=t,-1===t||!a[n]||!a[t]||e.data.length-1<d||d<0||(e.data[d]||(e.data[d]={}),e.data[d][a[n].name]=i[o][a[t].name])}))}))},e.isColumnVisible=function(t){return e.visibleCells.filter((function(e){return e.columnIndex===t})).length>0},e.isRowVisible=function(t){return e.visibleCells.filter((function(e){return e.rowIndex===t})).length>0},e.getVisibleCellByIndex=function(t,r){return e.visibleCells.filter((function(e){return e.columnIndex===t&&e.rowIndex===r}))[0]},e.getCellAt=function(t,r,o){function n(o){return o.x+o.width-.4*e.attributes.borderResizeZone<t&&o.x+o.width+.6*e.attributes.borderResizeZone>t?"r":o.x-.4*e.attributes.borderResizeZone<t&&o.x+.6*e.attributes.borderResizeZone>t?"l":o.y+o.height-.4*e.attributes.borderResizeZone<r&&o.y+o.height+.6*e.attributes.borderResizeZone>r?"b":o.y-.4*e.attributes.borderResizeZone<r&&o.y+.6*e.attributes.borderResizeZone>r?"t":void 0}if(e.visibleCells){var i,a,s,l,c,d=o?e.attributes.touchScrollZone:0,u="move"===e.attributes.borderDragBehavior,p=e.visibleCells.length,h=u?e.cursorGrab:"ew-resize",f=u?e.cursorGrab:"ns-resize";if(e.visibleCells&&e.visibleCells.length){if(e.hasFocus=!0,!(r<e.height&&r>0&&t<e.width&&t>0))return e.hasFocus=!1,{dragContext:"inherit",context:"inherit"};for(a=0;a<p;a+=1)if(c={x:(l=e.visibleCells[a]).x,y:l.y,height:l.height,width:l.width},o&&/(vertical|horizontal)-scroll-/.test(l.style)&&(c.x-=d,c.y-=d,c.height+=d,c.width+=d),c.x-e.style.cellBorderWidth<t&&c.x+c.width+e.style.cellBorderWidth>t&&c.y-e.style.cellBorderWidth<r&&c.y+c.height+e.style.cellBorderWidth>r){if(/frozen-row-marker/.test(l.style))return l.dragContext=l.style,l.context="row-resize",l;if(/frozen-column-marker/.test(l.style))return l.dragContext=l.style,l.context="col-resize",l;if(/selection-handle-/.test(l.style))return l.dragContext=l.style,l.context="crosshair",l;if(/vertical-scroll-(bar|box)/.test(l.style))return l.dragContext="vertical-scroll-box",l.context="vertical-scroll-box",l.isScrollBar=!0,l.isVerticalScrollBar=!0,r>e.scrollBox.box.v.y+e.scrollBox.scrollBoxHeight?(l.dragContext="vertical-scroll-bottom",l.context="vertical-scroll-bottom"):r<e.scrollBox.box.v.y&&(l.dragContext="vertical-scroll-top",l.context="vertical-scroll-top"),e.cursor="default",l;if(/horizontal-scroll-(bar|box)/.test(l.style))return l.dragContext="horizontal-scroll-box",l.context="horizontal-scroll-box",l.isScrollBar=!0,l.isHorizontalScrollBar=!0,t>e.scrollBox.box.h.x+e.scrollBox.scrollBoxWidth?(l.dragContext="horizontal-scroll-right",l.context="horizontal-scroll-right"):t<e.scrollBox.box.h.x&&(l.dragContext="horizontal-scroll-left",l.context="horizontal-scroll-left"),e.cursor="default",l;if(i=n(c),s=u&&l.selectionBorder&&-1!==l.selectionBorder.indexOf(i),-1!==["l","r"].indexOf(i)&&(e.attributes.allowColumnResize||s)&&(e.attributes.allowColumnResizeFromCell&&l.isNormal||!l.isNormal||s)&&(e.attributes.allowRowHeaderResize&&(l.isRowHeader||l.isCorner)||!l.isRowHeader||!l.isCorner)){if((l.isColumnHeader||l.isCorner||e.attributes.allowColumnResizeFromCell&&l.isNormal)&&"r"===i)return l.context="ew-resize",l.dragContext="ew-resize",l;if(!l.isColumnHeader&&!l.isCorner&&s)return l.context=h,l.dragContext=i+"-move",l}if(-1!==["t","b"].indexOf(i)&&l.rowIndex>-1&&(e.attributes.allowRowResize||s)&&(e.attributes.allowRowResizeFromCell&&l.isNormal||!l.isNormal||s)&&!l.isColumnHeader){if((l.isRowHeader||l.isCorner||e.attributes.allowRowResizeFromCell&&l.isNormal)&&"b"===i)return l.context="ns-resize",l.dragContext="ns-resize",l;if(!l.isRowHeader&&!l.isCorner&&s)return l.context=f,l.dragContext=i+"-move",l}return"columnHeaderCell"===l.style?(l.context="cell",l.dragContext="column-reorder",l):"rowHeaderCell"===l.style?(e.attributes.rowGrabZoneSize+(l.y-e.style.cellBorderWidth)<r||!e.attributes.allowRowReordering?(l.dragContext="cell",l.context="cell"):(l.context=e.cursorGrab,l.dragContext="row-reorder"),l):l.isGrid?(e.hasFocus=!1,l.dragContext="cell-grid",l.context="cell-grid",l):"tree-grid"===l.style?(e.hasFocus=!1,l.dragContext="tree",l.context="tree",l):(l.dragContext="cell",l.context="cell",l)}return e.hasFocus=!0,e.cursor="default",{dragContext:"background",context:"background",style:"background",isBackground:!0}}}},e.getSelectionBounds=function(){var t={x:1/0,y:1/0},r={x:-1/0,y:-1/0};return e.selections.forEach((function(e,o){var n,i;t.y=o<t.y?o:t.y,r.y=o>r.y?o:r.y,n=Math.max.apply(null,e),i=Math.min.apply(null,e),t.x=i<t.x?i:t.x,r.x=n>r.x?n:r.x})),{top:t.y,left:t.x,bottom:r.y,right:r.x}},e.getSchemaFromData=function(t){return t=t||e.originalData,Object.keys(t[0]||{" ":""}).map((function(r,o){var n=e.getBestGuessDataType(r,t),i={name:r,title:isNaN(parseInt(r,10))?r:e.integerToAlpha(r).toUpperCase(),index:o,columnIndex:o,type:n,filter:e.filter(n)};return e.storedSettings&&e.storedSettings.visibility&&void 0!==e.storedSettings.visibility[i.name]&&(i.hidden=!e.storedSettings.visibility[i.name]),i}))},e.clearChangeLog=function(){e.changes=[]},e.selectArea=function(t,r){e.selectionBounds=t||e.selectionBounds;var o,n,i,a=e.getSchema();if(r||(e.selections=[]),e.selectionBounds.top<-1||e.selectionBounds.bottom>e.viewData.length||e.selectionBounds.left<-1||e.selectionBounds.right>a.length)throw new Error("Impossible selection area");for(n=e.selectionBounds.top;n<=e.selectionBounds.bottom;n+=1)for(e.selections[n]=[],i=e.selectionBounds.left;i<=e.selectionBounds.right;i+=1)-1===e.selections[n].indexOf(i)&&e.selections[n].push(i);o={selections:e.selections,selectionBounds:e.selectionBounds},Object.defineProperty(o,"selectedData",{get:function(){return e.getSelectedData()}}),e.dispatchEvent("selectionchanged",o)},e.findColumnMaxTextLength=function(t){var r=-1/0;if("cornerCell"===t)return e.ctx.font=e.style.rowHeaderCellFont,e.ctx.measureText((e.viewData.length+(e.attributes.showNewRow?1:0)).toString()).width+e.style.autosizePadding+e.style.autosizeHeaderCellPadding+e.style.rowHeaderCellPaddingRight+e.style.rowHeaderCellPaddingLeft+(e.attributes.tree?e.style.treeArrowWidth+e.style.treeArrowMarginLeft+e.style.treeArrowMarginRight:0);var o=null;return e.getSchema().forEach((function(n){if(n.name===t){e.ctx.font=e.style.columnHeaderCellFont;var i=e.ctx.measureText(n.title||n.name).width+e.style.headerCellPaddingRight+e.style.headerCellPaddingLeft;r=i>r?i:r,o=e.formatters[n.type]}})),e.viewData.forEach((function(n){var i=n[t];o&&(i=o({cell:{value:i}})),e.ctx.font=e.style.cellFont;var a=e.ctx.measureText(i).width+e.style.cellPaddingRight+e.style.cellPaddingLeft+e.style.cellAutoResizePadding;r=a>r?a:r})),r},e.getHeaderWidth=function(){return e.getVisibleSchema().reduce((function(t,r){return t+parseInt(r.width||e.style.cellWidth,10)}),0)},e.getRowHeight=function(t){return(e.sizes.rows[t]||e.style.cellHeight)*e.scale},e.getColumnWidth=function(t){return(e.sizes.columns[t]||e.getSchema()[t].width||e.style.cellWidth)*e.scale},e.formatters.string=function(e){return void 0!==e.cell.value?e.cell.value:""},e.formatters.rowHeaderCell=e.formatters.string,e.formatters.headerCell=e.formatters.string,e.formatters.number=e.formatters.string,e.formatters.int=e.formatters.string,e.formatters.html=e.formatters.string,e.sorters.string=function(e,t){var r="asc"===t;return function(t,o){return void 0===t[e]||null===t[e]?1:void 0===o[e]||null===o[e]?0:r?t[e].localeCompare?t[e].localeCompare(o[e]):1:o[e].localeCompare?o[e].localeCompare(t[e]):1}},e.sorters.number=function(e,t){var r="asc"===t;return function(t,o){return r?t[e]-o[e]:o[e]-t[e]}},e.sorters.date=function(e,t){var r="asc"===t;return function(t,o){return r?new Date(t[e]).getTime()-new Date(o[e]).getTime():new Date(o[e]).getTime()-new Date(t[e]).getTime()}}}var webComponent=component(),modules=[defaults,draw,events,touch,intf,contextMenu,dom,publicMethods];function Grid(args){args=args||{};var self={};return self.isComponent=void 0===args.component,self.isChildGrid=args.parentNode&&/canvas-datagrid-(cell|tree)/.test(args.parentNode.nodeType),self.isChildGrid?self.intf={}:self.intf=self.isComponent?eval("Reflect.construct(HTMLElement, [], new.target)"):document.createElement("canvas"),self.args=args,self.intf.args=args,self.applyComponentStyle=webComponent.applyComponentStyle,self.hyphenateProperty=webComponent.hyphenateProperty,self.dehyphenateProperty=webComponent.dehyphenateProperty,self.createGrid=function(e){return e.component=!1,new Grid(e)},modules.forEach((function(e){e(self)})),self.isChildGrid?(self.shadowRoot=args.parentNode.shadowRoot,self.parentNode=args.parentNode):(self.shadowRoot=self.intf.attachShadow({mode:"open"}),self.parentNode=self.shadowRoot),self.init(),self.intf}window.HTMLElement&&(Grid.prototype=Object.create(window.HTMLElement.prototype)),window.customElements&&(Grid.observedAttributes=webComponent.getObservableAttributes(),Grid.prototype.disconnectedCallback=webComponent.disconnectedCallback,Grid.prototype.attributeChangedCallback=webComponent.attributeChangedCallback,Grid.prototype.connectedCallback=webComponent.connectedCallback,Grid.prototype.adoptedCallback=webComponent.adoptedCallback,window.customElements.define("canvas-datagrid",Grid)),window&&!window.canvasDatagrid&&window.require;var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),Symbol$1=root.Symbol,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty.call(e,symToStringTag),r=e[symToStringTag];try{e[symToStringTag]=void 0;var o=!0}catch(e){}var n=nativeObjectToString.call(e);return o&&(t?e[symToStringTag]=r:delete e[symToStringTag]),n}var objectProto$1=Object.prototype,nativeObjectToString$1=objectProto$1.toString;function objectToString(e){return nativeObjectToString$1.call(e)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?undefinedTag:nullTag:symToStringTag$1&&symToStringTag$1 in Object(e)?getRawTag(e):objectToString(e)}function isObjectLike(e){return null!=e&&"object"==typeof e}var symbolTag="[object Symbol]";function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&baseGetTag(e)==symbolTag}function arrayMap(e,t){for(var r=-1,o=null==e?0:e.length,n=Array(o);++r<o;)n[r]=t(e[r],r,e);return n}var isArray=Array.isArray,INFINITY=1/0,symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;function baseToString(e){if("string"==typeof e)return e;if(isArray(e))return arrayMap(e,baseToString)+"";if(isSymbol(e))return symbolToString?symbolToString.call(e):"";var t=e+"";return"0"==t&&1/e==-INFINITY?"-0":t}function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var NAN=NaN,reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN;if(isObject(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(reTrim,"");var r=reIsBinary.test(e);return r||reIsOctal.test(e)?freeParseInt(e.slice(2),r?2:8):reIsBadHex.test(e)?NAN:+e}var INFINITY$1=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(e){return e?(e=toNumber(e))===INFINITY$1||e===-INFINITY$1?(e<0?-1:1)*MAX_INTEGER:e==e?e:0:0===e?e:0}function toInteger(e){var t=toFinite(e),r=t%1;return t==t?r?t-r:t:0}function identity(e){return e}var asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(e){if(!isObject(e))return!1;var t=baseGetTag(e);return t==funcTag||t==genTag||t==asyncTag||t==proxyTag}var coreJsData=root["__core-js_shared__"],maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""),uid?"Symbol(src)_1."+uid:""),uid;function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var funcProto=Function.prototype,funcToString=funcProto.toString;function toSource(e){if(null!=e){try{return funcToString.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$2=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$1=objectProto$2.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$1).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!isObject(e)||isMasked(e))&&(isFunction(e)?reIsNative:reIsHostCtor).test(toSource(e))}function getValue(e,t){return null==e?void 0:e[t]}function getNative(e,t){var r=getValue(e,t);return baseIsNative(r)?r:void 0}var WeakMap$1=getNative(root,"WeakMap");function apply(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function noop(){}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(e){var t=0,r=0;return function(){var o=nativeNow(),n=HOT_SPAN-(o-r);if(r=o,n>0){if(++t>=HOT_COUNT)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function constant(e){return function(){return e}}var defineProperty=function(){try{var e=getNative(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),baseSetToString=defineProperty?function(e,t){return defineProperty(e,"toString",{configurable:!0,enumerable:!1,value:constant(t),writable:!0})}:identity,setToString=shortOut(baseSetToString);function baseFindIndex(e,t,r,o){for(var n=e.length,i=r+(o?1:-1);o?i--:++i<n;)if(t(e[i],i,e))return i;return-1}function baseIsNaN(e){return e!=e}function strictIndexOf(e,t,r){for(var o=r-1,n=e.length;++o<n;)if(e[o]===t)return o;return-1}function baseIndexOf(e,t,r){return t==t?strictIndexOf(e,t,r):baseFindIndex(e,baseIsNaN,r)}function arrayIncludes(e,t){return!!(null==e?0:e.length)&&baseIndexOf(e,t,0)>-1}var MAX_SAFE_INTEGER=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var r=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER:t)&&("number"==r||"symbol"!=r&&reIsUint.test(e))&&e>-1&&e%1==0&&e<t}function eq(e,t){return e===t||e!=e&&t!=t}var nativeMax=Math.max;function overRest(e,t,r){return t=nativeMax(void 0===t?e.length-1:t,0),function(){for(var o=arguments,n=-1,i=nativeMax(o.length-t,0),a=Array(i);++n<i;)a[n]=o[t+n];n=-1;for(var s=Array(t+1);++n<t;)s[n]=o[n];return s[t]=r(a),apply(e,this,s)}}function baseRest(e,t){return setToString(overRest(e,t,identity),e+"")}var MAX_SAFE_INTEGER$1=9007199254740991;function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER$1}function isArrayLike(e){return null!=e&&isLength(e.length)&&!isFunction(e)}function isIterateeCall(e,t,r){if(!isObject(r))return!1;var o=typeof t;return!!("number"==o?isArrayLike(r)&&isIndex(t,r.length):"string"==o&&t in r)&&eq(r[t],e)}var objectProto$3=Object.prototype;function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$3)}function baseTimes(e,t){for(var r=-1,o=Array(e);++r<e;)o[r]=t(r);return o}var argsTag="[object Arguments]";function baseIsArguments(e){return isObjectLike(e)&&baseGetTag(e)==argsTag}var objectProto$4=Object.prototype,hasOwnProperty$2=objectProto$4.hasOwnProperty,propertyIsEnumerable=objectProto$4.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike(e)&&hasOwnProperty$2.call(e,"callee")&&!propertyIsEnumerable.call(e,"callee")};function stubFalse(){return!1}var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root.Buffer:void 0,nativeIsBuffer=Buffer?Buffer.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse,argsTag$1="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag$1="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!typedArrayTags[baseGetTag(e)]}function baseUnary(e){return function(t){return e(t)}}typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var freeExports$1="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal.process,nodeUtil=function(){try{var e=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return e||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,objectProto$5=Object.prototype,hasOwnProperty$3=objectProto$5.hasOwnProperty;function arrayLikeKeys(e,t){var r=isArray(e),o=!r&&isArguments(e),n=!r&&!o&&isBuffer(e),i=!r&&!o&&!n&&isTypedArray(e),a=r||o||n||i,s=a?baseTimes(e.length,String):[],l=s.length;for(var c in e)!t&&!hasOwnProperty$3.call(e,c)||a&&("length"==c||n&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||isIndex(c,l))||s.push(c);return s}function overArg(e,t){return function(r){return e(t(r))}}var nativeKeys=overArg(Object.keys,Object),objectProto$6=Object.prototype,hasOwnProperty$4=objectProto$6.hasOwnProperty;function baseKeys(e){if(!isPrototype(e))return nativeKeys(e);var t=[];for(var r in Object(e))hasOwnProperty$4.call(e,r)&&"constructor"!=r&&t.push(r);return t}function keys(e){return isArrayLike(e)?arrayLikeKeys(e):baseKeys(e)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,t){if(isArray(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!isSymbol(e))||(reIsPlainProp.test(e)||!reIsDeepProp.test(e)||null!=t&&e in Object(t))}var nativeCreate=getNative(Object,"create");function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var HASH_UNDEFINED="__lodash_hash_undefined__",objectProto$7=Object.prototype,hasOwnProperty$5=objectProto$7.hasOwnProperty;function hashGet(e){var t=this.__data__;if(nativeCreate){var r=t[e];return r===HASH_UNDEFINED?void 0:r}return hasOwnProperty$5.call(t,e)?t[e]:void 0}var objectProto$8=Object.prototype,hasOwnProperty$6=objectProto$8.hasOwnProperty;function hashHas(e){var t=this.__data__;return nativeCreate?void 0!==t[e]:hasOwnProperty$6.call(t,e)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=nativeCreate&&void 0===t?HASH_UNDEFINED$1:t,this}function Hash(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var o=e[t];this.set(o[0],o[1])}}function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(e,t){for(var r=e.length;r--;)if(eq(e[r][0],t))return r;return-1}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet;var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,r=assocIndexOf(t,e);return!(r<0)&&(r==t.length-1?t.pop():splice.call(t,r,1),--this.size,!0)}function listCacheGet(e){var t=this.__data__,r=assocIndexOf(t,e);return r<0?void 0:t[r][1]}function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1}function listCacheSet(e,t){var r=this.__data__,o=assocIndexOf(r,e);return o<0?(++this.size,r.push([e,t])):r[o][1]=t,this}function ListCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var o=e[t];this.set(o[0],o[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet;var Map$1=getNative(root,"Map");function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$1||ListCache),string:new Hash}}function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function getMapData(e,t){var r=e.__data__;return isKeyable(t)?r["string"==typeof t?"string":"hash"]:r.map}function mapCacheDelete(e){var t=getMapData(this,e).delete(e);return this.size-=t?1:0,t}function mapCacheGet(e){return getMapData(this,e).get(e)}function mapCacheHas(e){return getMapData(this,e).has(e)}function mapCacheSet(e,t){var r=getMapData(this,e),o=r.size;return r.set(e,t),this.size+=r.size==o?0:1,this}function MapCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var o=e[t];this.set(o[0],o[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT="Expected a function";function memoize(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT);var r=function(){var o=arguments,n=t?t.apply(this,o):o[0],i=r.cache;if(i.has(n))return i.get(n);var a=e.apply(this,o);return r.cache=i.set(n,a)||i,a};return r.cache=new(memoize.Cache||MapCache),r}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var t=memoize(e,(function(e){return r.size===MAX_MEMOIZE_SIZE&&r.clear(),e})),r=t.cache;return t}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(rePropName,(function(e,r,o,n){t.push(o?n.replace(reEscapeChar,"$1"):r||e)})),t}));function toString(e){return null==e?"":baseToString(e)}function castPath(e,t){return isArray(e)?e:isKey(e,t)?[e]:stringToPath(toString(e))}var INFINITY$2=1/0;function toKey(e){if("string"==typeof e||isSymbol(e))return e;var t=e+"";return"0"==t&&1/e==-INFINITY$2?"-0":t}function baseGet(e,t){for(var r=0,o=(t=castPath(t,e)).length;null!=e&&r<o;)e=e[toKey(t[r++])];return r&&r==o?e:void 0}function get(e,t,r){var o=null==e?void 0:baseGet(e,t);return void 0===o?r:o}function arrayPush(e,t){for(var r=-1,o=t.length,n=e.length;++r<o;)e[n+r]=t[r];return e}var spreadableSymbol=Symbol$1?Symbol$1.isConcatSpreadable:void 0;function isFlattenable(e){return isArray(e)||isArguments(e)||!!(spreadableSymbol&&e&&e[spreadableSymbol])}function baseFlatten(e,t,r,o,n){var i=-1,a=e.length;for(r||(r=isFlattenable),n||(n=[]);++i<a;){var s=e[i];t>0&&r(s)?t>1?baseFlatten(s,t-1,r,o,n):arrayPush(n,s):o||(n[n.length]=s)}return n}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function stackGet(e){return this.__data__.get(e)}function stackHas(e){return this.__data__.has(e)}var LARGE_ARRAY_SIZE=200;function stackSet(e,t){var r=this.__data__;if(r instanceof ListCache){var o=r.__data__;if(!Map$1||o.length<LARGE_ARRAY_SIZE-1)return o.push([e,t]),this.size=++r.size,this;r=this.__data__=new MapCache(o)}return r.set(e,t),this.size=r.size,this}function Stack(e){var t=this.__data__=new ListCache(e);this.size=t.size}function arrayFilter(e,t){for(var r=-1,o=null==e?0:e.length,n=0,i=[];++r<o;){var a=e[r];t(a,r,e)&&(i[n++]=a)}return i}function stubArray(){return[]}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var objectProto$9=Object.prototype,propertyIsEnumerable$1=objectProto$9.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(e){return null==e?[]:(e=Object(e),arrayFilter(nativeGetSymbols(e),(function(t){return propertyIsEnumerable$1.call(e,t)})))}:stubArray;function baseGetAllKeys(e,t,r){var o=t(e);return isArray(e)?o:arrayPush(o,r(e))}function getAllKeys(e){return baseGetAllKeys(e,keys,getSymbols)}var DataView=getNative(root,"DataView"),Promise$1=getNative(root,"Promise"),Set$1=getNative(root,"Set"),mapTag$1="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$1="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$1="[object DataView]",dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set$1),weakMapCtorString=toSource(WeakMap$1),getTag=baseGetTag;(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag$1||Map$1&&getTag(new Map$1)!=mapTag$1||Promise$1&&getTag(Promise$1.resolve())!=promiseTag||Set$1&&getTag(new Set$1)!=setTag$1||WeakMap$1&&getTag(new WeakMap$1)!=weakMapTag$1)&&(getTag=function(e){var t=baseGetTag(e),r=t==objectTag$1?e.constructor:void 0,o=r?toSource(r):"";if(o)switch(o){case dataViewCtorString:return dataViewTag$1;case mapCtorString:return mapTag$1;case promiseCtorString:return promiseTag;case setCtorString:return setTag$1;case weakMapCtorString:return weakMapTag$1}return t});var getTag$1=getTag,Uint8Array$1=root.Uint8Array,HASH_UNDEFINED$2="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED$2),this}function setCacheHas(e){return this.__data__.has(e)}function SetCache(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new MapCache;++t<r;)this.add(e[t])}function arraySome(e,t){for(var r=-1,o=null==e?0:e.length;++r<o;)if(t(e[r],r,e))return!0;return!1}function cacheHas(e,t){return e.has(t)}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas;var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function equalArrays(e,t,r,o,n,i){var a=r&COMPARE_PARTIAL_FLAG,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=i.get(e),d=i.get(t);if(c&&d)return c==t&&d==e;var u=-1,p=!0,h=r&COMPARE_UNORDERED_FLAG?new SetCache:void 0;for(i.set(e,t),i.set(t,e);++u<s;){var f=e[u],g=t[u];if(o)var m=a?o(g,f,u,t,e,i):o(f,g,u,e,t,i);if(void 0!==m){if(m)continue;p=!1;break}if(h){if(!arraySome(t,(function(e,t){if(!cacheHas(h,t)&&(f===e||n(f,e,r,o,i)))return h.push(t)}))){p=!1;break}}else if(f!==g&&!n(f,g,r,o,i)){p=!1;break}}return i.delete(e),i.delete(t),p}function mapToArray(e){var t=-1,r=Array(e.size);return e.forEach((function(e,o){r[++t]=[o,e]})),r}function setToArray(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2,boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$2="[object DataView]",symbolProto$1=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf=symbolProto$1?symbolProto$1.valueOf:void 0;function equalByTag(e,t,r,o,n,i,a){switch(r){case dataViewTag$2:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case arrayBufferTag$1:return!(e.byteLength!=t.byteLength||!i(new Uint8Array$1(e),new Uint8Array$1(t)));case boolTag$1:case dateTag$1:case numberTag$1:return eq(+e,+t);case errorTag$1:return e.name==t.name&&e.message==t.message;case regexpTag$1:case stringTag$1:return e==t+"";case mapTag$2:var s=mapToArray;case setTag$2:var l=o&COMPARE_PARTIAL_FLAG$1;if(s||(s=setToArray),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;o|=COMPARE_UNORDERED_FLAG$1,a.set(e,t);var d=equalArrays(s(e),s(t),o,n,i,a);return a.delete(e),d;case symbolTag$1:if(symbolValueOf)return symbolValueOf.call(e)==symbolValueOf.call(t)}return!1}var COMPARE_PARTIAL_FLAG$2=1,objectProto$a=Object.prototype,hasOwnProperty$7=objectProto$a.hasOwnProperty;function equalObjects(e,t,r,o,n,i){var a=r&COMPARE_PARTIAL_FLAG$2,s=getAllKeys(e),l=s.length;if(l!=getAllKeys(t).length&&!a)return!1;for(var c=l;c--;){var d=s[c];if(!(a?d in t:hasOwnProperty$7.call(t,d)))return!1}var u=i.get(e),p=i.get(t);if(u&&p)return u==t&&p==e;var h=!0;i.set(e,t),i.set(t,e);for(var f=a;++c<l;){var g=e[d=s[c]],m=t[d];if(o)var y=a?o(m,g,d,t,e,i):o(g,m,d,e,t,i);if(!(void 0===y?g===m||n(g,m,r,o,i):y)){h=!1;break}f||(f="constructor"==d)}if(h&&!f){var b=e.constructor,v=t.constructor;b==v||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof v&&v instanceof v||(h=!1)}return i.delete(e),i.delete(t),h}var COMPARE_PARTIAL_FLAG$3=1,argsTag$2="[object Arguments]",arrayTag$1="[object Array]",objectTag$2="[object Object]",objectProto$b=Object.prototype,hasOwnProperty$8=objectProto$b.hasOwnProperty;function baseIsEqualDeep(e,t,r,o,n,i){var a=isArray(e),s=isArray(t),l=a?arrayTag$1:getTag$1(e),c=s?arrayTag$1:getTag$1(t),d=(l=l==argsTag$2?objectTag$2:l)==objectTag$2,u=(c=c==argsTag$2?objectTag$2:c)==objectTag$2,p=l==c;if(p&&isBuffer(e)){if(!isBuffer(t))return!1;a=!0,d=!1}if(p&&!d)return i||(i=new Stack),a||isTypedArray(e)?equalArrays(e,t,r,o,n,i):equalByTag(e,t,l,r,o,n,i);if(!(r&COMPARE_PARTIAL_FLAG$3)){var h=d&&hasOwnProperty$8.call(e,"__wrapped__"),f=u&&hasOwnProperty$8.call(t,"__wrapped__");if(h||f){var g=h?e.value():e,m=f?t.value():t;return i||(i=new Stack),n(g,m,r,o,i)}}return!!p&&(i||(i=new Stack),equalObjects(e,t,r,o,n,i))}function baseIsEqual(e,t,r,o,n){return e===t||(null==e||null==t||!isObjectLike(e)&&!isObjectLike(t)?e!=e&&t!=t:baseIsEqualDeep(e,t,r,o,baseIsEqual,n))}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2;function baseIsMatch(e,t,r,o){var n=r.length,i=n,a=!o;if(null==e)return!i;for(e=Object(e);n--;){var s=r[n];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++n<i;){var l=(s=r[n])[0],c=e[l],d=s[1];if(a&&s[2]){if(void 0===c&&!(l in e))return!1}else{var u=new Stack;if(o)var p=o(c,d,l,e,t,u);if(!(void 0===p?baseIsEqual(d,c,COMPARE_PARTIAL_FLAG$4|COMPARE_UNORDERED_FLAG$2,o,u):p))return!1}}return!0}function isStrictComparable(e){return e==e&&!isObject(e)}function getMatchData(e){for(var t=keys(e),r=t.length;r--;){var o=t[r],n=e[o];t[r]=[o,n,isStrictComparable(n)]}return t}function matchesStrictComparable(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}function baseMatches(e){var t=getMatchData(e);return 1==t.length&&t[0][2]?matchesStrictComparable(t[0][0],t[0][1]):function(r){return r===e||baseIsMatch(r,e,t)}}function baseHasIn(e,t){return null!=e&&t in Object(e)}function hasPath(e,t,r){for(var o=-1,n=(t=castPath(t,e)).length,i=!1;++o<n;){var a=toKey(t[o]);if(!(i=null!=e&&r(e,a)))break;e=e[a]}return i||++o!=n?i:!!(n=null==e?0:e.length)&&isLength(n)&&isIndex(a,n)&&(isArray(e)||isArguments(e))}function hasIn(e,t){return null!=e&&hasPath(e,t,baseHasIn)}var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function baseMatchesProperty(e,t){return isKey(e)&&isStrictComparable(t)?matchesStrictComparable(toKey(e),t):function(r){var o=get(r,e);return void 0===o&&o===t?hasIn(r,e):baseIsEqual(t,o,COMPARE_PARTIAL_FLAG$5|COMPARE_UNORDERED_FLAG$3)}}function baseProperty(e){return function(t){return null==t?void 0:t[e]}}function basePropertyDeep(e){return function(t){return baseGet(t,e)}}function property$1(e){return isKey(e)?baseProperty(toKey(e)):basePropertyDeep(e)}function baseIteratee(e){return"function"==typeof e?e:null==e?identity:"object"==typeof e?isArray(e)?baseMatchesProperty(e[0],e[1]):baseMatches(e):property$1(e)}function createBaseFor(e){return function(t,r,o){for(var n=-1,i=Object(t),a=o(t),s=a.length;s--;){var l=a[e?s:++n];if(!1===r(i[l],l,i))break}return t}}var baseFor=createBaseFor();function baseForOwn(e,t){return e&&baseFor(e,t,keys)}function createBaseEach(e,t){return function(r,o){if(null==r)return r;if(!isArrayLike(r))return e(r,o);for(var n=r.length,i=t?n:-1,a=Object(r);(t?i--:++i<n)&&!1!==o(a[i],i,a););return r}}var baseEach=createBaseEach(baseForOwn);function isArrayLikeObject(e){return isObjectLike(e)&&isArrayLike(e)}function arrayIncludesWith(e,t,r){for(var o=-1,n=null==e?0:e.length;++o<n;)if(r(t,e[o]))return!0;return!1}var LARGE_ARRAY_SIZE$1=200;function baseDifference(e,t,r,o){var n=-1,i=arrayIncludes,a=!0,s=e.length,l=[],c=t.length;if(!s)return l;r&&(t=arrayMap(t,baseUnary(r))),o?(i=arrayIncludesWith,a=!1):t.length>=LARGE_ARRAY_SIZE$1&&(i=cacheHas,a=!1,t=new SetCache(t));e:for(;++n<s;){var d=e[n],u=null==r?d:r(d);if(d=o||0!==d?d:0,a&&u==u){for(var p=c;p--;)if(t[p]===u)continue e;l.push(d)}else i(t,u,o)||l.push(d)}return l}function createFind(e){return function(t,r,o){var n=Object(t);if(!isArrayLike(t)){var i=baseIteratee(r);t=keys(t),r=function(e){return i(n[e],e,n)}}var a=e(t,r,o);return a>-1?n[i?t[a]:a]:void 0}}var nativeMax$1=Math.max;function findIndex(e,t,r){var o=null==e?0:e.length;if(!o)return-1;var n=null==r?0:toInteger(r);return n<0&&(n=nativeMax$1(o+n,0)),baseFindIndex(e,baseIteratee(t),n)}var find=createFind(findIndex);function baseMap(e,t){var r=-1,o=isArrayLike(e)?Array(e.length):[];return baseEach(e,(function(e,n,i){o[++r]=t(e,n,i)})),o}var objectProto$c=Object.prototype,hasOwnProperty$9=objectProto$c.hasOwnProperty;function baseHas(e,t){return null!=e&&hasOwnProperty$9.call(e,t)}function has(e,t){return null!=e&&hasPath(e,t,baseHas)}var stringTag$2="[object String]";function isString(e){return"string"==typeof e||!isArray(e)&&isObjectLike(e)&&baseGetTag(e)==stringTag$2}function isEqual(e,t){return baseIsEqual(e,t)}function baseSortBy(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}function compareAscending(e,t){if(e!==t){var r=void 0!==e,o=null===e,n=e==e,i=isSymbol(e),a=void 0!==t,s=null===t,l=t==t,c=isSymbol(t);if(!s&&!c&&!i&&e>t||i&&a&&l&&!s&&!c||o&&a&&l||!r&&l||!n)return 1;if(!o&&!i&&!c&&e<t||c&&r&&n&&!o&&!i||s&&r&&n||!a&&n||!l)return-1}return 0}function compareMultiple(e,t,r){for(var o=-1,n=e.criteria,i=t.criteria,a=n.length,s=r.length;++o<a;){var l=compareAscending(n[o],i[o]);if(l)return o>=s?l:l*("desc"==r[o]?-1:1)}return e.index-t.index}function baseOrderBy(e,t,r){t=t.length?arrayMap(t,(function(e){return isArray(e)?function(t){return baseGet(t,1===e.length?e[0]:e)}:e})):[identity];var o=-1;return t=arrayMap(t,baseUnary(baseIteratee)),baseSortBy(baseMap(e,(function(e,r,n){return{criteria:arrayMap(t,(function(t){return t(e)})),index:++o,value:e}})),(function(e,t){return compareMultiple(e,t,r)}))}function orderBy(e,t,r,o){return null==e?[]:(isArray(t)||(t=null==t?[]:[t]),isArray(r=o?void 0:r)||(r=null==r?[]:[r]),baseOrderBy(e,t,r))}function baseSome(e,t){var r;return baseEach(e,(function(e,o,n){return!(r=t(e,o,n))})),!!r}function some(e,t,r){var o=isArray(e)?arraySome:baseSome;return r&&isIterateeCall(e,t,r)&&(t=void 0),o(e,baseIteratee(t))}var INFINITY$3=1/0,createSet=Set$1&&1/setToArray(new Set$1([,-0]))[1]==INFINITY$3?function(e){return new Set$1(e)}:noop,LARGE_ARRAY_SIZE$2=200;function baseUniq(e,t,r){var o=-1,n=arrayIncludes,i=e.length,a=!0,s=[],l=s;if(r)a=!1,n=arrayIncludesWith;else if(i>=LARGE_ARRAY_SIZE$2){var c=t?null:createSet(e);if(c)return setToArray(c);a=!1,n=cacheHas,l=new SetCache}else l=t?[]:s;e:for(;++o<i;){var d=e[o],u=t?t(d):d;if(d=r||0!==d?d:0,a&&u==u){for(var p=l.length;p--;)if(l[p]===u)continue e;t&&l.push(u),s.push(d)}else n(l,u,r)||(l!==s&&l.push(u),s.push(d))}return s}function baseXor(e,t,r){var o=e.length;if(o<2)return o?baseUniq(e[0]):[];for(var n=-1,i=Array(o);++n<o;)for(var a=e[n],s=-1;++s<o;)s!=n&&(i[n]=baseDifference(i[n]||a,e[s],t,r));return baseUniq(baseFlatten(i,1),t,r)}var xor=baseRest((function(e){return baseXor(arrayFilter(e,isArrayLikeObject))})),css_248z$9=css`:host{overflow:hidden}.flex-columns{display:flex;height:0;visibility:hidden;margin:0 .25rem}.flex-columns>*{flex:1}`;const previousStylePropertyCache=new WeakMap,styleMap=directive((e=>t=>{if(!(t instanceof AttributePart)||t instanceof PropertyPart||"style"!==t.committer.name||t.committer.parts.length>1)throw new Error("The `styleMap` directive must be used in the style attribute and must be the only part in the attribute.");const{committer:r}=t,{style:o}=r.element;let n=previousStylePropertyCache.get(t);void 0===n&&(o.cssText=r.strings.join(" "),previousStylePropertyCache.set(t,n=new Set)),n.forEach((t=>{t in e||(n.delete(t),-1===t.indexOf("-")?o[t]=null:o.removeProperty(t))}));for(const t in e)n.add(t),-1===t.indexOf("-")?o[t]=e[t]:o.setProperty(t,e[t])}));function isFunction$1(e){return"function"==typeof e}var _enable_super_gross_mode_that_will_cause_bad_things=!1,config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack;_enable_super_gross_mode_that_will_cause_bad_things=e},get useDeprecatedSynchronousErrorHandling(){return _enable_super_gross_mode_that_will_cause_bad_things}};function hostReportError(e){setTimeout((function(){throw e}),0)}var empty={closed:!0,next:function(e){},error:function(e){if(config.useDeprecatedSynchronousErrorHandling)throw e;hostReportError(e)},complete:function(){}},isArray$1=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();function isObject$1(e){return null!==e&&"object"==typeof e}var UnsubscriptionErrorImpl=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),UnsubscriptionError=UnsubscriptionErrorImpl,Subscription=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var r=this,o=r._parentOrParents,n=r._ctorUnsubscribe,i=r._unsubscribe,a=r._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,o instanceof e)o.remove(this);else if(null!==o)for(var s=0;s<o.length;++s){o[s].remove(this)}if(isFunction$1(i)){n&&(this._unsubscribe=void 0);try{i.call(this)}catch(e){t=e instanceof UnsubscriptionError?flattenUnsubscriptionErrors(e.errors):[e]}}if(isArray$1(a)){s=-1;for(var l=a.length;++s<l;){var c=a[s];if(isObject$1(c))try{c.unsubscribe()}catch(e){t=t||[],e instanceof UnsubscriptionError?t=t.concat(flattenUnsubscriptionErrors(e.errors)):t.push(e)}}}if(t)throw new UnsubscriptionError(t)}},e.prototype.add=function(t){var r=t;if(!t)return e.EMPTY;switch(typeof t){case"function":r=new e(t);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var o=r;(r=new e)._subscriptions=[o]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var n=r._parentOrParents;if(null===n)r._parentOrParents=this;else if(n instanceof e){if(n===this)return r;r._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return r;n.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function flattenUnsubscriptionErrors(e){return e.reduce((function(e,t){return e.concat(t instanceof UnsubscriptionError?t.errors:t)}),[])}var rxSubscriber=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Subscriber=function(e){function t(r,o,n){var i=e.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=empty;break;case 1:if(!r){i.destination=empty;break}if("object"==typeof r){r instanceof t?(i.syncErrorThrowable=r.syncErrorThrowable,i.destination=r,r.add(i)):(i.syncErrorThrowable=!0,i.destination=new SafeSubscriber(i,r));break}default:i.syncErrorThrowable=!0,i.destination=new SafeSubscriber(i,r,o,n)}return i}return __extends(t,e),t.prototype[rxSubscriber]=function(){return this},t.create=function(e,r,o){var n=new t(e,r,o);return n.syncErrorThrowable=!1,n},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(Subscription),SafeSubscriber=function(e){function t(t,r,o,n){var i,a=e.call(this)||this;a._parentSubscriber=t;var s=a;return isFunction$1(r)?i=r:r&&(i=r.next,o=r.error,n=r.complete,r!==empty&&(isFunction$1((s=Object.create(r)).unsubscribe)&&a.add(s.unsubscribe.bind(s)),s.unsubscribe=a.unsubscribe.bind(a))),a._context=s,a._next=i,a._error=o,a._complete=n,a}return __extends(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,r=config.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):hostReportError(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;hostReportError(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),config.useDeprecatedSynchronousErrorHandling)throw e;hostReportError(e)}},t.prototype.__tryOrSetError=function(e,t,r){if(!config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(t){return config.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(hostReportError(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(Subscriber);function canReportError(e){for(;e;){var t=e,r=t.closed,o=t.destination,n=t.isStopped;if(r||n)return!1;e=o&&o instanceof Subscriber?o:null}return!0}function toSubscriber(e,t,r){if(e){if(e instanceof Subscriber)return e;if(e[rxSubscriber])return e[rxSubscriber]()}return e||t||r?new Subscriber(e,t,r):new Subscriber(empty)}var observable=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function identity$1(e){return e}function pipeFromArray(e){return 0===e.length?identity$1:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var Observable=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var o=this.operator,n=toSubscriber(e,t,r);if(o?n.add(o.call(n,this.source)):n.add(this.source||config.useDeprecatedSynchronousErrorHandling&&!n.syncErrorThrowable?this._subscribe(n):this._trySubscribe(n)),config.useDeprecatedSynchronousErrorHandling&&n.syncErrorThrowable&&(n.syncErrorThrowable=!1,n.syncErrorThrown))throw n.syncErrorValue;return n},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){config.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),canReportError(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=getPromiseCtor(t))((function(t,o){var n;n=r.subscribe((function(t){try{e(t)}catch(e){o(e),n&&n.unsubscribe()}}),o,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[observable]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:pipeFromArray(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=getPromiseCtor(e))((function(e,r){var o;t.subscribe((function(e){return o=e}),(function(e){return r(e)}),(function(){return e(o)}))}))},e.create=function(t){return new e(t)},e}();function getPromiseCtor(e){if(e||(e=Promise),!e)throw new Error("no Promise impl found");return e}var ObjectUnsubscribedErrorImpl=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),ObjectUnsubscribedError=ObjectUnsubscribedErrorImpl,SubjectSubscription=function(e){function t(t,r){var o=e.call(this)||this;return o.subject=t,o.subscriber=r,o.closed=!1,o}return __extends(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var r=t.indexOf(this.subscriber);-1!==r&&t.splice(r,1)}}},t}(Subscription),SubjectSubscriber=function(e){function t(t){var r=e.call(this,t)||this;return r.destination=t,r}return __extends(t,e),t}(Subscriber),Subject=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return __extends(t,e),t.prototype[rxSubscriber]=function(){return new SubjectSubscriber(this)},t.prototype.lift=function(e){var t=new AnonymousSubject(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new ObjectUnsubscribedError;if(!this.isStopped)for(var t=this.observers,r=t.length,o=t.slice(),n=0;n<r;n++)o[n].next(e)},t.prototype.error=function(e){if(this.closed)throw new ObjectUnsubscribedError;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,r=t.length,o=t.slice(),n=0;n<r;n++)o[n].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new ObjectUnsubscribedError;this.isStopped=!0;for(var e=this.observers,t=e.length,r=e.slice(),o=0;o<t;o++)r[o].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new ObjectUnsubscribedError;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new ObjectUnsubscribedError;return this.hasError?(e.error(this.thrownError),Subscription.EMPTY):this.isStopped?(e.complete(),Subscription.EMPTY):(this.observers.push(e),new SubjectSubscription(this,e))},t.prototype.asObservable=function(){var e=new Observable;return e.source=this,e},t.create=function(e,t){return new AnonymousSubject(e,t)},t}(Observable),AnonymousSubject=function(e){function t(t,r){var o=e.call(this)||this;return o.destination=t,o.source=r,o}return __extends(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):Subscription.EMPTY},t}(Subject),Action=function(e){function t(t,r){return e.call(this)||this}return __extends(t,e),t.prototype.schedule=function(e,t){return this},t}(Subscription),AsyncAction=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o.scheduler=t,o.work=r,o.pending=!1,o}return __extends(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(o,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var r=!1,o=void 0;try{this.work(e)}catch(e){r=!0,o=!!e&&e||new Error(e)}if(r)return this.unsubscribe(),o},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,r=t.actions,o=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==o&&r.splice(o,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(Action),QueueAction=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o.scheduler=t,o.work=r,o}return __extends(t,e),t.prototype.schedule=function(t,r){return void 0===r&&(r=0),r>0?e.prototype.schedule.call(this,t,r):(this.delay=r,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,r){return r>0||this.closed?e.prototype.execute.call(this,t,r):this._execute(t,r)},t.prototype.requestAsyncId=function(t,r,o){return void 0===o&&(o=0),null!==o&&o>0||null===o&&this.delay>0?e.prototype.requestAsyncId.call(this,t,r,o):t.flush(this)},t}(AsyncAction),Scheduler=function(){function e(t,r){void 0===r&&(r=e.now),this.SchedulerAction=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(r,t)},e.now=function(){return Date.now()},e}(),AsyncScheduler=function(e){function t(r,o){void 0===o&&(o=Scheduler.now);var n=e.call(this,r,(function(){return t.delegate&&t.delegate!==n?t.delegate.now():o()}))||this;return n.actions=[],n.active=!1,n.scheduled=void 0,n}return __extends(t,e),t.prototype.schedule=function(r,o,n){return void 0===o&&(o=0),t.delegate&&t.delegate!==this?t.delegate.schedule(r,o,n):e.prototype.schedule.call(this,r,o,n)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var r;this.active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}},t}(Scheduler),QueueScheduler=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(AsyncScheduler),queueScheduler=new QueueScheduler(QueueAction),EMPTY=new Observable((function(e){return e.complete()}));function empty$1(e){return e?emptyScheduled(e):EMPTY}function emptyScheduled(e){return new Observable((function(t){return e.schedule((function(){return t.complete()}))}))}function isScheduler(e){return e&&"function"==typeof e.schedule}var subscribeToArray=function(e){return function(t){for(var r=0,o=e.length;r<o&&!t.closed;r++)t.next(e[r]);t.complete()}};function scheduleArray(e,t){return new Observable((function(r){var o=new Subscription,n=0;return o.add(t.schedule((function(){n!==e.length?(r.next(e[n++]),r.closed||o.add(this.schedule())):r.complete()}))),o}))}function fromArray(e,t){return t?scheduleArray(e,t):new Observable(subscribeToArray(e))}function of(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[e.length-1];return isScheduler(r)?(e.pop(),scheduleArray(e,r)):fromArray(e)}function throwError(e,t){return new Observable(t?function(r){return t.schedule(dispatch,0,{error:e,subscriber:r})}:function(t){return t.error(e)})}function dispatch(e){var t=e.error;e.subscriber.error(t)}var Notification=function(){function e(e,t,r){this.kind=e,this.value=t,this.error=r,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,r){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return r&&r()}},e.prototype.accept=function(e,t,r){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,r)},e.prototype.toObservable=function(){switch(this.kind){case"N":return of(this.value);case"E":return throwError(this.error);case"C":return empty$1()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}();function observeOn(e,t){return void 0===t&&(t=0),function(r){return r.lift(new ObserveOnOperator(e,t))}}var ObserveOnOperator=function(){function e(e,t){void 0===t&&(t=0),this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return t.subscribe(new ObserveOnSubscriber(e,this.scheduler,this.delay))},e}(),ObserveOnSubscriber=function(e){function t(t,r,o){void 0===o&&(o=0);var n=e.call(this,t)||this;return n.scheduler=r,n.delay=o,n}return __extends(t,e),t.dispatch=function(e){var t=e.notification,r=e.destination;t.observe(r),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(t.dispatch,this.delay,new ObserveOnMessage(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(Notification.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(Notification.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(Notification.createComplete()),this.unsubscribe()},t}(Subscriber),ObserveOnMessage=function(){return function(e,t){this.notification=e,this.destination=t}}(),nextHandle=1,RESOLVED=function(){return Promise.resolve()}(),activeHandles={};function findAndClearHandle(e){return e in activeHandles&&(delete activeHandles[e],!0)}var Immediate={setImmediate:function(e){var t=nextHandle++;return activeHandles[t]=!0,RESOLVED.then((function(){return findAndClearHandle(t)&&e()})),t},clearImmediate:function(e){findAndClearHandle(e)}},AsapAction=function(e){function t(t,r){var o=e.call(this,t,r)||this;return o.scheduler=t,o.work=r,o}return __extends(t,e),t.prototype.requestAsyncId=function(t,r,o){return void 0===o&&(o=0),null!==o&&o>0?e.prototype.requestAsyncId.call(this,t,r,o):(t.actions.push(this),t.scheduled||(t.scheduled=Immediate.setImmediate(t.flush.bind(t,null))))},t.prototype.recycleAsyncId=function(t,r,o){if(void 0===o&&(o=0),null!==o&&o>0||null===o&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,r,o);0===t.actions.length&&(Immediate.clearImmediate(r),t.scheduled=void 0)},t}(AsyncAction),AsapScheduler=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,r=this.actions,o=-1,n=r.length;e=e||r.shift();do{if(t=e.execute(e.state,e.delay))break}while(++o<n&&(e=r.shift()));if(this.active=!1,t){for(;++o<n&&(e=r.shift());)e.unsubscribe();throw t}},t}(AsyncScheduler),asapScheduler=new AsapScheduler(AsapAction),asap=asapScheduler,asyncScheduler=new AsyncScheduler(AsyncAction),async=asyncScheduler;function noop$1(){}var ArgumentOutOfRangeErrorImpl=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}(),ArgumentOutOfRangeError=ArgumentOutOfRangeErrorImpl,TimeoutErrorImpl=function(){function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e}(),TimeoutError=TimeoutErrorImpl;function map(e,t){return function(r){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new MapOperator(e,t))}}var MapOperator=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new MapSubscriber(e,this.project,this.thisArg))},e}(),MapSubscriber=function(e){function t(t,r,o){var n=e.call(this,t)||this;return n.project=r,n.count=0,n.thisArg=o||n,n}return __extends(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Subscriber),OuterSubscriber=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.notifyNext=function(e,t,r,o,n){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(Subscriber),InnerSubscriber=function(e){function t(t,r,o){var n=e.call(this)||this;return n.parent=t,n.outerValue=r,n.outerIndex=o,n.index=0,n}return __extends(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(Subscriber),subscribeToPromise=function(e){return function(t){return e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,hostReportError),t}};function getSymbolIterator(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var iterator=getSymbolIterator(),subscribeToIterable=function(e){return function(t){for(var r=e[iterator]();;){var o=void 0;try{o=r.next()}catch(e){return t.error(e),t}if(o.done){t.complete();break}if(t.next(o.value),t.closed)break}return"function"==typeof r.return&&t.add((function(){r.return&&r.return()})),t}},subscribeToObservable=function(e){return function(t){var r=e[observable]();if("function"!=typeof r.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return r.subscribe(t)}},isArrayLike$1=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function isPromise(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var subscribeTo=function(e){if(e&&"function"==typeof e[observable])return subscribeToObservable(e);if(isArrayLike$1(e))return subscribeToArray(e);if(isPromise(e))return subscribeToPromise(e);if(e&&"function"==typeof e[iterator])return subscribeToIterable(e);var t=isObject$1(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+t+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function subscribeToResult(e,t,r,o,n){if(void 0===n&&(n=new InnerSubscriber(e,r,o)),!n.closed)return t instanceof Observable?t.subscribe(n):subscribeTo(t)(n)}function scheduleObservable(e,t){return new Observable((function(r){var o=new Subscription;return o.add(t.schedule((function(){var n=e[observable]();o.add(n.subscribe({next:function(e){o.add(t.schedule((function(){return r.next(e)})))},error:function(e){o.add(t.schedule((function(){return r.error(e)})))},complete:function(){o.add(t.schedule((function(){return r.complete()})))}}))}))),o}))}function schedulePromise(e,t){return new Observable((function(r){var o=new Subscription;return o.add(t.schedule((function(){return e.then((function(e){o.add(t.schedule((function(){r.next(e),o.add(t.schedule((function(){return r.complete()})))})))}),(function(e){o.add(t.schedule((function(){return r.error(e)})))}))}))),o}))}function scheduleIterable(e,t){if(!e)throw new Error("Iterable cannot be null");return new Observable((function(r){var o,n=new Subscription;return n.add((function(){o&&"function"==typeof o.return&&o.return()})),n.add(t.schedule((function(){o=e[iterator](),n.add(t.schedule((function(){if(!r.closed){var e,t;try{var n=o.next();e=n.value,t=n.done}catch(e){return void r.error(e)}t?r.complete():(r.next(e),this.schedule())}})))}))),n}))}function isInteropObservable(e){return e&&"function"==typeof e[observable]}function isIterable$1(e){return e&&"function"==typeof e[iterator]}function scheduled(e,t){if(null!=e){if(isInteropObservable(e))return scheduleObservable(e,t);if(isPromise(e))return schedulePromise(e,t);if(isArrayLike$1(e))return scheduleArray(e,t);if(isIterable$1(e)||"string"==typeof e)return scheduleIterable(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}function from(e,t){return t?scheduled(e,t):e instanceof Observable?e:new Observable(subscribeTo(e))}var SimpleInnerSubscriber=function(e){function t(t){var r=e.call(this)||this;return r.parent=t,r}return __extends(t,e),t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(Subscriber),SimpleOuterSubscriber=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(Subscriber);function innerSubscribe(e,t){if(!t.closed)return e instanceof Observable?e.subscribe(t):subscribeTo(e)(t)}function mergeMap(e,t,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"==typeof t?function(o){return o.pipe(mergeMap((function(r,o){return from(e(r,o)).pipe(map((function(e,n){return t(r,e,o,n)})))}),r))}:("number"==typeof t&&(r=t),function(t){return t.lift(new MergeMapOperator(e,r))})}var MergeMapOperator=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new MergeMapSubscriber(e,this.project,this.concurrent))},e}(),MergeMapSubscriber=function(e){function t(t,r,o){void 0===o&&(o=Number.POSITIVE_INFINITY);var n=e.call(this,t)||this;return n.project=r,n.concurrent=o,n.hasCompleted=!1,n.buffer=[],n.active=0,n.index=0,n}return __extends(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,r=this.index++;try{t=this.project(e,r)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t)},t.prototype._innerSub=function(e){var t=new SimpleInnerSubscriber(this),r=this.destination;r.add(t);var o=innerSubscribe(e,t);o!==t&&r.add(o)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(SimpleOuterSubscriber);function mergeAll(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),mergeMap(identity$1,e)}function concatAll(){return mergeAll(1)}function concat(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return concatAll()(of.apply(void 0,e))}function forkJoin(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var r=e[0];if(isArray$1(r))return forkJoinInternal(r,null);if(isObject$1(r)&&Object.getPrototypeOf(r)===Object.prototype){var o=Object.keys(r);return forkJoinInternal(o.map((function(e){return r[e]})),o)}}if("function"==typeof e[e.length-1]){var n=e.pop();return forkJoinInternal(e=1===e.length&&isArray$1(e[0])?e[0]:e,null).pipe(map((function(e){return n.apply(void 0,e)})))}return forkJoinInternal(e,null)}function forkJoinInternal(e,t){return new Observable((function(r){var o=e.length;if(0!==o)for(var n=new Array(o),i=0,a=0,s=function(s){var l=from(e[s]),c=!1;r.add(l.subscribe({next:function(e){c||(c=!0,a++),n[s]=e},error:function(e){return r.error(e)},complete:function(){++i!==o&&c||(a===o&&r.next(t?t.reduce((function(e,t,r){return e[t]=n[r],e}),{}):n),r.complete())}}))},l=0;l<o;l++)s(l);else r.complete()}))}function fromEvent(e,t,r,o){return isFunction$1(r)&&(o=r,r=void 0),o?fromEvent(e,t,r).pipe(map((function(e){return isArray$1(e)?o.apply(void 0,e):o(e)}))):new Observable((function(o){setupSubscription(e,t,(function(e){arguments.length>1?o.next(Array.prototype.slice.call(arguments)):o.next(e)}),o,r)}))}function setupSubscription(e,t,r,o,n){var i;if(isEventTarget(e)){var a=e;e.addEventListener(t,r,n),i=function(){return a.removeEventListener(t,r,n)}}else if(isJQueryStyleEventEmitter(e)){var s=e;e.on(t,r),i=function(){return s.off(t,r)}}else if(isNodeStyleEventEmitter(e)){var l=e;e.addListener(t,r),i=function(){return l.removeListener(t,r)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var c=0,d=e.length;c<d;c++)setupSubscription(e[c],t,r,o,n)}o.add(i)}function isNodeStyleEventEmitter(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}function isJQueryStyleEventEmitter(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}function isEventTarget(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}function isNumeric(e){return!isArray$1(e)&&e-parseFloat(e)+1>=0}function merge(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Number.POSITIVE_INFINITY,o=null,n=e[e.length-1];return isScheduler(n)?(o=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(r=e.pop())):"number"==typeof n&&(r=e.pop()),null===o&&1===e.length&&e[0]instanceof Observable?e[0]:mergeAll(r)(fromArray(e,o))}function filter(e,t){return function(r){return r.lift(new FilterOperator(e,t))}}var FilterOperator=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new FilterSubscriber(e,this.predicate,this.thisArg))},e}(),FilterSubscriber=function(e){function t(t,r,o){var n=e.call(this,t)||this;return n.predicate=r,n.thisArg=o,n.count=0,n}return __extends(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(Subscriber);function catchError(e){return function(t){var r=new CatchOperator(e),o=t.lift(r);return r.caught=o}}var CatchOperator=function(){function e(e){this.selector=e}return e.prototype.call=function(e,t){return t.subscribe(new CatchSubscriber(e,this.selector,this.caught))},e}(),CatchSubscriber=function(e){function t(t,r,o){var n=e.call(this,t)||this;return n.selector=r,n.caught=o,n}return __extends(t,e),t.prototype.error=function(t){if(!this.isStopped){var r=void 0;try{r=this.selector(t,this.caught)}catch(t){return void e.prototype.error.call(this,t)}this._unsubscribeAndRecycle();var o=new SimpleInnerSubscriber(this);this.add(o);var n=innerSubscribe(r,o);n!==o&&this.add(n)}},t}(SimpleOuterSubscriber);function debounceTime(e,t){return void 0===t&&(t=async),function(r){return r.lift(new DebounceTimeOperator(e,t))}}var DebounceTimeOperator=function(){function e(e,t){this.dueTime=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new DebounceTimeSubscriber(e,this.dueTime,this.scheduler))},e}(),DebounceTimeSubscriber=function(e){function t(t,r,o){var n=e.call(this,t)||this;return n.dueTime=r,n.scheduler=o,n.debouncedSubscription=null,n.lastValue=null,n.hasValue=!1,n}return __extends(t,e),t.prototype._next=function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(dispatchNext,this.dueTime,this))},t.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},t.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}},t.prototype.clearDebounce=function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)},t}(Subscriber);function dispatchNext(e){e.debouncedNext()}function isDate(e){return e instanceof Date&&!isNaN(+e)}function delay(e,t){void 0===t&&(t=async);var r=isDate(e)?+e-t.now():Math.abs(e);return function(e){return e.lift(new DelayOperator(r,t))}}var DelayOperator=function(){function e(e,t){this.delay=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new DelaySubscriber(e,this.delay,this.scheduler))},e}(),DelaySubscriber=function(e){function t(t,r,o){var n=e.call(this,t)||this;return n.delay=r,n.scheduler=o,n.queue=[],n.active=!1,n.errored=!1,n}return __extends(t,e),t.dispatch=function(e){for(var t=e.source,r=t.queue,o=e.scheduler,n=e.destination;r.length>0&&r[0].time-o.now()<=0;)r.shift().notification.observe(n);if(r.length>0){var i=Math.max(0,r[0].time-o.now());this.schedule(e,i)}else this.unsubscribe(),t.active=!1},t.prototype._schedule=function(e){this.active=!0,this.destination.add(e.schedule(t.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))},t.prototype.scheduleNotification=function(e){if(!0!==this.errored){var t=this.scheduler,r=new DelayMessage(t.now()+this.delay,e);this.queue.push(r),!1===this.active&&this._schedule(t)}},t.prototype._next=function(e){this.scheduleNotification(Notification.createNext(e))},t.prototype._error=function(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.scheduleNotification(Notification.createComplete()),this.unsubscribe()},t}(Subscriber),DelayMessage=function(){return function(e,t){this.time=e,this.notification=t}}();function distinctUntilChanged(e,t){return function(r){return r.lift(new DistinctUntilChangedOperator(e,t))}}var DistinctUntilChangedOperator=function(){function e(e,t){this.compare=e,this.keySelector=t}return e.prototype.call=function(e,t){return t.subscribe(new DistinctUntilChangedSubscriber(e,this.compare,this.keySelector))},e}(),DistinctUntilChangedSubscriber=function(e){function t(t,r,o){var n=e.call(this,t)||this;return n.keySelector=o,n.hasKey=!1,"function"==typeof r&&(n.compare=r),n}return __extends(t,e),t.prototype.compare=function(e,t){return e===t},t.prototype._next=function(e){var t;try{var r=this.keySelector;t=r?r(e):e}catch(e){return this.destination.error(e)}var o=!1;if(this.hasKey)try{o=(0,this.compare)(this.key,t)}catch(e){return this.destination.error(e)}else this.hasKey=!0;o||(this.key=t,this.destination.next(e))},t}(Subscriber);function take(e){return function(t){return 0===e?empty$1():t.lift(new TakeOperator(e))}}var TakeOperator=function(){function e(e){if(this.total=e,this.total<0)throw new ArgumentOutOfRangeError}return e.prototype.call=function(e,t){return t.subscribe(new TakeSubscriber(e,this.total))},e}(),TakeSubscriber=function(e){function t(t,r){var o=e.call(this,t)||this;return o.total=r,o.count=0,o}return __extends(t,e),t.prototype._next=function(e){var t=this.total,r=++this.count;r<=t&&(this.destination.next(e),r===t&&(this.destination.complete(),this.unsubscribe()))},t}(Subscriber);function ignoreElements(){return function(e){return e.lift(new IgnoreElementsOperator)}}var IgnoreElementsOperator=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new IgnoreElementsSubscriber(e))},e}(),IgnoreElementsSubscriber=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._next=function(e){},t}(Subscriber),SubscribeOnObservable=function(e){function t(t,r,o){void 0===r&&(r=0),void 0===o&&(o=asap);var n=e.call(this)||this;return n.source=t,n.delayTime=r,n.scheduler=o,(!isNumeric(r)||r<0)&&(n.delayTime=0),o&&"function"==typeof o.schedule||(n.scheduler=asap),n}return __extends(t,e),t.create=function(e,r,o){return void 0===r&&(r=0),void 0===o&&(o=asap),new t(e,r,o)},t.dispatch=function(e){var t=e.source,r=e.subscriber;return this.add(t.subscribe(r))},t.prototype._subscribe=function(e){var r=this.delayTime,o=this.source;return this.scheduler.schedule(t.dispatch,r,{source:o,subscriber:e})},t}(Observable);function subscribeOn(e,t){return void 0===t&&(t=0),function(r){return r.lift(new SubscribeOnOperator(e,t))}}var SubscribeOnOperator=function(){function e(e,t){this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return new SubscribeOnObservable(t,this.delay,this.scheduler).subscribe(e)},e}();function switchMap(e,t){return"function"==typeof t?function(r){return r.pipe(switchMap((function(r,o){return from(e(r,o)).pipe(map((function(e,n){return t(r,e,o,n)})))})))}:function(t){return t.lift(new SwitchMapOperator(e))}}var SwitchMapOperator=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new SwitchMapSubscriber(e,this.project))},e}(),SwitchMapSubscriber=function(e){function t(t,r){var o=e.call(this,t)||this;return o.project=r,o.index=0,o}return __extends(t,e),t.prototype._next=function(e){var t,r=this.index++;try{t=this.project(e,r)}catch(e){return void this.destination.error(e)}this._innerSub(t)},t.prototype._innerSub=function(e){var t=this.innerSubscription;t&&t.unsubscribe();var r=new SimpleInnerSubscriber(this),o=this.destination;o.add(r),this.innerSubscription=innerSubscribe(e,r),this.innerSubscription!==r&&o.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e){this.destination.next(e)},t}(SimpleOuterSubscriber);function tap(e,t,r){return function(o){return o.lift(new DoOperator(e,t,r))}}var DoOperator=function(){function e(e,t,r){this.nextOrObserver=e,this.error=t,this.complete=r}return e.prototype.call=function(e,t){return t.subscribe(new TapSubscriber(e,this.nextOrObserver,this.error,this.complete))},e}(),TapSubscriber=function(e){function t(t,r,o,n){var i=e.call(this,t)||this;return i._tapNext=noop$1,i._tapError=noop$1,i._tapComplete=noop$1,i._tapError=o||noop$1,i._tapComplete=n||noop$1,isFunction$1(r)?(i._context=i,i._tapNext=r):r&&(i._context=r,i._tapNext=r.next||noop$1,i._tapError=r.error||noop$1,i._tapComplete=r.complete||noop$1),i}return __extends(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(Subscriber);function timeoutWith(e,t,r){return void 0===r&&(r=async),function(o){var n=isDate(e),i=n?+e-r.now():Math.abs(e);return o.lift(new TimeoutWithOperator(i,n,t,r))}}var TimeoutWithOperator=function(){function e(e,t,r,o){this.waitFor=e,this.absoluteTimeout=t,this.withObservable=r,this.scheduler=o}return e.prototype.call=function(e,t){return t.subscribe(new TimeoutWithSubscriber(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},e}(),TimeoutWithSubscriber=function(e){function t(t,r,o,n,i){var a=e.call(this,t)||this;return a.absoluteTimeout=r,a.waitFor=o,a.withObservable=n,a.scheduler=i,a.scheduleTimeout(),a}return __extends(t,e),t.dispatchTimeout=function(e){var t=e.withObservable;e._unsubscribeAndRecycle(),e.add(innerSubscribe(t,new SimpleInnerSubscriber(e)))},t.prototype.scheduleTimeout=function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(t.dispatchTimeout,this.waitFor,this))},t.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),e.prototype._next.call(this,t)},t.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},t}(SimpleOuterSubscriber);function timeout(e,t){return void 0===t&&(t=async),timeoutWith(e,throwError(new TimeoutError),t)}function withLatestFrom(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var r;"function"==typeof e[e.length-1]&&(r=e.pop());var o=e;return t.lift(new WithLatestFromOperator(o,r))}}var WithLatestFromOperator=function(){function e(e,t){this.observables=e,this.project=t}return e.prototype.call=function(e,t){return t.subscribe(new WithLatestFromSubscriber(e,this.observables,this.project))},e}(),WithLatestFromSubscriber=function(e){function t(t,r,o){var n=e.call(this,t)||this;n.observables=r,n.project=o,n.toRespond=[];var i=r.length;n.values=new Array(i);for(var a=0;a<i;a++)n.toRespond.push(a);for(a=0;a<i;a++){var s=r[a];n.add(subscribeToResult(n,s,void 0,a))}return n}return __extends(t,e),t.prototype.notifyNext=function(e,t,r){this.values[r]=t;var o=this.toRespond;if(o.length>0){var n=o.indexOf(r);-1!==n&&o.splice(n,1)}},t.prototype.notifyComplete=function(){},t.prototype._next=function(e){if(0===this.toRespond.length){var t=[e].concat(this.values);this.project?this._tryProject(t):this.destination.next(t)}},t.prototype._tryProject=function(e){var t;try{t=this.project.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(OuterSubscriber);let Typo3Datagrid=class extends LitElement{constructor(){super(...arguments),this.schema=[],this.data=[],this.sorters={},this.editableColumns=[],this.selectedRows=[],this.rowIdentifier="identifier",this.ascArrowSvgUrl="",this.descArrowSvgUrl="",this.transformedColumns=[],this.imageBuffer={},this.additionalStyles={},this.clicks=0,this.inEditMode=!1,this.fillColorBuffer={},this._onClickOutsideOfEditArea=()=>{this._endEdit()}}render(){return html`${this.renderFlexColumns} ${this.renderGrid}`}get renderFlexColumns(){return html`<div class="flex-columns">${this.schema.filter((e=>!0!==e.hidden)).map((e=>{let t={};return e.width&&"auto"!==e.width&&(t={...t,flex:`0 0 ${e.width}px`}),e.minWidth&&(t={...t,minWidth:e.minWidth+"px"}),html`<div id="${e.name}" style="${styleMap(t)}"></div>`}))}</div>`}get renderGrid(){const e=this.draggable?"move":"none",t=this.transformedColumns.length>0?this.transformedColumns:this.schema;return html`<canvas-datagrid style="--cdg-active-cell-border-color:var(--typo3-global-datagrid-border-color);--cdg-active-cell-border-width:var(--typo3-global-datagrid-cell-border-width);--cdg-active-cell-font:var(--typo3-global-datagrid-font);--cdg-active-cell-overlay-border-color:transparent;--cdg-active-cell-overlay-border-width:var(--typo3-global-datagrid-cell-border-width);--cdg-active-column-header-cell-background-color:transparent;--cdg-active-row-header-cell-background-color:transparent;--cdg-cell-background-color:transparent;--cdg-cell-border-color:var(--typo3-global-datagrid-border-color);--cdg-cell-border-width:var(--typo3-global-datagrid-cell-border-width);--cdg-cell-color:var(--typo3-global-datagrid-cell-color);--cdg-cell-font:var(--typo3-global-datagrid-font);--cdg-cell-height:var(--typo3-global-datagrid-cell-height);--cdg-cell-hover-background-color:var(--typo3-global-gray-lighter);--cdg-column-header-cell-background-color:#fff;--cdg-column-header-cell-border-color:transparent;--cdg-column-header-cell-border-width:var(--typo3-global-datagrid-cell-border-width);--cdg-column-header-cell-cap-background-color:transparent;--cdg-column-header-cell-cap-border-color:transparent;--cdg-column-header-cell-color:var(--typo3-global-datagrid-cell-color);--cdg-column-header-cell-font:var(--typo3-global-datagrid-font);--cdg-column-header-cell-hover-background-color:transparent;--cdg-column-header-order-by-arrow-border-color:var(--typo3-global-datagrid-order-arrow-color);--cdg-column-header-order-by-arrow-border-width:2;--cdg-column-header-order-by-arrow-height:4;--cdg-column-header-order-by-arrow-width:8;--cdg-corner-cell-background-color:transparent;--cdg-corner-cell-border-color:transparent;--cdg-frozen-marker-border-width:var(--typo3-global-datagrid-cell-border-width);--cdg-grid-background-color:#fff;--cdg-grid-border-color:transparent;--cdg-grid-border-width:var(--typo3-global-datagrid-cell-border-width);--cdg-row-header-cell-background-color:#fff;--cdg-row-header-cell-border-color:transparent;--cdg-row-header-cell-hover-background-color:transparent;--cdg-selection-overlay-borderColor:transparent;--cdg-disabled-cell-opacity:0.5" allowcolumnreordering="false" allowcolumnresize="false" borderdragbehavior="${e}" .data="${this.data}" .schema="${t}" editable="${this.editableColumns.length>0}" selectionmode="row" hovermode="row" showrowheaders="false" @afterrendercell="${this._onAfterRendercell}" @beforebeginedit="${this._onBeforeBeginEdit}" @beginedit="${this._onBeginEdit}" @beginmove="${this._onBeginmove}" @mouseup="${this._onMouseup}" @contextmenu="${this._onContextmenu}" @dblclick="${this._onDblClick}" @endedit="${this._onEndEdit}" @mousedown="${this._onMousedown}" @rendercell="${this._onRendercell}" @renderorderbyarrow="${this._onRenderOrderByArrow}" @rendertext="${this._onRenderText}" @selectionchanged="${this._onSelectionChanged}" @touchstart="${this._onTouchStart}"></canvas-datagrid>`}getColumnsWithCaluclatedWidths(){return this.flexColumnsHelper?this.schema.map((e=>{const t=this.flexColumnsHelper.querySelector("#"+e.name),r=t?t.clientWidth:0;return{...e,width:r+""}})):[]}updated(e){if(e.has("selectedRows")){const e=this.selectedRows.map((e=>this.canvasGrid.data.findIndex((t=>t[this.rowIdentifier]===e[this.rowIdentifier])))),t=this.canvasGrid.selectedRows.map(((e,t)=>e?t:void 0)).filter((e=>void 0!==e));0!=xor(e,t).length&&(this.canvasGrid.selectNone(),e.forEach((e=>this.canvasGrid.selectRow(e))))}}disconnectedCallback(){this._endEdit(),this.resizeSubscription.unsubscribe(),super.disconnectedCallback()}connectedCallback(){super.connectedCallback(),this.resizeSubscription=fromEvent(window,"resize").pipe(delay(200),tap((()=>this.transformedColumns=[...this.getColumnsWithCaluclatedWidths()])),tap((()=>this.setGridDimensions()))).subscribe()}_onRenderText(e){this._isSvgCell(e.cell)&&(e.cell.formattedValue=""),this._handleDisabledRow(e)}_onAfterRendercell(e){var t,r,o,n,i,a;if(void 0!==(null===(t=e.cell)||void 0===t?void 0:t.value)&&this._isSvgCell(e.cell)){if(!this.imageBuffer[e.cell.value])return void this.loadExternalSVG(null===(r=e.cell)||void 0===r?void 0:r.value);const t=this.imageBuffer[null===(o=e.cell)||void 0===o?void 0:o.value];if(t&&0!==t.width){const r=t.width,o=t.height;e.ctx.fillStyle="blue";const s=(null===(n=e.cell)||void 0===n?void 0:n.x)+((null===(i=e.cell)||void 0===i?void 0:i.width)-r)/2,l=(null===(a=e.cell)||void 0===a?void 0:a.y)+(e.cell.height-o)/2;this._handleDisabledRow(e),e.ctx.drawImage(t,s,l,r,o)}}}_onRendercell(e){void 0!==e.cell&&(e.ctx.beginPath(),e.ctx.moveTo(e.cell.x,e.cell.y),e.ctx.lineTo(e.cell.x+e.cell.width,e.cell.y),e.ctx.stroke(),e.ctx.strokeStyle="transparent")}_onContextmenu(e){var t,r;if(e.preventDefault(),!0===(null===(t=e.cell)||void 0===t?void 0:t.isHeader))return;if(void 0===(null===(r=e.cell)||void 0===r?void 0:r.data))return;const o=new CustomEvent("typo3-datagrid-contextmenu",{bubbles:!0,composed:!0,detail:{node:e.cell.data,event:e.NativeEvent}});this.dispatchEvent(o)}_onDblClick(e){var t;!0!==(null===(t=e.cell)||void 0===t?void 0:t.isHeader)&&e.preventDefault()}_onMousedown(e){var t,r;if(!this._isNotSelectableRow(e.cell))return"selected"===(null===(r=null===(t=e.cell)||void 0===t?void 0:t.header)||void 0===r?void 0:r.name)?(this.addRowToSelection(e.cell),void e.preventDefault()):void 0;e.preventDefault()}_onBeginmove(){setTimeout((()=>document.body.dispatchEvent(new MouseEvent("mouseup"))),10)}_onMouseup(e){var t,r;if(!0===(null===(t=e.cell)||void 0===t?void 0:t.isHeader))return;if(this.inEditMode)return;if(0!==e.NativeEvent.button)return;this.clicks+=1;const o=(null===(r=e.cell)||void 0===r?void 0:r.selected)?e.cell.rowIndex:void 0;1===this.clicks&&(this.latestSelectedRowIndex=o,setTimeout((()=>{var t;if(1===this.clicks)null!=o&&o===this.latestSelectedRowIndex&&(this._handleSingleClick(e),this.latestSelectedRowIndex=void 0);else{const r=new CustomEvent("typo3-datagrid-dblclick",{bubbles:!0,composed:!0,detail:null===(t=e.cell)||void 0===t?void 0:t.data});this.dispatchEvent(r),this.latestSelectedRowIndex=void 0}this.clicks=0}),300))}_handleSingleClick(e){var t;!1!==this._isEditableCell(e.cell)&&1==(null===(t=e.cell)||void 0===t?void 0:t.selected)&&this.canvasGrid.beginEditAt(e.cell.columnIndex,e.cell.rowIndex)}_onRenderOrderByArrow(e){var t,r,o,n,i,a,s,l;e.preventDefault();const c=this.canvasGrid.style;let d=null!==(r=null===(t=e.cell)||void 0===t?void 0:t.x)&&void 0!==r?r:0,u=null!==(n=null===(o=e.cell)||void 0===o?void 0:o.y)&&void 0!==n?n:0;e.ctx.font=c.columnHeaderCellFont;const p=e.ctx.measureText(e.header.title).width,h=c.columnHeaderOrderByArrowMarginRight,f=c.columnHeaderOrderByArrowHeight;if(d+=+h+p+5,u+=(null!==(a=null===(i=e.cell)||void 0===i?void 0:i.height)&&void 0!==a?a:1)/2-1.5*f,this.canvasGrid.orderBy===(null===(l=null===(s=e.cell)||void 0===s?void 0:s.header)||void 0===l?void 0:l.name)){const t=`<svg class="icon-color" fill="#0078e6" role="img"><use xlink:href="${"asc"===this.canvasGrid.orderDirection?this.ascArrowSvgUrl:this.descArrowSvgUrl}" /></svg>`;this.imageBuffer[t]||this.loadExternalSVG(t);const r=this.imageBuffer[t];if(r&&0!==r.width){const t=r.width,o=r.height;e.ctx.drawImage(r,d,u,t,o)}}}_onSelectionChanged(e){const t=e.selectedData.map(((e,t)=>e?""+t:"")),r=this.canvasGrid.data.filter(((e,r)=>t.includes(""+r)));this.dispatchEvent(new CustomEvent("typo3-datagrid-selection-change",{detail:r}))}_onBeforeBeginEdit(e){!1===this._isEditableCell(e.cell)&&e.preventDefault()}_onBeginEdit(){this.inEditMode=!0,window.addEventListener("click",this._onClickOutsideOfEditArea)}_onEndEdit(e){var t,r,o,n;if(this.inEditMode=!1,window.removeEventListener("click",this._onClickOutsideOfEditArea),!0!==e.aborted&&e.value!==(null===(t=e.cell)||void 0===t?void 0:t.value)){const t=new CustomEvent("typo3-datagrid-value-change",{detail:{field:null===(o=null===(r=e.cell)||void 0===r?void 0:r.header)||void 0===o?void 0:o.name,value:e.value,data:null===(n=e.cell)||void 0===n?void 0:n.data}});this.dispatchEvent(t)}}_endEdit(){try{this.canvasGrid.endEdit(!0)}catch(e){}this.inEditMode=!1}_handleDisabledRow(e){0==Object.prototype.hasOwnProperty.call(this.additionalStyles,"disabledCellOpacity")&&(this.additionalStyles={disabledCellOpacity:parseFloat(getComputedStyle(this.canvasGrid).getPropertyValue("--cdg-disabled-cell-opacity"))}),this._isDisabledRow(e.cell)&&this.additionalStyles.disabledCellOpacity&&(e.ctx.globalAlpha=this.additionalStyles.disabledCellOpacity)}_isEditableCell(e){var t,r;return void 0!==e&&(void 0!==(null===(t=e.header)||void 0===t?void 0:t.name)&&-1!==this.editableColumns.indexOf(null===(r=e.header)||void 0===r?void 0:r.name))}_isDisabledRow(e){return void 0!==e&&!1===e.isHeader&&Object.prototype.hasOwnProperty.call(e.data,"disabled")&&!0===e.data.disabled}_isNotSelectableRow(e){return void 0!==e&&e.data&&Object.prototype.hasOwnProperty.call(e.data,"notSelectable")&&!0===e.data.notSelectable}_isSvgCell(e){return void 0!==e&&"html"===e.type&&""!==e.value&&e.rowIndex>-1&&/use/.test(e.value)}_onTouchStart(e){var t,r;"selected"===(null===(r=null===(t=e.cell)||void 0===t?void 0:t.header)||void 0===r?void 0:r.name)&&e.stopPropagation()}firstUpdated(e){super.firstUpdated(e),this.transformedColumns=this.getColumnsWithCaluclatedWidths(),this.canvasGrid.sorters=Object.assign(this.canvasGrid.sorters,this.sorters),this.setGridDimensions()}setGridDimensions(){this.canvasGrid.style.width=this.offsetWidth+"px",this.canvasGrid.style.height=this.offsetHeight+"px"}loadExternalSVG(e){const t=(new DOMParser).parseFromString(e,"text/html"),r=t.querySelector("use");if(!r)return;const o=new Image;this.imageBuffer[e]=o;const n=r.href.baseVal,i=n.replace(/.*#/,""),a=t.querySelector("svg").getAttribute("fill");a&&(this.fillColorBuffer[i]=a),fetch(n).then((e=>e.text())).then((e=>(new DOMParser).parseFromString(e,"image/svg+xml"))).then((e=>{const t=e.getElementById(i);t.setAttribute("width","16px"),t.setAttribute("height","16px"),this.fillColorBuffer[i]&&t.setAttribute("fill",this.fillColorBuffer[i]);const r=(new XMLSerializer).serializeToString(t).replace("symbol","svg").replace("symbol","svg"),n=new Blob([r],{type:"image/svg+xml"}),a=self.URL||self.webkitURL||self,s=a.createObjectURL(n);o.onload=()=>{this.canvasGrid.draw(),a.revokeObjectURL(s)},o.src=s}))}addRowToSelection(e){const t={};t[this.rowIdentifier]=e.data[this.rowIdentifier];const r=findIndex(this.canvasGrid.data,t);this.canvasGrid.selectRow(r,!0)}};Typo3Datagrid.styles=[css_248z$1,css_248z$9],__decorate([property({type:Array})],Typo3Datagrid.prototype,"schema",void 0),__decorate([property({type:Array})],Typo3Datagrid.prototype,"data",void 0),__decorate([property({type:Object})],Typo3Datagrid.prototype,"sorters",void 0),__decorate([property({type:Array})],Typo3Datagrid.prototype,"editableColumns",void 0),__decorate([property({type:Array})],Typo3Datagrid.prototype,"selectedRows",void 0),__decorate([property({type:String})],Typo3Datagrid.prototype,"rowIdentifier",void 0),__decorate([property({type:String})],Typo3Datagrid.prototype,"ascArrowSvgUrl",void 0),__decorate([property({type:String})],Typo3Datagrid.prototype,"descArrowSvgUrl",void 0),__decorate([internalProperty()],Typo3Datagrid.prototype,"transformedColumns",void 0),__decorate([query("canvas-datagrid")],Typo3Datagrid.prototype,"canvasGrid",void 0),__decorate([query(".flex-columns")],Typo3Datagrid.prototype,"flexColumnsHelper",void 0),Typo3Datagrid=__decorate([customElement("typo3-datagrid")],Typo3Datagrid);var css_248z$a=css`.draghandler{background-color:var(--typo3-draghandler-background-color,var(--typo3-global-brand-primary));color:var(--typo3-draghandler-color,#fff);padding:1rem;display:flex;gap:var(--typo3-global-default-gap);pointer-events:none}.draghandler--body{display:flex;flex-direction:column}.draghandler--title{font-size:.85rem;margin-bottom:.25rem}.draghandler--message{font-size:.625rem}slot[name=icon]::slotted(*){fill:currentColor;height:1.2rem;width:1.2rem}`;let Typo3Draghandler=class extends LitElement{render(){return html`<div class="draghandler"><div class="draghandler--icon"><slot name="icon"></slot></div><div class="draghandler--body"><span class="draghandler--title"><slot name="title"></slot><div class="draghandler--message"><slot name="message"></slot></div></span></div></div>`}};Typo3Draghandler.styles=[css_248z$1,css_248z$a],Typo3Draghandler=__decorate([customElement("typo3-draghandler")],Typo3Draghandler);var css_248z$b=css`:host{position:relative}`;let Typo3Dropdown=class extends LitElement{constructor(){super(...arguments),this.multi=!1}render(){return html`<slot name="button" @click="${this.showDropdownMenu}"></slot><typo3-menu corner="BOTTOM_LEFT" fixed="true" ?multi="${this.multi}" ?forceGroupSelection="${this.multi}" @typo3-menu-open="${this.onMenuOpen}" @typo3-menu-close="${this.onMenuClose}"><slot></slot></typo3-menu>`}showDropdownMenu(){this.buttonElement&&(this.typo3Menu.anchor=this.buttonElement),this.typo3Menu.show()}onMenuOpen(){var e;null===(e=this.buttonElement)||void 0===e||e.setAttribute("active","")}onMenuClose(){var e;null===(e=this.buttonElement)||void 0===e||e.removeAttribute("active")}get buttonElement(){return this.buttonSlotElement?this.buttonSlotElement.assignedNodes()[0]:null}};Typo3Dropdown.styles=[css_248z$1,css_248z$b],__decorate([property({type:Boolean,reflect:!0})],Typo3Dropdown.prototype,"multi",void 0),__decorate([query('slot[name="button"]')],Typo3Dropdown.prototype,"buttonSlotElement",void 0),__decorate([query("typo3-menu")],Typo3Dropdown.prototype,"typo3Menu",void 0),Typo3Dropdown=__decorate([customElement("typo3-dropdown")],Typo3Dropdown);const checkmarkIcon=html`<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 24 24"><path d="M21 6.285l-11.16 12.733-6.84-6.018 1.319-1.49 5.341 4.686 9.865-11.196 1.475 1.285z"/></svg>`;var css_248z$c=css`.checkmark{color:var(--typo3-dropdown-list-item-checkmark-color,#287fde);flex-shrink:0;align-items:center;justify-content:center;fill:currentcolor;display:inline-flex;width:var(--typo3-dropdown-list-item-checkmark-icon-size,1rem);height:var(--typo3-dropdown-list-item-checkmark-icon-size,1rem);margin-right:var(--typo3-dropdown-list-item-side-padding,.625rem);margin-left:var(--typo3-dropdown-checkmark-margin-left,-.5rem)}`,css_248z$d=css`:host{cursor:pointer;user-select:none;-webkit-tap-highlight-color:transparent;display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:var(--typo3-list-item-vertical-padding,var(--typo3-global-list-item-padding-y)) var(--typo3-list-item-side-padding,var(--typo3-global-list-item-padding-x));outline:none;color:var(--typo3-list-item-color,var(--typo3-global-list-item-color));font-size:var(--typo3-list-font-size,.75rem);letter-spacing:var(--typo3-list-item-letter-spacing,.009375em);line-height:var(--typo3-list-item-line-height,1.5rem);white-space:nowrap}:host(:not([disabled]):focus),:host(:not([disabled]):hover){color:var(--typo3-list-item-color-hover,var(--typo3-global-list-item-color-hover));text-decoration:none;background-color:var(--typo3-list-item-background-color-hover,var(--typo3-global-list-item-bg-hover))}:host(:not([disabled]):focus){outline:var(--typo3-global-default-border-width) auto Highlight;outline:var(--typo3-global-default-border-width) auto -webkit-focus-ring-color;outline-offset:-.0625rem}:host([tabindex="-1"]:focus:not(:focus-visible)){outline:0!important}:host([disabled]){cursor:default;pointer-events:none;opacity:.38}slot[name=icon]::slotted(*){fill:currentColor;width:var(--typo3-list-item-icon-size,var(--typo3-global-list-item-icon-size));height:var(--typo3-list-item-icon-size,var(--typo3-global-list-item-icon-size));line-height:1;margin-right:var(--typo3-list-item-icon-gap,var(--typo3-global-list-item-icon-size))}::slotted(a){text-decoration:none;color:var(--typo3-list-item-color,var(--typo3-global-list-item-color))}.list-item__text{overflow:hidden;flex:1;text-align:left}`;function matches(e,t){return(e.matches||e.webkitMatchesSelector||e.msMatchesSelector).call(e,t)}const isNodeElement=e=>e.nodeType===Node.ELEMENT_NODE;function findAssignedElement(e,t){for(const r of e.assignedNodes({flatten:!0}))if(isNodeElement(r)){const e=r;if(matches(e,t))return e}return null}function addHasRemoveClass(e){return{addClass:t=>{e.classList.add(t)},removeClass:t=>{e.classList.remove(t)},hasClass:t=>e.classList.contains(t)}}const fn=()=>{},optionsBlock={get passive(){return!1}};document.addEventListener("x",fn,optionsBlock),document.removeEventListener("x",fn);const deepActiveElementPath=(e=window.document)=>{let t=e.activeElement;const r=[];if(!t)return r;for(;t&&(r.push(t),t.shadowRoot);)t=t.shadowRoot.activeElement;return r},doesElementContainFocus=e=>{const t=deepActiveElementPath();if(!t.length)return!1;const r=t[t.length-1],o=new Event("check-if-focused",{bubbles:!0,composed:!0});let n=[];const i=e=>{n=e.composedPath()};return document.body.addEventListener("check-if-focused",i),r.dispatchEvent(o),document.body.removeEventListener("check-if-focused",i),-1!==n.indexOf(e)};class BaseElement extends LitElement{createFoundation(){void 0!==this.mdcFoundation&&this.mdcFoundation.destroy(),this.mdcFoundationClass&&(this.mdcFoundation=new this.mdcFoundationClass(this.createAdapter()),this.mdcFoundation.init())}firstUpdated(){this.createFoundation()}}var MDCFoundation=function(){function e(e){void 0===e&&(e={}),this.adapter=e}return Object.defineProperty(e,"cssClasses",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{}},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.destroy=function(){},e}(),cssClasses={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},strings={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},numbers={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300};function getNormalizedEventCoords(e,t,r){if(!e)return{x:0,y:0};var o,n,i=t.x,a=t.y,s=i+r.left,l=a+r.top;if("touchstart"===e.type){var c=e;o=c.changedTouches[0].pageX-s,n=c.changedTouches[0].pageY-l}else{var d=e;o=d.pageX-s,n=d.pageY-l}return{x:o,y:n}}var ACTIVATION_EVENT_TYPES=["touchstart","pointerdown","mousedown","keydown"],POINTER_DEACTIVATION_EVENT_TYPES=["touchend","pointerup","mouseup","contextmenu"],activatedTargets=[],MDCRippleFoundation=function(e){function t(r){var o=e.call(this,__assign(__assign({},t.defaultAdapter),r))||this;return o.activationAnimationHasEnded_=!1,o.activationTimer_=0,o.fgDeactivationRemovalTimer_=0,o.fgScale_="0",o.frame_={width:0,height:0},o.initialSize_=0,o.layoutFrame_=0,o.maxRadius_=0,o.unboundedCoords_={left:0,top:0},o.activationState_=o.defaultActivationState_(),o.activationTimerCallback_=function(){o.activationAnimationHasEnded_=!0,o.runDeactivationUXLogicIfReady_()},o.activateHandler_=function(e){return o.activate_(e)},o.deactivateHandler_=function(){return o.deactivate_()},o.focusHandler_=function(){return o.handleFocus()},o.blurHandler_=function(){return o.handleBlur()},o.resizeHandler_=function(){return o.layout()},o}return __extends(t,e),Object.defineProperty(t,"cssClasses",{get:function(){return cssClasses},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return strings},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return numbers},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!0,configurable:!0}),t.prototype.init=function(){var e=this,r=this.supportsPressRipple_();if(this.registerRootHandlers_(r),r){var o=t.cssClasses,n=o.ROOT,i=o.UNBOUNDED;requestAnimationFrame((function(){e.adapter.addClass(n),e.adapter.isUnbounded()&&(e.adapter.addClass(i),e.layoutInternal_())}))}},t.prototype.destroy=function(){var e=this;if(this.supportsPressRipple_()){this.activationTimer_&&(clearTimeout(this.activationTimer_),this.activationTimer_=0,this.adapter.removeClass(t.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer_&&(clearTimeout(this.fgDeactivationRemovalTimer_),this.fgDeactivationRemovalTimer_=0,this.adapter.removeClass(t.cssClasses.FG_DEACTIVATION));var r=t.cssClasses,o=r.ROOT,n=r.UNBOUNDED;requestAnimationFrame((function(){e.adapter.removeClass(o),e.adapter.removeClass(n),e.removeCssVars_()}))}this.deregisterRootHandlers_(),this.deregisterDeactivationHandlers_()},t.prototype.activate=function(e){this.activate_(e)},t.prototype.deactivate=function(){this.deactivate_()},t.prototype.layout=function(){var e=this;this.layoutFrame_&&cancelAnimationFrame(this.layoutFrame_),this.layoutFrame_=requestAnimationFrame((function(){e.layoutInternal_(),e.layoutFrame_=0}))},t.prototype.setUnbounded=function(e){var r=t.cssClasses.UNBOUNDED;e?this.adapter.addClass(r):this.adapter.removeClass(r)},t.prototype.handleFocus=function(){var e=this;requestAnimationFrame((function(){return e.adapter.addClass(t.cssClasses.BG_FOCUSED)}))},t.prototype.handleBlur=function(){var e=this;requestAnimationFrame((function(){return e.adapter.removeClass(t.cssClasses.BG_FOCUSED)}))},t.prototype.supportsPressRipple_=function(){return this.adapter.browserSupportsCssVars()},t.prototype.defaultActivationState_=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},t.prototype.registerRootHandlers_=function(e){var t=this;e&&(ACTIVATION_EVENT_TYPES.forEach((function(e){t.adapter.registerInteractionHandler(e,t.activateHandler_)})),this.adapter.isUnbounded()&&this.adapter.registerResizeHandler(this.resizeHandler_)),this.adapter.registerInteractionHandler("focus",this.focusHandler_),this.adapter.registerInteractionHandler("blur",this.blurHandler_)},t.prototype.registerDeactivationHandlers_=function(e){var t=this;"keydown"===e.type?this.adapter.registerInteractionHandler("keyup",this.deactivateHandler_):POINTER_DEACTIVATION_EVENT_TYPES.forEach((function(e){t.adapter.registerDocumentInteractionHandler(e,t.deactivateHandler_)}))},t.prototype.deregisterRootHandlers_=function(){var e=this;ACTIVATION_EVENT_TYPES.forEach((function(t){e.adapter.deregisterInteractionHandler(t,e.activateHandler_)})),this.adapter.deregisterInteractionHandler("focus",this.focusHandler_),this.adapter.deregisterInteractionHandler("blur",this.blurHandler_),this.adapter.isUnbounded()&&this.adapter.deregisterResizeHandler(this.resizeHandler_)},t.prototype.deregisterDeactivationHandlers_=function(){var e=this;this.adapter.deregisterInteractionHandler("keyup",this.deactivateHandler_),POINTER_DEACTIVATION_EVENT_TYPES.forEach((function(t){e.adapter.deregisterDocumentInteractionHandler(t,e.deactivateHandler_)}))},t.prototype.removeCssVars_=function(){var e=this,r=t.strings;Object.keys(r).forEach((function(t){0===t.indexOf("VAR_")&&e.adapter.updateCssVariable(r[t],null)}))},t.prototype.activate_=function(e){var t=this;if(!this.adapter.isSurfaceDisabled()){var r=this.activationState_;if(!r.isActivated){var o=this.previousActivationEvent_;if(!(o&&void 0!==e&&o.type!==e.type))r.isActivated=!0,r.isProgrammatic=void 0===e,r.activationEvent=e,r.wasActivatedByPointer=!r.isProgrammatic&&(void 0!==e&&("mousedown"===e.type||"touchstart"===e.type||"pointerdown"===e.type)),void 0!==e&&activatedTargets.length>0&&activatedTargets.some((function(e){return t.adapter.containsEventTarget(e)}))?this.resetActivationState_():(void 0!==e&&(activatedTargets.push(e.target),this.registerDeactivationHandlers_(e)),r.wasElementMadeActive=this.checkElementMadeActive_(e),r.wasElementMadeActive&&this.animateActivation_(),requestAnimationFrame((function(){activatedTargets=[],r.wasElementMadeActive||void 0===e||" "!==e.key&&32!==e.keyCode||(r.wasElementMadeActive=t.checkElementMadeActive_(e),r.wasElementMadeActive&&t.animateActivation_()),r.wasElementMadeActive||(t.activationState_=t.defaultActivationState_())})))}}},t.prototype.checkElementMadeActive_=function(e){return void 0===e||"keydown"!==e.type||this.adapter.isSurfaceActive()},t.prototype.animateActivation_=function(){var e=this,r=t.strings,o=r.VAR_FG_TRANSLATE_START,n=r.VAR_FG_TRANSLATE_END,i=t.cssClasses,a=i.FG_DEACTIVATION,s=i.FG_ACTIVATION,l=t.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal_();var c="",d="";if(!this.adapter.isUnbounded()){var u=this.getFgTranslationCoordinates_(),p=u.startPoint,h=u.endPoint;c=p.x+"px, "+p.y+"px",d=h.x+"px, "+h.y+"px"}this.adapter.updateCssVariable(o,c),this.adapter.updateCssVariable(n,d),clearTimeout(this.activationTimer_),clearTimeout(this.fgDeactivationRemovalTimer_),this.rmBoundedActivationClasses_(),this.adapter.removeClass(a),this.adapter.computeBoundingRect(),this.adapter.addClass(s),this.activationTimer_=setTimeout((function(){return e.activationTimerCallback_()}),l)},t.prototype.getFgTranslationCoordinates_=function(){var e,t=this.activationState_,r=t.activationEvent;return{startPoint:e={x:(e=t.wasActivatedByPointer?getNormalizedEventCoords(r,this.adapter.getWindowPageOffset(),this.adapter.computeBoundingRect()):{x:this.frame_.width/2,y:this.frame_.height/2}).x-this.initialSize_/2,y:e.y-this.initialSize_/2},endPoint:{x:this.frame_.width/2-this.initialSize_/2,y:this.frame_.height/2-this.initialSize_/2}}},t.prototype.runDeactivationUXLogicIfReady_=function(){var e=this,r=t.cssClasses.FG_DEACTIVATION,o=this.activationState_,n=o.hasDeactivationUXRun,i=o.isActivated;(n||!i)&&this.activationAnimationHasEnded_&&(this.rmBoundedActivationClasses_(),this.adapter.addClass(r),this.fgDeactivationRemovalTimer_=setTimeout((function(){e.adapter.removeClass(r)}),numbers.FG_DEACTIVATION_MS))},t.prototype.rmBoundedActivationClasses_=function(){var e=t.cssClasses.FG_ACTIVATION;this.adapter.removeClass(e),this.activationAnimationHasEnded_=!1,this.adapter.computeBoundingRect()},t.prototype.resetActivationState_=function(){var e=this;this.previousActivationEvent_=this.activationState_.activationEvent,this.activationState_=this.defaultActivationState_(),setTimeout((function(){return e.previousActivationEvent_=void 0}),t.numbers.TAP_DELAY_MS)},t.prototype.deactivate_=function(){var e=this,t=this.activationState_;if(t.isActivated){var r=__assign({},t);t.isProgrammatic?(requestAnimationFrame((function(){return e.animateDeactivation_(r)})),this.resetActivationState_()):(this.deregisterDeactivationHandlers_(),requestAnimationFrame((function(){e.activationState_.hasDeactivationUXRun=!0,e.animateDeactivation_(r),e.resetActivationState_()})))}},t.prototype.animateDeactivation_=function(e){var t=e.wasActivatedByPointer,r=e.wasElementMadeActive;(t||r)&&this.runDeactivationUXLogicIfReady_()},t.prototype.layoutInternal_=function(){var e=this;this.frame_=this.adapter.computeBoundingRect();var r=Math.max(this.frame_.height,this.frame_.width);this.maxRadius_=this.adapter.isUnbounded()?r:Math.sqrt(Math.pow(e.frame_.width,2)+Math.pow(e.frame_.height,2))+t.numbers.PADDING;var o=Math.floor(r*t.numbers.INITIAL_ORIGIN_SCALE);this.adapter.isUnbounded()&&o%2!=0?this.initialSize_=o-1:this.initialSize_=o,this.fgScale_=""+this.maxRadius_/this.initialSize_,this.updateLayoutCssVars_()},t.prototype.updateLayoutCssVars_=function(){var e=t.strings,r=e.VAR_FG_SIZE,o=e.VAR_LEFT,n=e.VAR_TOP,i=e.VAR_FG_SCALE;this.adapter.updateCssVariable(r,this.initialSize_+"px"),this.adapter.updateCssVariable(i,this.fgScale_),this.adapter.isUnbounded()&&(this.unboundedCoords_={left:Math.round(this.frame_.width/2-this.initialSize_/2),top:Math.round(this.frame_.height/2-this.initialSize_/2)},this.adapter.updateCssVariable(o,this.unboundedCoords_.left+"px"),this.adapter.updateCssVariable(n,this.unboundedCoords_.top+"px"))},t}(MDCFoundation);class ClassList{constructor(e){this.classes=new Set,this.changed=!1,this.element=e;const t=(e.getAttribute("class")||"").split(/\s+/);for(const e of t)this.classes.add(e)}add(e){this.classes.add(e),this.changed=!0}remove(e){this.classes.delete(e),this.changed=!0}commit(){if(this.changed){let e="";this.classes.forEach((t=>e+=t+" ")),this.element.setAttribute("class",e)}}}const previousClassesCache=new WeakMap,classMap=directive((e=>t=>{if(!(t instanceof AttributePart)||t instanceof PropertyPart||"class"!==t.committer.name||t.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");const{committer:r}=t,{element:o}=r;let n=previousClassesCache.get(t);void 0===n&&(o.setAttribute("class",r.strings.join(" ")),previousClassesCache.set(t,n=new Set));const i=o.classList||new ClassList(o);n.forEach((t=>{t in e||(i.remove(t),n.delete(t))}));for(const t in e){const r=e[t];r!=n.has(t)&&(r?(i.add(t),n.add(t)):(i.remove(t),n.delete(t)))}"function"==typeof i.commit&&i.commit()}));let _=e=>e,_t;class RippleBase extends BaseElement{constructor(){super(...arguments),this.primary=!1,this.accent=!1,this.unbounded=!1,this.disabled=!1,this.activated=!1,this.selected=!1,this.hovering=!1,this.bgFocused=!1,this.fgActivation=!1,this.fgDeactivation=!1,this.fgScale="",this.fgSize="",this.translateStart="",this.translateEnd="",this.leftPos="",this.topPos="",this.mdcFoundationClass=MDCRippleFoundation}get isActive(){return(this.parentElement||this).matches(":active")}createAdapter(){return{browserSupportsCssVars:()=>!0,isUnbounded:()=>this.unbounded,isSurfaceActive:()=>this.isActive,isSurfaceDisabled:()=>this.disabled,addClass:e=>{switch(e){case"mdc-ripple-upgraded--background-focused":this.bgFocused=!0;break;case"mdc-ripple-upgraded--foreground-activation":this.fgActivation=!0;break;case"mdc-ripple-upgraded--foreground-deactivation":this.fgDeactivation=!0}},removeClass:e=>{switch(e){case"mdc-ripple-upgraded--background-focused":this.bgFocused=!1;break;case"mdc-ripple-upgraded--foreground-activation":this.fgActivation=!1;break;case"mdc-ripple-upgraded--foreground-deactivation":this.fgDeactivation=!1}},containsEventTarget:()=>!0,registerInteractionHandler:()=>{},deregisterInteractionHandler:()=>{},registerDocumentInteractionHandler:()=>{},deregisterDocumentInteractionHandler:()=>{},registerResizeHandler:()=>{},deregisterResizeHandler:()=>{},updateCssVariable:(e,t)=>{switch(e){case"--mdc-ripple-fg-scale":this.fgScale=t;break;case"--mdc-ripple-fg-size":this.fgSize=t;break;case"--mdc-ripple-fg-translate-end":this.translateEnd=t;break;case"--mdc-ripple-fg-translate-start":this.translateStart=t;break;case"--mdc-ripple-left":this.leftPos=t;break;case"--mdc-ripple-top":this.topPos=t}},computeBoundingRect:()=>(this.parentElement||this).getBoundingClientRect(),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset})}}startPress(e){this.waitForFoundation((()=>{this.mdcFoundation.activate(e)}))}endPress(){this.waitForFoundation((()=>{this.mdcFoundation.deactivate()}))}startFocus(){this.waitForFoundation((()=>{this.mdcFoundation.handleFocus()}))}endFocus(){this.waitForFoundation((()=>{this.mdcFoundation.handleBlur()}))}startHover(){this.hovering=!0}endHover(){this.hovering=!1}waitForFoundation(e){this.mdcFoundation?e():this.updateComplete.then(e)}render(){const e={"mdc-ripple-upgraded--unbounded":this.unbounded,"mdc-ripple-upgraded--background-focused":this.bgFocused,"mdc-ripple-upgraded--foreground-activation":this.fgActivation,"mdc-ripple-upgraded--foreground-deactivation":this.fgDeactivation,hover:this.hovering,primary:this.primary,accent:this.accent,disabled:this.disabled,activated:this.activated,selected:this.selected};return html(_t||(_t=_`<div class="mdc-ripple-surface mdc-ripple-upgraded ${0}" style="${0}"></div>`),classMap(e),styleMap({"--mdc-ripple-fg-scale":this.fgScale,"--mdc-ripple-fg-size":this.fgSize,"--mdc-ripple-fg-translate-end":this.translateEnd,"--mdc-ripple-fg-translate-start":this.translateStart,"--mdc-ripple-left":this.leftPos,"--mdc-ripple-top":this.topPos}))}}__decorate([query(".mdc-ripple-surface")],RippleBase.prototype,"mdcRoot",void 0),__decorate([property({type:Boolean})],RippleBase.prototype,"primary",void 0),__decorate([property({type:Boolean})],RippleBase.prototype,"accent",void 0),__decorate([property({type:Boolean})],RippleBase.prototype,"unbounded",void 0),__decorate([property({type:Boolean})],RippleBase.prototype,"disabled",void 0),__decorate([property({type:Boolean})],RippleBase.prototype,"activated",void 0),__decorate([property({type:Boolean})],RippleBase.prototype,"selected",void 0),__decorate([internalProperty()],RippleBase.prototype,"hovering",void 0),__decorate([internalProperty()],RippleBase.prototype,"bgFocused",void 0),__decorate([internalProperty()],RippleBase.prototype,"fgActivation",void 0),__decorate([internalProperty()],RippleBase.prototype,"fgDeactivation",void 0),__decorate([internalProperty()],RippleBase.prototype,"fgScale",void 0),__decorate([internalProperty()],RippleBase.prototype,"fgSize",void 0),__decorate([internalProperty()],RippleBase.prototype,"translateStart",void 0),__decorate([internalProperty()],RippleBase.prototype,"translateEnd",void 0),__decorate([internalProperty()],RippleBase.prototype,"leftPos",void 0),__decorate([internalProperty()],RippleBase.prototype,"topPos",void 0);let _$1=e=>e,_t$1;const style=css(_t$1||(_t$1=_$1`:host{display:block;position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;pointer-events:none}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(.4,0,.2,1);transform:translate(var(--mdc-ripple-fg-translate-start,0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity,0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity,0)}to{opacity:0}}:host .primary{--mdc-ripple-color:var(--mdc-theme-primary, #6200ee)}:host .accent{--mdc-ripple-color:var( --mdc-theme-secondary, #018786 )}:host .mdc-ripple-surface{top:0;bottom:0;left:0;right:0;width:100%;height:100%;pointer-events:none;--mdc-ripple-fg-size:0;--mdc-ripple-left:0;--mdc-ripple-top:0;--mdc-ripple-fg-scale:1;--mdc-ripple-fg-translate-end:0;--mdc-ripple-fg-translate-start:0;-webkit-tap-highlight-color:transparent;will-change:transform,opacity;position:relative;outline:0;overflow:hidden;--mdc-ripple-fg-opacity:var( --mdc-ripple-press-opacity, 0.12 )}:host .mdc-ripple-surface::after,:host .mdc-ripple-surface::before{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:""}:host .mdc-ripple-surface::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1}:host .mdc-ripple-surface.mdc-ripple-upgraded::before{transform:scale(var(--mdc-ripple-fg-scale,1))}:host .mdc-ripple-surface.mdc-ripple-upgraded::after{top:0;left:0;transform:scale(0);transform-origin:center center}:host .mdc-ripple-surface.mdc-ripple-upgraded--unbounded::after{top:var(--mdc-ripple-top,0);left:var(--mdc-ripple-left,0)}:host .mdc-ripple-surface.mdc-ripple-upgraded--foreground-activation::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}:host .mdc-ripple-surface.mdc-ripple-upgraded--foreground-deactivation::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}:host .mdc-ripple-surface::after,:host .mdc-ripple-surface::before{top:calc(50% - 100%);left:calc(50% - 100%);width:200%;height:200%}:host .mdc-ripple-surface.mdc-ripple-upgraded::after{width:var(--mdc-ripple-fg-size,100%);height:var(--mdc-ripple-fg-size,100%)}:host .mdc-ripple-surface.mdc-ripple-upgraded--unbounded{overflow:visible}:host .mdc-ripple-surface.mdc-ripple-upgraded--unbounded::after,:host .mdc-ripple-surface.mdc-ripple-upgraded--unbounded::before{top:calc(50% - 50%);left:calc(50% - 50%);width:100%;height:100%}:host .mdc-ripple-surface.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::after,:host .mdc-ripple-surface.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::before{top:var(--mdc-ripple-top,calc(50% - 50%));left:var(--mdc-ripple-left,calc(50% - 50%));width:var(--mdc-ripple-fg-size,100%);height:var(--mdc-ripple-fg-size,100%)}:host .mdc-ripple-surface.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::after{width:var(--mdc-ripple-fg-size,100%);height:var(--mdc-ripple-fg-size,100%)}:host .mdc-ripple-surface.hover::before{opacity:.04;opacity:var(--mdc-ripple-hover-opacity,.04)}:host .mdc-ripple-surface.mdc-ripple-upgraded--background-focused::before{opacity:.12;opacity:var(--mdc-ripple-focus-opacity,.12)}:host .mdc-ripple-surface::after,:host .mdc-ripple-surface::before{background-color:#000;background-color:var(--mdc-ripple-color,#000)}:host .mdc-ripple-surface.activated{--mdc-ripple-press-opacity:calc( var(--mdc-ripple-press-opacity, 0.12) + 0.12 )}:host .mdc-ripple-surface.activated::before{opacity:.12;opacity:var(--mdc-ripple-activated-opacity,.12)}:host .mdc-ripple-surface.activated.hover::before{opacity:.16;opacity:calc(var(--mdc-ripple-hover-opacity,.04) + var(--mdc-ripple-activated-opacity,.12))}:host .mdc-ripple-surface.activated.mdc-ripple-upgraded--background-focused::before{opacity:.24;opacity:calc(var(--mdc-ripple-focus-opacity,.12) + var(--mdc-ripple-activated-opacity,.12))}:host .mdc-ripple-surface.selected{--mdc-ripple-press-opacity:calc( var(--mdc-ripple-press-opacity, 0.12) + 0.08 )}:host .mdc-ripple-surface.selected::before{opacity:.08;opacity:var(--mdc-ripple-selected-opacity,.08)}:host .mdc-ripple-surface.selected.hover::before{opacity:.12;opacity:calc(var(--mdc-ripple-hover-opacity,.04) + var(--mdc-ripple-selected-opacity,.08))}:host .mdc-ripple-surface.selected.mdc-ripple-upgraded--background-focused::before{opacity:.2;opacity:calc(var(--mdc-ripple-focus-opacity,.12) + var(--mdc-ripple-selected-opacity,.08))}:host .mdc-ripple-surface.disabled{--mdc-ripple-color:transparent}:host .mdc-ripple-surface::before{z-index:1;z-index:var(--m-ripple-z-index,1)}:host .mdc-ripple-surface::after{z-index:0;z-index:var(--m-ripple-z-index,0)}`));let Ripple=class extends RippleBase{};Ripple.styles=style,Ripple=__decorate([customElement("mwc-ripple")],Ripple);const observer=e=>(t,r)=>{if(t.constructor._observers){if(!t.constructor.hasOwnProperty("_observers")){const e=t.constructor._observers;t.constructor._observers=new Map,e.forEach(((e,r)=>t.constructor._observers.set(r,e)))}}else{t.constructor._observers=new Map;const e=t.updated;t.updated=function(t){e.call(this,t),t.forEach(((e,t)=>{const r=this.constructor._observers.get(t);void 0!==r&&r.call(this,this[t],e)}))}}t.constructor._observers.set(r,e)};class RippleHandlers{constructor(e){this.startPress=t=>{e().then((e=>{e&&e.startPress(t)}))},this.endPress=()=>{e().then((e=>{e&&e.endPress()}))},this.startFocus=()=>{e().then((e=>{e&&e.startFocus()}))},this.endFocus=()=>{e().then((e=>{e&&e.endFocus()}))},this.startHover=()=>{e().then((e=>{e&&e.startHover()}))},this.endHover=()=>{e().then((e=>{e&&e.endHover()}))}}}let _$2=e=>e,_t$2,_t2,_t3,_t4,_t5,_t6,_t7,_t8,_t9,_t10,_t11;class ListItemBase extends LitElement{constructor(){super(...arguments),this.value="",this.group=null,this.tabindex=-1,this.disabled=!1,this.twoline=!1,this.activated=!1,this.graphic=null,this.multipleGraphics=!1,this.hasMeta=!1,this.noninteractive=!1,this.selected=!1,this.shouldRenderRipple=!1,this._managingList=null,this.boundOnClick=this.onClick.bind(this),this._firstChanged=!0,this._skipPropRequest=!1,this.rippleHandlers=new RippleHandlers((()=>(this.shouldRenderRipple=!0,this.ripple))),this.listeners=[{target:this,eventNames:["click"],cb:()=>{this.onClick()}},{target:this,eventNames:["mouseenter"],cb:this.rippleHandlers.startHover},{target:this,eventNames:["mouseleave"],cb:this.rippleHandlers.endHover},{target:this,eventNames:["focus"],cb:this.rippleHandlers.startFocus},{target:this,eventNames:["blur"],cb:this.rippleHandlers.endFocus},{target:this,eventNames:["mousedown","touchstart"],cb:e=>{const t=e.type;this.onDown("mousedown"===t?"mouseup":"touchend",e)}}]}get text(){const e=this.textContent;return e?e.trim():""}render(){const e=this.renderText(),t=this.graphic?this.renderGraphic():html(_t$2||(_t$2=_$2``)),r=this.hasMeta?this.renderMeta():html(_t2||(_t2=_$2``));return html(_t3||(_t3=_$2`${0} ${0} ${0} ${0}`),this.renderRipple(),t,e,r)}renderRipple(){return this.shouldRenderRipple?html(_t4||(_t4=_$2`<mwc-ripple .activated="${0}"></mwc-ripple>`),this.activated):this.activated?html(_t5||(_t5=_$2`<div class="fake-activated-ripple"></div>`)):html(_t6||(_t6=_$2``))}renderGraphic(){const e={multi:this.multipleGraphics};return html(_t7||(_t7=_$2`<span class="mdc-list-item__graphic material-icons ${0}"><slot name="graphic"></slot></span>`),classMap(e))}renderMeta(){return html(_t8||(_t8=_$2`<span class="mdc-list-item__meta material-icons"><slot name="meta"></slot></span>`))}renderText(){const e=this.twoline?this.renderTwoline():this.renderSingleLine();return html(_t9||(_t9=_$2`<span class="mdc-list-item__text">${0}</span>`),e)}renderSingleLine(){return html(_t10||(_t10=_$2`<slot></slot>`))}renderTwoline(){return html(_t11||(_t11=_$2`<span class="mdc-list-item__primary-text"><slot></slot></span><span class="mdc-list-item__secondary-text"><slot name="secondary"></slot></span>`))}onClick(){this.fireRequestSelected(!this.selected,"interaction")}onDown(e,t){const r=()=>{window.removeEventListener(e,r),this.rippleHandlers.endPress()};window.addEventListener(e,r),this.rippleHandlers.startPress(t)}fireRequestSelected(e,t){if(this.noninteractive)return;const r=new CustomEvent("request-selected",{bubbles:!0,composed:!0,detail:{source:t,selected:e}});this.dispatchEvent(r)}connectedCallback(){super.connectedCallback(),this.noninteractive||this.setAttribute("mwc-list-item","");for(const e of this.listeners)for(const t of e.eventNames)e.target.addEventListener(t,e.cb,{passive:!0})}disconnectedCallback(){super.disconnectedCallback();for(const e of this.listeners)for(const t of e.eventNames)e.target.removeEventListener(t,e.cb);this._managingList&&this._managingList.layout(!0)}firstUpdated(){const e=new Event("list-item-rendered",{bubbles:!0,composed:!0});this.dispatchEvent(e)}}__decorate([query("slot")],ListItemBase.prototype,"slotElement",void 0),__decorate([queryAsync("mwc-ripple")],ListItemBase.prototype,"ripple",void 0),__decorate([property({type:String})],ListItemBase.prototype,"value",void 0),__decorate([property({type:String,reflect:!0})],ListItemBase.prototype,"group",void 0),__decorate([property({type:Number,reflect:!0})],ListItemBase.prototype,"tabindex",void 0),__decorate([property({type:Boolean,reflect:!0}),observer((function(e){e?this.setAttribute("aria-disabled","true"):this.setAttribute("aria-disabled","false")}))],ListItemBase.prototype,"disabled",void 0),__decorate([property({type:Boolean,reflect:!0})],ListItemBase.prototype,"twoline",void 0),__decorate([property({type:Boolean,reflect:!0})],ListItemBase.prototype,"activated",void 0),__decorate([property({type:String,reflect:!0})],ListItemBase.prototype,"graphic",void 0),__decorate([property({type:Boolean})],ListItemBase.prototype,"multipleGraphics",void 0),__decorate([property({type:Boolean})],ListItemBase.prototype,"hasMeta",void 0),__decorate([property({type:Boolean,reflect:!0}),observer((function(e){e?(this.removeAttribute("aria-checked"),this.removeAttribute("mwc-list-item"),this.selected=!1,this.activated=!1,this.tabIndex=-1):this.setAttribute("mwc-list-item","")}))],ListItemBase.prototype,"noninteractive",void 0),__decorate([property({type:Boolean,reflect:!0}),observer((function(e){const t=this.getAttribute("role"),r="gridcell"===t||"option"===t||"row"===t||"tab"===t;r&&e?this.setAttribute("aria-selected","true"):r&&this.setAttribute("aria-selected","false"),this._firstChanged?this._firstChanged=!1:this._skipPropRequest||this.fireRequestSelected(e,"property")}))],ListItemBase.prototype,"selected",void 0),__decorate([internalProperty()],ListItemBase.prototype,"shouldRenderRipple",void 0),__decorate([internalProperty()],ListItemBase.prototype,"_managingList",void 0);class Typo3ListItemBase extends ListItemBase{constructor(){super(...arguments),this.value="",this.group=null,this.tabindex=-1,this.disabled=!1,this.activated=!1,this.selected=!1,this.listeners=[{target:this,eventNames:["click"],cb:()=>{this.onClick()}}]}render(){return html`<slot name="icon"></slot><div class="list-item__text"><slot></slot></div>`}connectedCallback(){super.connectedCallback();for(const e of this.listeners)for(const t of e.eventNames)e.target.addEventListener(t,e.cb,{passive:!0})}disconnectedCallback(){super.disconnectedCallback();for(const e of this.listeners)for(const t of e.eventNames)e.target.removeEventListener(t,e.cb)}}Typo3ListItemBase.styles=[css_248z$1,css_248z$d],__decorate([property({type:String})],Typo3ListItemBase.prototype,"value",void 0),__decorate([property({type:String,reflect:!0})],Typo3ListItemBase.prototype,"group",void 0),__decorate([property({type:Number,reflect:!0})],Typo3ListItemBase.prototype,"tabindex",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3ListItemBase.prototype,"disabled",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3ListItemBase.prototype,"activated",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3ListItemBase.prototype,"selected",void 0),__decorate([query("slot")],Typo3ListItemBase.prototype,"slotElement",void 0);let Typo3DropdownItem=class extends Typo3ListItemBase{constructor(){super(...arguments),this.displayCheckmark=!0}render(){return html`${this.displayCheckmark?html`<div class="checkmark">${this.selected?checkmarkIcon:""}</div>`:html``} ${super.render()}`}};Typo3DropdownItem.styles=[...Typo3ListItemBase.styles,css_248z$c],__decorate([property({type:Boolean,reflect:!0,attribute:"display-checkmark"})],Typo3DropdownItem.prototype,"displayCheckmark",void 0),Typo3DropdownItem=__decorate([customElement("typo3-dropdown-item")],Typo3DropdownItem);var css_248z$e=css`:host{display:block;text-align:center;position:relative}:host(:focus){outline:0}.message{display:flex;position:absolute;overflow:auto;align-items:center;justify-content:center;flex-direction:column;height:100%;width:100%}typo3-overlay{--typo3-modal-overlay-color:var(--typo3-global-brand-danger);--typo3-modal-overlay-opacity:.9}:host([drop-allowed]) typo3-overlay{--typo3-modal-overlay-color:var(--typo3-global-brand-primary)}`;let Typo3Dropzone=class extends LitElement{constructor(){super(...arguments),this.isDragged=!1,this.dropAllowed=!0,this.debouncedDragLeave=null,this._dropEffect="copy"}get dropEffect(){return this._dropEffect}set dropEffect(e){["copy","move","link","none"].includes(e)&&(this._dropEffect=e)}connectedCallback(){super.connectedCallback(),this.addEventListener("drop",this.onDrop),this.addEventListener("dragover",this.onDragOver),this.addEventListener("dragleave",this.onDragLeave)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("drop",this.onDrop),this.removeEventListener("dragover",this.onDragOver),this.removeEventListener("dragleave",this.onDragLeave)}onDragOver(e){const t=new CustomEvent("typo3-dropzone-should-accept",{bubbles:!0,cancelable:!0,composed:!0,detail:e});if(this.dropAllowed=!!this.dispatchEvent(t),!e.dataTransfer||!isEqual(["Files"],e.dataTransfer.types))return;this.dropEffect=this.dropAllowed?"copy":"none",e.preventDefault(),this.clearDebouncedDragLeave(),this.isDragged=!0,e.dataTransfer.dropEffect=this.dropEffect;const r=new CustomEvent("typo3-dropzone-dragover",{bubbles:!0,composed:!0,detail:e});this.dispatchEvent(r)}onDragLeave(e){this.clearDebouncedDragLeave(),this.debouncedDragLeave=window.setTimeout((()=>{this.isDragged=!1;const t=new CustomEvent("typo3-dropzone-dragleave",{bubbles:!0,composed:!0,detail:e});this.dispatchEvent(t)}),100)}onDrop(e){if(e.preventDefault(),this.clearDebouncedDragLeave(),this.isDragged=!1,!1===this.dropAllowed)return;const t=new CustomEvent("typo3-dropzone-drop",{bubbles:!0,composed:!0,detail:e});this.dispatchEvent(t)}render(){return html`${this.isDragged?html`<div class="message">${this.dropAllowed?html`<slot name="allowed-drop-message"></slot>`:html`<slot name="denied-drop-message"></slot>`}</div><typo3-overlay></typo3-overlay>`:html``}<slot></slot>`}clearDebouncedDragLeave(){this.debouncedDragLeave&&(clearTimeout(this.debouncedDragLeave),this.debouncedDragLeave=null)}};Typo3Dropzone.styles=[css_248z$1,css_248z$e],__decorate([property({type:Boolean,reflect:!0,attribute:"dragged"})],Typo3Dropzone.prototype,"isDragged",void 0),__decorate([property({type:Boolean,reflect:!0,attribute:"drop-allowed"})],Typo3Dropzone.prototype,"dropAllowed",void 0),Typo3Dropzone=__decorate([customElement("typo3-dropzone")],Typo3Dropzone);var noop$2={value:()=>{}};function dispatch$1(){for(var e,t=0,r=arguments.length,o={};t<r;++t){if(!(e=arguments[t]+"")||e in o||/[\s.]/.test(e))throw new Error("illegal type: "+e);o[e]=[]}return new Dispatch(o)}function Dispatch(e){this._=e}function parseTypenames(e,t){return e.trim().split(/^|\s+/).map((function(e){var r="",o=e.indexOf(".");if(o>=0&&(r=e.slice(o+1),e=e.slice(0,o)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}}))}function get$1(e,t){for(var r,o=0,n=e.length;o<n;++o)if((r=e[o]).name===t)return r.value}function set(e,t,r){for(var o=0,n=e.length;o<n;++o)if(e[o].name===t){e[o]=noop$2,e=e.slice(0,o).concat(e.slice(o+1));break}return null!=r&&e.push({name:t,value:r}),e}Dispatch.prototype=dispatch$1.prototype={constructor:Dispatch,on:function(e,t){var r,o=this._,n=parseTypenames(e+"",o),i=-1,a=n.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++i<a;)if(r=(e=n[i]).type)o[r]=set(o[r],e.name,t);else if(null==t)for(r in o)o[r]=set(o[r],e.name,null);return this}for(;++i<a;)if((r=(e=n[i]).type)&&(r=get$1(o[r],e.name)))return r},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new Dispatch(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var r,o,n=new Array(r),i=0;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,r=(o=this._[e]).length;i<r;++i)o[i].value.apply(t,n)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],n=0,i=o.length;n<i;++n)o[n].value.apply(t,r)}};var xhtml="http://www.w3.org/1999/xhtml",namespaces={svg:"http://www.w3.org/2000/svg",xhtml:xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(e){var t=e+="",r=t.indexOf(":");return r>=0&&"xmlns"!==(t=e.slice(0,r))&&(e=e.slice(r+1)),namespaces.hasOwnProperty(t)?{space:namespaces[t],local:e}:e}function creatorInherit(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===xhtml&&t.documentElement.namespaceURI===xhtml?t.createElement(e):t.createElementNS(r,e)}}function creatorFixed(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function creator(e){var t=namespace(e);return(t.local?creatorFixed:creatorInherit)(t)}function none(){}function selector(e){return null==e?none:function(){return this.querySelector(e)}}function selection_select(e){"function"!=typeof e&&(e=selector(e));for(var t=this._groups,r=t.length,o=new Array(r),n=0;n<r;++n)for(var i,a,s=t[n],l=s.length,c=o[n]=new Array(l),d=0;d<l;++d)(i=s[d])&&(a=e.call(i,i.__data__,d,s))&&("__data__"in i&&(a.__data__=i.__data__),c[d]=a);return new Selection(o,this._parents)}function array(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function empty$2(){return[]}function selectorAll(e){return null==e?empty$2:function(){return this.querySelectorAll(e)}}function arrayAll(e){return function(){var t=e.apply(this,arguments);return null==t?[]:array(t)}}function selection_selectAll(e){e="function"==typeof e?arrayAll(e):selectorAll(e);for(var t=this._groups,r=t.length,o=[],n=[],i=0;i<r;++i)for(var a,s=t[i],l=s.length,c=0;c<l;++c)(a=s[c])&&(o.push(e.call(a,a.__data__,c,s)),n.push(a));return new Selection(o,n)}function matcher(e){return function(){return this.matches(e)}}function childMatcher(e){return function(t){return t.matches(e)}}var find$1=Array.prototype.find;function childFind(e){return function(){return find$1.call(this.children,e)}}function childFirst(){return this.firstElementChild}function selection_selectChild(e){return this.select(null==e?childFirst:childFind("function"==typeof e?e:childMatcher(e)))}var filter$1=Array.prototype.filter;function children(){return this.children}function childrenFilter(e){return function(){return filter$1.call(this.children,e)}}function selection_selectChildren(e){return this.selectAll(null==e?children:childrenFilter("function"==typeof e?e:childMatcher(e)))}function selection_filter(e){"function"!=typeof e&&(e=matcher(e));for(var t=this._groups,r=t.length,o=new Array(r),n=0;n<r;++n)for(var i,a=t[n],s=a.length,l=o[n]=[],c=0;c<s;++c)(i=a[c])&&e.call(i,i.__data__,c,a)&&l.push(i);return new Selection(o,this._parents)}function sparse(e){return new Array(e.length)}function selection_enter(){return new Selection(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function constant$1(e){return function(){return e}}function bindIndex(e,t,r,o,n,i){for(var a,s=0,l=t.length,c=i.length;s<c;++s)(a=t[s])?(a.__data__=i[s],o[s]=a):r[s]=new EnterNode(e,i[s]);for(;s<l;++s)(a=t[s])&&(n[s]=a)}function bindKey(e,t,r,o,n,i,a){var s,l,c,d=new Map,u=t.length,p=i.length,h=new Array(u);for(s=0;s<u;++s)(l=t[s])&&(h[s]=c=a.call(l,l.__data__,s,t)+"",d.has(c)?n[s]=l:d.set(c,l));for(s=0;s<p;++s)c=a.call(e,i[s],s,i)+"",(l=d.get(c))?(o[s]=l,l.__data__=i[s],d.delete(c)):r[s]=new EnterNode(e,i[s]);for(s=0;s<u;++s)(l=t[s])&&d.get(h[s])===l&&(n[s]=l)}function datum(e){return e.__data__}function selection_data(e,t){if(!arguments.length)return Array.from(this,datum);var r=t?bindKey:bindIndex,o=this._parents,n=this._groups;"function"!=typeof e&&(e=constant$1(e));for(var i=n.length,a=new Array(i),s=new Array(i),l=new Array(i),c=0;c<i;++c){var d=o[c],u=n[c],p=u.length,h=array(e.call(d,d&&d.__data__,c,o)),f=h.length,g=s[c]=new Array(f),m=a[c]=new Array(f),y=l[c]=new Array(p);r(d,u,g,m,y,h,t);for(var b,v,_=0,w=0;_<f;++_)if(b=g[_]){for(_>=w&&(w=_+1);!(v=m[w])&&++w<f;);b._next=v||null}}return(a=new Selection(a,o))._enter=s,a._exit=l,a}function selection_exit(){return new Selection(this._exit||this._groups.map(sparse),this._parents)}function selection_join(e,t,r){var o=this.enter(),n=this,i=this.exit();return o="function"==typeof e?e(o):o.append(e+""),null!=t&&(n=t(n)),null==r?i.remove():r(i),o&&n?o.merge(n).order():n}function selection_merge(e){if(!(e instanceof Selection))throw new Error("invalid merge");for(var t=this._groups,r=e._groups,o=t.length,n=r.length,i=Math.min(o,n),a=new Array(o),s=0;s<i;++s)for(var l,c=t[s],d=r[s],u=c.length,p=a[s]=new Array(u),h=0;h<u;++h)(l=c[h]||d[h])&&(p[h]=l);for(;s<o;++s)a[s]=t[s];return new Selection(a,this._parents)}function selection_order(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var o,n=e[t],i=n.length-1,a=n[i];--i>=0;)(o=n[i])&&(a&&4^o.compareDocumentPosition(a)&&a.parentNode.insertBefore(o,a),a=o);return this}function selection_sort(e){function t(t,r){return t&&r?e(t.__data__,r.__data__):!t-!r}e||(e=ascending);for(var r=this._groups,o=r.length,n=new Array(o),i=0;i<o;++i){for(var a,s=r[i],l=s.length,c=n[i]=new Array(l),d=0;d<l;++d)(a=s[d])&&(c[d]=a);c.sort(t)}return new Selection(n,this._parents).order()}function ascending(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function selection_call(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function selection_nodes(){return Array.from(this)}function selection_node(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var o=e[t],n=0,i=o.length;n<i;++n){var a=o[n];if(a)return a}return null}function selection_size(){let e=0;for(const t of this)++e;return e}function selection_empty(){return!this.node()}function selection_each(e){for(var t=this._groups,r=0,o=t.length;r<o;++r)for(var n,i=t[r],a=0,s=i.length;a<s;++a)(n=i[a])&&e.call(n,n.__data__,a,i);return this}function attrRemove(e){return function(){this.removeAttribute(e)}}function attrRemoveNS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant(e,t){return function(){this.setAttribute(e,t)}}function attrConstantNS(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function attrFunction(e,t){return function(){var r=t.apply(this,arguments);null==r?this.removeAttribute(e):this.setAttribute(e,r)}}function attrFunctionNS(e,t){return function(){var r=t.apply(this,arguments);null==r?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function selection_attr(e,t){var r=namespace(e);if(arguments.length<2){var o=this.node();return r.local?o.getAttributeNS(r.space,r.local):o.getAttribute(r)}return this.each((null==t?r.local?attrRemoveNS:attrRemove:"function"==typeof t?r.local?attrFunctionNS:attrFunction:r.local?attrConstantNS:attrConstant)(r,t))}function defaultView(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function styleRemove(e){return function(){this.style.removeProperty(e)}}function styleConstant(e,t,r){return function(){this.style.setProperty(e,t,r)}}function styleFunction(e,t,r){return function(){var o=t.apply(this,arguments);null==o?this.style.removeProperty(e):this.style.setProperty(e,o,r)}}function selection_style(e,t,r){return arguments.length>1?this.each((null==t?styleRemove:"function"==typeof t?styleFunction:styleConstant)(e,t,null==r?"":r)):styleValue(this.node(),e)}function styleValue(e,t){return e.style.getPropertyValue(t)||defaultView(e).getComputedStyle(e,null).getPropertyValue(t)}function propertyRemove(e){return function(){delete this[e]}}function propertyConstant(e,t){return function(){this[e]=t}}function propertyFunction(e,t){return function(){var r=t.apply(this,arguments);null==r?delete this[e]:this[e]=r}}function selection_property(e,t){return arguments.length>1?this.each((null==t?propertyRemove:"function"==typeof t?propertyFunction:propertyConstant)(e,t)):this.node()[e]}function classArray(e){return e.trim().split(/^|\s+/)}function classList(e){return e.classList||new ClassList$1(e)}function ClassList$1(e){this._node=e,this._names=classArray(e.getAttribute("class")||"")}function classedAdd(e,t){for(var r=classList(e),o=-1,n=t.length;++o<n;)r.add(t[o])}function classedRemove(e,t){for(var r=classList(e),o=-1,n=t.length;++o<n;)r.remove(t[o])}function classedTrue(e){return function(){classedAdd(this,e)}}function classedFalse(e){return function(){classedRemove(this,e)}}function classedFunction(e,t){return function(){(t.apply(this,arguments)?classedAdd:classedRemove)(this,e)}}function selection_classed(e,t){var r=classArray(e+"");if(arguments.length<2){for(var o=classList(this.node()),n=-1,i=r.length;++n<i;)if(!o.contains(r[n]))return!1;return!0}return this.each(("function"==typeof t?classedFunction:t?classedTrue:classedFalse)(r,t))}function textRemove(){this.textContent=""}function textConstant(e){return function(){this.textContent=e}}function textFunction(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function selection_text(e){return arguments.length?this.each(null==e?textRemove:("function"==typeof e?textFunction:textConstant)(e)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(e){return function(){this.innerHTML=e}}function htmlFunction(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function selection_html(e){return arguments.length?this.each(null==e?htmlRemove:("function"==typeof e?htmlFunction:htmlConstant)(e)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(e){var t="function"==typeof e?e:creator(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))}function constantNull(){return null}function selection_insert(e,t){var r="function"==typeof e?e:creator(e),o=null==t?constantNull:"function"==typeof t?t:selector(t);return this.select((function(){return this.insertBefore(r.apply(this,arguments),o.apply(this,arguments)||null)}))}function remove(){var e=this.parentNode;e&&e.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_cloneShallow(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function selection_cloneDeep(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function selection_clone(e){return this.select(e?selection_cloneDeep:selection_cloneShallow)}function selection_datum(e){return arguments.length?this.property("__data__",e):this.node().__data__}function contextListener(e){return function(t){e.call(this,t,this.__data__)}}function parseTypenames$1(e){return e.trim().split(/^|\s+/).map((function(e){var t="",r=e.indexOf(".");return r>=0&&(t=e.slice(r+1),e=e.slice(0,r)),{type:e,name:t}}))}function onRemove(e){return function(){var t=this.__on;if(t){for(var r,o=0,n=-1,i=t.length;o<i;++o)r=t[o],e.type&&r.type!==e.type||r.name!==e.name?t[++n]=r:this.removeEventListener(r.type,r.listener,r.options);++n?t.length=n:delete this.__on}}}function onAdd(e,t,r){return function(){var o,n=this.__on,i=contextListener(t);if(n)for(var a=0,s=n.length;a<s;++a)if((o=n[a]).type===e.type&&o.name===e.name)return this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=r),void(o.value=t);this.addEventListener(e.type,i,r),o={type:e.type,name:e.name,value:t,listener:i,options:r},n?n.push(o):this.__on=[o]}}function selection_on(e,t,r){var o,n,i=parseTypenames$1(e+""),a=i.length;if(!(arguments.length<2)){for(s=t?onAdd:onRemove,o=0;o<a;++o)this.each(s(i[o],t,r));return this}var s=this.node().__on;if(s)for(var l,c=0,d=s.length;c<d;++c)for(o=0,l=s[c];o<a;++o)if((n=i[o]).type===l.type&&n.name===l.name)return l.value}function dispatchEvent$1(e,t,r){var o=defaultView(e),n=o.CustomEvent;"function"==typeof n?n=new n(t,r):(n=o.document.createEvent("Event"),r?(n.initEvent(t,r.bubbles,r.cancelable),n.detail=r.detail):n.initEvent(t,!1,!1)),e.dispatchEvent(n)}function dispatchConstant(e,t){return function(){return dispatchEvent$1(this,e,t)}}function dispatchFunction(e,t){return function(){return dispatchEvent$1(this,e,t.apply(this,arguments))}}function selection_dispatch(e,t){return this.each(("function"==typeof t?dispatchFunction:dispatchConstant)(e,t))}function*selection_iterator(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var o,n=e[t],i=0,a=n.length;i<a;++i)(o=n[i])&&(yield o)}EnterNode.prototype={constructor:EnterNode,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}},ClassList$1.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var root$1=[null];function Selection(e,t){this._groups=e,this._parents=t}function selection(){return new Selection([[document.documentElement]],root$1)}function selection_selection(){return this}function select(e){return"string"==typeof e?new Selection([[document.querySelector(e)]],[document.documentElement]):new Selection([[e]],root$1)}function sourceEvent(e){let t;for(;t=e.sourceEvent;)e=t;return e}function pointer(e,t){if(e=sourceEvent(e),void 0===t&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var o=r.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,[(o=o.matrixTransform(t.getScreenCTM().inverse())).x,o.y]}if(t.getBoundingClientRect){var n=t.getBoundingClientRect();return[e.clientX-n.left-t.clientLeft,e.clientY-n.top-t.clientTop]}}return[e.pageX,e.pageY]}function nopropagation(e){e.stopImmediatePropagation()}function noevent(e){e.preventDefault(),e.stopImmediatePropagation()}function dragDisable(e){var t=e.document.documentElement,r=select(e).on("dragstart.drag",noevent,!0);"onselectstart"in t?r.on("selectstart.drag",noevent,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function yesdrag(e,t){var r=e.document.documentElement,o=select(e).on("dragstart.drag",null);t&&(o.on("click.drag",noevent,!0),setTimeout((function(){o.on("click.drag",null)}),0)),"onselectstart"in r?o.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}Selection.prototype=selection.prototype={constructor:Selection,select:selection_select,selectAll:selection_selectAll,selectChild:selection_selectChild,selectChildren:selection_selectChildren,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,join:selection_join,merge:selection_merge,selection:selection_selection,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch,[Symbol.iterator]:selection_iterator};var constant$2=e=>()=>e;function DragEvent(e,{sourceEvent:t,subject:r,target:o,identifier:n,active:i,x:a,y:s,dx:l,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:n,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}function defaultFilter(e){return!e.ctrlKey&&!e.button}function defaultContainer(){return this.parentNode}function defaultSubject(e,t){return null==t?{x:e.x,y:e.y}:t}function defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function drag(){var e,t,r,o,n=defaultFilter,i=defaultContainer,a=defaultSubject,s=defaultTouchable,l={},c=dispatch$1("start","drag","end"),d=0,u=0;function p(e){e.on("mousedown.drag",h).filter(s).on("touchstart.drag",m).on("touchmove.drag",y).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(a,s){if(!o&&n.call(this,a,s)){var l=v(this,i.call(this,a,s),a,s,"mouse");l&&(select(a.view).on("mousemove.drag",f,!0).on("mouseup.drag",g,!0),dragDisable(a.view),nopropagation(a),r=!1,e=a.clientX,t=a.clientY,l("start",a))}}function f(o){if(noevent(o),!r){var n=o.clientX-e,i=o.clientY-t;r=n*n+i*i>u}l.mouse("drag",o)}function g(e){select(e.view).on("mousemove.drag mouseup.drag",null),yesdrag(e.view,r),noevent(e),l.mouse("end",e)}function m(e,t){if(n.call(this,e,t)){var r,o,a=e.changedTouches,s=i.call(this,e,t),l=a.length;for(r=0;r<l;++r)(o=v(this,s,e,t,a[r].identifier,a[r]))&&(nopropagation(e),o("start",e,a[r]))}}function y(e){var t,r,o=e.changedTouches,n=o.length;for(t=0;t<n;++t)(r=l[o[t].identifier])&&(noevent(e),r("drag",e,o[t]))}function b(e){var t,r,n=e.changedTouches,i=n.length;for(o&&clearTimeout(o),o=setTimeout((function(){o=null}),500),t=0;t<i;++t)(r=l[n[t].identifier])&&(nopropagation(e),r("end",e,n[t]))}function v(e,t,r,o,n,i){var s,u,h,f=c.copy(),g=pointer(i||r,t);if(null!=(h=a.call(e,new DragEvent("beforestart",{sourceEvent:r,target:p,identifier:n,active:d,x:g[0],y:g[1],dx:0,dy:0,dispatch:f}),o)))return s=h.x-g[0]||0,u=h.y-g[1]||0,function r(i,a,c){var m,y=g;switch(i){case"start":l[n]=r,m=d++;break;case"end":delete l[n],--d;case"drag":g=pointer(c||a,t),m=d}f.call(i,e,new DragEvent(i,{sourceEvent:a,subject:h,target:p,identifier:n,active:m,x:g[0]+s,y:g[1]+u,dx:g[0]-y[0],dy:g[1]-y[1],dispatch:f}),o)}}return p.filter=function(e){return arguments.length?(n="function"==typeof e?e:constant$2(!!e),p):n},p.container=function(e){return arguments.length?(i="function"==typeof e?e:constant$2(e),p):i},p.subject=function(e){return arguments.length?(a="function"==typeof e?e:constant$2(e),p):a},p.touchable=function(e){return arguments.length?(s="function"==typeof e?e:constant$2(!!e),p):s},p.on=function(){var e=c.on.apply(c,arguments);return e===c?p:e},p.clickDistance=function(e){return arguments.length?(u=(e=+e)*e,p):Math.sqrt(u)},p}function define(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function extend(e,t){var r=Object.create(e.prototype);for(var o in t)r[o]=t[o];return r}function Color(){}DragEvent.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp("^rgb\\("+[reI,reI,reI]+"\\)$"),reRgbPercent=new RegExp("^rgb\\("+[reP,reP,reP]+"\\)$"),reRgbaInteger=new RegExp("^rgba\\("+[reI,reI,reI,reN]+"\\)$"),reRgbaPercent=new RegExp("^rgba\\("+[reP,reP,reP,reN]+"\\)$"),reHslPercent=new RegExp("^hsl\\("+[reN,reP,reP]+"\\)$"),reHslaPercent=new RegExp("^hsla\\("+[reN,reP,reP,reN]+"\\)$"),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function color_formatHex(){return this.rgb().formatHex()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=reHex.exec(e))?(r=t[1].length,t=parseInt(t[1],16),6===r?rgbn(t):3===r?new Rgb(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===r?rgba(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===r?rgba(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=reRgbInteger.exec(e))?new Rgb(t[1],t[2],t[3],1):(t=reRgbPercent.exec(e))?new Rgb(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=reRgbaInteger.exec(e))?rgba(t[1],t[2],t[3],t[4]):(t=reRgbaPercent.exec(e))?rgba(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=reHslPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,1):(t=reHslaPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,t[4]):named.hasOwnProperty(e)?rgbn(named[e]):"transparent"===e?new Rgb(NaN,NaN,NaN,0):null}function rgbn(e){return new Rgb(e>>16&255,e>>8&255,255&e,1)}function rgba(e,t,r,o){return o<=0&&(e=t=r=NaN),new Rgb(e,t,r,o)}function rgbConvert(e){return e instanceof Color||(e=color(e)),e?new Rgb((e=e.rgb()).r,e.g,e.b,e.opacity):new Rgb}function rgb(e,t,r,o){return 1===arguments.length?rgbConvert(e):new Rgb(e,t,r,null==o?1:o)}function Rgb(e,t,r,o){this.r=+e,this.g=+t,this.b=+r,this.opacity=+o}function rgb_formatHex(){return"#"+hex(this.r)+hex(this.g)+hex(this.b)}function rgb_formatRgb(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function hex(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function hsla(e,t,r,o){return o<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Hsl(e,t,r,o)}function hslConvert(e){if(e instanceof Hsl)return new Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof Color||(e=color(e)),!e)return new Hsl;if(e instanceof Hsl)return e;var t=(e=e.rgb()).r/255,r=e.g/255,o=e.b/255,n=Math.min(t,r,o),i=Math.max(t,r,o),a=NaN,s=i-n,l=(i+n)/2;return s?(a=t===i?(r-o)/s+6*(r<o):r===i?(o-t)/s+2:(t-r)/s+4,s/=l<.5?i+n:2-i-n,a*=60):s=l>0&&l<1?0:a,new Hsl(a,s,l,e.opacity)}function hsl(e,t,r,o){return 1===arguments.length?hslConvert(e):new Hsl(e,t,r,null==o?1:o)}function Hsl(e,t,r,o){this.h=+e,this.s=+t,this.l=+r,this.opacity=+o}function hsl2rgb(e,t,r){return 255*(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)}define(Color,color,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb}),define(Rgb,rgb,extend(Color,{brighter:function(e){return e=null==e?brighter:Math.pow(brighter,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?darker:Math.pow(darker,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatRgb:rgb_formatRgb,toString:rgb_formatRgb})),define(Hsl,hsl,extend(Color,{brighter:function(e){return e=null==e?brighter:Math.pow(brighter,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?darker:Math.pow(darker,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,o=r+(r<.5?r:1-r)*t,n=2*r-o;return new Rgb(hsl2rgb(e>=240?e-240:e+120,n,o),hsl2rgb(e,n,o),hsl2rgb(e<120?e+240:e-120,n,o),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var constant$3=e=>()=>e;function linear(e,t){return function(r){return e+r*t}}function exponential(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(o){return Math.pow(e+o*t,r)}}function gamma(e){return 1==(e=+e)?nogamma:function(t,r){return r-t?exponential(t,r,e):constant$3(isNaN(t)?r:t)}}function nogamma(e,t){var r=t-e;return r?linear(e,r):constant$3(isNaN(e)?t:e)}var interpolateRgb=function e(t){var r=gamma(t);function o(e,t){var o=r((e=rgb(e)).r,(t=rgb(t)).r),n=r(e.g,t.g),i=r(e.b,t.b),a=nogamma(e.opacity,t.opacity);return function(t){return e.r=o(t),e.g=n(t),e.b=i(t),e.opacity=a(t),e+""}}return o.gamma=e,o}(1);function interpolateNumber(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(e){return function(){return e}}function one(e){return function(t){return e(t)+""}}function interpolateString(e,t){var r,o,n,i=reA.lastIndex=reB.lastIndex=0,a=-1,s=[],l=[];for(e+="",t+="";(r=reA.exec(e))&&(o=reB.exec(t));)(n=o.index)>i&&(n=t.slice(i,n),s[a]?s[a]+=n:s[++a]=n),(r=r[0])===(o=o[0])?s[a]?s[a]+=o:s[++a]=o:(s[++a]=null,l.push({i:a,x:interpolateNumber(r,o)})),i=reB.lastIndex;return i<t.length&&(n=t.slice(i),s[a]?s[a]+=n:s[++a]=n),s.length<2?l[0]?one(l[0].x):zero(t):(t=l.length,function(e){for(var r,o=0;o<t;++o)s[(r=l[o]).i]=r.x(e);return s.join("")})}var degrees=180/Math.PI,identity$2={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},svgNode;function decompose(e,t,r,o,n,i){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*r+t*o)&&(r-=e*l,o-=t*l),(s=Math.sqrt(r*r+o*o))&&(r/=s,o/=s,l/=s),e*o<t*r&&(e=-e,t=-t,l=-l,a=-a),{translateX:n,translateY:i,rotate:Math.atan2(t,e)*degrees,skewX:Math.atan(l)*degrees,scaleX:a,scaleY:s}}function parseCss(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?identity$2:decompose(t.a,t.b,t.c,t.d,t.e,t.f)}function parseSvg(e){return null==e?identity$2:(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",e),(e=svgNode.transform.baseVal.consolidate())?decompose((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):identity$2)}function interpolateTransform(e,t,r,o){function n(e){return e.length?e.pop()+" ":""}return function(i,a){var s=[],l=[];return i=e(i),a=e(a),function(e,o,n,i,a,s){if(e!==n||o!==i){var l=a.push("translate(",null,t,null,r);s.push({i:l-4,x:interpolateNumber(e,n)},{i:l-2,x:interpolateNumber(o,i)})}else(n||i)&&a.push("translate("+n+t+i+r)}(i.translateX,i.translateY,a.translateX,a.translateY,s,l),function(e,t,r,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:r.push(n(r)+"rotate(",null,o)-2,x:interpolateNumber(e,t)})):t&&r.push(n(r)+"rotate("+t+o)}(i.rotate,a.rotate,s,l),function(e,t,r,i){e!==t?i.push({i:r.push(n(r)+"skewX(",null,o)-2,x:interpolateNumber(e,t)}):t&&r.push(n(r)+"skewX("+t+o)}(i.skewX,a.skewX,s,l),function(e,t,r,o,i,a){if(e!==r||t!==o){var s=i.push(n(i)+"scale(",null,",",null,")");a.push({i:s-4,x:interpolateNumber(e,r)},{i:s-2,x:interpolateNumber(t,o)})}else 1===r&&1===o||i.push(n(i)+"scale("+r+","+o+")")}(i.scaleX,i.scaleY,a.scaleX,a.scaleY,s,l),i=a=null,function(e){for(var t,r=-1,o=l.length;++r<o;)s[(t=l[r]).i]=t.x(e);return s.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),frame=0,timeout$1=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock="object"==typeof performance&&performance.now?performance:Date,setFrame="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}function timer(e,t,r){var o=new Timer;return o.restart(e,t,r),o}function timerFlush(){now(),++frame;for(var e,t=taskHead;t;)(e=clockNow-t._time)>=0&&t._call.call(null,e),t=t._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout$1=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var e=clock.now(),t=e-clockLast;t>pokeDelay&&(clockSkew-=t,clockLast=e)}function nap(){for(var e,t,r=taskHead,o=1/0;r;)r._call?(o>r._time&&(o=r._time),e=r,r=r._next):(t=r._next,r._next=null,r=e?e._next=t:taskHead=t);taskTail=e,sleep(o)}function sleep(e){frame||(timeout$1&&(timeout$1=clearTimeout(timeout$1)),e-clockNow>24?(e<1/0&&(timeout$1=setTimeout(wake,e-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake)))}function timeout$2(e,t,r){var o=new Timer;return t=null==t?0:+t,o.restart((r=>{o.stop(),e(r+t)}),t,r),o}Timer.prototype=timer.prototype={constructor:Timer,restart:function(e,t,r){if("function"!=typeof e)throw new TypeError("callback is not a function");r=(null==r?now():+r)+(null==t?0:+t),this._next||taskTail===this||(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=e,this._time=r,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};var emptyOn=dispatch$1("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(e,t,r,o,n,i){var a=e.__transition;if(a){if(r in a)return}else e.__transition={};create(e,r,{name:t,index:o,group:n,on:emptyOn,tween:emptyTween,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:CREATED})}function init(e,t){var r=get$2(e,t);if(r.state>CREATED)throw new Error("too late; already scheduled");return r}function set$1(e,t){var r=get$2(e,t);if(r.state>STARTED)throw new Error("too late; already running");return r}function get$2(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function create(e,t,r){var o,n=e.__transition;function i(l){var c,d,u,p;if(r.state!==SCHEDULED)return s();for(c in n)if((p=n[c]).name===r.name){if(p.state===STARTED)return timeout$2(i);p.state===RUNNING?(p.state=ENDED,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete n[c]):+c<t&&(p.state=ENDED,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete n[c])}if(timeout$2((function(){r.state===STARTED&&(r.state=RUNNING,r.timer.restart(a,r.delay,r.time),a(l))})),r.state=STARTING,r.on.call("start",e,e.__data__,r.index,r.group),r.state===STARTING){for(r.state=STARTED,o=new Array(u=r.tween.length),c=0,d=-1;c<u;++c)(p=r.tween[c].value.call(e,e.__data__,r.index,r.group))&&(o[++d]=p);o.length=d+1}}function a(t){for(var n=t<r.duration?r.ease.call(null,t/r.duration):(r.timer.restart(s),r.state=ENDING,1),i=-1,a=o.length;++i<a;)o[i].call(e,n);r.state===ENDING&&(r.on.call("end",e,e.__data__,r.index,r.group),s())}function s(){for(var o in r.state=ENDED,r.timer.stop(),delete n[t],n)return;delete e.__transition}n[t]=r,r.timer=timer((function(e){r.state=SCHEDULED,r.timer.restart(i,r.delay,r.time),r.delay<=e&&i(e-r.delay)}),0,r.time)}function interrupt(e,t){var r,o,n,i=e.__transition,a=!0;if(i){for(n in t=null==t?null:t+"",i)(r=i[n]).name===t?(o=r.state>STARTING&&r.state<ENDING,r.state=ENDED,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete i[n]):a=!1;a&&delete e.__transition}}function selection_interrupt(e){return this.each((function(){interrupt(this,e)}))}function tweenRemove(e,t){var r,o;return function(){var n=set$1(this,e),i=n.tween;if(i!==r)for(var a=0,s=(o=r=i).length;a<s;++a)if(o[a].name===t){(o=o.slice()).splice(a,1);break}n.tween=o}}function tweenFunction(e,t,r){var o,n;if("function"!=typeof r)throw new Error;return function(){var i=set$1(this,e),a=i.tween;if(a!==o){n=(o=a).slice();for(var s={name:t,value:r},l=0,c=n.length;l<c;++l)if(n[l].name===t){n[l]=s;break}l===c&&n.push(s)}i.tween=n}}function transition_tween(e,t){var r=this._id;if(e+="",arguments.length<2){for(var o,n=get$2(this.node(),r).tween,i=0,a=n.length;i<a;++i)if((o=n[i]).name===e)return o.value;return null}return this.each((null==t?tweenRemove:tweenFunction)(r,e,t))}function tweenValue(e,t,r){var o=e._id;return e.each((function(){var e=set$1(this,o);(e.value||(e.value={}))[t]=r.apply(this,arguments)})),function(e){return get$2(e,o).value[t]}}function interpolate(e,t){var r;return("number"==typeof t?interpolateNumber:t instanceof color?interpolateRgb:(r=color(t))?(t=r,interpolateRgb):interpolateString)(e,t)}function attrRemove$1(e){return function(){this.removeAttribute(e)}}function attrRemoveNS$1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant$1(e,t,r){var o,n,i=r+"";return function(){var a=this.getAttribute(e);return a===i?null:a===o?n:n=t(o=a,r)}}function attrConstantNS$1(e,t,r){var o,n,i=r+"";return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===o?n:n=t(o=a,r)}}function attrFunction$1(e,t,r){var o,n,i;return function(){var a,s,l=r(this);if(null!=l)return(a=this.getAttribute(e))===(s=l+"")?null:a===o&&s===n?i:(n=s,i=t(o=a,l));this.removeAttribute(e)}}function attrFunctionNS$1(e,t,r){var o,n,i;return function(){var a,s,l=r(this);if(null!=l)return(a=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:a===o&&s===n?i:(n=s,i=t(o=a,l));this.removeAttributeNS(e.space,e.local)}}function transition_attr(e,t){var r=namespace(e),o="transform"===r?interpolateTransformSvg:interpolate;return this.attrTween(e,"function"==typeof t?(r.local?attrFunctionNS$1:attrFunction$1)(r,o,tweenValue(this,"attr."+e,t)):null==t?(r.local?attrRemoveNS$1:attrRemove$1)(r):(r.local?attrConstantNS$1:attrConstant$1)(r,o,t))}function attrInterpolate(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function attrInterpolateNS(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function attrTweenNS(e,t){var r,o;function n(){var n=t.apply(this,arguments);return n!==o&&(r=(o=n)&&attrInterpolateNS(e,n)),r}return n._value=t,n}function attrTween(e,t){var r,o;function n(){var n=t.apply(this,arguments);return n!==o&&(r=(o=n)&&attrInterpolate(e,n)),r}return n._value=t,n}function transition_attrTween(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;var o=namespace(e);return this.tween(r,(o.local?attrTweenNS:attrTween)(o,t))}function delayFunction(e,t){return function(){init(this,e).delay=+t.apply(this,arguments)}}function delayConstant(e,t){return t=+t,function(){init(this,e).delay=t}}function transition_delay(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?delayFunction:delayConstant)(t,e)):get$2(this.node(),t).delay}function durationFunction(e,t){return function(){set$1(this,e).duration=+t.apply(this,arguments)}}function durationConstant(e,t){return t=+t,function(){set$1(this,e).duration=t}}function transition_duration(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?durationFunction:durationConstant)(t,e)):get$2(this.node(),t).duration}function easeConstant(e,t){if("function"!=typeof t)throw new Error;return function(){set$1(this,e).ease=t}}function transition_ease(e){var t=this._id;return arguments.length?this.each(easeConstant(t,e)):get$2(this.node(),t).ease}function easeVarying(e,t){return function(){var r=t.apply(this,arguments);if("function"!=typeof r)throw new Error;set$1(this,e).ease=r}}function transition_easeVarying(e){if("function"!=typeof e)throw new Error;return this.each(easeVarying(this._id,e))}function transition_filter(e){"function"!=typeof e&&(e=matcher(e));for(var t=this._groups,r=t.length,o=new Array(r),n=0;n<r;++n)for(var i,a=t[n],s=a.length,l=o[n]=[],c=0;c<s;++c)(i=a[c])&&e.call(i,i.__data__,c,a)&&l.push(i);return new Transition(o,this._parents,this._name,this._id)}function transition_merge(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,o=t.length,n=r.length,i=Math.min(o,n),a=new Array(o),s=0;s<i;++s)for(var l,c=t[s],d=r[s],u=c.length,p=a[s]=new Array(u),h=0;h<u;++h)(l=c[h]||d[h])&&(p[h]=l);for(;s<o;++s)a[s]=t[s];return new Transition(a,this._parents,this._name,this._id)}function start(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}function onFunction(e,t,r){var o,n,i=start(t)?init:set$1;return function(){var a=i(this,e),s=a.on;s!==o&&(n=(o=s).copy()).on(t,r),a.on=n}}function transition_on(e,t){var r=this._id;return arguments.length<2?get$2(this.node(),r).on.on(e):this.each(onFunction(r,e,t))}function removeFunction(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function transition_remove(){return this.on("end.remove",removeFunction(this._id))}function transition_select(e){var t=this._name,r=this._id;"function"!=typeof e&&(e=selector(e));for(var o=this._groups,n=o.length,i=new Array(n),a=0;a<n;++a)for(var s,l,c=o[a],d=c.length,u=i[a]=new Array(d),p=0;p<d;++p)(s=c[p])&&(l=e.call(s,s.__data__,p,c))&&("__data__"in s&&(l.__data__=s.__data__),u[p]=l,schedule(u[p],t,r,p,u,get$2(s,r)));return new Transition(i,this._parents,t,r)}function transition_selectAll(e){var t=this._name,r=this._id;"function"!=typeof e&&(e=selectorAll(e));for(var o=this._groups,n=o.length,i=[],a=[],s=0;s<n;++s)for(var l,c=o[s],d=c.length,u=0;u<d;++u)if(l=c[u]){for(var p,h=e.call(l,l.__data__,u,c),f=get$2(l,r),g=0,m=h.length;g<m;++g)(p=h[g])&&schedule(p,t,r,g,h,f);i.push(h),a.push(l)}return new Transition(i,a,t,r)}var Selection$1=selection.prototype.constructor;function transition_selection(){return new Selection$1(this._groups,this._parents)}function styleNull(e,t){var r,o,n;return function(){var i=styleValue(this,e),a=(this.style.removeProperty(e),styleValue(this,e));return i===a?null:i===r&&a===o?n:n=t(r=i,o=a)}}function styleRemove$1(e){return function(){this.style.removeProperty(e)}}function styleConstant$1(e,t,r){var o,n,i=r+"";return function(){var a=styleValue(this,e);return a===i?null:a===o?n:n=t(o=a,r)}}function styleFunction$1(e,t,r){var o,n,i;return function(){var a=styleValue(this,e),s=r(this),l=s+"";return null==s&&(this.style.removeProperty(e),l=s=styleValue(this,e)),a===l?null:a===o&&l===n?i:(n=l,i=t(o=a,s))}}function styleMaybeRemove(e,t){var r,o,n,i,a="style."+t,s="end."+a;return function(){var l=set$1(this,e),c=l.on,d=null==l.value[a]?i||(i=styleRemove$1(t)):void 0;c===r&&n===d||(o=(r=c).copy()).on(s,n=d),l.on=o}}function transition_style(e,t,r){var o="transform"==(e+="")?interpolateTransformCss:interpolate;return null==t?this.styleTween(e,styleNull(e,o)).on("end.style."+e,styleRemove$1(e)):"function"==typeof t?this.styleTween(e,styleFunction$1(e,o,tweenValue(this,"style."+e,t))).each(styleMaybeRemove(this._id,e)):this.styleTween(e,styleConstant$1(e,o,t),r).on("end.style."+e,null)}function styleInterpolate(e,t,r){return function(o){this.style.setProperty(e,t.call(this,o),r)}}function styleTween(e,t,r){var o,n;function i(){var i=t.apply(this,arguments);return i!==n&&(o=(n=i)&&styleInterpolate(e,i,r)),o}return i._value=t,i}function transition_styleTween(e,t,r){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(null==t)return this.tween(o,null);if("function"!=typeof t)throw new Error;return this.tween(o,styleTween(e,t,null==r?"":r))}function textConstant$1(e){return function(){this.textContent=e}}function textFunction$1(e){return function(){var t=e(this);this.textContent=null==t?"":t}}function transition_text(e){return this.tween("text","function"==typeof e?textFunction$1(tweenValue(this,"text",e)):textConstant$1(null==e?"":e+""))}function textInterpolate(e){return function(t){this.textContent=e.call(this,t)}}function textTween(e){var t,r;function o(){var o=e.apply(this,arguments);return o!==r&&(t=(r=o)&&textInterpolate(o)),t}return o._value=e,o}function transition_textTween(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,textTween(e))}function transition_transition(){for(var e=this._name,t=this._id,r=newId(),o=this._groups,n=o.length,i=0;i<n;++i)for(var a,s=o[i],l=s.length,c=0;c<l;++c)if(a=s[c]){var d=get$2(a,t);schedule(a,e,r,c,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Transition(o,this._parents,e,r)}function transition_end(){var e,t,r=this,o=r._id,n=r.size();return new Promise((function(i,a){var s={value:a},l={value:function(){0==--n&&i()}};r.each((function(){var r=set$1(this,o),n=r.on;n!==e&&((t=(e=n).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),r.on=t})),0===n&&i()}))}var id=0;function Transition(e,t,r,o){this._groups=e,this._parents=t,this._name=r,this._id=o}function newId(){return++id}var selection_prototype=selection.prototype;function cubicInOut(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}Transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,textTween:transition_textTween,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease,easeVarying:transition_easeVarying,end:transition_end,[Symbol.iterator]:selection_prototype[Symbol.iterator]};var defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function selection_transition(e){var t,r;e instanceof Transition?(t=e._id,e=e._name):(t=newId(),(r=defaultTiming).time=now(),e=null==e?null:e+"");for(var o=this._groups,n=o.length,i=0;i<n;++i)for(var a,s=o[i],l=s.length,c=0;c<l;++c)(a=s[c])&&schedule(a,e,t,c,s,r||inherit(a,t));return new Transition(o,this._parents,e,t)}selection.prototype.interrupt=selection_interrupt,selection.prototype.transition=selection_transition;var css_248z$f=css`:host{width:100%;display:flex;flex-direction:column;background-color:#f5f5f5}.svg-tree{flex:1}.svg-tree-loader{display:none;position:absolute;width:100%;height:100%;padding-top:200px;top:0;left:0;text-align:center;background:rgba(0,0,0,.3);z-index:3000;user-select:none}.svg-tree-loader>*{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.node-loader{display:none;position:absolute;width:100%;height:20px;top:0;left:0;text-align:center;background:rgba(0,0,0,.3);z-index:3000}.node-loader>*{position:absolute;top:0;bottom:0;right:10px;margin:auto}.svg-tree-wrapper{position:relative;overflow-y:auto}.svg-tree-wrapper>svg{margin-top:15px}.svg-tree-wrapper path.link{fill:none;shape-rendering:crispEdges;stroke:#ddd;stroke-width:1;pointer-events:none}.svg-tree-wrapper .node-bg{fill:transparent}.svg-tree-wrapper .node-bg__border{display:none;pointer-events:none;fill:#9eb2c5}.svg-tree-wrapper .node-bg.ver-element,.svg-tree-wrapper .node-bg.ver-page,.svg-tree-wrapper .node-bg.ver-versions{fill:#f7c898!important}.svg-tree-wrapper .node-over:not(.node-selected){fill:#f2f2f2;stroke-width:1px;stroke:#d7d7d7}.svg-tree-wrapper .node-selected{fill:#fff;stroke-width:1px;stroke:#d7d7d7}.svg-tree-wrapper .nodes-wrapper{cursor:pointer}.svg-tree-wrapper .nodes-wrapper--dragging{cursor:-webkit-grabbing}.svg-tree-wrapper .nodes-wrapper--dragging .node-over{fill:#d7e4f1!important;stroke-width:1px;stroke:transparent}.svg-tree-wrapper .nodes-wrapper--dragging .node-alert{fill:#f6d3cf!important;stroke:#d66c68}.svg-tree-wrapper .nodes-wrapper--dragging.nodes-wrapper--nodrop .node-over{fill:#f6d3cf!important}.svg-tree-wrapper .nodes-wrapper--dragging.nodes-wrapper--ok-above .node-over,.svg-tree-wrapper .nodes-wrapper--dragging.nodes-wrapper--ok-below .node-over,.svg-tree-wrapper .nodes-wrapper--dragging.nodes-wrapper--ok-between .node-over{fill:transparent!important;stroke:transparent}.svg-tree-wrapper .nodes-wrapper--nodrop{cursor:no-drop}.node-dd{position:fixed;display:none;padding:0;margin:0;border:none;background-color:#d7e4f1;box-shadow:0 1px 3px rgba(0,0,0,.3);z-index:9999}.node-dd--nodrop{background-color:#f6d3cf;border:1px solid #d66c68}.node-dd__text{display:table;vertical-align:middle;opacity:.85;padding:5px 5px 5px 20px}.node-dd__icon{padding-left:3px;padding-right:3px}.node-dd__icon,.node-dd__name{display:table-cell;vertical-align:top}.node-dd__ctrl-icon{position:absolute;top:3px;left:3px;display:block;width:16px;height:16px;background-color:transparent;background-position:50%;background-repeat:no-repeat;z-index:1}.nodes-drop-zone[data-open=false]{display:none}.nodes-drop-zone rect{fill:#d66c68;cursor:-webkit-grabbing}.nodes-drop-zone text{pointer-events:none}.node-edit{position:absolute;top:0;left:0}.svg-toolbar{min-height:6.25rem;padding:4px 10px 0;border-bottom:1px solid #c3c3c3;background-color:#eee}.svg-toolbar__btn{padding:0;border:none;background:transparent}.svg-toolbar__btn:focus{outline:none}.svg-toolbar__menu{margin-bottom:4px}.svg-toolbar__menu .x-btn:last-child{float:right}.svg-toolbar__submenu{margin:0 -5px}.svg-toolbar__submenu .search-input{max-height:26px}.svg-toolbar__submenu-item{display:none}.svg-toolbar__submenu-item.active{display:block}.svg-toolbar__drag-node{display:inline-block;cursor:move;padding:5px;border:none;background:0 0;font-size:11px;line-height:16px}.node-stop{fill:#d66c68}.node-mount-point{display:table;width:100%;max-width:265px;margin:10px 10px 0;box-shadow:inset 0 0 0 1px rgba(0,0,0,.1);border:0;background-color:#6daae0;color:#fff;padding:11px;border-radius:2px}.node-mount-point__icon{display:table-cell;width:1%}.node-mount-point__icon[data-tree-icon=actions-close]{cursor:pointer}.node-mount-point__text{display:table-cell;padding-left:10px;padding-right:10px}.node-mount-point__text>div{max-width:185px;overflow:hidden}`;class Typo3SvgTree extends LitElement{constructor(){super(...arguments),this.nodes=[],this.expandedNodeIds=[],this.selectedNodeIds=[],this.inDropMode=!1,this.exclusiveSelectedNode=null,this.processedNodes=[],this.data={nodes:[],links:[],icons:{}},this.isOverSvg=!1,this.settings={showCheckboxes:!1,showIcons:!1,marginTop:15,nodeHeight:20,indentWidth:16,width:300,duration:400,dataUrl:"",validation:{maxItems:Number.MAX_VALUE},defaultProperties:{},unselectableElements:[],expandUpToLevel:null,readOnlyMode:!1,exclusiveNodesIdentifiers:""},this._setWrapperHeight=()=>{this.wrapper.style.height=this.offsetHeight+"px"}}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this._setWrapperHeight)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("resize",this._setWrapperHeight)}firstUpdated(){this._setWrapperHeight(),this.dispatch=dispatch$1("updateNodes","updateSvg","loadDataAfter","prepareLoadedNode","nodeSelectedAfter","nodeRightClick","contextmenu"),this.d3Wrapper=select(this.wrapper),this.svg=this.d3Wrapper.append("svg").attr("version","1.1").attr("width","100%").on("mouseover",(()=>{this.isOverSvg=!0})).on("mouseout",(()=>{this.isOverSvg=!1})).on("keydown",(e=>this.handleKeyboardInteraction(e))),this.container=this.svg.append("g").attr("class","nodes-wrapper").attr("transform","translate("+this.settings.indentWidth/2+","+this.settings.nodeHeight/2+")"),this.nodesBgContainer=this.container.append("g").attr("class","nodes-bg"),this.linksContainer=this.container.append("g").attr("class","links"),this.nodesContainer=this.container.append("g").attr("class","nodes").attr("role","tree"),this._updateScrollPosition()}updated(e){if(super.update(e),e.has("nodes"))this._nodesAddPlaceholder(),this._replaceData(this.nodes),this._nodesRemovePlaceholder();else if(e.has("selectedNodeIds")){const t=e.get("selectedNodeIds");!1===isEqual(this.selectedNodeIds,t)&&this._update()}e.has("inDropMode")&&this.container.classed("nodes-wrapper--dragging",this.inDropMode)}render(){return html`<div id="typo3-filetree" class="svg-tree"><div><div id="typo3-pagetree-treeContainer"><div id="typo3-pagetree-tree" class="svg-tree-wrapper"><div class="node-loader"></div></div></div></div><div class="svg-tree-loader"></div></div>`}_updateScrollPosition(){this.viewportHeight=this.wrapper.clientHeight,this.scrollBottom=this.scrollTop+this.viewportHeight+this.viewportHeight/2}_nodesAddPlaceholder(e){e?(this.nodeLoader.style.top=e.y+this.settings.marginTop+"px",this.nodeLoader.style.display="block"):this.svgTreeLoader.style.display="block"}_nodesRemovePlaceholder(){this.nodeLoader.style.display="none",this.svgTreeLoader.style.display="none"}_replaceData(e){this._setParametersNode(e),this.dispatch.call("loadDataAfter",this),this._prepareDataForVisibleNodes(),this.nodesContainer.selectAll(".node").remove(),this.nodesBgContainer.selectAll(".node-bg").remove(),this.linksContainer.selectAll(".link").remove(),this._update()}_setParametersNode(e){1===(e=e.map(((t,r)=>{if(void 0===t.command&&(t=Object.assign({},this.settings.defaultProperties,t)),t.parents=[],t.parentsStateIdentifier=[],t._isDragged=!1,t.depth>0){let o=t.depth;for(let n=r;n>=0;n--){const r=e[n];r.depth<o&&(t.parents.push(n),t.parentsStateIdentifier.push(e[n].stateIdentifier),o=r.depth)}}if(t.canToggle=t.hasChildren,!t.stateIdentifier){const e=t.parents.length?t.parents[t.parents.length-1]:t.identifier;t.stateIdentifier=e+"_"+t.identifier}return!1===t.selectable&&this.settings.unselectableElements.push(t.identifier),this.dispatch.call("prepareLoadedNode",this,t),t}))).filter((e=>0===e.depth)).length&&(e[0].canToggle=!1),this.processedNodes=e}_prepareDataForVisibleNodes(){const e={};this.processedNodes.map(((t,r)=>{this._isNodeExpanded(t)||(e[r]=!0)})),this.data.nodes=this.processedNodes.filter((t=>!0!==t.hidden&&!t.parents.some((t=>Boolean(e[t]))))),this.data.links=[];let t=0;this.data.nodes.forEach(((e,r)=>{e.x=e.depth*this.settings.indentWidth,e.readableRootline&&(t+=this.settings.nodeHeight),e.y=r*this.settings.nodeHeight+t,void 0!==e.parents[0]&&this.data.links.push({source:this.processedNodes[e.parents[0]],target:e}),this.settings.showIcons&&(this._fetchIcon(e.icon),this._fetchIcon(e.overlayIcon),e.locked&&this._fetchIcon("warning-in-use"))})),this.svg.attr("height",this.data.nodes.length*this.settings.nodeHeight+this.settings.nodeHeight/2+t)}_fetchIcon(e,t=!0){}_update(){const e=Math.ceil(this.viewportHeight/this.settings.nodeHeight+1),t=Math.floor(Math.max(this.scrollTop-2*this.settings.nodeHeight,0)/this.settings.nodeHeight),r=this.data.nodes.slice(t,t+e),o=this.wrapper.querySelector('[tabindex="0"]'),n=r.find((e=>-1!=this.selectedNodeIds.indexOf(e.identifier)));let i=this.nodesContainer.selectAll(".node").data(r,(e=>e.stateIdentifier));const a=this.nodesBgContainer.selectAll(".node-bg").data(r,(e=>e.stateIdentifier));i.exit().remove(),a.exit().remove();const s=this._updateNodeBgClass(a);s.attr("class",((e,t)=>this._getNodeBgClass(e,t,s))).attr("style",(e=>e.backgroundColor?"fill: "+e.backgroundColor+";":"")),this._updateLinks(),i=this._enterSvgElements(i),i.attr("tabindex",(function(e,t){if(void 0!==n){if(n===e)return"0"}else if(null===o){if(0===t)return"0"}else if(select(o).datum()===e)return"0";return"-1"})).attr("transform",this._getNodeTransform).select(".node-name").text(this._getNodeLabel),i.select(".chevron").attr("transform",(e=>this._getChevronTransform(e))).style("fill",(e=>this._getChevronColor(e))).attr("class",(e=>this._getChevronClass(e))),i.select(".toggle").attr("visibility",(e=>this._getToggleVisibility(e))),this.settings.showIcons&&(i.select("use.node-icon").attr("xlink:href",this._getIconId).attr("width","16px").attr("height","16px"),i.select("use.node-icon-overlay").attr("xlink:href",this._getIconOverlayId).attr("width","11px").attr("height","11px")),this.dispatch.call("updateNodes",this,i)}_updateNodeBgClass(e){return e.enter().append("rect").merge(e).attr("width","100%").attr("height",this.settings.nodeHeight).attr("data-state-id",this._getNodeStateIdentifier).attr("transform",this._getNodeBgTransform).on("mouseover",((e,t)=>{this._nodeBgEvents().mouseOver(t,this)})).on("mouseout",((e,t)=>{this._nodeBgEvents().mouseOut(t,this)})).on("click",((e,t)=>{this._selectNode(t),this._switchFocusNode(t)})).on("contextmenu",((e,t)=>{this._onContextmenu(e,t)}))}_nodeBgEvents(){const e={};return e.mouseOver=e=>{const t=this.svg.select('.nodes-bg .node-bg[data-state-id="'+e.stateIdentifier+'"]');e.isOver=!0,t.size()&&t.classed("node-over",!0).attr("rx","3").attr("ry","3")},e.mouseOut=e=>{const t=this.svg.select('.nodes-bg .node-bg[data-state-id="'+e.stateIdentifier+'"]');e.isOver=!1,t.size()&&t.classed("node-over node-alert",!1).attr("rx","0").attr("ry","0")},e}_updateLinks(){const e=this.data.links.filter((e=>e.source.y<=this.scrollBottom&&e.target.y>=this.scrollTop-this.settings.nodeHeight));e.forEach((e=>{e.source.owns=e.source.owns||[],e.source.owns.push("identifier-"+e.target.stateIdentifier)}));const t=this.linksContainer.selectAll(".link").data(e);t.exit().remove(),t.enter().append("path").attr("class","link").attr("id",this._getGroupIdentifier).attr("role",(e=>1===e.target.siblingsPosition&&e.source.owns.length>0?"group":null)).attr("aria-owns",(e=>1===e.target.siblingsPosition&&e.source.owns.length>0?e.source.owns.join(" "):null)).merge(t).attr("d",this._getLinkPath.bind(this))}_getGroupIdentifier(e){return 1===e.target.siblingsPosition?"group-identifier-"+e.source.stateIdentifier:null}_enterSvgElements(e){this.textPosition=10;const t=this._nodesUpdate(e),r=t.append("g").attr("class","toggle").attr("visibility",this._getToggleVisibility).attr("transform","translate(-8, -8)").on("click",((e,t)=>{this._chevronClick(t)}));if(r.append("path").style("opacity",0).attr("d","M 0 0 L 16 0 L 16 16 L 0 16 Z"),r.append("path").attr("class","chevron").attr("d","M 4 3 L 13 8 L 4 13 Z"),this.settings.showIcons){this.textPosition=30;const e=t.append("g").attr("class","node-icon-container").attr("title",this._getNodeTitle).attr("data-toggle","tooltip").on("click",((e,t)=>{this._clickOnIcon(t,this)}));e.append("use").attr("class","node-icon").attr("data-uid",this._getNodeIdentifier).attr("transform","translate(8, -8)"),e.append("use").attr("transform","translate(8, -3)").attr("x",5).attr("class","node-icon-overlay"),e.append("use").attr("x",27).attr("y",-7).attr("class","node-icon-locked")}return this.dispatch.call("updateSvg",this,t),this._appendTextElement(t),e.merge(t)}_appendTextElement(e){return e.append("text").attr("dx",(e=>this.textPosition+(e.locked?15:0))).attr("dy",5).attr("class","node-name").on("click",((e,t)=>{this._clickOnLabel(t)}))}_nodesUpdate(e){return(e=e.enter().append("g").attr("class",this._getNodeClass).attr("id",(e=>"identifier-"+e.stateIdentifier)).attr("role","treeitem").attr("aria-owns",(e=>e.hasChildren?"group-identifier-"+e.stateIdentifier:null)).attr("aria-level",this._getNodeDepth).attr("aria-setsize",this._getNodeSetsize).attr("aria-posinset",this._getNodePositionInSet).attr("aria-expanded",(e=>e.hasChildren?this._isNodeExpanded(e):null)).attr("transform",this._getNodeTransform).attr("data-state-id",this._getNodeStateIdentifier).attr("title",this._getNodeTitle).on("mouseover",((e,t)=>{this._nodeBgEvents().mouseOver(t,this)})).on("mouseout dragleave",((e,t)=>{this._nodeBgEvents().mouseOut(t,this)})).on("contextmenu",((e,t)=>{this._onContextmenu(e,t)})).on("dragover",((e,t)=>{e.preventDefault(),this._nodeBgEvents().mouseOver(t,this)})).on("drop",((e,t)=>{this._onNodeDrop(e,t)}))).append("text").text((e=>e.readableRootline)).attr("class","node-rootline").attr("dx",0).attr("dy",-15).attr("visibility",(e=>e.readableRootline?"visible":"hidden")),e}_getNodeIdentifier(e){return e.identifier}_getNodeDepth(e){return e.depth}_getNodeSetsize(e){return e.siblingsCount}_getNodePositionInSet(e){return e.siblingsPosition}_getNodeStateIdentifier(e){return e.stateIdentifier}_getNodeLabel(e){return(e.prefix||"")+e.name+(e.suffix||"")}_getNodeClass(e){return"node identifier-"+e.stateIdentifier}_getNodeBgClass(e,t,r){let o="node-bg",n=null,i=null;return"object"==typeof r&&(n=r.data()[t-1],i=r.data()[t+1]),this._isNodeSelected(e)&&(o+=" node-selected"),(n&&e.depth>n.depth||!n)&&(e.firstChild=!0,o+=" node-firth-child"),(i&&e.depth>i.depth||!i)&&(e.lastChild=!0,o+=" node-last-child"),e.class&&(o+=" "+e.class),o}_getNodeTitle(e){return e.tip?e.tip:"uid="+e.identifier}_getChevronTransform(e){return this._isNodeExpanded(e)?"translate(16,0) rotate(90)":" rotate(0)"}_getChevronColor(e){return this._isNodeExpanded(e)?"#000":"#8e8e8e"}_getToggleVisibility(e){return e.canToggle?"visible":"hidden"}_getChevronClass(e){return"chevron "+(this._isNodeExpanded(e)?"expanded":"collapsed")}_getIconId(e){return e.icon}_getIconOverlayId(e){return e.overlayIcon}_getLinkPath(e){const t=e.target._isDragged?e.target._x:e.target.x,r=e.target._isDragged?e.target._y:e.target.y,o=[];return o.push("M"+e.source.x+" "+e.source.y),o.push("V"+r),o.push("H"+(t+this.settings.indentWidth/4-2)),o.join(" ")}_getNodeTransform(e){return"translate("+(e.x||0)+","+(e.y||0)+")"}_getNodeBgTransform(e){return"translate(-8, "+((e.y||0)-10)+")"}_selectNode(e){if(!this._isNodeSelectable(e))return;const t=this._isNodeSelected(e);if(this.settings.validation&&this.settings.validation.maxItems){const e=this._getSelectedNodes();if(!t&&e.length>=this.settings.validation.maxItems)return}this.dispatchEvent(new CustomEvent("typo3-node-select",{detail:e})),this.dispatch.call("nodeSelectedAfter",this,e),this._update()}_isNodeSelectable(e){return!this.settings.readOnlyMode&&-1===this.settings.unselectableElements.indexOf(e.identifier)}_isNodeExpanded(e){return-1!=this.expandedNodeIds.indexOf(e.identifier)}_isNodeSelected(e){return-1!=this.selectedNodeIds.indexOf(e.identifier)}_getSelectedNodes(){return this.processedNodes.filter((e=>-1!=this.selectedNodeIds.indexOf(e.identifier)))}_clickOnIcon(e,t){this.dispatch.call("contextmenu",e,t)}_clickOnLabel(e){this._selectNode(e)}_chevronClick(e){this._isNodeExpanded(e)?this._hideChildren(e):this._showChildren(e),this._prepareDataForVisibleNodes(),this._update()}_hideChildren(e){this.expandedNodeIds=this.expandedNodeIds.filter((t=>t!=e.identifier)),this.dispatchEvent(new CustomEvent("typo3-node-collapse",{detail:e})),this._setExpandedState(e)}_showChildren(e){this.expandedNodeIds.push(e.identifier),this.dispatchEvent(new CustomEvent("typo3-node-expand",{detail:e})),this._setExpandedState(e)}_setExpandedState(e){const t=this.shadowRoot.querySelector("#identifier-"+this._getNodeStateIdentifier(e));t&&t.toggleAttribute("aria-expanded",!!e.hasChildren&&this._isNodeExpanded(e))}expandAll(){this.processedNodes.forEach(this._showChildren.bind(this)),this._prepareDataForVisibleNodes(),this._update()}collapseAll(){this.processedNodes.forEach(this._hideChildren.bind(this)),this._prepareDataForVisibleNodes(),this._update()}_switchFocusNode(e){const t=this.querySelector("identifier-"+this._getNodeStateIdentifier(e));this._switchFocus(t)}_switchFocus(e){if(null!==e){e.parentNode.querySelectorAll("[tabindex]").forEach((e=>e.setAttribute("tabindex","-1"))),e.setAttribute("tabindex","0"),e.focus()}}_onContextmenu(e,t){this.dispatchEvent(new CustomEvent("typo3-node-contextmenu",{detail:{event:e,node:t}})),this.dispatch.call("nodeRightClick",t,this)}_onNodeDrop(e,t){this.dispatchEvent(new CustomEvent("typo3-node-drop",{detail:{event:e,node:t}}))}_getHoveredNode(){var e;return null!==(e=this.processedNodes.find((e=>e.isOver)))&&void 0!==e?e:null}handleKeyboardInteraction(e){const t=e.target,r=select(t).datum();if(-1===["Enter","Space","End","Enter","Home","ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].indexOf(e.key))return;e.preventDefault();const o=t.parentNode;switch(e.key){case"End":const e=o.lastElementChild;this.scrollTop=e.getBoundingClientRect().height+this.settings.nodeHeight-this.viewportHeight,o.scrollIntoView({behavior:"smooth",block:"end"}),this._update(),this._switchFocus(e);break;case"Home":this.scrollTop=this.nodes[0].y,this.wrapper.scrollTo({top:this.scrollTop,behavior:"smooth"}),this._update(),this._switchFocus(o.firstElementChild);break;case"ArrowLeft":if(this._isNodeExpanded(r))r.canToggle&&(this._hideChildren(r),this._prepareDataForVisibleNodes(),this._update());else if(r.parents.length>0){let e=this.nodes[r.parents[0]];this._scrollNodeIntoVisibleArea(e,"up"),this._switchFocusNode(e)}break;case"ArrowUp":this._scrollNodeIntoVisibleArea(r,"up"),this._switchFocus(t.previousSibling);break;case"ArrowRight":this._isNodeExpanded(r)?(this._scrollNodeIntoVisibleArea(r,"down"),this._switchFocus(t.nextSibling)):r.hasChildren&&(this._showChildren(r),this._prepareDataForVisibleNodes(),this._update(),this._switchFocus(t));break;case"ArrowDown":this._scrollNodeIntoVisibleArea(r,"down"),this._switchFocus(t.nextSibling);break;case"Enter":case"Space":this._selectNode(r)}}_scrollNodeIntoVisibleArea(e,t="up"){if("up"===t&&this.scrollTop>e.y-this.settings.nodeHeight)this.scrollTop=e.y-this.settings.nodeHeight;else{if(!("down"===t&&this.scrollTop+this.viewportHeight<=e.y+3*this.settings.nodeHeight))return;this.scrollTop=this.scrollTop+this.settings.nodeHeight}this.wrapper.scrollTo({top:this.scrollTop,behavior:"smooth"}),this._update()}}Typo3SvgTree.styles=[css_248z$1,css_248z$f],__decorate([property({type:Array})],Typo3SvgTree.prototype,"nodes",void 0),__decorate([property({type:Array})],Typo3SvgTree.prototype,"expandedNodeIds",void 0),__decorate([property({type:Array})],Typo3SvgTree.prototype,"selectedNodeIds",void 0),__decorate([property({type:Boolean})],Typo3SvgTree.prototype,"inDropMode",void 0),__decorate([query(".svg-tree-wrapper")],Typo3SvgTree.prototype,"wrapper",void 0),__decorate([query(".node-loader")],Typo3SvgTree.prototype,"nodeLoader",void 0),__decorate([query(".svg-tree-loader")],Typo3SvgTree.prototype,"svgTreeLoader",void 0),__decorate([query(".svg-toolbar")],Typo3SvgTree.prototype,"svgToolbar",void 0);let Typo3Filetree=class extends Typo3SvgTree{constructor(){super(),this.editable=!1,this.dragDropEnabled=!1,this.isDragging=!1,this.allowDrop=!1,this.clicks=0,this.nodeIsEdit=!1,this.settings.showIcons=!0,this.settings.defaultProperties={hasChildren:!1,nameSourceField:"title",prefix:"",suffix:"",locked:!1,loaded:!1,overlayIcon:"",selectable:!0,checked:!1,backgroundColor:"",stopPageTree:!1,class:"",readableRootline:"",isMountPoint:!1}}updated(e){super.updated(e),(e.has("allowDrop")||e.has("isDragging"))&&this.container.classed("nodes-wrapper--nodrop",this.isDragging&&!this.allowDrop)}render(){return[super.render(),this.renderDragHandler()]}renderDragHandler(){const e=this.draggedNode;return html`<div class="${classMap({"node-dd":!0,"node-dd--nodrop":!this.allowDrop,"node-dd--ok-append":this.allowDrop})}" style="${styleMap({display:this.isDragging?"block":"none"})}">${this.isDragging&&e?html`<div class="node-dd__ctrl-icon"></div><div class="node-dd__text"><div class="node-dd__icon"><svg width="16" height="16" role="img"><use xlink:href="" xlink:href="${this._getIconId(e)}"/></svg></div><span class="node-dd__name">${e.name}</span></div>`:html``}</div>`}get draggedNode(){var e;return null!==(e=this.processedNodes.find((e=>e._isDragged)))&&void 0!==e?e:null}addNode(e){var t;const r=this.processedNodes.find((t=>t.identifier===e));if(!r)return;const o=null===(t=this.svg.node())||void 0===t?void 0:t.parentNode;if(!o)return;const n={identifier:"-1",depth:r.depth+1,x:r.x,y:r.y},i=this.processedNodes.indexOf(r)+1,a=e=>{const t=this.nodes.indexOf(e);this.nodes[t-1].depth==e.depth||this.nodes[t+1]&&this.nodes[t+1].depth==e.depth||(this.nodes[t-1].hasChildren=!1),this.nodes.splice(t,1),this._setParametersNode(this.nodes),this._prepareDataForVisibleNodes(),this._update(),this._removeEditedText(),this.nodeIsEdit=!0};!1===this._isNodeExpanded(r)&&this._showChildren(r);const s=select(o);this.nodes.splice(i,0,n),this._setParametersNode(this.nodes),this._prepareDataForVisibleNodes(),this._update(),this._removeEditedText(),this.nodeIsEdit=!0;const l=this;s.append("input").attr("class","node-edit").style("top",n.y+this.settings.nodeHeight+this.settings.marginTop+"px").style("left",n.x+this.textPosition+5+"px").style("width",this.settings.width-(n.x+this.textPosition+20)+"px").style("height",this.settings.nodeHeight+"px").attr("type","text").attr("value",n.name).on("keydown",(function(e){const t=e.keyCode;if(13===t||9===t){const e=this.value.trim();e.length?(l.nodeIsEdit=!1,l._removeEditedText(),n.name=e,n.nameSourceField=n.nameSourceField||"title",l._sendAddNodeCommand(n,r)):(l.nodeIsEdit=!1,l._removeEditedText())}else 27===t&&(l.nodeIsEdit=!1,a(n))})).on("blur",(function(){if(l.nodeIsEdit){const e=this.value.trim();e.length?(l._removeEditedText(),n.name=e,n.nameSourceField=n.nameSourceField||"title",l._sendAddNodeCommand(n,r)):a(n)}})).node().select()}_selectNode(e){this.selectedNodeIds=[e.identifier],super._selectNode(e)}_clickOnLabel(e){this.clicks+=1,"0"!==e.identifier?1===this.clicks&&setTimeout((()=>{1===this.clicks?super._clickOnLabel(e):this._editNodeLabel(e),this.clicks=0}),300):super._clickOnLabel(e)}_editNodeLabel(e){var t;const r=this;if(!e.allowEdit||!r.editable)return;const o=null===(t=this.svg.node())||void 0===t?void 0:t.parentNode;if(!o)return;this._removeEditedText(),this.nodeIsEdit=!0;select(o).append("input").attr("class","node-edit").style("top",(()=>e.y+this.settings.marginTop+"px")).style("left",e.x+this.textPosition+5+"px").style("width",this.settings.width-(e.x+this.textPosition+20)+"px").style("height",this.settings.nodeHeight+"px").attr("type","text").attr("value",e.name).on("keydown",(function(t){const o=t.keyCode;if(13===o||9===o){const t=this.value.trim();t.length&&t!==e.name?(r.nodeIsEdit=!1,r._removeEditedText(),e.nameSourceField=e.nameSourceField||"title",r._sendEditNodeLabelCommand(e,t)):(r.nodeIsEdit=!1,r._removeEditedText())}else 27===o&&(r.nodeIsEdit=!1,r._removeEditedText())})).on("blur",(function(){if(r.nodeIsEdit){const t=this.value.trim();t.length&&t!==e.name&&(e.nameSourceField=e.nameSourceField||"title",r._sendEditNodeLabelCommand(e,t)),r._removeEditedText()}})).node().select()}_removeEditedText(){const e=this.d3Wrapper.selectAll(".node-edit");if(e.size())try{e.remove(),this.nodeIsEdit=!1}catch(e){}}_sendEditNodeLabelCommand(e,t){this.dispatchEvent(new CustomEvent("typo3-node-rename",{detail:{node:e,name:t}}))}_sendAddNodeCommand(e,t){this.dispatchEvent(new CustomEvent("typo3-node-add",{detail:{node:e,parentNode:t}}))}_nodesUpdate(e){const t=super._nodesUpdate(e);return this.dragDropEnabled&&t.call(this._getDragBehavior()),t}_updateNodeBgClass(e){const t=super._updateNodeBgClass(e);return this.dragDropEnabled&&t.call(this._getDragBehavior()),t}_getDragBehavior(){return drag().clickDistance(5).on("start",(e=>this.dragStart(e))).on("drag",((e,t)=>this.dragDragged(e,t))).on("end",((e,t)=>this.dragEnd(e,t)))}dragStart(e){this.isDragging=!1,this.dragData={startPageX:e.sourceEvent.pageX,startPageY:e.sourceEvent.pageY,startDrag:!1}}dragDragged(e,t){if(0===t.depth)return!1;if(!this.isDragNodeDistanceMore(e,this.dragData,10))return!1;this.dragData.startDrag=!0,t._isDragged||(t._isDragged=!0),this.isDragging=!0,this.inDropMode=!0;let r=10,o=15;e.sourceEvent&&e.sourceEvent.pageX&&(r+=e.sourceEvent.pageX),e.sourceEvent&&e.sourceEvent.pageY&&(o+=e.sourceEvent.pageY),this.dragHandler.style.left=r+"px",this.dragHandler.style.top=o+"px",this.allowDrop=!t.isOver&&this.isOverSvg}dragEnd(e,t){if(this.inDropMode=!1,document.body.style.pointerEvents="auto",!this.dragData.startDrag||!0!==this.dragDropEnabled||0===t.depth)return!1;if(this.isDragging=!1,t._isDragged=!1,this.inDropMode=!1,t.isOver)return!1;const r=this._getHoveredNode();return!!r&&(this.dispatchEvent(new CustomEvent("typo3-node-move",{detail:{event:e,node:t,target:r}})),!0)}isDragNodeDistanceMore(e,t,r){return t.startDrag||t.startPageX-r>e.sourceEvent.pageX||t.startPageX+r<e.sourceEvent.pageX||t.startPageY-r>e.sourceEvent.pageY||t.startPageY+r<e.sourceEvent.pageY}};__decorate([property({type:Boolean})],Typo3Filetree.prototype,"editable",void 0),__decorate([property({type:Boolean})],Typo3Filetree.prototype,"dragDropEnabled",void 0),__decorate([internalProperty()],Typo3Filetree.prototype,"isDragging",void 0),__decorate([internalProperty()],Typo3Filetree.prototype,"allowDrop",void 0),__decorate([query(".node-dd")],Typo3Filetree.prototype,"dragHandler",void 0),Typo3Filetree=__decorate([customElement("typo3-filetree")],Typo3Filetree);var css_248z$g=css`:host{outline:none}.grid{display:grid;grid-gap:.75rem;grid-template-columns:repeat(auto-fill,minmax(12rem,1fr))}::slotted([slot=item]){width:100%}`;let Typo3Grid=class extends LitElement{constructor(){super(...arguments),this.selectable=!1,this.hash="",this._onFocusIn=e=>{this.items.forEach((t=>{t.tabindex=t===e.target?0:-1}))},this._onItemClick=e=>{e.stopPropagation();const t=e.target;if(!1===this.selectable||!1===this.items.includes(t))return;let r=this.selectedItems;const o=e.composedPath().some((e=>"BUTTON"===e.tagName)),n=!(!e.metaKey&&!e.ctrlKey)||o;t.hasAttribute("selected")?n?(t.removeAttribute("selected"),r=this.selectedItems.filter((e=>e!=t))):(this.selectedItems.filter((e=>e!=t)).forEach((e=>e.removeAttribute("selected"))),r=[t]):(t.setAttribute("selected","selected"),n?r.push(t):(r.forEach((e=>e.removeAttribute("selected"))),r=[t])),this.dispatchEvent(new CustomEvent("typo3-grid-selection-changed",{detail:r}))},this._onKeyDown=e=>{switch(e.key){case"Escape":this.selectedItems.forEach((e=>e.removeAttribute("selected"))),this.dispatchEvent(new CustomEvent("typo3-grid-selection-changed",{detail:[]})),e.preventDefault();break;case"Enter":-1!==this.focusedElementIndex&&(this.items[this.focusedElementIndex].click(),e.preventDefault());break;case"a":(e.metaKey||e.ctrlKey)&&(this.items.forEach((e=>e.setAttribute("selected","selected"))),this.dispatchEvent(new CustomEvent("typo3-grid-selection-changed",{detail:this.items})),e.preventDefault());break;default:this.handleArrowNavigation(e)}}}updated(e){super.updated(e),e.has("hash")&&this.items.length>0&&(this.items[0].tabindex=0)}connectedCallback(){super.connectedCallback(),this.addEventListener("keydown",this._onKeyDown)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("keydown",this._onKeyDown)}render(){return html`<div class="grid"><slot name="item" @click="${this._onItemClick}" @focusin="${this._onFocusIn}"></slot></div>`}get items(){return this.slotElement.assignedElements().filter((e=>!1===e.notSelectable))}get selectedItems(){return this.items.filter((e=>e.hasAttribute("selected")))}handleArrowNavigation(e){let t=null;switch(e.key){case"ArrowRight":t=this.focusedElementIndex+1;break;case"ArrowLeft":t=this.focusedElementIndex-1;break;case"ArrowDown":t=this.focusedElementIndex+this.numOfColumns;break;case"ArrowUp":t=this.focusedElementIndex-this.numOfColumns;break;case"Home":t=0;break;case"End":t=this.items.length-1}if(null!==t&&(e.preventDefault(),this.focusElement(t),!0===e.shiftKey)){const e=this.items.slice(this.focusedElementIndex,t);this.dispatchEvent(new CustomEvent("typo3-grid-selection-changed",{detail:e}))}}get focusedElementIndex(){const e=deepActiveElementPath();if(!e.length)return-1;for(let t=e.length-1;t>=0;t--){const r=e[t];if("TYPO3-CARD"===r.tagName)return this.items.indexOf(r)}return-1}focusElement(e){const t=this.items[e];t&&t.focus()}get numOfColumns(){const e=this.grid.offsetWidth,t=parseFloat(getComputedStyle(this.grid,null).getPropertyValue("grid-template-columns")),r=parseFloat(getComputedStyle(this.grid,null).getPropertyValue("column-gap"));return Math.round((e+r)/(t+r))}};Typo3Grid.styles=[css_248z$1,css_248z$g],__decorate([query(".grid")],Typo3Grid.prototype,"grid",void 0),__decorate([query("slot")],Typo3Grid.prototype,"slotElement",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3Grid.prototype,"selectable",void 0),__decorate([property({type:String})],Typo3Grid.prototype,"hash",void 0),Typo3Grid=__decorate([customElement("typo3-grid")],Typo3Grid);var css_248z$h=css`.typo3-list{text-decoration:inherit;text-transform:inherit;margin:0;padding:var(--typo3-list-padding-y,.5rem) var(--typo3-list-padding-x,0);list-style-type:none;width:100%}`;const previousValues=new WeakMap,ifDefined=directive((e=>t=>{const r=previousValues.get(t);if(void 0===e&&t instanceof AttributePart){if(void 0!==r||!previousValues.has(t)){const e=t.committer.name;t.committer.element.removeAttribute(e)}}else e!==r&&t.setValue(e);previousValues.set(t,e)}));var KEY={UNKNOWN:"Unknown",BACKSPACE:"Backspace",ENTER:"Enter",SPACEBAR:"Spacebar",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",ARROW_LEFT:"ArrowLeft",ARROW_UP:"ArrowUp",ARROW_RIGHT:"ArrowRight",ARROW_DOWN:"ArrowDown",DELETE:"Delete",ESCAPE:"Escape"},normalizedKeys=new Set;normalizedKeys.add(KEY.BACKSPACE),normalizedKeys.add(KEY.ENTER),normalizedKeys.add(KEY.SPACEBAR),normalizedKeys.add(KEY.PAGE_UP),normalizedKeys.add(KEY.PAGE_DOWN),normalizedKeys.add(KEY.END),normalizedKeys.add(KEY.HOME),normalizedKeys.add(KEY.ARROW_LEFT),normalizedKeys.add(KEY.ARROW_UP),normalizedKeys.add(KEY.ARROW_RIGHT),normalizedKeys.add(KEY.ARROW_DOWN),normalizedKeys.add(KEY.DELETE),normalizedKeys.add(KEY.ESCAPE);var KEY_CODE={BACKSPACE:8,ENTER:13,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ESCAPE:27},mappedKeyCodes=new Map;mappedKeyCodes.set(KEY_CODE.BACKSPACE,KEY.BACKSPACE),mappedKeyCodes.set(KEY_CODE.ENTER,KEY.ENTER),mappedKeyCodes.set(KEY_CODE.SPACEBAR,KEY.SPACEBAR),mappedKeyCodes.set(KEY_CODE.PAGE_UP,KEY.PAGE_UP),mappedKeyCodes.set(KEY_CODE.PAGE_DOWN,KEY.PAGE_DOWN),mappedKeyCodes.set(KEY_CODE.END,KEY.END),mappedKeyCodes.set(KEY_CODE.HOME,KEY.HOME),mappedKeyCodes.set(KEY_CODE.ARROW_LEFT,KEY.ARROW_LEFT),mappedKeyCodes.set(KEY_CODE.ARROW_UP,KEY.ARROW_UP),mappedKeyCodes.set(KEY_CODE.ARROW_RIGHT,KEY.ARROW_RIGHT),mappedKeyCodes.set(KEY_CODE.ARROW_DOWN,KEY.ARROW_DOWN),mappedKeyCodes.set(KEY_CODE.DELETE,KEY.DELETE),mappedKeyCodes.set(KEY_CODE.ESCAPE,KEY.ESCAPE);var navigationKeys=new Set;function normalizeKey(e){var t=e.key;if(normalizedKeys.has(t))return t;var r=mappedKeyCodes.get(e.keyCode);return r||KEY.UNKNOWN}navigationKeys.add(KEY.PAGE_UP),navigationKeys.add(KEY.PAGE_DOWN),navigationKeys.add(KEY.END),navigationKeys.add(KEY.HOME),navigationKeys.add(KEY.ARROW_LEFT),navigationKeys.add(KEY.ARROW_UP),navigationKeys.add(KEY.ARROW_RIGHT),navigationKeys.add(KEY.ARROW_DOWN);var cssClasses$1={LIST_ITEM_ACTIVATED_CLASS:"mdc-list-item--activated",LIST_ITEM_CLASS:"mdc-list-item",LIST_ITEM_DISABLED_CLASS:"mdc-list-item--disabled",LIST_ITEM_SELECTED_CLASS:"mdc-list-item--selected",LIST_ITEM_TEXT_CLASS:"mdc-list-item__text",LIST_ITEM_PRIMARY_TEXT_CLASS:"mdc-list-item__primary-text",ROOT:"mdc-list"},strings$1={ACTION_EVENT:"MDCList:action",ARIA_CHECKED:"aria-checked",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role="checkbox"][aria-checked="true"]',ARIA_CHECKED_RADIO_SELECTOR:'[role="radio"][aria-checked="true"]',ARIA_CURRENT:"aria-current",ARIA_DISABLED:"aria-disabled",ARIA_ORIENTATION:"aria-orientation",ARIA_ORIENTATION_HORIZONTAL:"horizontal",ARIA_ROLE_CHECKBOX_SELECTOR:'[role="checkbox"]',ARIA_SELECTED:"aria-selected",CHECKBOX_RADIO_SELECTOR:'input[type="checkbox"], input[type="radio"]',CHECKBOX_SELECTOR:'input[type="checkbox"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:"\n    ."+cssClasses$1.LIST_ITEM_CLASS+" button:not(:disabled),\n    ."+cssClasses$1.LIST_ITEM_CLASS+" a\n  ",FOCUSABLE_CHILD_ELEMENTS:"\n    ."+cssClasses$1.LIST_ITEM_CLASS+" button:not(:disabled),\n    ."+cssClasses$1.LIST_ITEM_CLASS+" a,\n    ."+cssClasses$1.LIST_ITEM_CLASS+' input[type="radio"]:not(:disabled),\n    .'+cssClasses$1.LIST_ITEM_CLASS+' input[type="checkbox"]:not(:disabled)\n  ',RADIO_SELECTOR:'input[type="radio"]'},numbers$1={UNSET_INDEX:-1,TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS:300};const findIndexDiff=(e,t)=>{const r=Array.from(e),o=Array.from(t),n={added:[],removed:[]},i=r.sort(),a=o.sort();let s=0,l=0;for(;s<i.length||l<a.length;){const e=i[s],t=a[l];e!==t?void 0!==e&&(void 0===t||e<t)?(n.removed.push(e),s++):void 0!==t&&(void 0===e||t<e)&&(n.added.push(t),l++):(s++,l++)}return n},ELEMENTS_KEY_ALLOWED_IN=["input","button","textarea","select"];function isIndexSet(e){return e instanceof Set}const createSetFromIndex=e=>{const t=e===numbers$1.UNSET_INDEX?new Set:e;return isIndexSet(t)?new Set(t):new Set([t])};class MDCListFoundation extends MDCFoundation{constructor(e){super(Object.assign(Object.assign({},MDCListFoundation.defaultAdapter),e)),this.isMulti_=!1,this.wrapFocus_=!1,this.isVertical_=!0,this.selectedIndex_=numbers$1.UNSET_INDEX,this.focusedItemIndex_=numbers$1.UNSET_INDEX,this.useActivatedClass_=!1,this.ariaCurrentAttrValue_=null}static get strings(){return strings$1}static get numbers(){return numbers$1}static get defaultAdapter(){return{focusItemAtIndex:()=>{},getFocusedElementIndex:()=>0,getListItemCount:()=>0,isFocusInsideList:()=>!1,isRootFocused:()=>!1,notifyAction:()=>{},notifySelected:()=>{},getSelectedStateForElementIndex:()=>!1,setDisabledStateForElementIndex:()=>{},getDisabledStateForElementIndex:()=>!1,setSelectedStateForElementIndex:()=>{},setActivatedStateForElementIndex:()=>{},setTabIndexForElementIndex:()=>{},setAttributeForElementIndex:()=>{},getAttributeForElementIndex:()=>null}}setWrapFocus(e){this.wrapFocus_=e}setMulti(e){this.isMulti_=e;const t=this.selectedIndex_;if(e){if(!isIndexSet(t)){const e=t===numbers$1.UNSET_INDEX;this.selectedIndex_=e?new Set:new Set([t])}}else if(isIndexSet(t))if(t.size){const e=Array.from(t).sort();this.selectedIndex_=e[0]}else this.selectedIndex_=numbers$1.UNSET_INDEX}setVerticalOrientation(e){this.isVertical_=e}setUseActivatedClass(e){this.useActivatedClass_=e}getSelectedIndex(){return this.selectedIndex_}setSelectedIndex(e){this.isIndexValid_(e)&&(this.isMulti_?this.setMultiSelectionAtIndex_(createSetFromIndex(e)):this.setSingleSelectionAtIndex_(e))}handleFocusIn(e,t){t>=0&&this.adapter.setTabIndexForElementIndex(t,0)}handleFocusOut(e,t){t>=0&&this.adapter.setTabIndexForElementIndex(t,-1),setTimeout((()=>{this.adapter.isFocusInsideList()||this.setTabindexToFirstSelectedItem_()}),0)}handleKeydown(e,t,r){const o="ArrowLeft"===normalizeKey(e),n="ArrowUp"===normalizeKey(e),i="ArrowRight"===normalizeKey(e),a="ArrowDown"===normalizeKey(e),s="Home"===normalizeKey(e),l="End"===normalizeKey(e),c="Enter"===normalizeKey(e),d="Spacebar"===normalizeKey(e);if(this.adapter.isRootFocused())return void(n||l?(e.preventDefault(),this.focusLastElement()):(a||s)&&(e.preventDefault(),this.focusFirstElement()));let u,p=this.adapter.getFocusedElementIndex();if(!(-1===p&&(p=r,p<0))){if(this.isVertical_&&a||!this.isVertical_&&i)this.preventDefaultEvent(e),u=this.focusNextElement(p);else if(this.isVertical_&&n||!this.isVertical_&&o)this.preventDefaultEvent(e),u=this.focusPrevElement(p);else if(s)this.preventDefaultEvent(e),u=this.focusFirstElement();else if(l)this.preventDefaultEvent(e),u=this.focusLastElement();else if((c||d)&&t){const t=e.target;if(t&&"A"===t.tagName&&c)return;this.preventDefaultEvent(e),this.setSelectedIndexOnAction_(p,!0)}this.focusedItemIndex_=p,void 0!==u&&(this.setTabindexAtIndex_(u),this.focusedItemIndex_=u)}}handleSingleSelection(e,t,r){e!==numbers$1.UNSET_INDEX&&(this.setSelectedIndexOnAction_(e,t,r),this.setTabindexAtIndex_(e),this.focusedItemIndex_=e)}focusNextElement(e){let t=e+1;if(t>=this.adapter.getListItemCount()){if(!this.wrapFocus_)return e;t=0}return this.adapter.focusItemAtIndex(t),t}focusPrevElement(e){let t=e-1;if(t<0){if(!this.wrapFocus_)return e;t=this.adapter.getListItemCount()-1}return this.adapter.focusItemAtIndex(t),t}focusFirstElement(){return this.adapter.focusItemAtIndex(0),0}focusLastElement(){const e=this.adapter.getListItemCount()-1;return this.adapter.focusItemAtIndex(e),e}setEnabled(e,t){this.isIndexValid_(e)&&this.adapter.setDisabledStateForElementIndex(e,!t)}preventDefaultEvent(e){const t=(""+e.target.tagName).toLowerCase();-1===ELEMENTS_KEY_ALLOWED_IN.indexOf(t)&&e.preventDefault()}setSingleSelectionAtIndex_(e,t=!0){this.selectedIndex_!==e&&(this.selectedIndex_!==numbers$1.UNSET_INDEX&&(this.adapter.setSelectedStateForElementIndex(this.selectedIndex_,!1),this.useActivatedClass_&&this.adapter.setActivatedStateForElementIndex(this.selectedIndex_,!1)),t&&this.adapter.setSelectedStateForElementIndex(e,!0),this.useActivatedClass_&&this.adapter.setActivatedStateForElementIndex(e,!0),this.setAriaForSingleSelectionAtIndex_(e),this.selectedIndex_=e,this.adapter.notifySelected(e))}setMultiSelectionAtIndex_(e,t=!0){const r=createSetFromIndex(this.selectedIndex_),o=findIndexDiff(r,e);if(o.removed.length||o.added.length){for(const e of o.removed)t&&this.adapter.setSelectedStateForElementIndex(e,!1),this.useActivatedClass_&&this.adapter.setActivatedStateForElementIndex(e,!1);for(const e of o.added)t&&this.adapter.setSelectedStateForElementIndex(e,!0),this.useActivatedClass_&&this.adapter.setActivatedStateForElementIndex(e,!0);this.selectedIndex_=e,this.adapter.notifySelected(e,o)}}setAriaForSingleSelectionAtIndex_(e){this.selectedIndex_===numbers$1.UNSET_INDEX&&(this.ariaCurrentAttrValue_=this.adapter.getAttributeForElementIndex(e,strings$1.ARIA_CURRENT));const t=null!==this.ariaCurrentAttrValue_,r=t?strings$1.ARIA_CURRENT:strings$1.ARIA_SELECTED;this.selectedIndex_!==numbers$1.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex_,r,"false");const o=t?this.ariaCurrentAttrValue_:"true";this.adapter.setAttributeForElementIndex(e,r,o)}setTabindexAtIndex_(e){this.focusedItemIndex_===numbers$1.UNSET_INDEX&&0!==e?this.adapter.setTabIndexForElementIndex(0,-1):this.focusedItemIndex_>=0&&this.focusedItemIndex_!==e&&this.adapter.setTabIndexForElementIndex(this.focusedItemIndex_,-1),this.adapter.setTabIndexForElementIndex(e,0)}setTabindexToFirstSelectedItem_(){let e=0;"number"==typeof this.selectedIndex_&&this.selectedIndex_!==numbers$1.UNSET_INDEX?e=this.selectedIndex_:isIndexSet(this.selectedIndex_)&&this.selectedIndex_.size>0&&(e=Math.min(...this.selectedIndex_)),this.setTabindexAtIndex_(e)}isIndexValid_(e){if(e instanceof Set){if(!this.isMulti_)throw new Error("MDCListFoundation: Array of index is only supported for checkbox based list");if(0===e.size)return!0;{let t=!1;for(const r of e)if(t=this.isIndexInRange_(r),t)break;return t}}if("number"==typeof e){if(this.isMulti_)throw new Error("MDCListFoundation: Expected array of index for checkbox based list but got number: "+e);return e===numbers$1.UNSET_INDEX||this.isIndexInRange_(e)}return!1}isIndexInRange_(e){const t=this.adapter.getListItemCount();return e>=0&&e<t}setSelectedIndexOnAction_(e,t,r){if(this.adapter.getDisabledStateForElementIndex(e))return;let o=e;if(this.isMulti_&&(o=new Set([e])),this.isIndexValid_(o)){if(this.isMulti_)this.toggleMultiAtIndex(e,r,t);else if(t||r)this.setSingleSelectionAtIndex_(e,t);else{this.selectedIndex_===e&&this.setSingleSelectionAtIndex_(numbers$1.UNSET_INDEX)}t&&this.adapter.notifyAction(e)}}toggleMultiAtIndex(e,t,r=!0){let o=!1;o=void 0===t?!this.adapter.getSelectedStateForElementIndex(e):t;const n=createSetFromIndex(this.selectedIndex_);o?n.add(e):n.delete(e),this.setMultiSelectionAtIndex_(n,r)}}let _$3=e=>e,_t$3;const isListItem=e=>e.hasAttribute("mwc-list-item");class ListBase extends BaseElement{constructor(){super(...arguments),this.mdcAdapter=null,this.mdcFoundationClass=MDCListFoundation,this.activatable=!1,this.multi=!1,this.wrapFocus=!1,this.itemRoles=null,this.innerRole=null,this.innerAriaLabel=null,this.rootTabbable=!1,this.previousTabindex=null,this.noninteractive=!1,this.items_=[]}get assignedElements(){const e=this.slotElement;return e?e.assignedNodes({flatten:!0}).filter(isNodeElement):[]}get items(){return this.items_}updateItems(){const e=this.assignedElements,t=[];for(const r of e)isListItem(r)&&(t.push(r),r._managingList=this),r.hasAttribute("divider")&&!r.hasAttribute("role")&&r.setAttribute("role","separator");this.items_=t;const r=new Set;if(this.items_.forEach(((e,t)=>{this.itemRoles?e.setAttribute("role",this.itemRoles):e.removeAttribute("role"),e.selected&&r.add(t)})),this.multi)this.select(r);else{const e=r.size?r.entries().next().value[1]:-1;this.select(e)}const o=new Event("items-updated",{bubbles:!0,composed:!0});this.dispatchEvent(o)}get selected(){const e=this.index;if(!isIndexSet(e))return-1===e?null:this.items[e];const t=[];for(const r of e)t.push(this.items[r]);return t}get index(){return this.mdcFoundation?this.mdcFoundation.getSelectedIndex():-1}render(){const e=null===this.innerRole?void 0:this.innerRole,t=null===this.innerAriaLabel?void 0:this.innerAriaLabel,r=this.rootTabbable?"0":"-1";return html(_t$3||(_t$3=_$3`<ul tabindex="${0}" role="${0}" aria-label="${0}" class="mdc-list" @keydown="${0}" @focusin="${0}" @focusout="${0}" @request-selected="${0}" @list-item-rendered="${0}"><slot></slot></ul>`),r,ifDefined(e),ifDefined(t),this.onKeydown,this.onFocusIn,this.onFocusOut,this.onRequestSelected,this.onListItemConnected)}firstUpdated(){super.firstUpdated(),this.items.length||(this.mdcFoundation.setMulti(this.multi),this.layout())}onFocusIn(e){if(this.mdcFoundation&&this.mdcRoot){const t=this.getIndexOfTarget(e);this.mdcFoundation.handleFocusIn(e,t)}}onFocusOut(e){if(this.mdcFoundation&&this.mdcRoot){const t=this.getIndexOfTarget(e);this.mdcFoundation.handleFocusOut(e,t)}}onKeydown(e){if(this.mdcFoundation&&this.mdcRoot){const t=this.getIndexOfTarget(e),r=e.target,o=isListItem(r);this.mdcFoundation.handleKeydown(e,o,t)}}onRequestSelected(e){if(this.mdcFoundation){let t=this.getIndexOfTarget(e);if(-1===t&&(this.layout(),t=this.getIndexOfTarget(e),-1===t))return;if(this.items[t].disabled)return;const r=e.detail.selected,o=e.detail.source;this.mdcFoundation.handleSingleSelection(t,"interaction"===o,r),e.stopPropagation()}}getIndexOfTarget(e){const t=this.items,r=e.composedPath();for(const e of r){let r=-1;if(isNodeElement(e)&&isListItem(e)&&(r=t.indexOf(e)),-1!==r)return r}return-1}createAdapter(){return this.mdcAdapter={getListItemCount:()=>this.mdcRoot?this.items.length:0,getFocusedElementIndex:this.getFocusedItemIndex,getAttributeForElementIndex:(e,t)=>{if(!this.mdcRoot)return"";const r=this.items[e];return r?r.getAttribute(t):""},setAttributeForElementIndex:(e,t,r)=>{if(!this.mdcRoot)return;const o=this.items[e];o&&o.setAttribute(t,r)},focusItemAtIndex:e=>{const t=this.items[e];t&&t.focus()},setTabIndexForElementIndex:(e,t)=>{const r=this.items[e];r&&(r.tabindex=t)},notifyAction:e=>{const t={bubbles:!0,composed:!0};t.detail={index:e};const r=new CustomEvent("action",t);this.dispatchEvent(r)},notifySelected:(e,t)=>{const r={bubbles:!0,composed:!0};r.detail={index:e,diff:t};const o=new CustomEvent("selected",r);this.dispatchEvent(o)},isFocusInsideList:()=>doesElementContainFocus(this),isRootFocused:()=>{const e=this.mdcRoot;return e.getRootNode().activeElement===e},setDisabledStateForElementIndex:(e,t)=>{const r=this.items[e];r&&(r.disabled=t)},getDisabledStateForElementIndex:e=>{const t=this.items[e];return!!t&&t.disabled},setSelectedStateForElementIndex:(e,t)=>{const r=this.items[e];r&&(r.selected=t)},getSelectedStateForElementIndex:e=>{const t=this.items[e];return!!t&&t.selected},setActivatedStateForElementIndex:(e,t)=>{const r=this.items[e];r&&(r.activated=t)}},this.mdcAdapter}selectUi(e,t=!1){const r=this.items[e];r&&(r.selected=!0,r.activated=t)}deselectUi(e){const t=this.items[e];t&&(t.selected=!1,t.activated=!1)}select(e){this.mdcFoundation&&this.mdcFoundation.setSelectedIndex(e)}toggle(e,t){this.multi&&this.mdcFoundation.toggleMultiAtIndex(e,t)}onListItemConnected(e){const t=e.target;this.layout(-1===this.items.indexOf(t))}layout(e=!0){e&&this.updateItems();const t=this.items[0];for(const e of this.items)e.tabindex=-1;t&&(this.noninteractive?this.previousTabindex||(this.previousTabindex=t):t.tabindex=0)}getFocusedItemIndex(){if(!this.mdcRoot)return-1;if(!this.items.length)return-1;const e=deepActiveElementPath();if(!e.length)return-1;for(let t=e.length-1;t>=0;t--){const r=e[t];if(isListItem(r))return this.items.indexOf(r)}return-1}focusItemAtIndex(e){for(const e of this.items)if(0===e.tabindex){e.tabindex=-1;break}this.items[e].tabindex=0,this.items[e].focus()}focus(){const e=this.mdcRoot;e&&e.focus()}blur(){const e=this.mdcRoot;e&&e.blur()}}__decorate([query(".mdc-list")],ListBase.prototype,"mdcRoot",void 0),__decorate([query("slot")],ListBase.prototype,"slotElement",void 0),__decorate([property({type:Boolean}),observer((function(e){this.mdcFoundation&&this.mdcFoundation.setUseActivatedClass(e)}))],ListBase.prototype,"activatable",void 0),__decorate([property({type:Boolean}),observer((function(e,t){this.mdcFoundation&&this.mdcFoundation.setMulti(e),void 0!==t&&this.layout()}))],ListBase.prototype,"multi",void 0),__decorate([property({type:Boolean}),observer((function(e){this.mdcFoundation&&this.mdcFoundation.setWrapFocus(e)}))],ListBase.prototype,"wrapFocus",void 0),__decorate([property({type:String}),observer((function(e,t){void 0!==t&&this.updateItems()}))],ListBase.prototype,"itemRoles",void 0),__decorate([property({type:String})],ListBase.prototype,"innerRole",void 0),__decorate([property({type:String})],ListBase.prototype,"innerAriaLabel",void 0),__decorate([property({type:Boolean})],ListBase.prototype,"rootTabbable",void 0),__decorate([property({type:Boolean,reflect:!0}),observer((function(e){const t=this.slotElement;if(e&&t){const e=findAssignedElement(t,'[tabindex="0"]');this.previousTabindex=e,e&&e.setAttribute("tabindex","-1")}else!e&&this.previousTabindex&&(this.previousTabindex.setAttribute("tabindex","0"),this.previousTabindex=null)}))],ListBase.prototype,"noninteractive",void 0);let Typo3List=class extends ListBase{render(){const e=null===this.innerRole?void 0:this.innerRole,t=null===this.innerAriaLabel?void 0:this.innerAriaLabel,r=this.rootTabbable?"0":"-1";return html`<ul tabindex="${r}" role="${ifDefined(e)}" aria-label="${ifDefined(t)}" class="typo3-list mdc-list" @keydown="${this.onKeydown}" @focusin="${this.onFocusIn}" @focusout="${this.onFocusOut}" @request-selected="${this.onRequestSelected}" @list-item-rendered="${this.onListItemConnected}"><slot></slot></ul>`}};Typo3List.styles=[css_248z$1,css_248z$h],Typo3List=__decorate([customElement("typo3-list")],Typo3List);let Typo3ListItem=class extends Typo3ListItemBase{};Typo3ListItem=__decorate([customElement("typo3-list-item")],Typo3ListItem);let Typo3MenuItem=class extends Typo3ListItemBase{};Typo3MenuItem=__decorate([customElement("typo3-menu-item")],Typo3MenuItem);const previousValues$1=new WeakMap,unsafeHTML=directive((e=>t=>{if(!(t instanceof NodePart))throw new Error("unsafeHTML can only be used in text bindings");const r=previousValues$1.get(t);if(void 0!==r&&isPrimitive(e)&&e===r.value&&t.value===r.fragment)return;const o=document.createElement("template");o.innerHTML=e;const n=document.importNode(o.content,!0);t.setValue(n),previousValues$1.set(t,{value:e,fragment:n})}));var css_248z$i=css`:host svg{width:1rem;height:1rem}typo3-menu{--mdc-list-vertical-padding:0}`;let Typo3ContextMenu=class extends LitElement{constructor(){super(...arguments),this.currentContextMenuDetail=null,this._handleShowContextMenu=e=>{this.currentContextMenuDetail=e.detail;const t=new CustomEvent("typo3-context-menu-open");this.dispatchEvent(t),this.style.position="absolute",this.style.top=e.detail.sourceEvent.pageY+"px",this.style.left=e.detail.sourceEvent.pageX+10+"px",this.typo3Menu.show()}}connectedCallback(){super.connectedCallback(),window.addEventListener("typo3-show-context-menu",this._handleShowContextMenu)}disconnectedCallback(){window.removeEventListener("typo3-show-context-menu",this._handleShowContextMenu),super.disconnectedCallback()}render(){return html`<typo3-menu @closed="${this.onClose}" @selected="${e=>this.dispatchContextMenuItemClick(e)}">${this.menuContent}</typo3-menu>`}get menuContent(){return this.currentContextMenuDetail?Object.values(this.currentContextMenuDetail.options).map((e=>{switch(e.type){case"divider":return html`<li divider></li>`;case"item":return html`<typo3-menu-item graphic="icon"><span slot="icon">${unsafeHTML(e.icon)}</span> ${e.label}</typo3-menu-item>`;default:return html``}})):[html``]}onClose(){const e=new CustomEvent("typo3-context-menu-close");this.dispatchEvent(e),this.currentContextMenuDetail=null}dispatchContextMenuItemClick(e){var t,r,o;const n=Object.values(null!==(r=null===(t=this.currentContextMenuDetail)||void 0===t?void 0:t.options)&&void 0!==r?r:{}).filter((e=>"divider"!==e.type))[e.detail.index];if(void 0===n)return;const i=new CustomEvent("typo3-context-menu-item-click",{detail:{option:n,context:null===(o=this.currentContextMenuDetail)||void 0===o?void 0:o.context}});this.dispatchEvent(i)}};Typo3ContextMenu.styles=[css_248z$1,css_248z$i],__decorate([internalProperty()],Typo3ContextMenu.prototype,"currentContextMenuDetail",void 0),__decorate([query("typo3-menu")],Typo3ContextMenu.prototype,"typo3Menu",void 0),Typo3ContextMenu=__decorate([customElement("typo3-context-menu")],Typo3ContextMenu);let _$4=e=>e,_t$4;const style$1=css(_t$4||(_t$4=_$4`@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(.4,0,.2,1);transform:translate(var(--mdc-ripple-fg-translate-start,0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity,0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity,0)}to{opacity:0}}:host{display:block}.mdc-list{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-subtitle1-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size,1rem);line-height:1.75rem;line-height:var(--mdc-typography-subtitle1-line-height,1.75rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight,400);letter-spacing:.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing,.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform,inherit);line-height:1.5rem;margin:0;padding:8px 0;list-style-type:none;color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-background,rgba(0,0,0,.87));padding:var(--mdc-list-vertical-padding,8px) 0}.mdc-list:focus{outline:0}.mdc-list-item{height:48px}.mdc-list--dense{padding-top:4px;padding-bottom:4px;font-size:.812rem}.mdc-list ::slotted([divider]){height:0;margin:0;border:none;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgba(0,0,0,.12)}.mdc-list ::slotted([divider][padded]){margin:0 var(--mdc-list-side-padding,16px)}.mdc-list ::slotted([divider][inset]){margin-left:var(--mdc-list-inset-margin,72px);margin-right:0;width:calc(100% - var(--mdc-list-inset-margin,72px))}.mdc-list-group[dir=rtl] .mdc-list ::slotted([divider][inset]),[dir=rtl] .mdc-list-group .mdc-list ::slotted([divider][inset]){margin-left:0;margin-right:var(--mdc-list-inset-margin,72px)}.mdc-list ::slotted([divider][inset][padded]){width:calc(100% - var(--mdc-list-inset-margin,72px) - var(--mdc-list-side-padding,16px))}.mdc-list--dense ::slotted([mwc-list-item]){height:40px}.mdc-list--dense ::slotted([mwc-list]){--mdc-list-item-graphic-size:20px}.mdc-list--avatar-list.mdc-list--dense ::slotted([mwc-list-item]),.mdc-list--two-line.mdc-list--dense ::slotted([mwc-list-item]){height:60px}.mdc-list--avatar-list.mdc-list--dense ::slotted([mwc-list]){--mdc-list-item-graphic-size:36px}:host([noninteractive]){pointer-events:none;cursor:default}.mdc-list--dense ::slotted(.mdc-list-item__primary-text){display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list--dense ::slotted(.mdc-list-item__primary-text)::before{display:inline-block;width:0;height:24px;content:"";vertical-align:0}.mdc-list--dense ::slotted(.mdc-list-item__primary-text)::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}`));let List=class extends ListBase{};List.styles=style$1,List=__decorate([customElement("mwc-list")],List);var cssClasses$2={ANCHOR:"mdc-menu-surface--anchor",ANIMATING_CLOSED:"mdc-menu-surface--animating-closed",ANIMATING_OPEN:"mdc-menu-surface--animating-open",FIXED:"mdc-menu-surface--fixed",IS_OPEN_BELOW:"mdc-menu-surface--is-open-below",OPEN:"mdc-menu-surface--open",ROOT:"mdc-menu-surface"},strings$2={CLOSED_EVENT:"MDCMenuSurface:closed",OPENED_EVENT:"MDCMenuSurface:opened",FOCUSABLE_ELEMENTS:["button:not(:disabled)",'[href]:not([aria-disabled="true"])',"input:not(:disabled)","select:not(:disabled)","textarea:not(:disabled)",'[tabindex]:not([tabindex="-1"]):not([aria-disabled="true"])'].join(", ")},numbers$2={TRANSITION_OPEN_DURATION:120,TRANSITION_CLOSE_DURATION:75,MARGIN_TO_EDGE:32,ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO:.67},CornerBit,Corner;!function(e){e[e.BOTTOM=1]="BOTTOM",e[e.CENTER=2]="CENTER",e[e.RIGHT=4]="RIGHT",e[e.FLIP_RTL=8]="FLIP_RTL"}(CornerBit||(CornerBit={})),function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=4]="TOP_RIGHT",e[e.BOTTOM_LEFT=1]="BOTTOM_LEFT",e[e.BOTTOM_RIGHT=5]="BOTTOM_RIGHT",e[e.TOP_START=8]="TOP_START",e[e.TOP_END=12]="TOP_END",e[e.BOTTOM_START=9]="BOTTOM_START",e[e.BOTTOM_END=13]="BOTTOM_END"}(Corner||(Corner={}));var MDCMenuSurfaceFoundation=function(e){function t(r){var o=e.call(this,__assign(__assign({},t.defaultAdapter),r))||this;return o.isSurfaceOpen=!1,o.isQuickOpen=!1,o.isHoistedElement=!1,o.isFixedPosition=!1,o.openAnimationEndTimerId=0,o.closeAnimationEndTimerId=0,o.animationRequestId=0,o.anchorCorner=Corner.TOP_START,o.originCorner=Corner.TOP_START,o.anchorMargin={top:0,right:0,bottom:0,left:0},o.position={x:0,y:0},o}return __extends(t,e),Object.defineProperty(t,"cssClasses",{get:function(){return cssClasses$2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return strings$2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return numbers$2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Corner",{get:function(){return Corner},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},hasAnchor:function(){return!1},isElementInContainer:function(){return!1},isFocused:function(){return!1},isRtl:function(){return!1},getInnerDimensions:function(){return{height:0,width:0}},getAnchorDimensions:function(){return null},getWindowDimensions:function(){return{height:0,width:0}},getBodyDimensions:function(){return{height:0,width:0}},getWindowScroll:function(){return{x:0,y:0}},setPosition:function(){},setMaxHeight:function(){},setTransformOrigin:function(){},saveFocus:function(){},restoreFocus:function(){},notifyClose:function(){},notifyOpen:function(){}}},enumerable:!0,configurable:!0}),t.prototype.init=function(){var e=t.cssClasses,r=e.ROOT,o=e.OPEN;if(!this.adapter.hasClass(r))throw new Error(r+" class required in root element.");this.adapter.hasClass(o)&&(this.isSurfaceOpen=!0)},t.prototype.destroy=function(){clearTimeout(this.openAnimationEndTimerId),clearTimeout(this.closeAnimationEndTimerId),cancelAnimationFrame(this.animationRequestId)},t.prototype.setAnchorCorner=function(e){this.anchorCorner=e},t.prototype.flipCornerHorizontally=function(){this.originCorner=this.originCorner^CornerBit.RIGHT},t.prototype.setAnchorMargin=function(e){this.anchorMargin.top=e.top||0,this.anchorMargin.right=e.right||0,this.anchorMargin.bottom=e.bottom||0,this.anchorMargin.left=e.left||0},t.prototype.setIsHoisted=function(e){this.isHoistedElement=e},t.prototype.setFixedPosition=function(e){this.isFixedPosition=e},t.prototype.setAbsolutePosition=function(e,t){this.position.x=this.isFinite(e)?e:0,this.position.y=this.isFinite(t)?t:0},t.prototype.setQuickOpen=function(e){this.isQuickOpen=e},t.prototype.isOpen=function(){return this.isSurfaceOpen},t.prototype.open=function(){var e=this;this.isSurfaceOpen||(this.adapter.saveFocus(),this.isQuickOpen?(this.isSurfaceOpen=!0,this.adapter.addClass(t.cssClasses.OPEN),this.dimensions=this.adapter.getInnerDimensions(),this.autoposition(),this.adapter.notifyOpen()):(this.adapter.addClass(t.cssClasses.ANIMATING_OPEN),this.animationRequestId=requestAnimationFrame((function(){e.adapter.addClass(t.cssClasses.OPEN),e.dimensions=e.adapter.getInnerDimensions(),e.autoposition(),e.openAnimationEndTimerId=setTimeout((function(){e.openAnimationEndTimerId=0,e.adapter.removeClass(t.cssClasses.ANIMATING_OPEN),e.adapter.notifyOpen()}),numbers$2.TRANSITION_OPEN_DURATION)})),this.isSurfaceOpen=!0))},t.prototype.close=function(e){var r=this;void 0===e&&(e=!1),this.isSurfaceOpen&&(this.isQuickOpen?(this.isSurfaceOpen=!1,e||this.maybeRestoreFocus(),this.adapter.removeClass(t.cssClasses.OPEN),this.adapter.removeClass(t.cssClasses.IS_OPEN_BELOW),this.adapter.notifyClose()):(this.adapter.addClass(t.cssClasses.ANIMATING_CLOSED),requestAnimationFrame((function(){r.adapter.removeClass(t.cssClasses.OPEN),r.adapter.removeClass(t.cssClasses.IS_OPEN_BELOW),r.closeAnimationEndTimerId=setTimeout((function(){r.closeAnimationEndTimerId=0,r.adapter.removeClass(t.cssClasses.ANIMATING_CLOSED),r.adapter.notifyClose()}),numbers$2.TRANSITION_CLOSE_DURATION)})),this.isSurfaceOpen=!1,e||this.maybeRestoreFocus()))},t.prototype.handleBodyClick=function(e){var t=e.target;this.adapter.isElementInContainer(t)||this.close()},t.prototype.handleKeydown=function(e){var t=e.keyCode;("Escape"===e.key||27===t)&&this.close()},t.prototype.autoposition=function(){var e;this.measurements=this.getAutoLayoutmeasurements();var r=this.getoriginCorner(),o=this.getMenuSurfaceMaxHeight(r),n=this.hasBit(r,CornerBit.BOTTOM)?"bottom":"top",i=this.hasBit(r,CornerBit.RIGHT)?"right":"left",a=this.getHorizontalOriginOffset(r),s=this.getVerticalOriginOffset(r),l=this.measurements,c=l.anchorSize,d=l.surfaceSize,u=((e={})[i]=a,e[n]=s,e);c.width/d.width>numbers$2.ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO&&(i="center"),(this.isHoistedElement||this.isFixedPosition)&&this.adjustPositionForHoistedElement(u),this.adapter.setTransformOrigin(i+" "+n),this.adapter.setPosition(u),this.adapter.setMaxHeight(o?o+"px":""),this.hasBit(r,CornerBit.BOTTOM)||this.adapter.addClass(t.cssClasses.IS_OPEN_BELOW)},t.prototype.getAutoLayoutmeasurements=function(){var e=this.adapter.getAnchorDimensions(),t=this.adapter.getBodyDimensions(),r=this.adapter.getWindowDimensions(),o=this.adapter.getWindowScroll();return e||(e={top:this.position.y,right:this.position.x,bottom:this.position.y,left:this.position.x,width:0,height:0}),{anchorSize:e,bodySize:t,surfaceSize:this.dimensions,viewportDistance:{top:e.top,right:r.width-e.right,bottom:r.height-e.bottom,left:e.left},viewportSize:r,windowScroll:o}},t.prototype.getoriginCorner=function(){var e,r,o=this.originCorner,n=this.measurements,i=n.viewportDistance,a=n.anchorSize,s=n.surfaceSize,l=t.numbers.MARGIN_TO_EDGE;this.hasBit(this.anchorCorner,CornerBit.BOTTOM)?(e=i.top-l+a.height+this.anchorMargin.bottom,r=i.bottom-l-this.anchorMargin.bottom):(e=i.top-l+this.anchorMargin.top,r=i.bottom-l+a.height-this.anchorMargin.top),!(r-s.height>0)&&e>=r&&(o=this.setBit(o,CornerBit.BOTTOM));var c,d,u=this.adapter.isRtl(),p=this.hasBit(this.anchorCorner,CornerBit.FLIP_RTL),h=this.hasBit(this.anchorCorner,CornerBit.RIGHT),f=!1;(f=u&&p?!h:h)?(c=i.left+a.width+this.anchorMargin.right,d=i.right-this.anchorMargin.right):(c=i.left+this.anchorMargin.left,d=i.right+a.width-this.anchorMargin.left);var g=c-s.width>0,m=d-s.width>0,y=this.hasBit(o,CornerBit.FLIP_RTL)&&this.hasBit(o,CornerBit.RIGHT);return m&&y&&u||!g&&y?o=this.unsetBit(o,CornerBit.RIGHT):(g&&f&&u||g&&!f&&h||!m&&c>=d)&&(o=this.setBit(o,CornerBit.RIGHT)),o},t.prototype.getMenuSurfaceMaxHeight=function(e){var r=this.measurements.viewportDistance,o=0,n=this.hasBit(e,CornerBit.BOTTOM),i=this.hasBit(this.anchorCorner,CornerBit.BOTTOM),a=t.numbers.MARGIN_TO_EDGE;return n?(o=r.top+this.anchorMargin.top-a,i||(o+=this.measurements.anchorSize.height)):(o=r.bottom-this.anchorMargin.bottom+this.measurements.anchorSize.height-a,i&&(o-=this.measurements.anchorSize.height)),o},t.prototype.getHorizontalOriginOffset=function(e){var t=this.measurements.anchorSize,r=this.hasBit(e,CornerBit.RIGHT),o=this.hasBit(this.anchorCorner,CornerBit.RIGHT);if(r){var n=o?t.width-this.anchorMargin.left:this.anchorMargin.right;return this.isHoistedElement||this.isFixedPosition?n-(this.measurements.viewportSize.width-this.measurements.bodySize.width):n}return o?t.width-this.anchorMargin.right:this.anchorMargin.left},t.prototype.getVerticalOriginOffset=function(e){var t=this.measurements.anchorSize,r=this.hasBit(e,CornerBit.BOTTOM),o=this.hasBit(this.anchorCorner,CornerBit.BOTTOM);return r?o?t.height-this.anchorMargin.top:-this.anchorMargin.bottom:o?t.height+this.anchorMargin.bottom:this.anchorMargin.top},t.prototype.adjustPositionForHoistedElement=function(e){var t,r,o=this.measurements,n=o.windowScroll,i=o.viewportDistance,a=Object.keys(e);try{for(var s=__values(a),l=s.next();!l.done;l=s.next()){var c=l.value,d=e[c]||0;d+=i[c],this.isFixedPosition||("top"===c?d+=n.y:"bottom"===c?d-=n.y:"left"===c?d+=n.x:d-=n.x),e[c]=d}}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}},t.prototype.maybeRestoreFocus=function(){var e=this.adapter.isFocused(),t=document.activeElement&&this.adapter.isElementInContainer(document.activeElement);(e||t)&&this.adapter.restoreFocus()},t.prototype.hasBit=function(e,t){return Boolean(e&t)},t.prototype.setBit=function(e,t){return e|t},t.prototype.unsetBit=function(e,t){return e^t},t.prototype.isFinite=function(e){return"number"==typeof e&&isFinite(e)},t}(MDCFoundation),cachedCssTransformPropertyName_;function getTransformPropertyName(e,t){if(void 0===t&&(t=!1),void 0===cachedCssTransformPropertyName_||t){var r=e.document.createElement("div");cachedCssTransformPropertyName_="transform"in r.style?"transform":"webkitTransform"}return cachedCssTransformPropertyName_}let _$5=e=>e,_t$5;const stringToCorner={TOP_LEFT:Corner.TOP_LEFT,TOP_RIGHT:Corner.TOP_RIGHT,BOTTOM_LEFT:Corner.BOTTOM_LEFT,BOTTOM_RIGHT:Corner.BOTTOM_RIGHT,TOP_START:Corner.TOP_START,TOP_END:Corner.TOP_END,BOTTOM_START:Corner.BOTTOM_START,BOTTOM_END:Corner.BOTTOM_END};class MenuSurfaceBase extends BaseElement{constructor(){super(...arguments),this.mdcFoundationClass=MDCMenuSurfaceFoundation,this.absolute=!1,this.fullwidth=!1,this.fixed=!1,this.x=null,this.y=null,this.quick=!1,this.open=!1,this.bitwiseCorner=Corner.TOP_START,this.previousMenuCorner=null,this.menuCorner="START",this.corner="TOP_START",this.anchor=null,this.previouslyFocused=null,this.previousAnchor=null,this.onBodyClickBound=()=>{}}render(){const e={"mdc-menu-surface--fixed":this.fixed,"mdc-menu-surface--fullwidth":this.fullwidth};return html(_t$5||(_t$5=_$5`<div class="mdc-menu-surface ${0}" @keydown="${0}" @opened="${0}" @closed="${0}"><slot></slot></div>`),classMap(e),this.onKeydown,this.registerBodyClick,this.deregisterBodyClick)}createAdapter(){return Object.assign(Object.assign({},addHasRemoveClass(this.mdcRoot)),{hasAnchor:()=>!!this.anchor,notifyClose:()=>{const e=new CustomEvent("closed",{bubbles:!0,composed:!0});this.open=!1,this.mdcRoot.dispatchEvent(e)},notifyOpen:()=>{const e=new CustomEvent("opened",{bubbles:!0,composed:!0});this.open=!0,this.mdcRoot.dispatchEvent(e)},isElementInContainer:()=>!1,isRtl:()=>!!this.mdcRoot&&"rtl"===getComputedStyle(this.mdcRoot).direction,setTransformOrigin:e=>{const t=this.mdcRoot;if(!t)return;const r=getTransformPropertyName(window)+"-origin";t.style.setProperty(r,e)},isFocused:()=>doesElementContainFocus(this),saveFocus:()=>{const e=deepActiveElementPath(),t=e.length;t||(this.previouslyFocused=null),this.previouslyFocused=e[t-1]},restoreFocus:()=>{this.previouslyFocused&&"focus"in this.previouslyFocused&&this.previouslyFocused.focus()},getInnerDimensions:()=>{const e=this.mdcRoot;return e?{width:e.offsetWidth,height:e.offsetHeight}:{width:0,height:0}},getAnchorDimensions:()=>{const e=this.anchor;return e?e.getBoundingClientRect():null},getBodyDimensions:()=>({width:document.body.clientWidth,height:document.body.clientHeight}),getWindowDimensions:()=>({width:window.innerWidth,height:window.innerHeight}),getWindowScroll:()=>({x:window.pageXOffset,y:window.pageYOffset}),setPosition:e=>{const t=this.mdcRoot;t&&(t.style.left="left"in e?e.left+"px":"",t.style.right="right"in e?e.right+"px":"",t.style.top="top"in e?e.top+"px":"",t.style.bottom="bottom"in e?e.bottom+"px":"")},setMaxHeight:e=>{const t=this.mdcRoot;t&&(t.style.maxHeight=e)}})}onKeydown(e){this.mdcFoundation&&this.mdcFoundation.handleKeydown(e)}onBodyClick(e){-1===e.composedPath().indexOf(this)&&this.close()}registerBodyClick(){this.onBodyClickBound=this.onBodyClick.bind(this),document.body.addEventListener("click",this.onBodyClickBound,{passive:!0,capture:!0})}deregisterBodyClick(){document.body.removeEventListener("click",this.onBodyClickBound)}close(){this.open=!1}show(){this.open=!0}}__decorate([query(".mdc-menu-surface")],MenuSurfaceBase.prototype,"mdcRoot",void 0),__decorate([query("slot")],MenuSurfaceBase.prototype,"slotElement",void 0),__decorate([property({type:Boolean}),observer((function(e){this.mdcFoundation&&!this.fixed&&this.mdcFoundation.setIsHoisted(e)}))],MenuSurfaceBase.prototype,"absolute",void 0),__decorate([property({type:Boolean})],MenuSurfaceBase.prototype,"fullwidth",void 0),__decorate([property({type:Boolean}),observer((function(e){this.mdcFoundation&&!this.absolute&&this.mdcFoundation.setIsHoisted(e)}))],MenuSurfaceBase.prototype,"fixed",void 0),__decorate([property({type:Number}),observer((function(e){this.mdcFoundation&&null!==this.y&&null!==e&&(this.mdcFoundation.setAbsolutePosition(e,this.y),this.mdcFoundation.setAnchorMargin({left:e,top:this.y,right:-e,bottom:this.y}))}))],MenuSurfaceBase.prototype,"x",void 0),__decorate([property({type:Number}),observer((function(e){this.mdcFoundation&&null!==this.x&&null!==e&&(this.mdcFoundation.setAbsolutePosition(this.x,e),this.mdcFoundation.setAnchorMargin({left:this.x,top:e,right:-this.x,bottom:e}))}))],MenuSurfaceBase.prototype,"y",void 0),__decorate([property({type:Boolean}),observer((function(e){this.mdcFoundation&&this.mdcFoundation.setQuickOpen(e)}))],MenuSurfaceBase.prototype,"quick",void 0),__decorate([property({type:Boolean,reflect:!0}),observer((function(e,t){this.mdcFoundation&&(e?this.mdcFoundation.open():void 0!==t&&this.mdcFoundation.close())}))],MenuSurfaceBase.prototype,"open",void 0),__decorate([internalProperty(),observer((function(e){this.mdcFoundation&&this.mdcFoundation.setAnchorCorner(e)}))],MenuSurfaceBase.prototype,"bitwiseCorner",void 0),__decorate([property({type:String}),observer((function(e){if(this.mdcFoundation){const t="START"===e||"END"===e,r=null===this.previousMenuCorner,o=!r&&e!==this.previousMenuCorner,n=r&&"END"===e;t&&(o||n)&&(this.bitwiseCorner=this.bitwiseCorner^CornerBit.RIGHT,this.mdcFoundation.flipCornerHorizontally(),this.previousMenuCorner=e)}}))],MenuSurfaceBase.prototype,"menuCorner",void 0),__decorate([property({type:String}),observer((function(e){if(this.mdcFoundation&&e){let t=stringToCorner[e];"END"===this.menuCorner&&(t^=CornerBit.RIGHT),this.bitwiseCorner=t}}))],MenuSurfaceBase.prototype,"corner",void 0);let _$6=e=>e,_t$6;const style$2=css(_t$6||(_t$6=_$6`.mdc-menu-surface{display:none;position:absolute;box-sizing:border-box;max-width:calc(100vw - 32px);max-height:calc(100vh - 32px);margin:0;padding:0;transform:scale(1);transform-origin:top left;opacity:0;overflow:auto;will-change:transform,opacity;z-index:8;transition:opacity .03s linear,transform .12s cubic-bezier(0,0,.2,1),height 250ms cubic-bezier(0,0,.2,1);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);background-color:#fff;background-color:var(--mdc-theme-surface,#fff);color:#000;color:var(--mdc-theme-on-surface,#000);border-radius:4px;border-radius:var(--mdc-shape-medium,4px);transform-origin-left:top left;transform-origin-right:top right}.mdc-menu-surface:focus{outline:0}.mdc-menu-surface--open{display:inline-block;transform:scale(1);opacity:1}.mdc-menu-surface--animating-open{display:inline-block;transform:scale(.8);opacity:0}.mdc-menu-surface--animating-closed{display:inline-block;opacity:0;transition:opacity 75ms linear}.mdc-menu-surface[dir=rtl],[dir=rtl] .mdc-menu-surface{transform-origin-left:top right;transform-origin-right:top left}.mdc-menu-surface--anchor{position:relative;overflow:visible}.mdc-menu-surface--fixed{position:fixed}.mdc-menu-surface--fullwidth{width:100%}:host(:not([open])){display:none}.mdc-menu-surface{z-index:var(--mdc-menu-z-index,8)}`));let MenuSurface=class extends MenuSurfaceBase{};MenuSurface.styles=style$2,MenuSurface=__decorate([customElement("mwc-menu-surface")],MenuSurface);var cssClasses$3={MENU_SELECTED_LIST_ITEM:"mdc-menu-item--selected",MENU_SELECTION_GROUP:"mdc-menu__selection-group",ROOT:"mdc-menu"},strings$3={ARIA_CHECKED_ATTR:"aria-checked",ARIA_DISABLED_ATTR:"aria-disabled",CHECKBOX_SELECTOR:'input[type="checkbox"]',LIST_SELECTOR:".mdc-list",SELECTED_EVENT:"MDCMenu:selected"},numbers$3={FOCUS_ROOT_INDEX:-1},DefaultFocusState;!function(e){e[e.NONE=0]="NONE",e[e.LIST_ROOT=1]="LIST_ROOT",e[e.FIRST_ITEM=2]="FIRST_ITEM",e[e.LAST_ITEM=3]="LAST_ITEM"}(DefaultFocusState||(DefaultFocusState={}));var MDCMenuFoundation=function(e){function t(r){var o=e.call(this,__assign(__assign({},t.defaultAdapter),r))||this;return o.closeAnimationEndTimerId_=0,o.defaultFocusState_=DefaultFocusState.LIST_ROOT,o}return __extends(t,e),Object.defineProperty(t,"cssClasses",{get:function(){return cssClasses$3},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return strings$3},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return numbers$3},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClassToElementAtIndex:function(){},removeClassFromElementAtIndex:function(){},addAttributeToElementAtIndex:function(){},removeAttributeFromElementAtIndex:function(){},elementContainsClass:function(){return!1},closeSurface:function(){},getElementIndex:function(){return-1},notifySelected:function(){},getMenuItemCount:function(){return 0},focusItemAtIndex:function(){},focusListRoot:function(){},getSelectedSiblingOfItemAtIndex:function(){return-1},isSelectableItemAtIndex:function(){return!1}}},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.closeAnimationEndTimerId_&&clearTimeout(this.closeAnimationEndTimerId_),this.adapter.closeSurface()},t.prototype.handleKeydown=function(e){var t=e.key,r=e.keyCode;("Tab"===t||9===r)&&this.adapter.closeSurface(!0)},t.prototype.handleItemAction=function(e){var t=this,r=this.adapter.getElementIndex(e);r<0||(this.adapter.notifySelected({index:r}),this.adapter.closeSurface(),this.closeAnimationEndTimerId_=setTimeout((function(){var r=t.adapter.getElementIndex(e);r>=0&&t.adapter.isSelectableItemAtIndex(r)&&t.setSelectedIndex(r)}),MDCMenuSurfaceFoundation.numbers.TRANSITION_CLOSE_DURATION))},t.prototype.handleMenuSurfaceOpened=function(){switch(this.defaultFocusState_){case DefaultFocusState.FIRST_ITEM:this.adapter.focusItemAtIndex(0);break;case DefaultFocusState.LAST_ITEM:this.adapter.focusItemAtIndex(this.adapter.getMenuItemCount()-1);break;case DefaultFocusState.NONE:break;default:this.adapter.focusListRoot()}},t.prototype.setDefaultFocusState=function(e){this.defaultFocusState_=e},t.prototype.setSelectedIndex=function(e){if(this.validatedIndex_(e),!this.adapter.isSelectableItemAtIndex(e))throw new Error("MDCMenuFoundation: No selection group at specified index.");var t=this.adapter.getSelectedSiblingOfItemAtIndex(e);t>=0&&(this.adapter.removeAttributeFromElementAtIndex(t,strings$3.ARIA_CHECKED_ATTR),this.adapter.removeClassFromElementAtIndex(t,cssClasses$3.MENU_SELECTED_LIST_ITEM)),this.adapter.addClassToElementAtIndex(e,cssClasses$3.MENU_SELECTED_LIST_ITEM),this.adapter.addAttributeToElementAtIndex(e,strings$3.ARIA_CHECKED_ATTR,"true")},t.prototype.setEnabled=function(e,t){this.validatedIndex_(e),t?(this.adapter.removeClassFromElementAtIndex(e,cssClasses$1.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(e,strings$3.ARIA_DISABLED_ATTR,"false")):(this.adapter.addClassToElementAtIndex(e,cssClasses$1.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(e,strings$3.ARIA_DISABLED_ATTR,"true"))},t.prototype.validatedIndex_=function(e){var t=this.adapter.getMenuItemCount();if(!(e>=0&&e<t))throw new Error("MDCMenuFoundation: No list item at specified index.")},t}(MDCFoundation);let _$7=e=>e,_t$7;class MenuBase extends BaseElement{constructor(){super(...arguments),this.mdcFoundationClass=MDCMenuFoundation,this.listElement_=null,this.anchor=null,this.open=!1,this.quick=!1,this.wrapFocus=!1,this.innerRole="menu",this.corner="TOP_START",this.x=null,this.y=null,this.absolute=!1,this.multi=!1,this.activatable=!1,this.fixed=!1,this.forceGroupSelection=!1,this.fullwidth=!1,this.menuCorner="START",this.defaultFocus="LIST_ROOT",this._listUpdateComplete=null}get listElement(){return this.listElement_||(this.listElement_=this.renderRoot.querySelector("mwc-list")),this.listElement_}get items(){const e=this.listElement;return e?e.items:[]}get index(){const e=this.listElement;return e?e.index:-1}get selected(){const e=this.listElement;return e?e.selected:null}render(){const e="menu"===this.innerRole?"menuitem":"option";return html(_t$7||(_t$7=_$7`<mwc-menu-surface ?hidden="${0}" .anchor="${0}" .open="${0}" .quick="${0}" .corner="${0}" .x="${0}" .y="${0}" .absolute="${0}" .fixed="${0}" .fullwidth="${0}" .menuCorner="${0}" class="mdc-menu mdc-menu-surface" @closed="${0}" @opened="${0}" @keydown="${0}"><mwc-list rootTabbable .innerRole="${0}" .multi="${0}" class="mdc-list" .itemRoles="${0}" .wrapFocus="${0}" .activatable="${0}" @action="${0}"><slot></slot></mwc-list></mwc-menu-surface>`),!this.open,this.anchor,this.open,this.quick,this.corner,this.x,this.y,this.absolute,this.fixed,this.fullwidth,this.menuCorner,this.onClosed,this.onOpened,this.onKeydown,this.innerRole,this.multi,e,this.wrapFocus,this.activatable,this.onAction)}createAdapter(){return{addClassToElementAtIndex:(e,t)=>{const r=this.listElement;if(!r)return;const o=r.items[e];o&&("mdc-menu-item--selected"===t?this.forceGroupSelection&&!o.selected&&r.toggle(e,!0):o.classList.add(t))},removeClassFromElementAtIndex:(e,t)=>{const r=this.listElement;if(!r)return;const o=r.items[e];o&&("mdc-menu-item--selected"===t?o.selected&&r.toggle(e,!1):o.classList.remove(t))},addAttributeToElementAtIndex:(e,t,r)=>{const o=this.listElement;if(!o)return;const n=o.items[e];n&&n.setAttribute(t,r)},removeAttributeFromElementAtIndex:(e,t)=>{const r=this.listElement;if(!r)return;const o=r.items[e];o&&o.removeAttribute(t)},elementContainsClass:(e,t)=>e.classList.contains(t),closeSurface:()=>{this.open=!1},getElementIndex:e=>{const t=this.listElement;return t?t.items.indexOf(e):-1},notifySelected:()=>{},getMenuItemCount:()=>{const e=this.listElement;return e?e.items.length:0},focusItemAtIndex:e=>{const t=this.listElement;if(!t)return;const r=t.items[e];r&&r.focus()},focusListRoot:()=>{this.listElement&&this.listElement.focus()},getSelectedSiblingOfItemAtIndex:e=>{const t=this.listElement;if(!t)return-1;const r=t.items[e];if(!r||!r.group)return-1;for(let o=0;o<t.items.length;o++){if(o===e)continue;const n=t.items[o];if(n.selected&&n.group===r.group)return o}return-1},isSelectableItemAtIndex:e=>{const t=this.listElement;if(!t)return!1;const r=t.items[e];return!!r&&r.hasAttribute("group")}}}onKeydown(e){this.mdcFoundation&&this.mdcFoundation.handleKeydown(e)}onAction(e){const t=this.listElement;if(this.mdcFoundation&&t){const r=e.detail.index,o=t.items[r];o&&this.mdcFoundation.handleItemAction(o)}}onOpened(){this.open=!0,this.mdcFoundation&&this.mdcFoundation.handleMenuSurfaceOpened()}onClosed(){this.open=!1}async _getUpdateComplete(){await this._listUpdateComplete,await super._getUpdateComplete()}async firstUpdated(){super.firstUpdated();const e=this.listElement;e&&(this._listUpdateComplete=e.updateComplete,await this._listUpdateComplete)}select(e){const t=this.listElement;t&&t.select(e)}close(){this.open=!1}show(){this.open=!0}getFocusedItemIndex(){const e=this.listElement;return e?e.getFocusedItemIndex():-1}focusItemAtIndex(e){const t=this.listElement;t&&t.focusItemAtIndex(e)}layout(e=!0){const t=this.listElement;t&&t.layout(e)}}__decorate([query(".mdc-menu")],MenuBase.prototype,"mdcRoot",void 0),__decorate([query("slot")],MenuBase.prototype,"slotElement",void 0),__decorate([property({type:Object})],MenuBase.prototype,"anchor",void 0),__decorate([property({type:Boolean,reflect:!0})],MenuBase.prototype,"open",void 0),__decorate([property({type:Boolean})],MenuBase.prototype,"quick",void 0),__decorate([property({type:Boolean})],MenuBase.prototype,"wrapFocus",void 0),__decorate([property({type:String})],MenuBase.prototype,"innerRole",void 0),__decorate([property({type:String})],MenuBase.prototype,"corner",void 0),__decorate([property({type:Number})],MenuBase.prototype,"x",void 0),__decorate([property({type:Number})],MenuBase.prototype,"y",void 0),__decorate([property({type:Boolean})],MenuBase.prototype,"absolute",void 0),__decorate([property({type:Boolean})],MenuBase.prototype,"multi",void 0),__decorate([property({type:Boolean})],MenuBase.prototype,"activatable",void 0),__decorate([property({type:Boolean})],MenuBase.prototype,"fixed",void 0),__decorate([property({type:Boolean})],MenuBase.prototype,"forceGroupSelection",void 0),__decorate([property({type:Boolean})],MenuBase.prototype,"fullwidth",void 0),__decorate([property({type:String})],MenuBase.prototype,"menuCorner",void 0),__decorate([property({type:String}),observer((function(e){this.mdcFoundation&&this.mdcFoundation.setDefaultFocusState(DefaultFocusState[e])}))],MenuBase.prototype,"defaultFocus",void 0);let Typo3Menu=class extends MenuBase{constructor(){super(...arguments),this.onBodyClick=e=>{-1==e.composedPath().indexOf(this)&&this.close()}}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("click",this.onBodyClick)}onOpened(){super.onOpened(),window.addEventListener("click",this.onBodyClick,{passive:!0}),this.dispatchEvent(new Event("typo3-menu-open"))}onClosed(){super.onClosed(),window.removeEventListener("click",this.onBodyClick),this.dispatchEvent(new Event("typo3-menu-close"))}};Typo3Menu=__decorate([customElement("typo3-menu")],Typo3Menu);var css_248z$j=css`.wrapper{opacity:0;transition:visibility 0s,opacity .25s ease-in}.wrapper:not(.open){visibility:hidden}.wrapper.open{align-items:center;display:flex;justify-content:center;height:100vh;position:fixed;top:0;left:0;right:0;bottom:0;opacity:1;visibility:visible;z-index:5001}.modal{width:var(--typo3-modal-width,37.5rem);max-height:calc(100vh - 2.5rem);max-width:calc(100vw - 2.5rem);position:relative;display:flex;flex-direction:column;pointer-events:auto;background-color:var(--typo3-modal-background-color,var(--typo3-global-modal-bg));background-clip:padding-box;border:var(--typo3-modal-border-width,var(--typo3-global-modal-border-width)) solid var(--typo3-modal-border-color,var(--typo3-global-modal-border-color));border-radius:var(--typo3-modal-border-radius,var(--typo3-global-modal-border-radius));outline:0;font-size:var(--typo3-modal-font-size,var(--typo3-global-modal-font-size));z-index:5002;transition:transform .3s ease-out;transform:translateY(-3.125rem)}.wrapper.open .modal{transform:none}.btn-close{background:none;border:none;color:inherit;padding:0;margin:0;text-shadow:rgba(0,0,0,.5) 0 0 .1875rem;opacity:.5;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer}.btn-close:hover{box-shadow:none;outline:0;background:0 0;opacity:1}.btn-close .icon-actions-close{height:1rem;width:1rem;line-height:1rem;position:relative;display:inline-block;overflow:hidden;vertical-align:-22%}.btn-close .icon-actions-close svg{display:block;height:100%;width:100%;transform:translateZ(0);fill:currentColor}.btn-close:hover{text-decoration:none;opacity:var(--typo3-modal-close-btn-color-hover,.75)}.header{display:flex;justify-content:space-between;flex-shrink:0;align-items:center;padding:var(--typo3-modal-header-padding,var(--typo3-global-modal-padding));background-color:var(--typo3-global-gray-lighter);border-bottom:var(--typo3-global-modal-border-width) solid var(--typo3-global-gray-lighter);color:var(--typo3-modal-header-color,#fff)}.modal-title{font-size:.9375rem;margin:0;line-height:1.5;font-weight:500}.content{position:relative;flex:1 1 auto;padding:var(--typo3-modal-content-padding,var(--typo3-global-modal-padding));overflow-y:auto;white-space:pre-line}.footer{display:flex;align-items:center;flex-wrap:wrap;gap:var(--typo3-global-default-gap);flex-grow:1;justify-content:flex-end;border-top:1px solid #d7d7d7;border-bottom-right-radius:calc(.125rem - 1px);border-bottom-left-radius:calc(.125rem - 1px)}.footer,.header{padding:var(--typo3-modal-header-padding,var(--typo3-global-modal-padding))}:host([variant=warning]) .header{background-color:var(--typo3-modal-header-warning-background-color,var(--typo3-global-brand-warning));border-bottom-color:var(--typo3-modal-header-warning-border-color,var(--typo3-global-brand-warning-border-color));color:var(--typo3-modal-header-warning-text-color,var(--typo3-global-brand-warning-text-color))}:host([variant=danger]) .header{background-color:var(--typo3-modal-header-danger-background-color,var(--typo3-global-brand-danger));border-bottom-color:var(--typo3-modal-header-danger-border-color,var(--typo3-global-brand-danger-border-color));color:var(--typo3-modal-header-danger-text-color,var(--typo3-global-brand-danger-text-color))}:host([variant=info]) .header{background-color:var(--typo3-modal-header-info-background-color,var(--typo3-global-brand-info));border-bottom-color:var(--typo3-modal-header-info-border-color,var(--typo3-global-brand-info-border-color));color:var(--typo3-modal-header-info-text-color,var(--typo3-global-brand-info-text-color))}:host([variant=default]) .header{background-color:var(--typo3-modal-header-default-background-color,var(--typo3-global-brand-default));border-bottom-color:var(--typo3-modal-header-default-border-color,var(--typo3-global-brand-default-border-color));color:var(--typo3-modal-header-default-text-color,var(--typo3-global-brand-default-text-color))}::slotted(*){--typo3-btn-padding:var(--typo3-global-btn-padding) 1rem}`,ModalVariant;!function(e){e.warning="warning",e.error="error",e.info="info",e.default="default"}(ModalVariant||(ModalVariant={}));let Typo3Modal=class extends LitElement{constructor(){super(...arguments),this.variant=ModalVariant.default,this.open=!1,this.headline="",this.dismissible=!1}show(){this.open=!0}close(){this.open=!1}_onKeyDown(e){this.dismissible&&"Escape"===e.key&&this.close()}update(e){if(e.has("open"))if(!0===this.open){const e=new CustomEvent("typo3-modal-open");this.dispatchEvent(e),setTimeout((()=>{let e=this.modal;this.footerButtons.length>0&&(e=this.footerButtons[0]),e.focus()}),10),window.addEventListener("keydown",(e=>this._onKeyDown(e)))}else{window.removeEventListener("keydown",(e=>this._onKeyDown(e)));const e=new CustomEvent("typo3-modal-close");this.dispatchEvent(e)}super.update(e)}render(){return html`<div class="wrapper ${this.open?"open":""}" aria-hidden="${!this.open}"><typo3-overlay fixed @click="${this.close}"></typo3-overlay><div id="modal" class="modal" tabindex="-1" aria-modal="true" role="dialog">${this.headerContent}<div id="content" class="content">${this.messageContent}</div><div id="footer" class="footer">${this.footerContent}</div></div></div>`}get headerContent(){return""!==this.headline||this.dismissible?html`<div class="header">${this.headline?html`<h4 class="modal-title" slot="headline">${this.headline}</h4>`:html``} ${this.dismissible?html`<button class="btn-close" aria-label="Close" @click="${this.close}"><span class="icon-actions-close" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M11.9 5.5L9.4 8l2.5 2.5c.2.2.2.5 0 .7l-.7.7c-.2.2-.5.2-.7 0L8 9.4l-2.5 2.5c-.2.2-.5.2-.7 0l-.7-.7c-.2-.2-.2-.5 0-.7L6.6 8 4.1 5.5c-.2-.2-.2-.5 0-.7l.7-.7c.2-.2.5-.2.7 0L8 6.6l2.5-2.5c.2-.2.5-.2.7 0l.7.7c.2.2.2.5 0 .7z"></path></svg></span></button>`:html``}</div>`:html``}get messageContent(){return html`<slot></slot>`}get footerContent(){return html`<slot name="footer"></slot>`}};Typo3Modal.styles=[css_248z$1,css_248z$j],__decorate([property({type:String,reflect:!0})],Typo3Modal.prototype,"variant",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3Modal.prototype,"open",void 0),__decorate([property({type:String,reflect:!0})],Typo3Modal.prototype,"headline",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3Modal.prototype,"dismissible",void 0),__decorate([query("#modal")],Typo3Modal.prototype,"modal",void 0),__decorate([queryAssignedNodes("footer",!1,"typo3-button")],Typo3Modal.prototype,"footerButtons",void 0),Typo3Modal=__decorate([customElement("typo3-modal")],Typo3Modal);var css_248z$k=css`:host{background:var(--typo3-modal-overlay-color,#000);opacity:var(--typo3-modal-overlay-opacity,.5);height:100%;position:absolute;top:0;right:0;bottom:0;left:0;width:100%;z-index:100}:host([fixed]){position:fixed}`;let Typo3Overlay=class extends LitElement{constructor(){super(...arguments),this.fixed=!1}render(){return html``}};Typo3Overlay.styles=[css_248z$1,css_248z$k],__decorate([property({type:Boolean,reflect:!0})],Typo3Overlay.prototype,"fixed",void 0),Typo3Overlay=__decorate([customElement("typo3-overlay")],Typo3Overlay);var css_248z$l=css`:host{display:inline-block;position:relative;max-width:var(--typo3-search-width,15rem);width:100%}#form,#input{margin:0}#input{outline-offset:-.125rem;box-sizing:border-box;text-indent:0;width:100%;vertical-align:top;appearance:none;color:var(--typo3-search-input-color,var(--typo3-global-gray-dark));overflow:visible;outline:none;line-height:var(--typo3-search-line-height,var(--typo3-global-btn-line-height));padding:.25rem .5rem;border-radius:var(--typo3-search-input-border-radius,var(--typo3-global-default-border-radius));border:var(--typo3-search-input-border-width,var(--typo3-global-default-border-width)) solid var(--typo3-search-input-border-color,var(--typo3-global-brand-default-border-color));padding-left:calc(var(--typo3-search-icon-size, var(--typo3-global-btn-icon-size)) + var(--typo3-search-icon-margin-left, .5rem)*2);height:var(--typo3-search-height,1.875rem)}#reset-button{right:0;top:0;position:absolute;width:var(--typo3-search-reset-button-width,1.875rem)}::slotted([slot=search-icon]){position:absolute;left:var(--typo3-search-icon-margin-left,.5rem);top:calc(var(--typo3-search-height, 1.875rem)/2 - var(--typo3-search-icon-size, var(--typo3-global-btn-icon-size))/2);width:var(--typo3-search-icon-size,var(--typo3-global-btn-icon-size));height:var(--typo3-search-icon-size,var(--typo3-global-btn-icon-size))}`;let Typo3Search=class extends LitElement{constructor(){super(...arguments),this.disabled=!1,this.label="Search",this.placeholder="Search",this.value=""}render(){return html`<form id="form" @submit="${this.handleSubmit}" @keydown="${this.handleKeydown}"><slot name="search-icon"></slot>${this.renderInput} ${this.renderResetButton}</form>`}async reset(){this.form&&(this.value="",this.form.reset(),this.inputElement.dispatchEvent(new InputEvent("input",{bubbles:!0,composed:!0})),this.inputElement.dispatchEvent(new InputEvent("change",{bubbles:!0})),await this.updateComplete)}get renderInput(){return html`<input aria-label="${this.label||this.placeholder}" id="input" placeholder="${this.placeholder}" .value="${this.value}" @input="${this.onInput}" ?disabled="${this.disabled}" autocomplete="off">`}get renderResetButton(){return""===this.value?html``:html`<typo3-button only-icon id="reset-button" tab-index="-1" @click="${this.reset}"><slot name="reset-icon" slot="icon"></slot></typo3-button>`}onInput(){this.value=this.inputElement.value;const e=this.inputElement.selectionStart;this.updateComplete.then((()=>{this.inputElement.setSelectionRange(e,e),this.dispatchEvent(new CustomEvent("typo3-search-change",{bubbles:!0,composed:!0,detail:this.value}))}))}handleSubmit(e){e.preventDefault(),this.dispatchEvent(new CustomEvent("typo3-search-submit",{bubbles:!0,composed:!0,detail:this.value}))}handleKeydown(e){const{key:t}=e;this.value&&"Escape"===t&&this.reset()}};Typo3Search.styles=[css_248z$1,css_248z$l],__decorate([query("#form")],Typo3Search.prototype,"form",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3Search.prototype,"disabled",void 0),__decorate([property()],Typo3Search.prototype,"label",void 0),__decorate([property()],Typo3Search.prototype,"placeholder",void 0),__decorate([property({type:String})],Typo3Search.prototype,"value",void 0),__decorate([query("#input")],Typo3Search.prototype,"inputElement",void 0),Typo3Search=__decorate([customElement("typo3-search")],Typo3Search);var css_248z$m=css`:host{display:var(--typo3-snackbar-display,flex);width:var(--typo3-snackbar-width,calc(100% - 2rem));max-width:var(--typo3-snackbar-max-width,640px);position:var(--typo3-snackbar-position,fixed);bottom:var(--typo3-snackbar-bottom,1rem);left:var(--typo3-snackbar-left,1rem);z-index:var(--typo3-snackbar-z-index,5001);transform:var(--typo3-snackbar-transform,translateY(calc(100% + 1rem)));opacity:var(--typo3-snackbar-opacity,0);transition:var(--typo3-snackbar-transition,all .25s ease-out)}:host([placement=right]){left:auto;right:var(--typo3-snackbar-right,1rem)}:host typo3-alert{width:100%;height:100%;--typo3-alert-margin-bottom:0}:host([visible]){transform:var(--typo3-snackbar-visible-transform,translateY(0));opacity:var(--typo3-snackbar-visible-opacity,1)}.snackbar__body{margin:var(--typo3-snackbar-message-margin,0);padding:var(--typo3-snackbar-message-padding,0 1rem 0 0)}.snackbar__btn-close{position:absolute;top:1rem;right:1rem;font-size:var(--typo3-global-close-btn-font-size);font-weight:var(--typo3-global-close-btn-font-weight);line-height:var(--typo3-global-close-btn-line-height);color:var(--typo3-global-close-btn-color);opacity:var(--typo3-global-close-btn-opacity);text-shadow:0 1px 0 #fff;background-color:transparent;border:none;cursor:pointer;outline:none}.snackbar__btn-close:hover{text-decoration:none;opacity:.75}`,SnackbarVariants;!function(e){e.default="default",e.success="success",e.warning="warning",e.danger="danger",e.info="info"}(SnackbarVariants||(SnackbarVariants={}));let Typo3Snackbar=class extends LitElement{constructor(){super(...arguments),this.visible=!1,this.message="",this.title="",this.buttonText="OK",this.variant=SnackbarVariants.default,this.placement="left",this.dismissible=!1}render(){return html`<typo3-alert color="${this.variant}"><div class="snackbar__body">${this.title?html`<h4 class="snackbar__title">${this.title}</h4>`:html``}<p class="snackbar__message">${unsafeHTML(this.message)}</p></div><slot name="footer"></slot>${this.dismissible?html`<button class="snackbar__btn-close" @click="${this.hideSnackbar}">Ã—</button>`:""}</typo3-alert>`}hideSnackbar(){clearTimeout(this.timerAutoHide),this.addEventListener("transitionend",this._afterHide),this.visible=!1}_afterHide(){this.removeEventListener("transitionend",this._afterHide),this.dispatchEvent(new CustomEvent("typo3-snackbar-close"))}updated(e){super.updated(e),clearTimeout(this.timerAutoHide),!0===this.visible&&this.duration&&(this.timerAutoHide=window.setTimeout((()=>{this.hideSnackbar()}),this.duration))}};Typo3Snackbar.styles=[css_248z$1,css_248z$m],__decorate([property({type:Number,reflect:!0})],Typo3Snackbar.prototype,"messageId",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3Snackbar.prototype,"visible",void 0),__decorate([property({type:String,reflect:!0})],Typo3Snackbar.prototype,"message",void 0),__decorate([property({type:String})],Typo3Snackbar.prototype,"title",void 0),__decorate([property({type:String,reflect:!0})],Typo3Snackbar.prototype,"buttonText",void 0),__decorate([property({type:String,reflect:!0})],Typo3Snackbar.prototype,"variant",void 0),__decorate([property({type:String,reflect:!0})],Typo3Snackbar.prototype,"placement",void 0),__decorate([property({type:Boolean,reflect:!0})],Typo3Snackbar.prototype,"dismissible",void 0),__decorate([property({type:String,reflect:!0})],Typo3Snackbar.prototype,"duration",void 0),Typo3Snackbar=__decorate([customElement("typo3-snackbar")],Typo3Snackbar);var css_248z$n=css`@keyframes spinner-border{to{transform:rotate(1turn)}}.spinner-border{display:inline-block;width:var(--typo3-spinner-size,2rem);height:var(--typo3-spinner-size,2rem);vertical-align:text-bottom;border:var(--typo3-spinner-border-width,.25em) solid;border-right-color:transparent;border-radius:50%;-webkit-animation:spinner-border var(--typo3-spinner-animation-duration,.75s) linear infinite;animation:spinner-border var(--typo3-spinner-animation-duration,.75s) linear infinite}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}:host([color=default]){color:var(--typo3-spinner-default-color,var(--typo3-global-gray-lighter))}:host([color=primary]){color:var(--typo3-spinner-primary-color,var(--typo3-global-brand-primary))}:host([color=success]){color:var(--typo3-spinner-success-color,var(--typo3-global-brand-success))}:host([color=info]){color:var(--typo3-spinner-info-color,var(--typo3-global-brand-info))}:host([color=warning]){color:var(--typo3-spinner-warning-color,var(--typo3-global-brand-warning))}:host([color=danger]){color:var(--typo3-spinner-danger-color,var(--typo3-global-brand-danger))}`,Color$1;!function(e){e.DEFAULT="default",e.PRIMARY="primary",e.SUCCESS="success",e.INFO="info",e.WARNING="warning",e.DANGER="danger"}(Color$1||(Color$1={}));let Typo3Spinner=class extends LitElement{constructor(){super(...arguments),this.color=Color$1.PRIMARY,this.screenReaderText="Loading"}render(){return html`<div class="spinner-border" role="status"><span class="sr-only">${this.screenReaderText}</span></div>`}};Typo3Spinner.styles=[css_248z$1,css_248z$n],__decorate([property({type:String,reflect:!0})],Typo3Spinner.prototype,"color",void 0),__decorate([property({type:String,reflect:!0})],Typo3Spinner.prototype,"screenReaderText",void 0),Typo3Spinner=__decorate([customElement("typo3-spinner")],Typo3Spinner);const appliedMixins=new WeakMap;function getPrototypeChain(e){const t=[];let r=e;for(;r;)t.push(r),r=Object.getPrototypeOf(r);return t}function wasApplied(e,t){const r=appliedMixins.get(e);return!!r&&getPrototypeChain(t).reduce(((e,t)=>e||r.has(t)),!1)}function applyMixin(e,t){let r=appliedMixins.get(e);r||(r=new WeakSet,appliedMixins.set(e,r)),r.add(t)}const DownUpMixin=e=>{if(wasApplied(DownUpMixin,e))return e;class t extends e{firstUpdated(e){super.firstUpdated(e),this._downUpTarget instanceof HTMLElement&&(this._downUpTarget.addEventListener("mousedown",(e=>{this._onMouseDown(e)})),this._downUpTarget.addEventListener("touchstart",(e=>{this._onTouchStart(e)})),this._downUpTarget.addEventListener("touchend",(e=>{this._onTouchEnd(e)})))}get _downUpTarget(){return this}_onMouseDown(e){if(1!==e.buttons)return;this._onDown();const t=e=>{this._onMouseUp(e),document.removeEventListener("mouseup",t)};document.addEventListener("mouseup",t)}_onMouseUp(e){this._onUp()}_onTouchStart(e){this._onDown()}_onTouchEnd(e){this._onUp()}_onDown(){}_onUp(){}}return applyMixin(DownUpMixin,t),t},isIOS=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,TRACK_LENGTH=2,TRACK_DISTANCE=5,TOUCH_STATE={id:-1};function isMouseEvent(e){return["mousedown","mousemove","mouseup"].includes(e)}function hasLeftMouseButton(e){const{type:t}=e;let r;if("mousemove"===t){const t=void 0===e.buttons?1:e.buttons;r=Boolean(1&t)}else{r=0===(void 0===e.button?0:e.button)}return r}function trackHasMovedEnough(e,t,r){if(e.started)return!0;const o=Math.abs(e.x-t),n=Math.abs(e.y-r);return o>=TRACK_DISTANCE||n>=TRACK_DISTANCE}function fireTrack(e,t,r){const{x:o,y:n,moves:i,state:a}=e,s=i[i.length-2],l=i[i.length-1],c=l.x-o,d=l.y-n;let u=0,p=0;s&&(u=l.x-s.x,p=l.y-s.y),t.dispatchEvent(new CustomEvent("track",{bubbles:!0,cancelable:!0,composed:!0,detail:{state:a,x:r.clientX,y:r.clientY,dx:c,dy:d,ddx:u,ddy:p,sourceEvent:r}}))}function trackDocument(e,t,r){e.moveFn=t,e.upFn=r,document.addEventListener("mousemove",t),document.addEventListener("mouseup",r)}function unTrackDocument(e){document.removeEventListener("mousemove",e.moveFn),document.removeEventListener("mouseup",e.upFn),e.moveFn=void 0,e.upFn=void 0}const TrackGesture={name:"track",touchAction:"none",deps:["mousedown","touchstart","touchmove","touchend"],info:{x:0,y:0,state:"start",started:!1,moves:[],addMove(e){this.moves.length>TRACK_LENGTH&&this.moves.shift(),this.moves.push(e)},moveFn:void 0,upFn:void 0},reset(){this.info.state="start",this.info.started=!1,this.info.moves=[],this.info.x=0,this.info.y=0,unTrackDocument(this.info)},mousedown(e){if(!hasLeftMouseButton(e))return;const t=e.composedPath()[0],r=TrackGesture,o=function(e){const o=e.clientX,n=e.clientY;if(trackHasMovedEnough(r.info,o,n)){const i="mouseup"===e.type?"end":"track";r.info.state=r.info.started?i:"start",r.info.addMove({x:o,y:n}),hasLeftMouseButton(e)||(r.info.state="end",unTrackDocument(r.info)),t&&fireTrack(r.info,t,e),r.info.started=!0}};trackDocument(this.info,o,(function(e){r.info.started&&o(e),unTrackDocument(r.info)})),this.info.x=e.clientX,this.info.y=e.clientY},touchstart(e){const t=e.changedTouches[0];this.info.x=t.clientX,this.info.y=t.clientY},touchmove(e){const t=e.composedPath()[0],r=e.changedTouches[0],o=r.clientX,n=r.clientY;trackHasMovedEnough(this.info,o,n)&&(this.info.addMove({x:o,y:n}),fireTrack(this.info,t,r),this.info.state="track",this.info.started=!0)},touchend(e){const t=e.composedPath()[0],r=e.changedTouches[0];this.info.started&&(this.info.state="end",this.info.addMove({x:r.clientX,y:r.clientY}),fireTrack(this.info,t,r))}},handleNative=e=>{const{type:t}=e;if("touch"===t.slice(0,5)){const r=e,o=r.changedTouches[0];if("touchstart"===t&&1===r.touches.length&&(TOUCH_STATE.id=o.identifier),TOUCH_STATE.id!==o.identifier)return}switch("mousedown"!==t&&"touchstart"!==t||TrackGesture.reset(),t){case"mousedown":TrackGesture.mousedown(e);break;case"touchstart":TrackGesture.touchstart(e);break;case"touchmove":TrackGesture.touchmove(e);break;case"touchend":TrackGesture.touchend(e)}};function addTrackListeners(e){const{deps:t}=TrackGesture;for(let r,o=0;o<t.length;o+=1)r=t[o],!1===Boolean(isIOS&&isMouseEvent(r))&&e.addEventListener(r,handleNative);e.style.touchAction=TrackGesture.touchAction}function removeTrackListeners(e){const{deps:t}=TrackGesture;for(let r,o=0;o<t.length;o+=1)r=t[o],!1===Boolean(isIOS&&isMouseEvent(r))&&e.removeEventListener(r,handleNative)}const TrackEventMixin=e=>{if(wasApplied(TrackEventMixin,e))return e;class t extends e{get _trackTargets(){return[this]}connectedCallback(){super.connectedCallback(),this.updateComplete.then((()=>{Array.isArray(this._trackTargets)&&this._trackTargets.forEach((e=>{e instanceof HTMLElement&&addTrackListeners(e)}))}))}disconnectedCallback(){super.disconnectedCallback(),Array.isArray(this._trackTargets)&&this._trackTargets.forEach((e=>{e instanceof HTMLElement&&removeTrackListeners(e)}))}}return applyMixin(TrackEventMixin,t),t},SplitLayoutMixin=e=>{class t extends(TrackEventMixin(DownUpMixin(e))){constructor(){super(...arguments),this._processing=!1,this._startSize={container:0,primary:0,secondary:0},this._oldPointerEvents=["",""]}render(){return html`<slot id="primary" name="primary" @slotchange="${this._processChildren}"></slot><div part="splitter" id="splitter" @track="${this._onHandleTrack}"><div part="handle"></div></div><slot id="secondary" name="secondary" @slotchange="${this._processChildren}"></slot><div hidden><slot @slotchange="${this._processChildren}"></slot></div>`}firstUpdated(e){this._splitter=this.renderRoot.querySelector("#splitter"),super.firstUpdated(e),this._processChildren()}get _downUpTarget(){return this._splitter}get _trackTargets(){return[this._splitter]}_onHandleTrack(e){if(!this._primaryChild||!this._secondaryChild)return;const{state:t,dy:r,dx:o}=e.detail,n="vertical"===this.orientation?"height":"width";if("start"===t)return void(this._startSize={container:this.getBoundingClientRect()[n]-this._splitter.getBoundingClientRect()[n],primary:this._primaryChild.getBoundingClientRect()[n],secondary:this._secondaryChild.getBoundingClientRect()[n]});const i="vertical"===this.orientation,a=i?r:o,s=!i&&"rtl"===this.getAttribute("dir")?-a:a,{primary:l,secondary:c,container:d}=this._startSize;this._setFlexBasis(this._primaryChild,l+s,d),this._setFlexBasis(this._secondaryChild,c-s,d),"end"===t&&this.dispatchEvent(new CustomEvent("splitter-dragend"))}_onDown(){const{_primaryChild:e,_secondaryChild:t}=this;e&&t&&(this._oldPointerEvents=[e.style.pointerEvents||"",t.style.pointerEvents||""],e.style.pointerEvents="none",t.style.pointerEvents="none")}_onUp(){const{_primaryChild:e,_secondaryChild:t}=this;if(!e||!t)return;const[r,o]=this._oldPointerEvents;e.style.pointerEvents=r,t.style.pointerEvents=o}_processChildren(){this._processing||([this._primaryChild,this._secondaryChild].forEach(((e,t)=>{e&&e.parentElement!==this&&(e.style.flex="",e.removeAttribute("slot"),this[0===t?"_primaryChild":"_secondaryChild"]=void 0)})),this._processing=!0,Array.from(this.children).forEach(((e,t)=>{const r=e;0===t?(this._primaryChild=r,r.setAttribute("slot","primary")):1===t?(this._secondaryChild=r,r.setAttribute("slot","secondary")):r.removeAttribute("slot")})),window.requestAnimationFrame((()=>{this._processing=!1})))}_setFlexBasis(e,t,r){let o=Math.max(0,Math.min(t,r));0===o&&(o=1e-6),e.style.flex=`1 1 ${o}px`}}return __decorate([property({type:String,reflect:!0})],t.prototype,"orientation",void 0),t};var css_248z$o=css`:host{display:flex;overflow:hidden!important;transform:translateZ(0);user-select:none}:host([hidden]),[hidden]{display:none!important}:host([orientation=vertical]){flex-direction:column}:host ::slotted(*){flex:1 1 auto;overflow:auto;-webkit-overflow-scrolling:touch}[part=splitter]{display:block;flex:0 0 auto;width:var(--typo3-splitpane-splitter-size,var(--typo3-global-default-border-width));height:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:3;background-color:var(--typo3-splitpane-splitter-color,var(--typo3-global-splitpane-splitter-color));transition:background-color .2s ease-in-out,border .2s ease-in-out}[part=splitter]:hover{background-color:var(--typo3-splitpane-splitter-color-hover,var(--typo3-global-splitpane-splitter-color-hover))}[part=splitter]:after{content:"";position:absolute;top:0;height:100%;width:.5rem;margin-left:-.3125rem;border-right:.125rem solid transparent;box-sizing:border-box}[part=splitter]:hover:after{border-right:.125rem solid var(--typo3-splitpane-splitter-color-hover,var(--typo3-global-splitpane-splitter-color-hover))}:host(:not([orientation=vertical]))>[part=splitter]{cursor:ew-resize}:host([orientation=vertical])>[part=splitter]{cursor:ns-resize}[part=handle]:after{content:"";display:block;width:var(--typo3-splitpane-handle-width,var(--typo3-global-splitpane-handle-width));height:var(--typo3-splitpane-handle-height,var(--typo3-global-splitpane-handle-height));background-color:var(--typo3-splitpane-handle-background,transparent);position:absolute;top:50%;left:50%;transform:translate3d(-50%,-50%,0)}`;let Typo3Splitpane=class extends(SplitLayoutMixin(LitElement)){};Typo3Splitpane.styles=[css_248z$1,css_248z$o],Typo3Splitpane=__decorate([customElement("typo3-splitpane")],Typo3Splitpane);var css_248z$p=css`:host{position:absolute;z-index:1002;-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none;user-select:none;cursor:default;top:-1000px}#tooltip,:host{display:block;outline:none}#tooltip{visibility:visible;font-size:var(--typo3-tooltip-font-size,var(--typo3-global-tooltip-font-size));line-height:var(--typo3-tooltip-line-height,var(--typo3-global-tooltip-line-height));background-color:var(--typo3-tooltip-background,var(--typo3-global-tooltip-bg));color:var(--typo3-tooltip-text-color,var(--typo3-global-tooltip-color));padding:var(--typo3-tooltip-padding,var(--typo3-global-tooltip-padding));border-radius:var(--typo3-tooltip-border-radius,var(--typo3-global-tooltip-border-radius));max-width:var(--typo3-tooltip-max-width,var(--typo3-global-tooltip-max-width));opacity:1}#tooltip,#tooltip[hidden]{transition:var(--typo3-tooltip-transition,var(--typo3-global-tooltip-transition))}#tooltip[hidden]{visibility:hidden;opacity:0}`;let Typo3Tooltip=class extends LitElement{constructor(){super(...arguments),this.offset=14,this.position="bottom",this.isHidden=!0}render(){return html`<div id="tooltip" ?hidden="${this.isHidden}"><slot></slot></div>`}disconnectedCallback(){super.disconnectedCallback();const e=this.anchor;null==e||e.removeEventListener("mouseenter",(()=>this.show())),null==e||e.removeEventListener("focus",(()=>this.show())),null==e||e.removeEventListener("mouseleave",(()=>this.hide())),null==e||e.removeEventListener("blur",(()=>this.hide())),null==e||e.removeEventListener("tap",(()=>this.hide()))}show(){this.isHidden=!1,this.updatePosition()}hide(){this.isHidden=!0}updated(e){super.updated(e);const t=this.anchor;null==t||t.addEventListener("mouseenter",(()=>this.show())),null==t||t.addEventListener("focus",(()=>this.show())),null==t||t.addEventListener("mouseleave",(()=>this.hide())),null==t||t.addEventListener("blur",(()=>this.hide())),null==t||t.addEventListener("tap",(()=>this.hide()))}updatePosition(){if(!this.anchor)return;const e=this.offset,t=this.offsetParent.getBoundingClientRect(),r=this.anchor.getBoundingClientRect(),o=this.tooltipHtmlElement.getBoundingClientRect(),n=(r.width-o.width)/2,i=(r.height-o.height)/2,a=r.left-t.left,s=r.top-t.top;let l=0,c=0;switch(this.position){case"top":l=a+n,c=s-o.height-e;break;case"left":l=a-o.width-e,c=s+i;break;case"right":l=a+r.width+e,c=s+i;break;case"bottom":default:l=a+n,c=s+r.height+e}this.style.left=l+"px",this.style.top=c+"px"}};Typo3Tooltip.styles=[css_248z$1,css_248z$p],__decorate([property({type:HTMLElement})],Typo3Tooltip.prototype,"anchor",void 0),__decorate([property({type:Number})],Typo3Tooltip.prototype,"offset",void 0),__decorate([property({type:String,reflect:!0})],Typo3Tooltip.prototype,"position",void 0),__decorate([internalProperty()],Typo3Tooltip.prototype,"isHidden",void 0),__decorate([query("#tooltip")],Typo3Tooltip.prototype,"tooltipHtmlElement",void 0),Typo3Tooltip=__decorate([customElement("typo3-tooltip")],Typo3Tooltip);var css_248z$q=css`:host{z-index:1;padding:var(--typo3-top-bar-bar-padding-top,.25rem) var(--typo3-top-bar-bar-padding-right,.75rem) var(--typo3-top-bar-bar-padding-bottom,.25rem) var(--typo3-top-bar-bar-padding-left,.75rem);min-height:var(--typo3-top-bar-bar-min-height,1.625rem);overflow:hidden;justify-content:space-between;background-color:var(--typo3-top-bar-bar-background-color,#eee)}::slotted(*),:host{display:flex;flex-direction:row;align-items:center;gap:var(--typo3-global-default-gap);flex-wrap:wrap}::slotted(*){color:var(--typo3-top-bar-bar-text-color,#333);flex-grow:1}::slotted([slot=right]){justify-content:flex-end}::slotted([slot=center]){justify-content:center}`;let Typo3Topbar=class extends LitElement{render(){return html`<slot name="left"></slot><slot name="center"></slot><slot name="right"></slot>`}};function symbolObservablePonyfill(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}var root$2;Typo3Topbar.styles=[css_248z$1,css_248z$q],Typo3Topbar=__decorate([customElement("typo3-topbar")],Typo3Topbar),root$2="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")();var result=symbolObservablePonyfill(root$2),randomString=function(){return Math.random().toString(36).substring(7).split("").join(".")},ActionTypes={INIT:"@@redux/INIT"+randomString(),REPLACE:"@@redux/REPLACE"+randomString(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+randomString()}};function isPlainObject(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function createStore(e,t,r){var o;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(createStore)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var n=e,i=t,a=[],s=a,l=!1;function c(){s===a&&(s=a.slice())}function d(){if(l)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return i}function u(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(l)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return c(),s.push(e),function(){if(t){if(l)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,c();var r=s.indexOf(e);s.splice(r,1),a=null}}}function p(e){if(!isPlainObject(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(l)throw new Error("Reducers may not dispatch actions.");try{l=!0,i=n(i,e)}finally{l=!1}for(var t=a=s,r=0;r<t.length;r++){(0,t[r])()}return e}function h(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");n=e,p({type:ActionTypes.REPLACE})}function f(){var e,t=u;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(d())}return r(),{unsubscribe:t(r)}}})[result]=function(){return this},e}return p({type:ActionTypes.INIT}),(o={dispatch:p,subscribe:u,getState:d,replaceReducer:h})[result]=f,o}function warning(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(e){}}function getUndefinedStateErrorMessage(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function getUnexpectedStateShapeWarningMessage(e,t,r,o){var n=Object.keys(t),i=r&&r.type===ActionTypes.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer";if(0===n.length)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!isPlainObject(e))return"The "+i+' has unexpected type of "'+{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1]+'". Expected argument to be an object with the following keys: "'+n.join('", "')+'"';var a=Object.keys(e).filter((function(e){return!t.hasOwnProperty(e)&&!o[e]}));return a.forEach((function(e){o[e]=!0})),r&&r.type===ActionTypes.REPLACE?void 0:a.length>0?"Unexpected "+(a.length>1?"keys":"key")+' "'+a.join('", "')+'" found in '+i+'. Expected to find one of the known reducer keys instead: "'+n.join('", "')+'". Unexpected keys will be ignored.':void 0}function assertReducerShape(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:ActionTypes.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:ActionTypes.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+ActionTypes.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}function combineReducers(e){for(var t=Object.keys(e),r={},o=0;o<t.length;o++){var n=t[o];"production"!==process.env.NODE_ENV&&void 0===e[n]&&warning('No reducer provided for key "'+n+'"'),"function"==typeof e[n]&&(r[n]=e[n])}var i,a,s=Object.keys(r);"production"!==process.env.NODE_ENV&&(i={});try{assertReducerShape(r)}catch(e){a=e}return function(e,t){if(void 0===e&&(e={}),a)throw a;if("production"!==process.env.NODE_ENV){var o=getUnexpectedStateShapeWarningMessage(e,r,t,i);o&&warning(o)}for(var n=!1,l={},c=0;c<s.length;c++){var d=s[c],u=r[d],p=e[d],h=u(p,t);if(void 0===h){var f=getUndefinedStateErrorMessage(d,t);throw new Error(f)}l[d]=h,n=n||h!==p}return(n=n||s.length!==Object.keys(e).length)?l:e}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ownKeys(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(r,!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function compose(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function applyMiddleware(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),o=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},n={getState:r.getState,dispatch:function(){return o.apply(void 0,arguments)}},i=t.map((function(e){return e(n)}));return _objectSpread2({},r,{dispatch:o=compose.apply(void 0,i)(r.dispatch)})}}}function isCrushed(){}"production"!==process.env.NODE_ENV&&"string"==typeof isCrushed.name&&"isCrushed"!==isCrushed.name&&warning('You are currently using minified code outside of NODE_ENV === "production". This means that you are running a slower development build of Redux. You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) to ensure you have the correct code for your production build.');const SET_SIDEBAR_WIDTH="[LAYOUT] SET SIDEBAR WIDTH",TOGGLE_SIDEBAR="[LAYOUT] TOGGLE SIDEBAR";class SetSidebarWidth{constructor(e){this.sidebarWidth=e,this.type=SET_SIDEBAR_WIDTH}}class ToggleSidebar{constructor(){this.type=TOGGLE_SIDEBAR}}const initialState={sidebarWidth:25,sidebarVisible:!0},layoutReducer=(e=initialState,t)=>{switch(t.type){case SET_SIDEBAR_WIDTH:return{...e,sidebarWidth:t.sidebarWidth};case TOGGLE_SIDEBAR:return{...e,sidebarVisible:!e.sidebarVisible};default:return e}},SET_VIEW_MODE="[VIEW_MODE] SET MODE",SET_SORT_ORDER_FIELD="[VIEW_MODE] SET SORT ORDER FIELD",SET_SORT_ORDER_DIRECTION="[VIEW_MODE] SET SORT ORDER DIRECTION";class SetViewMode{constructor(e){this.viewmode=e,this.type=SET_VIEW_MODE}}class SetSortOrderField{constructor(e){this.field=e,this.type=SET_SORT_ORDER_FIELD}}class SetSortOrderDirection{constructor(e){this.direction=e,this.type=SET_SORT_ORDER_DIRECTION}}var ViewMode,OrderDirection,_a$1;!function(e){e.LIST="list",e.TILES="tiles"}(ViewMode||(ViewMode={})),function(e){e.ASC="asc",e.DESC="desc"}(OrderDirection||(OrderDirection={}));const initialState$1={mode:null!==(_a$1=localStorage.getItem("t3-file-list-view-mode"))&&void 0!==_a$1?_a$1:ViewMode.LIST,order:{field:"name",direction:OrderDirection.ASC}},viewModeReducer=(e=initialState$1,t)=>{switch(t.type){case SET_VIEW_MODE:return{...e,mode:t.viewmode};case SET_SORT_ORDER_FIELD:return{...e,order:{...e.order,field:t.field}};case SET_SORT_ORDER_DIRECTION:return{...e,order:{...e.order,direction:t.direction}};default:return e}},LOAD_TREE_DATA="[TREE] LOAD DATA",LOAD_TREE_DATA_SUCCESS="[TREE] LOAD DATA SUCCESS",LOAD_TREE_DATA_FAILURE="[TREE] LOAD DATA FAILURE",SELECT_TREE_NODE="[TREE] SELECT NODE",EXPAND_TREE_NODE="[TREE] EXPAND NODE",COLLAPSE_TREE_NODE="[TREE] COLLAPSE NODE";class LoadTreeData{constructor(e=!0){this.init=e,this.type=LOAD_TREE_DATA}}class LoadTreeDataSuccess{constructor(e){this.data=e,this.type=LOAD_TREE_DATA_SUCCESS}}class LoadTreeDataFailure{constructor(e){this.error=e,this.type=LOAD_TREE_DATA_FAILURE}}class SelectTreeNode{constructor(e){this.identifier=e,this.type=SELECT_TREE_NODE}}class ExpandTreeNode{constructor(e){this.identifier=e,this.type=EXPAND_TREE_NODE}}class CollapseTreeNode{constructor(e){this.identifier=e,this.type=COLLAPSE_TREE_NODE}}const initialState$2={loading:!1,error:null,nodes:[],selectedNodeId:null,expandedNodeIds:[]},treeReducer=(e=initialState$2,t)=>{switch(t.type){case LOAD_TREE_DATA:return{...e,loading:!0};case LOAD_TREE_DATA_SUCCESS:return{...e,nodes:t.data,loading:!1};case LOAD_TREE_DATA_FAILURE:return{...e,loading:!1,error:t.error};case SELECT_TREE_NODE:return{...e,selectedNodeId:t.identifier};case EXPAND_TREE_NODE:return{...e,expandedNodeIds:[...e.expandedNodeIds,t.identifier]};case COLLAPSE_TREE_NODE:return{...e,expandedNodeIds:e.expandedNodeIds.filter((e=>e!=t.identifier))};default:return e}},CLEAR_SELECTION="[LIST] CLEAR SELECTION",SET_SELECTION="[LIST] SET SELECTION",LOAD_LIST_DATA="[LIST] LOAD DATA",RELOAD_LIST_DATA="[LIST] RELOAD DATA",LOAD_LIST_DATA_SUCCESS="[LIST] LOAD DATA SUCCESS",LOAD_LIST_DATA_FAILURE="[LIST] LOAD DATA FAILURE",SEARCH_TERM_CHANGED="[LIST] SEARCH TERM CHANGED",SEARCH_FILES="[LIST] SEARCH FILES",SEARCH_FILES_SUCCESS="[LIST] SEARCH FILES SUCCESS",SEARCH_FILES_FAILURE="[LIST] SEARCH FILES FAILURE";class ClearSelection{constructor(){this.type=CLEAR_SELECTION}}class SetSelection{constructor(e){this.ids=e,this.type=SET_SELECTION}}class LoadListData{constructor(e){this.url=e,this.type=LOAD_LIST_DATA}}class LoadListDataSuccess{constructor(e){this.data=e,this.type=LOAD_LIST_DATA_SUCCESS}}class LoadListDataFailure{constructor(e){this.error=e,this.type=LOAD_LIST_DATA_FAILURE}}class ReloadListData{constructor(){this.type=RELOAD_LIST_DATA}}class SearchTermChanged{constructor(e){this.searchTerm=e,this.type=SEARCH_TERM_CHANGED}}class SearchFiles{constructor(e){this.searchTerm=e,this.type=SEARCH_FILES}}class SearchFilesSuccess{constructor(e){this.data=e,this.type=SEARCH_FILES_SUCCESS}}class SearchFilesFailure{constructor(e){this.error=e,this.type=SEARCH_FILES_FAILURE}}const initialState$3={items:[],selectedItemIds:[],loading:!1,error:null,searchTerm:null},listReducer=(e=initialState$3,t)=>{switch(t.type){case LOAD_LIST_DATA:return{...e,searchTerm:null,loading:!0,items:[]};case SEARCH_FILES:return{...e,searchTerm:t.searchTerm,loading:!0,items:[]};case LOAD_LIST_DATA_SUCCESS:case SEARCH_FILES_SUCCESS:return{...e,items:t.data,loading:!1};case LOAD_LIST_DATA_FAILURE:case SEARCH_FILES_FAILURE:return{...e,loading:!1,error:t.error};case CLEAR_SELECTION:return{...e,selectedItemIds:[]};case SET_SELECTION:return{...e,selectedItemIds:t.ids.slice()};default:return e}},ADD_FOLDER="[FILE] ADD FOLDER",ADD_FOLDER_SUCCESS="[FILE] ADD FOLDER SUCCESS",ADD_FOLDER_FAILURE="[FILE] ADD FOLDER FAILURE";class AddFolder{constructor(e,t){this.node=e,this.parentNode=t,this.type=ADD_FOLDER}}class AddFolderSuccess{constructor(e,t){this.message=e,this.undoAction=t,this.type=ADD_FOLDER_SUCCESS}}class AddFolderFailure{constructor(){this.type=ADD_FOLDER_FAILURE}}const CLIPBOARD_COPY_FILE="[FILE][CLIPBOARD] COPY FILE",CLIPBOARD_CUT_FILE="[FILE][CLIPBOARD] CUT FILE",CLIPBOARD_PASTE="[FILE][CLIPBOARD] PASTE",CLIPBOARD_PASTE_SUCCESS="[FILE][CLIPBOARD] PASTE SUCCESS",CLIPBOARD_PASTE_FAILURE="[FILE][CLIPBOARD] PASTE FAILURE";class ClipboardAction{constructor(e){this.contextItems=e}}class ClipboardCopyFile extends ClipboardAction{constructor(){super(...arguments),this.type=CLIPBOARD_COPY_FILE}}class ClipboardCutFile extends ClipboardAction{constructor(){super(...arguments),this.type=CLIPBOARD_CUT_FILE}}class ClipboardPaste{constructor(e){this.targetIdentifier=e,this.type=CLIPBOARD_PASTE}}class ClipboardPasteFailure{constructor(){this.type=CLIPBOARD_PASTE_FAILURE}}class ClipboardPasteSuccess{constructor(e){this.message=e,this.type=CLIPBOARD_PASTE_SUCCESS}}const COPY_FILES="[FILE] COPY FILES",COPY_FILES_SUCCESS="[FILE] COPY FILES SUCCESS",COPY_FILES_FAILURE="[FILE] COPY FILES FAILURE";class CopyFiles{constructor(e,t){this.identifiers=e,this.target=t,this.type=COPY_FILES}}class CopyFilesFailure{constructor(){this.type=COPY_FILES_FAILURE}}class CopyFilesSuccess{constructor(e,t){this.message=e,this.undoAction=t,this.type=COPY_FILES_SUCCESS}}const DELETE_FILES="[FILE] DELETE FILES",DELETE_FILES_CONFIRM="[FILE] DELETE FILES CONFIRM",DELETE_FILES_SUCCESS="[FILE] DELETE FILES SUCCESS",DELETE_FILES_FAILURE="[FILE] DELETE FILES FAILURE";class DeleteFilesConfirm{constructor(e){this.identifiers=e,this.type=DELETE_FILES_CONFIRM}}class DeleteFiles{constructor(e){this.identifiers=e,this.type=DELETE_FILES}}class DeleteFilesSuccess{constructor(e,t){this.message=e,this.undoAction=t,this.type=DELETE_FILES_SUCCESS}}class DeleteFilesFailure{constructor(){this.type=DELETE_FILES_FAILURE}}const DOWNLOAD_FILES="[FILE] DOWNLOAD FILES",DOWNLOAD_FILES_SUCCESS="[FILE] DOWNLOAD FILES SUCCESS",DOWNLOAD_FILES_FAILURE="[FILE] DOWNLOAD FILES FAILURE";class DownloadFiles{constructor(e){this.identifiers=e,this.type=DOWNLOAD_FILES}}class DownloadFilesSuccess{constructor(){this.type=DOWNLOAD_FILES_SUCCESS}}class DownloadFilesFailure{constructor(){this.type=DOWNLOAD_FILES_FAILURE}}const DRAG_FILES_START="[FILE] DRAG FILES START",DRAG_FILES_CHANGE_MODE="[FILE] DRAG FILES CHANGE MODE",DRAG_FILES_END="[FILE] DRAG FILES END";class DragFilesEnd{constructor(){this.type=DRAG_FILES_END}}class DragFilesChangeMode{constructor(e){this.mode=e,this.type=DRAG_FILES_CHANGE_MODE}}class DragFilesStart{constructor(){this.type=DRAG_FILES_START}}const EDIT_FILE_STORAGE="[FILE] EDIT FILE STORAGE",EDIT_FILE_METADATA="[FILE] EDIT FILE METADATA";class EditFileMetadata{constructor(e){this.metaDataUrl=e,this.type=EDIT_FILE_METADATA}}class EditFileStorage{constructor(e){this.identifier=e,this.type=EDIT_FILE_STORAGE}}const MOVE_FILES="[FILE] MOVE FILES",MOVE_FILES_SUCCESS="[FILE] MOVE FILES SUCCESS",MOVE_FILES_FAILURE="[FILE] MOVE FILES FAILURE";class MoveFiles{constructor(e,t){this.identifiers=e,this.target=t,this.type=MOVE_FILES}}class MoveFilesFailure{constructor(){this.type=MOVE_FILES_FAILURE}}class MoveFilesSuccess{constructor(e,t){this.message=e,this.undoAction=t,this.type=MOVE_FILES_SUCCESS}}const RENAME_FILE="[FILE] RENAME",RENAME_FILE_SUCCESS="[FILE] RENAME SUCCESS",RENAME_FILE_FAILURE="[FILE] RENAME FAILURE";class RenameFile{constructor(e,t){this.identifier=e,this.name=t,this.type=RENAME_FILE}}class RenameFileSuccess{constructor(e,t){this.message=e,this.undoAction=t,this.type=RENAME_FILE_SUCCESS}}class RenameFileFailure{constructor(){this.type=RENAME_FILE_FAILURE}}const REPLACE_FILE="[FILE] REPLACE FILE",REPLACE_FILE_SUCCESS="[FILE] REPLACE FILES SUCCESS",REPLACE_FILE_FAILURE="[FILE] REPLACE FILES FAILURE";class ReplaceFile{constructor(e){this.formData=e,this.type=REPLACE_FILE}}class ReplaceFileSuccess{constructor(e,t){this.message=e,this.undoAction=t,this.type=REPLACE_FILE_SUCCESS}}class ReplaceFileFailure{constructor(){this.type=REPLACE_FILE_FAILURE}}const REPLACE_FILE_CONFIRM="[FILE] REPLACE FILE CONFIRM";class ReplaceFileConfirm{constructor(e){this.identifier=e,this.type=REPLACE_FILE_CONFIRM}}const SHOW_FILE_INFO="[FILE] SHOW FILE INFO",SHOW_FILE="[FILE] SHOW FILE";class ShowFile{constructor(e){this.fileUrl=e,this.type=SHOW_FILE}}class ShowFileInfo{constructor(e,t){this.identifier=e,this.sysType=t,this.type=SHOW_FILE_INFO}}const UNDO_FILES_ACTION="[FILE] UNDO FILES ACTION",UNDO_FILES_ACTION_SUCCESS="[FILE] UNDO FILES ACTION SUCCESS",UNDO_FILES_ACTION_FAILURE="[FILE] UNDO FILES ACTION FAILURE";class UndoFilesAction{constructor(e){this.formData=e,this.type=UNDO_FILES_ACTION}}class UndoFilesActionSuccess{constructor(e){this.message=e,this.type=UNDO_FILES_ACTION_SUCCESS}}class UndoFilesActionFailure{constructor(){this.type=UNDO_FILES_ACTION_FAILURE}}const UPLOAD_FILES="[FILE] UPLOAD FILES",UPLOAD_FILES_SUCCESS="[FILE] UPLOAD FILES SUCCESS",UPLOAD_FILES_FAILURE="[FILE] UPLOAD FILES FAILURE",UPLOAD_FILES_CONFLICTS="[FILE] UPLOAD FILES CONFLICTS";class UploadFiles{constructor(e,t){this.dataTransfer=e,this.node=t,this.type=UPLOAD_FILES}}class UploadFilesSuccess{constructor(e,t){this.message=e,this.undoAction=t,this.type=UPLOAD_FILES_SUCCESS}}class UploadFilesFailure{constructor(){this.type=UPLOAD_FILES_FAILURE}}class UploadFilesConflicts{constructor(e,t){this.files=e,this.node=t,this.type=UPLOAD_FILES_CONFLICTS}}const RELOAD="[GLOBAL] RELOAD",LOAD_FLASH_MESSAGES="[GLOBAL] LOAD FLASH MESSAGES";class Reload{constructor(){this.type=RELOAD}}class LoadFlashMessages{constructor(e,t,r){this.severity=e,this.message=t,this.undoAction=r,this.type=LOAD_FLASH_MESSAGES}}const initialState$4={isAddingFolder:!1,isDeletingFiles:!1,isRenamingFile:!1,isReplacingFile:!1,isUploadingFiles:!1,isDraggingFiles:!1,isMovingFiles:!1,isCopyingFiles:!1,isPastingFiles:!1,isDownloadingFiles:!1,isUndoingFileAction:!1,dragFilesMode:"move"},fileActionsReducer=(e=initialState$4,t)=>{switch(t.type){case ADD_FOLDER:return{...e,isAddingFolder:!0};case ADD_FOLDER_SUCCESS:case ADD_FOLDER_FAILURE:return{...e,isAddingFolder:!1};case CLIPBOARD_PASTE:return{...e,isPastingFiles:!0};case CLIPBOARD_PASTE_SUCCESS:case CLIPBOARD_PASTE_FAILURE:return{...e,isPastingFiles:!1};case COPY_FILES:return{...e,isCopyingFiles:!0};case COPY_FILES_SUCCESS:case COPY_FILES_FAILURE:return{...e,isCopyingFiles:!1};case DELETE_FILES:return{...e,isDeletingFiles:!0};case DELETE_FILES_SUCCESS:case DELETE_FILES_FAILURE:return{...e,isDeletingFiles:!1};case DRAG_FILES_CHANGE_MODE:return{...e,dragFilesMode:t.mode};case DRAG_FILES_START:return{...e,isDraggingFiles:!0,dragFilesMode:"move"};case DRAG_FILES_END:return{...e,isDraggingFiles:!1};case DOWNLOAD_FILES:return{...e,isDownloadingFiles:!0};case DOWNLOAD_FILES_SUCCESS:case DOWNLOAD_FILES_FAILURE:return{...e,isDownloadingFiles:!1};case MOVE_FILES:return{...e,isMovingFiles:!0};case MOVE_FILES_SUCCESS:case MOVE_FILES_FAILURE:return{...e,isMovingFiles:!1};case RENAME_FILE:return{...e,isRenamingFile:!0};case RENAME_FILE_SUCCESS:case RENAME_FILE_FAILURE:return{...e,isRenamingFile:!1};case REPLACE_FILE:return{...e,isReplacingFile:!0};case REPLACE_FILE_SUCCESS:case REPLACE_FILE_FAILURE:return{...e,isReplacingFile:!1};case UPLOAD_FILES:return{...e,isUploadingFiles:!0};case UPLOAD_FILES_CONFLICTS:return{...e,isUploadingFiles:!1};case UPLOAD_FILES_SUCCESS:case UPLOAD_FILES_FAILURE:return{...e,isUploadingFiles:!1};case UNDO_FILES_ACTION:return{...e,isUndoingFileAction:!0};case UNDO_FILES_ACTION_SUCCESS:case UNDO_FILES_ACTION_FAILURE:return{...e,isUndoingFileAction:!1};default:return e}},rootReducer=combineReducers({layout:layoutReducer,viewMode:viewModeReducer,tree:treeReducer,list:listReducer,fileActions:fileActionsReducer});var keyHasType=function(e,t){return e===t||"function"==typeof t&&e===t.toString()},ofType=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return e.pipe(filter((function(e){var r=e.type,o=t.length;if(1===o)return keyHasType(r,t[0]);for(var n=0;n<o;n++)if(keyHasType(r,t[n]))return!0;return!1})))}},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ActionsObservable=function(e){function t(e){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.source=e,r}return _inherits(t,Observable),_createClass(t,null,[{key:"of",value:function(){return new this(of.apply(void 0,arguments))}},{key:"from",value:function(e,t){return new this(from(e,t))}}]),_createClass(t,[{key:"lift",value:function(e){var r=new t(this);return r.operator=e,r}},{key:"ofType",value:function(){return ofType.apply(void 0,arguments)(this)}}]),t}();function _classCallCheck$1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$1(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$1(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var StateObservable=function(e){function t(e,r){_classCallCheck$1(this,t);var o=_possibleConstructorReturn$1(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e){var t=o.__notifier.subscribe(e);return t&&!t.closed&&e.next(o.value),t})));return o.value=r,o.__notifier=new Subject,o.__subscription=e.subscribe((function(e){e!==o.value&&(o.value=e,o.__notifier.next(e))})),o}return _inherits$1(t,Observable),t}(),_typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},consoleWarn="object"===("undefined"==typeof console?"undefined":_typeof$1(console))&&"function"==typeof console.warn?function(){var e;return(e=console).warn.apply(e,arguments)}:function(){},warn=function(e){consoleWarn("redux-observable | WARNING: "+e)};function createEpicMiddleware(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=queueScheduler.constructor,r=new t(queueScheduler.SchedulerAction);if("production"!==process.env.NODE_ENV&&"function"==typeof e)throw new TypeError("Providing your root Epic to `createEpicMiddleware(rootEpic)` is no longer supported, instead use `epicMiddleware.run(rootEpic)`\n\nLearn more: https://redux-observable.js.org/MIGRATION.html#setting-up-the-middleware");var o=new Subject,n=void 0,i=function(t){"production"!==process.env.NODE_ENV&&n&&warn("this middleware is already associated with a store. createEpicMiddleware should be called for every store.\n\nLearn more: https://goo.gl/2GQ7Da"),n=t;var i=(new Subject).pipe(observeOn(r)),a=(new Subject).pipe(observeOn(r)),s=new ActionsObservable(i),l=new StateObservable(a,n.getState());return o.pipe(map((function(t){var r="dependencies"in e?t(s,l,e.dependencies):t(s,l);if(!r)throw new TypeError('Your root Epic "'+(t.name||"<anonymous>")+"\" does not return a stream. Double check you're not missing a return statement!");return r})),mergeMap((function(e){return from(e).pipe(subscribeOn(r),observeOn(r))}))).subscribe(n.dispatch),function(e){return function(t){var r=e(t);return a.next(n.getState()),i.next(t),r}}};return i.run=function(e){"production"===process.env.NODE_ENV||n||warn("epicMiddleware.run(rootEpic) called before the middleware has been setup by redux. Provide the epicMiddleware instance to createStore() first."),o.next(e)},i}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var combineEpics=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=function(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return merge.apply(void 0,_toConsumableArray(t.map((function(e){var t=e.apply(void 0,r);if(!t)throw new TypeError('combineEpics: one of the provided Epics "'+(e.name||"<anonymous>")+"\" does not return a stream. Double check you're not missing a return statement!");return t}))))};try{Object.defineProperty(o,"name",{value:"combineEpics("+t.map((function(e){return e.name||"<anonymous>"})).join(", ")+")"})}catch(e){}return o},__window="undefined"!=typeof window&&window,__self="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,__global="undefined"!=typeof global&&global,_root=__window||__global||__self;function getCORSRequest(){if(_root.XMLHttpRequest)return new _root.XMLHttpRequest;if(_root.XDomainRequest)return new _root.XDomainRequest;throw new Error("CORS is not supported by your browser")}function getXMLHttpRequest(){if(_root.XMLHttpRequest)return new _root.XMLHttpRequest;var e=void 0;try{for(var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=0;r<3;r++)try{if(e=t[r],new _root.ActiveXObject(e))break}catch(e){}return new _root.ActiveXObject(e)}catch(e){throw new Error("XMLHttpRequest is not supported by your browser")}}function ajaxGet(e,t){return void 0===t&&(t=null),new AjaxObservable({method:"GET",url:e,headers:t})}function ajaxPost(e,t,r){return new AjaxObservable({method:"POST",url:e,body:t,headers:r})}function ajaxDelete(e,t){return new AjaxObservable({method:"DELETE",url:e,headers:t})}function ajaxPut(e,t,r){return new AjaxObservable({method:"PUT",url:e,body:t,headers:r})}function ajaxPatch(e,t,r){return new AjaxObservable({method:"PATCH",url:e,body:t,headers:r})}var mapResponse=map((function(e,t){return e.response}));function ajaxGetJSON(e,t){return mapResponse(new AjaxObservable({method:"GET",url:e,responseType:"json",headers:t}))}var AjaxObservable=function(e){function t(t){var r=e.call(this)||this,o={async:!0,createXHR:function(){return this.crossDomain?getCORSRequest():getXMLHttpRequest()},crossDomain:!0,withCredentials:!1,headers:{},method:"GET",responseType:"json",timeout:0};if("string"==typeof t)o.url=t;else for(var n in t)t.hasOwnProperty(n)&&(o[n]=t[n]);return r.request=o,r}return __extends(t,e),t.prototype._subscribe=function(e){return new AjaxSubscriber(e,this.request)},t.create=function(){var e=function(e){return new t(e)};return e.get=ajaxGet,e.post=ajaxPost,e.delete=ajaxDelete,e.put=ajaxPut,e.patch=ajaxPatch,e.getJSON=ajaxGetJSON,e}(),t}(Observable),AjaxSubscriber=function(e){function t(t,r){var o=e.call(this,t)||this;o.request=r,o.done=!1;var n=r.headers=r.headers||{};return r.crossDomain||o.getHeader(n,"X-Requested-With")||(n["X-Requested-With"]="XMLHttpRequest"),o.getHeader(n,"Content-Type")||_root.FormData&&r.body instanceof _root.FormData||void 0===r.body||(n["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),r.body=o.serializeBody(r.body,o.getHeader(r.headers,"Content-Type")),o.send(),o}return __extends(t,e),t.prototype.next=function(e){this.done=!0;var t,r=this,o=r.xhr,n=r.request,i=r.destination;try{t=new AjaxResponse(e,o,n)}catch(e){return i.error(e)}i.next(t)},t.prototype.send=function(){var e=this.request,t=this.request,r=t.user,o=t.method,n=t.url,i=t.async,a=t.password,s=t.headers,l=t.body;try{var c=this.xhr=e.createXHR();this.setupEvents(c,e),r?c.open(o,n,i,r,a):c.open(o,n,i),i&&(c.timeout=e.timeout,c.responseType=e.responseType),"withCredentials"in c&&(c.withCredentials=!!e.withCredentials),this.setHeaders(c,s),l?c.send(l):c.send()}catch(e){this.error(e)}},t.prototype.serializeBody=function(e,t){if(!e||"string"==typeof e)return e;if(_root.FormData&&e instanceof _root.FormData)return e;if(t){var r=t.indexOf(";");-1!==r&&(t=t.substring(0,r))}switch(t){case"application/x-www-form-urlencoded":return Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&");case"application/json":return JSON.stringify(e);default:return e}},t.prototype.setHeaders=function(e,t){for(var r in t)t.hasOwnProperty(r)&&e.setRequestHeader(r,t[r])},t.prototype.getHeader=function(e,t){for(var r in e)if(r.toLowerCase()===t.toLowerCase())return e[r]},t.prototype.setupEvents=function(e,t){var r=t.progressSubscriber;function o(e){var t,r=o,n=r.subscriber,i=r.progressSubscriber,a=r.request;i&&i.error(e);try{t=new AjaxTimeoutError(this,a)}catch(e){t=e}n.error(t)}if(e.ontimeout=o,o.request=t,o.subscriber=this,o.progressSubscriber=r,e.upload&&"withCredentials"in e){var n,i;if(r)n=function(e){n.progressSubscriber.next(e)},_root.XDomainRequest?e.onprogress=n:e.upload.onprogress=n,n.progressSubscriber=r;i=function(e){var t,r=i,o=r.progressSubscriber,n=r.subscriber,a=r.request;o&&o.error(e);try{t=new AjaxError("ajax error",this,a)}catch(e){t=e}n.error(t)},e.onerror=i,i.request=t,i.subscriber=this,i.progressSubscriber=r}function a(e){}function s(e){var t=s,r=t.subscriber,o=t.progressSubscriber,n=t.request;if(4===this.readyState){var i=1223===this.status?204:this.status,a="text"===this.responseType?this.response||this.responseText:this.response;if(0===i&&(i=a?200:0),i<400)o&&o.complete(),r.next(e),r.complete();else{o&&o.error(e);var l=void 0;try{l=new AjaxError("ajax error "+i,this,n)}catch(e){l=e}r.error(l)}}}e.onreadystatechange=a,a.subscriber=this,a.progressSubscriber=r,a.request=t,e.onload=s,s.subscriber=this,s.progressSubscriber=r,s.request=t},t.prototype.unsubscribe=function(){var t=this.done,r=this.xhr;!t&&r&&4!==r.readyState&&"function"==typeof r.abort&&r.abort(),e.prototype.unsubscribe.call(this)},t}(Subscriber),AjaxResponse=function(){return function(e,t,r){this.originalEvent=e,this.xhr=t,this.request=r,this.status=t.status,this.responseType=t.responseType||r.responseType,this.response=parseXhrResponse(this.responseType,t)}}(),AjaxErrorImpl=function(){function e(e,t,r){return Error.call(this),this.message=e,this.name="AjaxError",this.xhr=t,this.request=r,this.status=t.status,this.responseType=t.responseType||r.responseType,this.response=parseXhrResponse(this.responseType,t),this}return e.prototype=Object.create(Error.prototype),e}(),AjaxError=AjaxErrorImpl;function parseJson(e){return"response"in e?e.responseType?e.response:JSON.parse(e.response||e.responseText||"null"):JSON.parse(e.responseText||"null")}function parseXhrResponse(e,t){switch(e){case"json":return parseJson(t);case"xml":return t.responseXML;case"text":default:return"response"in t?t.response:t.responseText}}function AjaxTimeoutErrorImpl(e,t){return AjaxError.call(this,"ajax timeout",e,t),this.name="AjaxTimeoutError",this}var AjaxTimeoutError=AjaxTimeoutErrorImpl,ajax=function(){return AjaxObservable.create}();class AppConfigService{getAppConfig(){return Object.prototype.hasOwnProperty.call(window,"app")?window.app:{translations:{},iconUrls:{},backendUrls:{}}}}class BackendUrlService{constructor(e){this.appService=e}get(e){const t=this.appService.getAppConfig().backendUrls;return Object.prototype.hasOwnProperty.call(t,e)?t[e]:""}}const service=new BackendUrlService(new AppConfigService),getUrl=(e,t)=>{const r=service.get(e);if(void 0===t)return r;const o=new URLSearchParams(t);return r+(r.match(/[?]/g)?"&":"?")+o.toString()};class TranslationService{constructor(e){this.appService=e}get(e){const t=this.appService.getAppConfig().translations;return Object.prototype.hasOwnProperty.call(t,e)?t[e]:""}}const service$1=new TranslationService(new AppConfigService),translate=e=>service$1.get(e);var ModalType,SeverityEnum;function addSlotToRawHtml(e,t){return e.replace(/(<\w*)(.*)/,'$1 slot="'+t+'"$2')}function resolveNodePath(e,t){var r;if(0===e.length)return[];if(null===t)return[];const o=[];let n=t;for(;null!==n;)o.unshift(n),n=null!==(r=e.find((e=>e.identifier===(null==n?void 0:n.parentIdentifier))))&&void 0!==r?r:null;return o}function extractStorageFromIdentifier(e){const t=/(\d:).*/gm.exec(e);return t?t[1]:""}function openAsLink(e,t={}){Object.assign(document.createElement("a"),{href:e,target:"_blank",...t}).click()}!function(e){e.CONFIRM="confirm",e.HTML="html"}(ModalType||(ModalType={})),function(e){e[e.notice=-2]="notice",e[e.info=-1]="info",e[e.ok=0]="ok",e[e.warning=1]="warning",e[e.error=2]="error"}(SeverityEnum||(SeverityEnum={}));const CLIPBOARD_PAD="mediamanager";var OverrideFileAction;function handleFilesUpload(e,t,r,o){const n=new FormData;return e.forEach(((e,r)=>{n.append("data[upload]["+r+"][target]",t),n.append("data[upload]["+r+"][data]",r.toString()),n.append("upload_"+r,e),o&&n.append("overwriteExistingFiles",o)})),r.postFormData(getUrl("fileActionUrl"),n).pipe(mergeMap((()=>[new UploadFilesSuccess(translate("message.header.filesUploaded"))])),catchError((()=>of(new UploadFilesFailure))))}!function(e){e.OVERRIDE="replace",e.RENAME="rename",e.SKIP="cancel"}(OverrideFileAction||(OverrideFileAction={}));const uploadFiles=(e,t,r)=>e.ofType(UPLOAD_FILES).pipe(switchMap((e=>{const t=[],o=e.node.identifier;for(let r=0;r<e.dataTransfer.files.length;r++)t.push(e.dataTransfer.files.item(r));return forkJoin(t.map((e=>{const t=getUrl("fileExistsUrl",{fileName:e.name,fileTarget:o});return r.apiService.getJSON(t)}))).pipe(map((r=>{const o=[],n=[];return t.forEach((e=>{const t=find(r,{name:e.name});if(t){const r={original:t,file:e,data:{name:e.name,lastModified:e.lastModified,size:e.size}};n.push(r)}else o.push(e)})),{uploadableFiles:o,conflictFiles:n,target:e.node}})))})),switchMap((e=>{const t=[];return e.uploadableFiles.length>0&&t.push(handleFilesUpload(e.uploadableFiles,e.target.identifier,r.apiService)),e.conflictFiles.length>0&&t.push(of(new UploadFilesConflicts(e.conflictFiles,e.target))),concat(...t)}))),uploadFilesConflict=(e,t,r)=>e.ofType(UPLOAD_FILES_CONFLICTS).pipe(switchMap((e=>{const t={type:ModalType.HTML,isForm:!0,title:translate("file_upload.existingfiles.title"),content:`<typo3-files-override-modal-content files='${JSON.stringify(e.files)}'></typo3-files-override-modal-content>`,dismissible:!0,variant:ModalVariant.warning,modalButtons:[{label:translate("button.cancel"),color:"default",action:"typo3-files-conflict-cancel"},{label:translate("file_upload.button.continue"),color:"warning",action:"typo3-files-conflict-confirm"}]};return r.modalService.openModal(t).pipe(filter((e=>"typo3-files-conflict-confirm"===e.actionName)),switchMap((t=>{const o=t.actionData,n=o["data[all]"],i=[];return e.files.forEach((t=>{var a;const s=o[`data[file][${null===(a=t.file)||void 0===a?void 0:a.name}]`]||n;if(s===OverrideFileAction.SKIP)return null;i.push(handleFilesUpload([t.file],e.node.identifier,r.apiService,s))})),concat(...i)})))}))),renameFile=(e,t,r)=>e.ofType(RENAME_FILE).pipe(withLatestFrom(t),switchMap((([e,t])=>{const o=new FormData;return o.append("data[rename][0][data]",e.identifier),o.append("data[rename][0][target]",e.name),r.apiService.postFormData(getUrl("fileActionUrl"),o).pipe(map((o=>r.undoActionResolverService.getUndoAction(e,o,t))),map((e=>new RenameFileSuccess(translate("message.header.fileRenamed"),e))),catchError((()=>of(new RenameFileFailure))))}))),confirmDeleteFiles=(e,t,r)=>e.ofType(DELETE_FILES_CONFIRM).pipe(switchMap((e=>{const t={};e.identifiers.forEach(((e,r)=>{t[`identifiers[${r}]`]=e}));const o=getUrl("mediamanager_delete_resources_confirm_modal_data",t);return r.apiService.getJSON(o).pipe(map((t=>[e,t])))})),switchMap((([e,t])=>{const o={title:t.title,content:t.message,type:ModalType.CONFIRM,variant:ModalVariant.warning,dismissible:!0,modalButtons:[{label:t.closeText,color:"default",action:"typo3-delete-cancel"},{label:t.deleteText,color:"warning",action:"typo3-confirm-delete"}]};return r.modalService.openModal(o).pipe(filter((e=>"typo3-confirm-delete"===e.actionName)),map((()=>new DeleteFiles(e.identifiers))))}))),deleteFiles=(e,t,r)=>e.ofType(DELETE_FILES).pipe(switchMap((e=>{const t=new FormData;return e.identifiers.forEach(((e,r)=>{t.append("data[delete]["+r+"][data]",e)})),r.apiService.postFormData(getUrl("fileActionUrl"),t).pipe(map((()=>new DeleteFilesSuccess(translate("message.header.fileDeleted")))),catchError((()=>of(new DeleteFilesFailure))))}))),showFileInfo=e=>e.ofType(SHOW_FILE_INFO).pipe(tap((e=>{window.top.TYPO3.InfoWindow.showItem(e.sysType,e.identifier)})),ignoreElements()),showFile=e=>e.ofType(SHOW_FILE).pipe(tap((e=>openAsLink(e.fileUrl))),ignoreElements()),addFolder=(e,t,r)=>e.ofType(ADD_FOLDER).pipe(withLatestFrom(t),switchMap((([e,t])=>{const o=new FormData;return o.append("data[newfolder][0][data]",e.node.name),o.append("data[newfolder][0][target]",e.parentNode.identifier),r.apiService.postFormData(getUrl("fileActionUrl"),o).pipe(map((o=>r.undoActionResolverService.getUndoAction(e,o,t))),map((e=>new AddFolderSuccess(translate("message.header.folderCreated"),e))),catchError((()=>of(new AddFolderFailure))))}))),moveFiles=(e,t,r)=>e.ofType(MOVE_FILES).pipe(withLatestFrom(t),switchMap((([e,t])=>{const o=new FormData;for(let t=0;t<e.identifiers.length;t++)o.append("data[move]["+t+"][target]",e.target.identifier),o.append("data[move]["+t+"][data]",e.identifiers[t]);return r.apiService.postFormData(getUrl("fileActionUrl"),o).pipe(map((o=>r.undoActionResolverService.getUndoAction(e,o,t))),map((e=>new MoveFilesSuccess(translate("message.header.filesMoved"),e))),catchError((()=>of(new MoveFilesFailure))))}))),copyFiles=(e,t,r)=>e.ofType(COPY_FILES).pipe(withLatestFrom(t),switchMap((([e,t])=>{const o=new FormData;for(let t=0;t<e.identifiers.length;t++)o.append("data[copy]["+t+"][target]",e.target.identifier),o.append("data[copy]["+t+"][data]",e.identifiers[t]);return r.apiService.postFormData(getUrl("fileActionUrl"),o).pipe(map((o=>r.undoActionResolverService.getUndoAction(e,o,t))),map((e=>new CopyFilesSuccess(translate("message.header.filesCopied"),e))),catchError((()=>of(new CopyFilesFailure))))}))),clipboardSelectionAction=(e,t,r)=>e.ofType(CLIPBOARD_COPY_FILE,CLIPBOARD_CUT_FILE).pipe(switchMap((e=>{const t={};return e.contextItems.forEach((e=>{t[`CB[el][_FILE|${e.clipboardIdentifier}]`]=e.identifier})),t["CB[setCopyMode]"]=e.type===CLIPBOARD_COPY_FILE?"1":"0",r.apiService.postFormData(getUrl("clipboardUrl",t)).pipe(catchError((()=>(console.warn("error during clipboard action"),EMPTY))))})),ignoreElements()),clipboardPaste=(e,t,r)=>e.ofType(CLIPBOARD_PASTE).pipe(switchMap((e=>{const t=new FormData;return t.append("CB[paste]","FILE|"+e.targetIdentifier),t.append("CB[pad]",CLIPBOARD_PAD),r.apiService.postFormData(getUrl("fileActionUrl"),t).pipe(map((()=>new ClipboardPasteSuccess(translate("message.header.filesMoved")))),catchError((()=>of(new ClipboardPasteFailure))))}))),downloadFiles=e=>e.ofType(DOWNLOAD_FILES).pipe(switchMap((e=>{const t=new FormData;e.identifiers.forEach(((e,r)=>{t.append("identifiers["+r+"]",e)}));const r=getUrl("downloadFilesUrl");return ajax({url:r,method:"POST",body:t,responseType:"arraybuffer"}).pipe(tap((e=>{var t;const r=new Blob([e.response],{type:null!==(t=e.xhr.getResponseHeader("Content-Type"))&&void 0!==t?t:void 0});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r);else{const e=URL.createObjectURL(r);openAsLink(e,{target:"_self",download:""}),setTimeout((function(){URL.revokeObjectURL(e)}),100)}})),map((()=>new DownloadFilesSuccess)),catchError((e=>{const t=String.fromCharCode.apply(null,new Uint8Array(e.response));return dispatchEvent(new CustomEvent("typo3-add-snackbar",{detail:{message:t,variant:"danger"}})),of(new DownloadFilesFailure)})))}))),editFileStorage=e=>e.ofType(EDIT_FILE_STORAGE).pipe(tap((e=>{const t={};t[`edit[sys_file_storage][${parseInt(e.identifier,10)}]`]="edit",t.returnUrl=window.document.location.href,window.location.href=getUrl("editFileStorageUrl",t)})),ignoreElements()),replaceFileConfirm=(e,t,r)=>e.ofType(REPLACE_FILE_CONFIRM).pipe(switchMap((e=>{const t=`\n        <form enctype="multipart/form-data">\n          <div>\n            <typo3-formfield\n              label="${translate("file_replace.keepfiletitle")}"\n              label-align="right"\n            >\n              <input type="checkbox" value="1" name="data[replace][1][keepFilename]">\n            </typo3-formfield>\n          </div>\n          <div>\n            <typo3-formfield label="${translate("file_replace.selectfile")}">\n              <input required type="file" name="replace_1">\n            </typo3-formfield>\n          </div>\n          <input type="hidden" name="data[replace][1][data]" value="1">\n          <input type="hidden" name="overwriteExistingFiles" value="replace">\n          <input type="hidden" name="data[replace][1][uid]" value="${e.identifier}">\n        </form>`.split("\n").join("");return r.modalService.openModal({title:translate("file_replace.pagetitle"),type:ModalType.HTML,isForm:!0,dismissible:!0,variant:ModalVariant.warning,content:t,modalButtons:[{label:translate("button.cancel"),color:"default",action:"typo3-replace-cancel"},{label:translate("file_replace.submit"),color:"warning",action:"typo3-replace-confirm"}]}).pipe(filter((e=>"typo3-replace-confirm"===e.actionName)),map((e=>{var t;return new ReplaceFile(null!==(t=e.actionData)&&void 0!==t?t:{})})))}))),replaceFile=(e,t,r)=>e.ofType(REPLACE_FILE).pipe(switchMap((e=>{const t=new FormData;for(const r in e.formData)t.append(r,e.formData[r]);return r.apiService.postFormData(getUrl("fileActionUrl"),t).pipe(map((()=>new ReplaceFileSuccess(translate("file_replace.pagetitle")))),catchError((()=>of(new ReplaceFileFailure))))}))),undoFileAction=(e,t,r)=>e.ofType(UNDO_FILES_ACTION).pipe(switchMap((e=>{const t=new FormData;for(const r in e.formData)t.append(r,e.formData[r]);return r.apiService.postFormData(getUrl("fileActionUrl"),t).pipe(map((()=>new UndoFilesActionSuccess(translate("message.header.undo")))),catchError((()=>of(new UndoFilesActionFailure))))}))),fileActionSuccess=e=>e.ofType(ADD_FOLDER_SUCCESS,DELETE_FILES_SUCCESS,RENAME_FILE_SUCCESS,UPLOAD_FILES_SUCCESS,MOVE_FILES_SUCCESS,COPY_FILES_SUCCESS,CLIPBOARD_PASTE_SUCCESS,REPLACE_FILE_SUCCESS,UNDO_FILES_ACTION_SUCCESS).pipe(mergeMap((e=>[new Reload,new LoadFlashMessages(SeverityEnum.ok,e.message,e.undoAction)]))),fileActionFailure=e=>e.ofType(DELETE_FILES_FAILURE,RENAME_FILE_FAILURE,UPLOAD_FILES_FAILURE,MOVE_FILES_FAILURE,COPY_FILES_FAILURE,CLIPBOARD_PASTE_FAILURE,REPLACE_FILE_FAILURE,UNDO_FILES_ACTION_FAILURE).pipe(mergeMap((e=>{const t=[new LoadFlashMessages(SeverityEnum.error,translate("message.header.genericError"))];return-1!=[RENAME_FILE_FAILURE,ADD_FOLDER_FAILURE,MOVE_FILES_FAILURE,COPY_FILES_FAILURE,UPLOAD_FILES_FAILURE].indexOf(e.type)&&t.push(new Reload),t}))),editFileMetadata=e=>e.ofType(EDIT_FILE_METADATA).pipe(tap((e=>{const t=window.top.TYPO3.Modal;t.advanced({type:t.types.iframe,size:t.sizes.large,content:e.metaDataUrl})})),ignoreElements()),fileActions=[addFolder,clipboardPaste,clipboardSelectionAction,copyFiles,confirmDeleteFiles,deleteFiles,downloadFiles,editFileMetadata,editFileStorage,fileActionFailure,fileActionSuccess,moveFiles,renameFile,replaceFile,replaceFileConfirm,showFileInfo,undoFileAction,uploadFiles,uploadFilesConflict,showFile];function defaultEqualityCheck(e,t){return e===t}function areArgumentsShallowlyEqual(e,t,r){if(null===t||null===r||t.length!==r.length)return!1;for(var o=t.length,n=0;n<o;n++)if(!e(t[n],r[n]))return!1;return!0}function defaultMemoize(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:defaultEqualityCheck,r=null,o=null;return function(){return areArgumentsShallowlyEqual(t,r,arguments)||(o=e.apply(null,arguments)),r=arguments,o}}function getDependencies(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var r=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+r+"]")}return t}function createSelectorCreator(e){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return function(){for(var t=arguments.length,o=Array(t),n=0;n<t;n++)o[n]=arguments[n];var i=0,a=o.pop(),s=getDependencies(o),l=e.apply(void 0,[function(){return i++,a.apply(null,arguments)}].concat(r)),c=e((function(){for(var e=[],t=s.length,r=0;r<t;r++)e.push(s[r].apply(null,arguments));return l.apply(null,e)}));return c.resultFunc=a,c.dependencies=s,c.recomputations=function(){return i},c.resetRecomputations=function(){return i=0},c}}var createSelector=createSelectorCreator(defaultMemoize);const listSelector=e=>e.list,getItems=createSelector(listSelector,(e=>{var t;return null!==(t=e.items)&&void 0!==t?t:[]})),isItemSelected=createSelector(listSelector,(e=>memoize((t=>e.selectedItemIds.includes(t))))),isEmptySelection=createSelector(listSelector,(e=>0===e.selectedItemIds.length)),getSelectedItems=createSelector(listSelector,getItems,((e,t)=>t.filter((t=>e.selectedItemIds.includes(t.identifier))))),getListItemByIdentifier=createSelector(getItems,(e=>memoize((t=>{var r;return null!==(r=e.find((e=>t===e.identifier)))&&void 0!==r?r:null})))),isInSearchMode=createSelector(listSelector,(e=>null!==e.searchTerm)),getSearchTermString=createSelector(listSelector,(e=>{var t;return null!==(t=e.searchTerm)&&void 0!==t?t:""})),treeSelector=e=>e.tree,getTreeNodes=createSelector(treeSelector,(e=>e.nodes)),getTreeNodeByIdentifier=createSelector(getTreeNodes,(e=>memoize((t=>{var r;return null!==(r=e.find((e=>t===e.identifier)))&&void 0!==r?r:null})))),getSelectedTreeNode=createSelector(treeSelector,(e=>{var t;return null!==(t=e.nodes.find((t=>t.identifier===e.selectedNodeId)))&&void 0!==t?t:null})),getLastSelectedTreeNodeId=createSelector(treeSelector,(e=>e.selectedNodeId)),getExpandedTreeNodeIds=createSelector(treeSelector,(e=>e.expandedNodeIds)),getSelectedTreeNodePath=createSelector(getTreeNodes,getSelectedTreeNode,((e,t)=>resolveNodePath(e,t))),selectedTreeNodeIdentifiers=createSelector(treeSelector,(e=>null===e.selectedNodeId?[]:[e.selectedNodeId])),fetchListData=(e,t,r)=>e.ofType(LOAD_LIST_DATA).pipe(switchMap((e=>r.apiService.getJSON(e.url).pipe(mergeMap((e=>[new ClearSelection,new LoadListDataSuccess(e)])),catchError((e=>of(new LoadListDataFailure(e.message)))))))),selectFirstNodeOnFetchListDataError=(e,t)=>e.ofType(LOAD_LIST_DATA_FAILURE).pipe(filter((e=>e.error.includes("404"))),debounceTime(100),withLatestFrom(t),map((([,e])=>e)),filter((e=>getTreeNodes(e).length>0)),filter((e=>null!==getLastSelectedTreeNodeId(e))),filter((e=>null===getSelectedTreeNode(e))),map((e=>getTreeNodes(e)[0])),mergeMap((e=>[new SelectTreeNode(e.identifier),new LoadListData(e.folderUrl)]))),searchTermChanged=(e,t)=>e.ofType(SEARCH_TERM_CHANGED).pipe(debounceTime(500),distinctUntilChanged(),withLatestFrom(t),map((([e,t])=>{if(""!==e.searchTerm)return new SearchFiles(e.searchTerm);const r=getSelectedTreeNode(t)||getTreeNodes(t)[0];return new LoadListData(r.folderUrl)}))),searchFiles=(e,t,r)=>e.ofType(SEARCH_FILES).pipe(switchMap((e=>{const t=getUrl("searchFilesUrl",{search:e.searchTerm});return r.apiService.getJSON(t).pipe(mergeMap((e=>[new ClearSelection,new SearchFilesSuccess(e)])),catchError((e=>of(new SearchFilesFailure(e.message)))))}))),reloadListData=(e,t)=>e.ofType(RELOAD_LIST_DATA).pipe(withLatestFrom(t),map((([,e])=>{if(isInSearchMode(e))return new SearchFiles(getSearchTermString(e));const t=getSelectedTreeNode(e)||getTreeNodes(e)[0];return new LoadListData(t.folderUrl)}))),listActions=[fetchListData,selectFirstNodeOnFetchListDataError,searchTermChanged,searchFiles,reloadListData],fetchTreeData=(e,t,r)=>{let o=!1;return e.ofType(LOAD_TREE_DATA).pipe(tap((e=>o=e.init)),switchMap((()=>r.apiService.getJSON(getUrl("treeUrl")).pipe(mergeMap((e=>{const t=[new LoadTreeDataSuccess(e)];if(o&&e.length>0){const r=e[0];r.parentsStateIdentifier=[],t.push(new ExpandTreeNode(r.identifier)),t.push(new SelectTreeNode(r.identifier)),t.push(new LoadListData(r.folderUrl))}return t})),catchError((e=>of(new LoadTreeDataFailure(e.message))))))))},selectTreeNode=e=>e.ofType(SELECT_TREE_NODE).pipe(distinctUntilChanged(),tap((e=>window.location.hash=e.identifier)),ignoreElements()),treeActions=[fetchTreeData,selectTreeNode],reload=e=>e.ofType(RELOAD).pipe(mergeMap((()=>[new LoadTreeData(!1),new ReloadListData]))),loadFlashMessages=(e,t,r)=>e.ofType(LOAD_FLASH_MESSAGES).pipe(switchMap((e=>r.flashMessagesService.fetchFlashMessages(e)))),saveViewMode=e=>e.ofType(SET_VIEW_MODE).pipe(tap((e=>localStorage.setItem("t3-file-list-view-mode",e.viewmode.toString()))),ignoreElements()),rootEpic=combineEpics(...fileActions,...listActions,...treeActions,reload,loadFlashMessages,saveViewMode);class MessageHandler{static sendPostMessage(e,t){e.filter((e=>null!==e)).map((e=>e)).forEach((e=>e.postMessage(t,e.origin)))}}const SNACKBAR_ACTION_MESSAGE_TYPE="typo3-snackbar-action",SHOW_SNACKBAR_MESSAGE_TYPE="typo3-show-snackbar";class ShowSnackbarMessage{constructor(e){this.data=e,this.type=SHOW_SNACKBAR_MESSAGE_TYPE}}class FlashMessagesService{constructor(e){this.apiService=e}fetchFlashMessages(e){const t=getUrl("flashMessagesUrl");return this.apiService.getJSON(t).pipe(map((t=>{const r=new ShowSnackbarMessage({title:e.message,message:t.map((e=>e.message)).join("\n"),severity:e.severity,duration:5,dismissible:!0});return e.undoAction&&(r.data.buttons=[{label:translate("undo"),color:"default",action:"undo",data:e.undoAction}]),MessageHandler.sendPostMessage([top],r),e.undoAction})),filter((e=>void 0!==e)),switchMap((t=>fromEvent(window,"message").pipe(map((e=>e.data)),filter((e=>SNACKBAR_ACTION_MESSAGE_TYPE==e.type)),filter((e=>isEqual(e.actionData.data.formData,t.formData))),timeout(5e3),take(1),catchError((()=>EMPTY)),map((()=>e.undoAction))))))}}const isExecutingFileAction=createSelector((e=>e),(e=>e.isUploadingFiles||e.isDeletingFiles||e.isAddingFolder||e.isRenamingFile||e.isMovingFiles||e.isCopyingFiles||e.isPastingFiles||e.isUndoingFileAction||e.isReplacingFile)),fileActionsSelector=e=>e.fileActions,getDragMode=createSelector(fileActionsSelector,(e=>e.dragFilesMode)),isCopyDragMode=createSelector(fileActionsSelector,(e=>"copy"===e.dragFilesMode)),isDraggingFiles=createSelector(fileActionsSelector,(e=>e.isDraggingFiles)),isDownloadingFiles=createSelector(fileActionsSelector,(e=>e.isDownloadingFiles)),isLoading=createSelector((e=>e),(e=>isExecutingFileAction(e.fileActions)||e.list.loading||e.tree.loading)),layoutSelector=e=>e.layout,getSidebarWidth=createSelector(layoutSelector,(e=>e.sidebarWidth)),isSidebarVisible=createSelector(layoutSelector,(e=>e.sidebarVisible)),viewModeSelector=e=>e.viewMode,isListMode=createSelector(viewModeSelector,(e=>e.mode===ViewMode.LIST)),isTilesMode=createSelector(viewModeSelector,(e=>e.mode===ViewMode.TILES)),getSortField=createSelector(viewModeSelector,(e=>e.order.field)),getSortDirection=createSelector(viewModeSelector,(e=>e.order.direction)),isSortField=createSelector(viewModeSelector,(e=>memoize((t=>e.order.field===t)))),isSortDirection=createSelector(viewModeSelector,(e=>memoize((t=>e.order.direction===t))));class UndoActionResolverService{getUndoAction(e,t,r){switch(e.type){case RENAME_FILE:return this.getUndoRenameAction(e,t.response,r);case MOVE_FILES:return this.getUndoMoveAction(e,t.response,r);case COPY_FILES:return this.getUndoCopyAction(e,t.response);case ADD_FOLDER:return this.getUndoAddFolderAction(e,t.response)}}getUndoRenameAction(e,t,r){const o=this.getItemFromStore(r,e.identifier);if(null===o)return;const n=isString(t.rename[0])?t.rename[0]:t.rename[0].identifier,i={"data[rename][0][data]":extractStorageFromIdentifier(e.identifier)+n,"data[rename][0][target]":o.name};return new UndoFilesAction(i)}getUndoMoveAction(e,t,r){const o={};return e.identifiers.forEach(((e,n)=>{const i=this.getItemFromStore(r,e);if(null===i)return;if(!Object.prototype.hasOwnProperty.call(t.move,n))return;const a=t.move[n],s=isString(a)?a:a.identifier,l=extractStorageFromIdentifier(e)+s;o["data[move]["+n+"][data]"]=l,o["data[move]["+n+"][target]"]=i.parentIdentifier})),new UndoFilesAction(o)}getUndoCopyAction(e,t){const r={};return t.copy.forEach(((t,o)=>{if(!Object.prototype.hasOwnProperty.call(e.identifiers,o))return;const n=e.identifiers[o],i=isString(t)?t:t.identifier,a=extractStorageFromIdentifier(n)+i;r["data[delete]["+o+"][data]"]=a})),new UndoFilesAction(r)}getUndoAddFolderAction(e,t){const r={};return t.newfolder.forEach(((t,o)=>{const n=extractStorageFromIdentifier(e.parentNode.identifier)+t;r["data[delete]["+o+"][data]"]=n})),new UndoFilesAction(r)}getItemFromStore(e,t){return getTreeNodeByIdentifier(e)(t)||getListItemByIdentifier(e)(t)}}const SHOW_MODAL_MESSAGE_TYPE="typo3-show-modal";class ShowModalMessage{constructor(e){this.data=e,this.type=SHOW_MODAL_MESSAGE_TYPE}}const MODAL_CLOSED_MESSAGE_TYPE="typo3-modal-closed";class ModalService{openModal(e){return MessageHandler.sendPostMessage([top],new ShowModalMessage(e)),fromEvent(window,"message").pipe(map((e=>e.data)),filter((e=>MODAL_CLOSED_MESSAGE_TYPE===e.type)),take(1))}}class ApiService{static detectSessionTimeout(e){if(e.xhr.responseURL.match(/login/))throw top.location.href=e.xhr.responseURL,Error("Login required")}getJSON(e){return ajax.get(e).pipe(tap(ApiService.detectSessionTimeout),map((e=>e.response)),catchError((e=>throwError(e))))}postFormData(e,t){return ajax.post(e,t).pipe(tap(ApiService.detectSessionTimeout),catchError((e=>throwError(e))))}}const allowCustomActionObjectsMiddleWare=()=>e=>t=>{e({...t})},epicMiddleware=createEpicMiddleware({dependencies:{flashMessagesService:new FlashMessagesService(new ApiService),undoActionResolverService:new UndoActionResolverService,modalService:new ModalService,apiService:new ApiService}}),enhancer=[];"development"===process.env.NODE_ENV&&window.__REDUX_DEVTOOLS_EXTENSION__&&enhancer.push(window.__REDUX_DEVTOOLS_EXTENSION__());const store=createStore(rootReducer,compose(applyMiddleware(allowCustomActionObjectsMiddleWare,epicMiddleware),...enhancer));epicMiddleware.run(rootEpic);const connect=e=>t=>class extends t{connectedCallback(){super.connectedCallback&&super.connectedCallback(),this._storeUnsubscribe=e.subscribe((()=>this.stateChanged(e.getState()))),this.stateChanged(e.getState())}disconnectedCallback(){this._storeUnsubscribe(),super.disconnectedCallback&&super.disconnectedCallback()}stateChanged(e){}};var css_248z$r=css`:host{height:100vh;width:100vw}.topbar-wrapper{background-color:var(--typo3-topbar-wrapper-background-color,var(--typo3-global-gray-lighter));padding-top:2rem;border-bottom:var(--typo3-global-default-border-width) solid var(--typo3-global-modal-border-color)}.topbar-wrapper typo3-topbar:last-child{border-top:var(--typo3-global-default-border-width) solid var(--typo3-global-modal-border-color);background-color:#f4f4f4;min-height:3rem}typo3-splitpane{flex:1}.content{height:100%;width:100%;display:flex}.navigation-switcher{border-right:1px solid #c3c3c3;margin-right:-.2rem;z-index:4}.content_left,.content_right{display:flex;flex-direction:column;flex:1;height:100%;overflow:hidden;background-color:#fff;min-width:12.5rem}typo3-filetree{overflow:auto;flex:1}.loading{display:block;position:fixed;top:0;left:0;width:100%;height:100%;background-color:hsla(0,0%,100%,.5);z-index:100}.loading typo3-spinner{top:50%;position:relative}.main-content{background-color:#fff;flex:1;overflow:auto;margin:.75rem}.main-content-info{align-items:center;justify-content:center;display:flex;flex-direction:column}typo3-datagrid.main-content{overflow:none;margin-bottom:0}#storage_select a{text-decoration:none}typo3-breadcrumb{overflow:hidden;margin-right:var(--typo3-global-default-gap);flex:1}typo3-breadcrumb-item{cursor:pointer}.dropzone-drop-message{width:95%;height:95%;margin:auto;box-sizing:border-box;border:.125rem dotted #fff;display:flex;z-index:1002;align-items:center;justify-content:center;flex-direction:column;color:#fff}.dropzone-drop-message__title{font-size:1.5rem;margin-bottom:var(--typo3-global-default-gap)}typo3-draghandler,typo3-files-modal{position:absolute;top:-1000px}`;class IconUrlService{constructor(e){this.appService=e}get(e){const t=this.appService.getAppConfig().iconUrls;return Object.prototype.hasOwnProperty.call(t,e)?t[e]:""}}const service$2=new IconUrlService(new AppConfigService),getIconUrl=e=>service$2.get(e);function createSVGElement(e,t){return html`<svg slot="${ifDefined(t)}"><use xlink:href="" xlink:href="${getIconUrl(e)}"></use></svg>`}class DatagridSorter{static getDatagridSorters(e){return{string:(t,r)=>{const o="asc"===r;return(r,n)=>{if(r.sysType!=n.sysType)return"_FILE"===r.sysType?0:1;const i=r[t],a=n[t];if(null==i)return 1;if(null==a)return 0;const s=find(e,["name",t]);if(s&&has(s,"sortField")){const e=s.sortField,t=parseInt(r[e],10),i=parseInt(n[e],10);return o?t-i:i-t}return o?i.localeCompare?i.localeCompare(a):1:a.localeCompare?a.localeCompare(i):1}}}}}let Typo3Filestorage=class extends(connect(store)(LitElement)){constructor(){super(),this.storages=[],this.selectedStorageUid=0,this.itemsDragDropEnabled=!1,this.itemsEditEnabled=!1,this._onWindowHashChange=()=>{const e=window.location.hash.replace("#",""),t=getTreeNodeByIdentifier(this.state)(e);t&&t.identifier!==getLastSelectedTreeNodeId(this.state)&&(store.dispatch(new SelectTreeNode(t.identifier)),store.dispatch(new LoadListData(t.folderUrl)))},this.apiService=new ApiService}stateChanged(e){this.state=e}connectedCallback(){super.connectedCallback(),this.addEventListener("dragend",this._onDragEnd),this.addEventListener("dragover",this._onDragOver),window.addEventListener("hashchange",this._onWindowHashChange)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("dragend",this._onDragEnd),this.addEventListener("dragover",this._onDragOver),window.addEventListener("hashchange",this._onWindowHashChange)}refresh(){store.dispatch(new Reload)}get datagridSchema(){const e=[{name:"identifier",type:"text",title:" ",hidden:!0,sortable:!1},{name:"selected",type:"html",title:" ",width:"24"},{name:"icon",type:"html",title:" ",width:"24",sortable:!1},{name:"name",title:translate("field.name"),sortable:!0,minWidth:"150"},{name:"modified",title:translate("field.modified"),width:"100",sortable:!0,sortField:"modifiedRaw"},{name:"size",title:translate("field.size"),width:"100",sortable:!0,sortField:"sizeRaw"},{name:"type",title:translate("field.type"),width:"100"},{name:"variants",title:translate("field.variants"),width:"100"},{name:"references",type:"number",title:translate("field.references"),width:"100"},{name:"rw",title:translate("field.rw"),width:"50"}];return isInSearchMode(this.state)&&e.splice(2,0,{name:"path",title:translate("field.path")}),e}_onSplitterDragend(){dispatchEvent(new Event("resize"));const e=this.contentLeft.offsetWidth+this.contentRight.offsetWidth;store.dispatch(new SetSidebarWidth(Math.round(this.contentLeft.offsetWidth/e*100)))}_onSelectedNode(e){store.dispatch(new SelectTreeNode(e.identifier)),store.dispatch(new LoadListData(e.folderUrl))}_onContextMenu(e,t="list"){e.detail.event.preventDefault(),e.detail.event.stopImmediatePropagation();const r=getSelectedItems(this.state);let o=[e.detail.node];"list"===t&&r.length>0&&some(r,{identifier:e.detail.node.identifier})&&(o=r);const n=getUrl("ajax_contextmenu",{table:e.detail.node.contextMenuType,uid:JSON.stringify(o.map((e=>e.identifier))),context:t});this.apiService.getJSON(n).pipe(take(1),map((e=>this.filterContextMenuOptions(Object.values(e)))),tap((t=>{dispatchEvent(new CustomEvent("typo3-show-context-menu",{detail:{sourceEvent:e.detail.event,options:t,context:o}}))})),catchError((e=>(console.log("todo: handle error on loading context-menu options",e),EMPTY)))).subscribe()}_onContextMenuWithoutContext(e){const t=getSelectedTreeNode(this.state);if(null===t||isInSearchMode(this.state))return;const r=new CustomEvent("unassigned-contextMenu",{detail:{node:t,event:e}});this._onContextMenu(r)}_onSelectViewMode(e){const t=Object.values(ViewMode)[e.detail.index];store.dispatch(new SetViewMode(t))}_onSelectSortField(e){store.dispatch(new SetSortOrderField(e))}_onSelectSortDirection(e){store.dispatch(new SetSortOrderDirection(e))}_onClearSelection(){store.dispatch(new ClearSelection)}_onDatagridSelectionChange(e){store.dispatch(new SetSelection(e.detail.map((e=>e.identifier))))}_onCardgridSelectionChange(e){store.dispatch(new SetSelection(e.detail.map((e=>""+e.value))))}_onNodeExpand(e){store.dispatch(new ExpandTreeNode(e.detail.identifier))}_onNodeCollapse(e){store.dispatch(new CollapseTreeNode(e.detail.identifier))}_onDeleteClicked(){const e=getSelectedItems(this.state).map((e=>e.identifier));store.dispatch(new DeleteFilesConfirm(e))}_onRename(e,t){store.dispatch(new RenameFile(e,t))}_onFolderAdd(e,t){store.dispatch(new AddFolder(e,t))}_onFileDialogUpload(){const e=getSelectedTreeNode(this.state),t={files:this.fileUploadInput.files},r=new UploadFiles(t,e);store.dispatch(r)}_onDragAndDropFileUpload(e){const t=getSelectedTreeNode(this.state),r=new UploadFiles(e.detail.dataTransfer,t);store.dispatch(r)}_onDropZoneShouldAccept(e){if(null==getSelectedTreeNode(this.state))return void e.preventDefault();if(null===e.detail.dataTransfer)return void e.preventDefault();-1!==e.detail.dataTransfer.types.indexOf("Files")||e.preventDefault()}_onContextMenuItemClick(e){const t=e.detail.context,r=e.detail.context[0],o=e.detail.option.callbackAction,n=t.map((e=>e.identifier));let i=null;const a=e.detail.option.additionalAttributes;switch(o){case"openInfoPopUp":i=new ShowFileInfo(r.identifier,r.sysType);break;case"showFile":i=new ShowFile(a["data-url"]);break;case"download":i=new DownloadFiles(n);break;case"deleteFile":i=new DeleteFilesConfirm(n);break;case"addFolder":this.fileTree.addNode(r.identifier);break;case"copyFile":i=new ClipboardCopyFile(t);break;case"cutFile":i=new ClipboardCutFile(t);break;case"pasteFileInto":i=new ClipboardPaste(r.identifier);break;case"editFileStorage":i=new EditFileStorage(r.identifier);break;case"replaceFile":i=new ReplaceFileConfirm(r.identifier);break;default:console.info("Todo: Implement cb action",e.detail.option)}null!==i&&store.dispatch(i)}_onDragStart(e){store.dispatch(new DragFilesStart);const t=document.createElement("div");t.textContent=".",t.style.position="absolute",document.body.appendChild(t),e.dataTransfer.setDragImage(t,0,0)}_onTreeNodeDrop(e){const t=getSelectedItems(this.state).map((e=>e.identifier));store.dispatch(new DragFilesEnd);const r=isCopyDragMode(this.state)?new CopyFiles(t,e.detail.node):new MoveFiles(t,e.detail.node);store.dispatch(r)}_onDragEnd(){store.dispatch(new DragFilesEnd)}_onDragOver(e){const t=1==e.ctrlKey?"copy":"move";t!=getDragMode(this.state)&&store.dispatch(new DragFilesChangeMode(t)),this.filesDragHandler.style.top=e.offsetY+10+"px",this.filesDragHandler.style.left=e.offsetX+"px"}_showFilesModalDialog(e){this.moveFilesModal.nodes=getTreeNodes(this.state),this.moveFilesModal.expandedNodeIds=getExpandedTreeNodeIds(this.state),this.moveFilesModal.selectedFiles=getSelectedItems(this.state),this.moveFilesModal.mode=e,this.moveFilesModal.show()}_onMoveFilesModal(e){const t="copy"===e.detail.mode?new CopyFiles(e.detail.files.map((e=>e.identifier)),e.detail.target):new MoveFiles(e.detail.files.map((e=>e.identifier)),e.detail.target);store.dispatch(t)}_onDownload(){const e=getSelectedItems(this.state).map((e=>e.identifier)),t=new DownloadFiles(e);store.dispatch(t)}_onTreeNodeMove(e){const t=new MoveFiles([e.detail.node.identifier],e.detail.target);store.dispatch(t)}_onItemDblClick(e){if("_FOLDER"!==e.sysType)e.metaDataUrl&&store.dispatch(new EditFileMetadata(e.metaDataUrl));else{const t=getTreeNodeByIdentifier(this.state)(e.identifier);null!==t&&this._onSelectedNode(t)}}_onFilesSearch(e){store.dispatch(new SearchTermChanged(e.detail))}_onToggleFileTree(){store.dispatch(new ToggleSidebar),setTimeout((()=>window.dispatchEvent(new Event("resize"))),2)}_orderItemsForCardgridView(e){return orderBy(e,[e=>"_FOLDER"===e.sysType,getSortField(this.state)],["desc",getSortDirection(this.state)])}firstUpdated(e){super.firstUpdated(e),store.dispatch(new LoadTreeData)}render(){return html`<div class="content">${!1===isSidebarVisible(this.state)?html`<div class="navigation-switcher"><div class="topbar-wrapper"><typo3-topbar><div slot="right">${this.renderTreeToggleButton}</div></typo3-topbar><typo3-topbar></typo3-topbar></div></div>`:html``}<typo3-splitpane @splitter-dragend="${this._onSplitterDragend}"><div class="content_left" style="${styleMap({flex:"1 1 "+getSidebarWidth(this.state)+"%",display:isSidebarVisible(this.state)?"":"none"})}"><div class="topbar-wrapper"><typo3-topbar><div slot="left">${this.renderStoragesDropDown}</div><div slot="right">${this.renderTreeToggleButton}</div></typo3-topbar><typo3-topbar><div slot="left">${this.renderNewFolderButton} ${this.renderUploadButton}</div></typo3-topbar></div>${this.renderFolderTree}</div><typo3-dropzone class="content_right" style="${"flex: 1 1 "+(100-getSidebarWidth(this.state))+"%"}" @typo3-dropzone-drop="${this._onDragAndDropFileUpload}" @typo3-dropzone-should-accept="${this._onDropZoneShouldAccept}"><div slot="allowed-drop-message" class="dropzone-drop-message"><span class="dropzone-drop-message__title">${translate("dragFiles.allowed.header")}</span> <span>${translate("dragFiles.allowed.message")}</span></div><div slot="denied-drop-message" class="dropzone-drop-message"><span class="dropzone-drop-message__title">${translate("dragFiles.denied.header")}</span> <span>${translate("dragFiles.denied.message")}</span></div><div class="topbar-wrapper"><typo3-topbar><div slot="left">${this.renderBreadcrumb}</div><div slot="right">${this.renderSearchField} ${this.renderSortingDropdown} ${this.renderViewModeDropDown}</div></typo3-topbar><typo3-topbar><div slot="left">${this.renderDownloadButton} ${this.renderDeleteButton} ${this.renderMoveToButton} ${this.renderCopyToButton}</div><div slot="right">${this.renderSelectionButton}</div></typo3-topbar></div>${this.renderMainContent}</typo3-dropzone></typo3-splitpane></div><typo3-context-menu @typo3-context-menu-item-click="${this._onContextMenuItemClick}"></typo3-context-menu>${this.renderDragHandler}<typo3-files-modal @typo3-move-files="${this._onMoveFilesModal}"></typo3-files-modal>`}get renderBreadcrumb(){if(isInSearchMode(this.state))return html`<span>${translate("labels.search")}: ${getSearchTermString(this.state)}</span>`;const e=getSelectedTreeNodePath(this.state).map((e=>html`<typo3-breadcrumb-item slot="item" title="${e.name}" @click="${()=>this._onSelectedNode(e)}" ?active="${e===getSelectedTreeNode(this.state)}"></typo3-breadcrumb-item>`));return html`<typo3-breadcrumb>${e}</typo3-breadcrumb>`}get renderMainContent(){const e=this.listItems;if(0===e.length)return this.renderEmptyContent;if(isListMode(this.state)){const t=e.map((e=>{const t=isItemSelected(this.state)(e.identifier),r=t?"actions-check-circle-alt":"actions-circle",o=t?"#0078e6":"#777";return e.notSelectable?e:{...e,selected:`<svg class="icon-color" role="img" fill="${o}"><use xlink:href="${getIconUrl(r)}" /></svg>`}})),r=DatagridSorter.getDatagridSorters(this.datagridSchema);return html`<typo3-datagrid class="main-content" draggable="${!this.itemsDragDropEnabled||isEmptySelection(this.state)?"false":"true"}" .schema="${this.datagridSchema}" .data="${t}" .editableColumns="${this.itemsEditEnabled?["name"]:[]}" .selectedRows="${getSelectedItems(this.state)}" .sorters="${r}" ascArrowSvgUrl="${getIconUrl("actions-sort-amount-up")}" descArrowSvgUrl="${getIconUrl("actions-sort-amount-down")}" @dragstart="${this._onDragStart}" @contextmenu="${this._onContextMenuWithoutContext}" @typo3-datagrid-selection-change="${this._onDatagridSelectionChange}" @typo3-datagrid-contextmenu="${this._onContextMenu}" @typo3-datagrid-dblclick="${e=>this._onItemDblClick(e.detail)}" @typo3-datagrid-value-change="${e=>this._onRename(e.detail.data.identifier,e.detail.data.name)}"></typo3-datagrid><defs><circle id="myCircle" cx="0" cy="0" r="5"></defs>`}const t=this._orderItemsForCardgridView(e),r=t.map((e=>e.identifier)).join(",");return html`<typo3-grid class="main-content" hash="${r}" selectable @contextmenu="${this._onContextMenuWithoutContext}" @typo3-grid-selection-changed="${this._onCardgridSelectionChange}" @click="${this._onClearSelection}">${t.map((e=>this.renderCardContent(e)))}</typo3-grid>`}renderCardContent(e){const t=addSlotToRawHtml(e.cardFolderIcon||e.icon,"image");let r=html`${unsafeHTML(t)}`;e.thumbnailUrl&&(r=html`<img slot="image" loading="lazy" src="${e.thumbnailUrl}" alt="${e.name}">`);let o=html``,n="file";if("_FOLDER"===e.sysType){const t=parseInt(e.size.replace(/^\D+/g,""),10);o=html`<span slot="badge">${t}</span>`,n="folder"}const i=isItemSelected(this.state)(e.identifier);return html`<typo3-card slot="item" ?disabled="${ifDefined(e.disabled)}" ?notSelectable="${ifDefined(e.notSelectable)}" ?selected="${i}" value="${e.identifier}" title="${e.name}" subtitle="${e.modified}" variant="${e.thumbnailUrl?"preview":n}" ?titleEditable="${this.itemsEditEnabled&&i}" draggable="${!this.itemsDragDropEnabled||isEmptySelection(this.state)?"false":"true"}" @dragstart="${this._onDragStart}" @contextmenu="${t=>{this._onContextMenu(new CustomEvent("typo3-card-context-menu",{detail:{event:t,node:e}}))}}" @dblclick="${()=>this._onItemDblClick(e)}" @typo3-card-title-rename="${t=>this._onRename(e.identifier,t.detail)}">${createSVGElement(i?"actions-check-circle-alt":"actions-circle","checkbox")}${r} ${o}</typo3-card>`}get renderEmptyContent(){if(!0===isLoading(this.state))return html``;let e="lockedFolder",t="emptyFolder",r="readOnlyFolder";const o=getSelectedTreeNode(this.state);return isInSearchMode(this.state)?(e="search",t="fileSearch.noResults",r=""):o&&o.allowEdit&&(e="emptyFolder",r="dragFiles.message.upload"),html`<div class="main-content main-content-info">${createSVGElement(e)}<h3>${translate(t)}</h3><span>${translate(r)}</span></div>`}get renderViewModeDropDown(){return html`<typo3-dropdown activatable @selected="${this._onSelectViewMode}"><typo3-dropdown-button slot="button" color="default">${createSVGElement("view.mode","icon")} ${translate("view.mode")}</typo3-dropdown-button><typo3-dropdown-item value="${ViewMode.LIST}" ?selected="${isListMode(this.state)}">${createSVGElement("view.mode.list","icon")} <span>${translate("view.mode.list")}</span></typo3-dropdown-item><li divider></li><typo3-dropdown-item value="${ViewMode.TILES}" ?selected="${isTilesMode(this.state)}">${createSVGElement("view.mode.tiles","icon")} <span>${translate("view.mode.tiles")}</span></typo3-dropdown-item></typo3-dropdown>${isLoading(this.state)?html`<div class="loading"><typo3-spinner></typo3-spinner></div>`:html``}`}get renderSortingDropdown(){return html`<typo3-dropdown multi activatable><typo3-dropdown-button slot="button" color="default" .disabled="${isListMode(this.state)}">${createSVGElement("view.sorting","icon")} <span>${translate("view.sorting")}</span></typo3-dropdown-button>${this.datagridSchema.filter((e=>!0===e.sortable)).map((e=>{var t;const r=null!==(t=e.sortField)&&void 0!==t?t:e.name;return html`<typo3-dropdown-item activated group="sort_field" ?selected="${isSortField(this.state)(r)}" value="${r}" @click="${()=>this._onSelectSortField(r)}"><span>${e.title}</span></typo3-dropdown-item>`}))}<li divider></li>${[{title:translate("view.sortingdir.asc"),name:"asc"},{title:translate("view.sortingdir.desc"),name:"desc"}].map((e=>html`<typo3-dropdown-item activated group="sort_dir" ?selected="${isSortDirection(this.state)(e.name)}" value="${e.name}" @click="${()=>this._onSelectSortDirection(e.name)}"><span>${e.title}</span></typo3-dropdown-item>`))}</typo3-dropdown>`}get renderDownloadButton(){return html`<typo3-button @click="${this._onDownload}" .disabled="${isEmptySelection(this.state)||isDownloadingFiles(this.state)}">${createSVGElement("download","icon")} ${translate("download")}</typo3-button>`}get renderDeleteButton(){return html`<typo3-button .disabled="${isEmptySelection(this.state)}" @click="${this._onDeleteClicked}">${createSVGElement("delete","icon")} ${translate("delete")}</typo3-button>`}get renderMoveToButton(){return html`<typo3-button .disabled="${isEmptySelection(this.state)}" @click="${()=>this._showFilesModalDialog("move")}">${createSVGElement("moveTo","icon")} ${translate("moveTo")}</typo3-button>`}get renderCopyToButton(){return html`<typo3-button .disabled="${isEmptySelection(this.state)}" @click="${()=>this._showFilesModalDialog("copy")}">${createSVGElement("copyTo","icon")} ${translate("copyTo")}</typo3-button>`}get renderSelectionButton(){return html`<typo3-selection-button suffix="${translate("selected")}" count="${getSelectedItems(this.state).length}" @typo3-selection-clear="${this._onClearSelection}"></typo3-selection-button>`}get renderStoragesDropDown(){if(0==this.storages.length)return html``;const e=this.storages.find((e=>e.uid===this.selectedStorageUid));return html`<typo3-dropdown id="storage_select" activatable><typo3-dropdown-button slot="button" color="default">${unsafeHTML(addSlotToRawHtml(e.icon,"icon"))} ${e.name}</typo3-dropdown-button>${this.storages.map((e=>html`<a href="${e.storageUrl}"><typo3-dropdown-item ?selected="${e.uid===this.selectedStorageUid}">${unsafeHTML(addSlotToRawHtml(e.icon,"icon"))} ${e.name}</typo3-dropdown-item></a>`))}</typo3-dropdown>`}get renderNewFolderButton(){return html`<typo3-button .disabled="${null==getSelectedTreeNode(this.state)}" @click="${()=>{var e;return this.fileTree.addNode(null===(e=getSelectedTreeNode(this.state))||void 0===e?void 0:e.identifier)}}">${createSVGElement("addFolder","icon")} ${translate("new")}</typo3-button>`}get renderUploadButton(){return html`<typo3-button .disabled="${null==getSelectedTreeNode(this.state)}" @click="${()=>this.fileUploadInput.click()}">${createSVGElement("upload","icon")} ${translate("upload")}</typo3-button><input type="file" id="file_upload" hidden multiple="multiple" @change="${this._onFileDialogUpload}">`}get renderTreeToggleButton(){const e=isSidebarVisible(this.state)?"fileTree.collapse":"fileTree.expand",t=isSidebarVisible(this.state)?"actions-chevron-left":"actions-chevron-right";return html`<typo3-button title="${translate(e)}" label="${translate(e)}" @click="${this._onToggleFileTree}">${createSVGElement(t,"icon")}</typo3-button>`}get renderFolderTree(){return html`<typo3-filetree .nodes="${getTreeNodes(this.state)}" .expandedNodeIds="${getExpandedTreeNodeIds(this.state)}" .selectedNodeIds="${selectedTreeNodeIdentifiers(this.state)}" ?editable="${this.itemsEditEnabled}" ?dragDropEnabled="${this.itemsDragDropEnabled}" ?inDropMode="${isDraggingFiles(this.state)}" @typo3-node-drop="${this._onTreeNodeDrop}" @typo3-node-select="${e=>this._onSelectedNode(e.detail)}" @typo3-node-contextmenu="${e=>this._onContextMenu(e,"tree")}" @typo3-node-expand="${this._onNodeExpand}" @typo3-node-collapse="${this._onNodeCollapse}" @typo3-node-move="${this._onTreeNodeMove}" @typo3-node-rename="${e=>this._onRename(e.detail.node.identifier,e.detail.name)}" @typo3-node-add="${e=>this._onFolderAdd(e.detail.node,e.detail.parentNode)}"></typo3-filetree>`}get renderDragHandler(){let e="moveTo",t=translate("dnd.move.message"),r=translate("dnd.move.title");return isCopyDragMode(this.state)&&(e="copyTo",t=translate("dnd.copy.message"),r=translate("dnd.copy.title")),r=r.replace(/%\w*/gm,""+getSelectedItems(this.state).length),html`<typo3-draghandler .hidden="${!0!==isDraggingFiles(this.state)}">${createSVGElement(e,"icon")} <span slot="title">${r}</span> <span slot="message">${unsafeHTML(t)}</span></typo3-draghandler>`}get renderSearchField(){return html`<typo3-search placeholder="${translate("labels.search")}" label="${translate("labels.search")}" value="${getSearchTermString(this.state)}" @typo3-search-change="${this._onFilesSearch}">${createSVGElement("search","search-icon")} ${createSVGElement("reset","reset-icon")}</typo3-search>`}get listItems(){return getItems(this.state)}filterContextMenuOptions(e){return e}};Typo3Filestorage.styles=[css_248z$1,css_248z$r],__decorate([property({type:Array})],Typo3Filestorage.prototype,"storages",void 0),__decorate([property({type:Number})],Typo3Filestorage.prototype,"selectedStorageUid",void 0),__decorate([property({type:Boolean})],Typo3Filestorage.prototype,"itemsDragDropEnabled",void 0),__decorate([property({type:Boolean})],Typo3Filestorage.prototype,"itemsEditEnabled",void 0),__decorate([internalProperty()],Typo3Filestorage.prototype,"state",void 0),__decorate([query(".content_left")],Typo3Filestorage.prototype,"contentLeft",void 0),__decorate([query(".content_right")],Typo3Filestorage.prototype,"contentRight",void 0),__decorate([query("typo3-filetree")],Typo3Filestorage.prototype,"fileTree",void 0),__decorate([query("typo3-draghandler")],Typo3Filestorage.prototype,"filesDragHandler",void 0),__decorate([query("typo3-files-modal")],Typo3Filestorage.prototype,"moveFilesModal",void 0),__decorate([query("#file_upload")],Typo3Filestorage.prototype,"fileUploadInput",void 0),Typo3Filestorage=__decorate([customElement("typo3-filestorage")],Typo3Filestorage);var css_248z$s=css`typo3-grid>a{text-decoration:none}typo3-modal typo3-button{width:100%}typo3-alert svg{width:2rem;height:2rem;fill:var(--typo3-global-brand-info);margin-right:.5rem}`;let Typo3Storages=class extends LitElement{constructor(){super(...arguments),this.storages=[]}_onRefresh(){window.location.reload()}_onRelocate(e){window.location.href=e}render(){const e=getUrl("newStorageUrl");return html`
      <div class="content_left">
        <div class="topbar-wrapper">
          <typo3-topbar>
            <span slot="left">${translate("myStorages")}</span>
          </typo3-topbar>
          <typo3-topbar>
            <div slot="left">
              ${e?html`<typo3-button
                    @click="${()=>this._onRelocate(e)}"
                  >
                     ${createSVGElement("addFolder","icon")}
                     ${translate("new")}
                  </typo3-button`:html``}
            </div>
          </typo3-topbar>
        </div>
        ${this.renderContent()}
      </div>
    `}renderContent(){if(0===this.storages.length){const e=getUrl("switchUserUrl");return html` <typo3-modal id="modal" open="true">
        <h2>${translate("storagesAccessDeniedTitle")}</h2>
        <p>${translate("storagesAccessDeniedMessage")}</p>
        <p><strong>${translate("userName")}</strong> ${this.userName}</p>
        <div
          slot="footer"
          style="display: flex;width: 100%;align-items: center;flex-direction: column; gap: 10px;"
        >
          ${e?html`<typo3-button
                @click="${()=>this._onRelocate(e)}"
                >${translate("storagesAccessDeniedSwitchUser")}</typo3-button
              >`:html``}
          <typo3-button color="success" @click="${this._onRefresh}">
            ${translate("storagesAccessDeniedRefresh")}
            ${createSVGElement("refresh","icon")}
          </typo3-button>
        </div>
      </typo3-modal>`}return html` <div class="main-content">
      <typo3-alert color="primary" dismissible>
        ${createSVGElement("actions-info-circle-alt")}
        ${translate("selectStorageInfo")}
      </typo3-alert>
      <typo3-grid>
        ${this.storages.map((e=>this.renderStoragCard(e)))}
      </typo3-grid>
    </div>`}renderStoragCard(e){const t=addSlotToRawHtml(e.icon,"image");return html` <a href="${e.storageUrl}" slot="item">
      <typo3-card title="${e.name}" subtitle="${e.type}">
        ${unsafeHTML(t)}
      </typo3-card></a
    >`}};Typo3Storages.styles=[css_248z$1,css_248z$r,css_248z$s],__decorate([property({type:Array})],Typo3Storages.prototype,"storages",void 0),__decorate([property({type:String})],Typo3Storages.prototype,"userName",void 0),Typo3Storages=__decorate([customElement("typo3-storages")],Typo3Storages);var css_248z$t=css`typo3-splitpane{height:50vh;max-height:800px}.selected-files{padding:1rem}.selected-files-target{padding-bottom:1rem;min-height:2rem}.footer typo3-button{align-self:flex-end;width:4rem}typo3-list-item{border:var(--typo3-global-default-border-width) solid var(--typo3-global-modal-border-color);margin-bottom:.5rem;--typo3-list-item-icon-size:2rem}.item-body{display:flex;align-items:center}.file-data{flex:1;overflow:hidden;line-height:1.2rem}.file-title{font-size:var(--typo3-card-title-text-size,.875rem);color:var(--typo3-card-title-text-color,#505050);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.file-subtitle{font-size:var(--typo3-card-subtitle-text-size,.625rem);color:var(--typo3-card-subtitle-color,#6e6e6e)}.btn-remove{text-shadow:0 1px 0 #fff;background-color:transparent;border:none;cursor:pointer;font-size:1rem;opacity:.5;outline:none}.btn-remove:hover{opacity:1}typo3-splitpane>*{flex:1 1 50%}`;let Typo3FilesModal=class extends LitElement{constructor(){super(...arguments),this.mode="move",this.nodes=[],this.expandedNodeIds=[],this.selectedFiles=[],this.target=null}render(){const e=this.selectedFiles.map((e=>this.formatFileItem(e)));let t=translate("modal.move.title"),r=translate("modal.move.button"),o=translate("modal.move.message");return"copy"===this.mode&&(t=translate("modal.copy.title"),r=translate("modal.copy.button"),o=translate("modal.move.message")),o=o.replace(/%\w*/gm,""+this.selectedFiles.length),html`<typo3-modal headline="${t}" dismissible style="--typo3-modal-width:60vw;--typo3-modal-content-padding:0;--typo3-modal-footer-padding:0"><typo3-splitpane><div class="selected-files"><div class="selected-files-target" style="${styleMap({visibility:this.target?"visible":"hidden"})}">${o}<br><strong>${this._getFullPath(this.target)}</strong></div><typo3-list>${e}</typo3-list></div><typo3-filetree .nodes="${this.nodes}" .expandedNodeIds="${this.expandedNodeIds}" @typo3-node-select="${this._onSelectedNode}"></typo3-filetree></typo3-splitpane><div slot="footer"><typo3-button color="primary" @click="${this._onSubmit}" ?disabled="${null==this.target||0==this.selectedFiles.length}">${r}</typo3-button></div></typo3-modal>`}show(){this.target=null,this.modal.show()}_onSubmit(){const e=new CustomEvent("typo3-move-files",{detail:{mode:this.mode,files:this.selectedFiles,target:this.target}});this.dispatchEvent(e),this.modal.close()}_onSelectedNode(e){this.target=e.detail}_getFullPath(e){return resolveNodePath(this.nodes,e).map((e=>e.name)).join("/")}_onRemoveItem(e){this.selectedFiles=this.selectedFiles.filter((t=>t!=e))}formatFileItem(e){const t=addSlotToRawHtml(e.icon,"icon");let r=html`${unsafeHTML(t)}`;e.thumbnailUrl&&(r=html`<img slot="icon" loading="lazy" src="${e.thumbnailUrl}" alt="${e.name}">`);const o=html`<div class="item-body"><div class="file-data"><div class="file-title">${e.name}</div><div class="file-subtitle">${e.modified}</div></div><button class="btn-remove" style="${styleMap({visibility:this.selectedFiles.length>1?"visible":"hidden"})}" @click="${()=>this._onRemoveItem(e)}">Ã—</button></div>`;return html`<typo3-list-item>${r} ${o}</typo3-list-item>`}};Typo3FilesModal.styles=[css_248z$1,css_248z$t],__decorate([property({type:String})],Typo3FilesModal.prototype,"mode",void 0),__decorate([property({type:Array})],Typo3FilesModal.prototype,"nodes",void 0),__decorate([property({type:Array})],Typo3FilesModal.prototype,"expandedNodeIds",void 0),__decorate([property({type:Array})],Typo3FilesModal.prototype,"selectedFiles",void 0),__decorate([internalProperty()],Typo3FilesModal.prototype,"target",void 0),__decorate([query("typo3-modal")],Typo3FilesModal.prototype,"modal",void 0),Typo3FilesModal=__decorate([customElement("typo3-files-modal")],Typo3FilesModal);var css_248z$u=css`typo3-button{margin-top:1rem}`;let Typo3FileActionUndoButton=class extends(connect(store)(LitElement)){render(){return this.undoAction?html`<div><typo3-button @click="${this._onUndo}">${translate("undo")}</typo3-button></div>`:html``}_onUndo(){store.dispatch(this.undoAction),dispatchEvent(new CustomEvent("typo3-remove-snackbar"))}};Typo3FileActionUndoButton.styles=[css_248z$1,css_248z$u],__decorate([property({type:Object,reflect:!0})],Typo3FileActionUndoButton.prototype,"undoAction",void 0),Typo3FileActionUndoButton=__decorate([customElement("typo3-file-action-undo-button")],Typo3FileActionUndoButton);var css_248z$v=css`.topbar-wrapper{padding-top:0}.topbar-wrapper typo3-topbar:not(:first-child){display:none}.allowed-extensions typo3-badge{--typo3-badge-padding-small:0 0.25rem}typo3-card[disabled]{opacity:.2;cursor:not-allowed}:host{display:flex;flex-direction:column}.content{height:calc(100vh - 3.5rem)}`;class IframeHelper{static getContentIframe(){const e=top.document.getElementById("typo3-contentIframe");return e?e.contentWindow:null}static getModalIframe(){const e=top.document.getElementsByClassName("modal-iframe");return e.length>0?e.item(0).contentWindow:null}}let Typo3Filebrowser=class extends Typo3Filestorage{constructor(){super(...arguments),this.irreObjectId="",this.allowedFileExtensions=[],this.expandFolder=""}connectedCallback(){super.connectedCallback(),setTimeout((()=>dispatchEvent(new Event("resize"))),200),this.expandFolder&&store.dispatch(new ExpandTreeNode(this.expandFolder))}_onItemDblClick(e){if("_FOLDER"!=e.sysType){if(!0===e.disabled)return;return this._sendForeignInsertCommand([e.uid]),void MessageHandler.sendPostMessage([top],new ShowSnackbarMessage({duration:5,title:"",message:translate("file_browser.fileAdded"),severity:SeverityEnum.ok,dismissible:!0}))}super._onItemDblClick(e)}_onInsert(){const e=getSelectedItems(this.state).map((e=>e.uid));this._sendForeignInsertCommand(e),this._closeModal()}_closeModal(){parent.TYPO3.Modal.currentModal.trigger("modal-dismiss")}_sendForeignInsertCommand(e){e.forEach((e=>{const t={actionName:"typo3:foreignRelation:insert",objectGroup:this.irreObjectId,table:"sys_file",uid:e};MessageHandler.sendPostMessage([IframeHelper.getContentIframe()],t)}))}_itemIsSelectable(e){return"_FILE"===e.sysType&&(0==this.allowedFileExtensions.length||this.allowedFileExtensions.includes(e.extension))}_itemIsDisabled(e){return"_FILE"===e.sysType&&!1===this._itemIsSelectable(e)}_onDatagridSelectionChange(e){const t=e.detail.filter((e=>this._itemIsSelectable(e))).map((e=>e.identifier));store.dispatch(new SetSelection(t))}_onCardgridSelectionChange(e){const t=e.detail.map((e=>""+e.value)).map((e=>getListItemByIdentifier(this.state)(e))).filter((e=>e&&this._itemIsSelectable(e))).map((e=>e.identifier));store.dispatch(new SetSelection(t))}_orderItemsForCardgridView(e){return orderBy(e,["disabled",e=>"_FOLDER"===e.sysType,getSortField(this.state)],["asc","desc",getSortDirection(this.state)])}updated(e){super.updated(e),this.disabledCards.forEach((e=>e.addEventListener("mouseover",(()=>{this.disabledFileTooltip.anchor=e}))))}render(){return html`${super.render()} ${this.renderFooter} ${this.renderDisabledTooltip}`}get renderFooter(){return html`<div class="topbar-wrapper footer"><typo3-topbar><div slot="left" class="allowed-extensions">${this.renderAllowedFileExtensions}</div><div slot="right"><typo3-button @click="${this._closeModal}">${translate("button.cancel")}</typo3-button><typo3-button color="primary" .disabled="${isEmptySelection(this.state)}" @click="${this._onInsert}">${translate("file_browser.button.insert")}</typo3-button></div></typo3-topbar></div>`}get renderAllowedFileExtensions(){if(0===this.allowedFileExtensions.length)return html``;const e=this.allowedFileExtensions.map((e=>html`<typo3-badge color="success" size="small">${e}</typo3-badge>`));return html`<div>${translate("cm.allowedFileExtensions")}</div>${e}`}get renderDisabledTooltip(){return html`<typo3-tooltip>${translate("file_browser.fileNotAllowed")}</typo3-tooltip>`}get listItems(){return orderBy(super.listItems.map((e=>({...e,disabled:this._itemIsDisabled(e),notSelectable:!this._itemIsSelectable(e)}))),["disabled"],["asc"])}filterContextMenuOptions(e){const t=["addFolder"];return e.filter((e=>t.includes(e.callbackAction)))}};Typo3Filebrowser.styles=[css_248z$1,css_248z$r,css_248z$v],__decorate([property({type:String})],Typo3Filebrowser.prototype,"irreObjectId",void 0),__decorate([property({type:Array})],Typo3Filebrowser.prototype,"allowedFileExtensions",void 0),__decorate([property({type:String})],Typo3Filebrowser.prototype,"expandFolder",void 0),__decorate([query("typo3-tooltip")],Typo3Filebrowser.prototype,"disabledFileTooltip",void 0),__decorate([queryAll("typo3-card[disabled]")],Typo3Filebrowser.prototype,"disabledCards",void 0),Typo3Filebrowser=__decorate([customElement("typo3-filebrowser")],Typo3Filebrowser);let Typo3Folderbrowser=class extends Typo3Filestorage{constructor(){super(...arguments),this.irreObjectId="",this.expandFolder=""}connectedCallback(){super.connectedCallback(),setTimeout((()=>dispatchEvent(new Event("resize"))),200),this.expandFolder&&store.dispatch(new ExpandTreeNode(this.expandFolder))}_onItemDblClick(e){if(this._itemIsSelectable(e))return this._sendForeignInsertCommand([e.identifier]),void MessageHandler.sendPostMessage([top],new ShowSnackbarMessage({duration:5,title:"",message:translate("folder_browser.folderAdded"),severity:SeverityEnum.ok,dismissible:!0}));super._onItemDblClick(e)}_onInsert(){const e=getSelectedItems(this.state).map((e=>e.identifier));this._sendForeignInsertCommand(e),this._closeModal()}_closeModal(){parent.TYPO3.Modal.currentModal.trigger("modal-dismiss")}_sendForeignInsertCommand(e){e.forEach((e=>{const t={actionName:"typo3:foreignRelation:insert",objectGroup:this.irreObjectId,table:"sys_folder",uid:e};MessageHandler.sendPostMessage([IframeHelper.getContentIframe()],t)}))}_itemIsSelectable(e){return!1===this._itemIsDisabled(e)}_itemIsDisabled(e){return"_FOLDER"!=e.sysType}_onDatagridSelectionChange(e){const t=e.detail.filter((e=>this._itemIsSelectable(e))).map((e=>e.identifier));store.dispatch(new SetSelection(t))}_onCardgridSelectionChange(e){const t=e.detail.map((e=>""+e.value)).map((e=>getListItemByIdentifier(this.state)(e))).filter((e=>e&&this._itemIsSelectable(e))).map((e=>e.identifier));store.dispatch(new SetSelection(t))}_orderItemsForCardgridView(e){return orderBy(e,[e=>this._itemIsSelectable(e),getSortField(this.state)],["desc",getSortDirection(this.state)])}updated(e){super.updated(e),this.disabledCards.forEach((e=>e.addEventListener("mouseover",(()=>{this.disabledFileTooltip.anchor=e}))))}render(){return html`${super.render()} ${this.renderFooter} ${this.renderDisabledTooltip}`}get renderFooter(){return html`<div class="topbar-wrapper footer"><typo3-topbar><div slot="right"><typo3-button @click="${this._closeModal}">${translate("button.cancel")}</typo3-button><typo3-button color="primary" .disabled="${isEmptySelection(this.state)}" @click="${this._onInsert}">${translate("folder_browser.button.insert")}</typo3-button></div></typo3-topbar></div>`}get renderSearchField(){return html``}get renderDisabledTooltip(){const e=translate("folder_browser.fileNotAllowed");return html`<typo3-tooltip>${e}</typo3-tooltip>`}get listItems(){return orderBy(super.listItems.map((e=>({...e,disabled:this._itemIsDisabled(e),notSelectable:!this._itemIsSelectable(e)}))),["disabled"],["asc"])}filterContextMenuOptions(e){const t=["addFolder"];return e.filter((e=>t.includes(e.callbackAction)))}};Typo3Folderbrowser.styles=[css_248z$1,css_248z$r,css_248z$v],__decorate([property({type:String})],Typo3Folderbrowser.prototype,"irreObjectId",void 0),__decorate([property({type:String})],Typo3Folderbrowser.prototype,"expandFolder",void 0),__decorate([query("typo3-tooltip")],Typo3Folderbrowser.prototype,"disabledFileTooltip",void 0),__decorate([queryAll("typo3-card[disabled]")],Typo3Folderbrowser.prototype,"disabledCards",void 0),Typo3Folderbrowser=__decorate([customElement("typo3-folderbrowser")],Typo3Folderbrowser);
